(self["webpackChunk_tntx_remind"] = self["webpackChunk_tntx_remind"] || []).push([["vendors-node_modules_rc-t"],{

/***/ "./node_modules/rc-textarea/es/ResizableTextArea.js":
/*!**********************************************************!*\
  !*** ./node_modules/rc-textarea/es/ResizableTextArea.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_resize_observer__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! rc-resize-observer */ "./node_modules/rc-resize-observer/es/index.js");
/* harmony import */ var rc_util_es_omit__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rc-util/es/omit */ "./node_modules/rc-util/es/omit.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _calculateNodeHeight__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./calculateNodeHeight */ "./node_modules/rc-textarea/es/calculateNodeHeight.js");











 // eslint-disable-next-line @typescript-eslint/naming-convention

var RESIZE_STATUS;

(function (RESIZE_STATUS) {
  RESIZE_STATUS[RESIZE_STATUS["NONE"] = 0] = "NONE";
  RESIZE_STATUS[RESIZE_STATUS["RESIZING"] = 1] = "RESIZING";
  RESIZE_STATUS[RESIZE_STATUS["RESIZED"] = 2] = "RESIZED";
})(RESIZE_STATUS || (RESIZE_STATUS = {}));

var ResizableTextArea = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.default)(ResizableTextArea, _React$Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__.default)(ResizableTextArea);

  function ResizableTextArea(props) {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__.default)(this, ResizableTextArea);

    _this = _super.call(this, props);

    _this.saveTextArea = function (textArea) {
      _this.textArea = textArea;
    };

    _this.handleResize = function (size) {
      var resizeStatus = _this.state.resizeStatus;
      var _this$props = _this.props,
          autoSize = _this$props.autoSize,
          onResize = _this$props.onResize;

      if (resizeStatus !== RESIZE_STATUS.NONE) {
        return;
      }

      if (typeof onResize === 'function') {
        onResize(size);
      }

      if (autoSize) {
        _this.resizeOnNextFrame();
      }
    };

    _this.resizeOnNextFrame = function () {
      cancelAnimationFrame(_this.nextFrameActionId);
      _this.nextFrameActionId = requestAnimationFrame(_this.resizeTextarea);
    };

    _this.resizeTextarea = function () {
      var autoSize = _this.props.autoSize;

      if (!autoSize || !_this.textArea) {
        return;
      }

      var minRows = autoSize.minRows,
          maxRows = autoSize.maxRows;
      var textareaStyles = (0,_calculateNodeHeight__WEBPACK_IMPORTED_MODULE_11__.default)(_this.textArea, false, minRows, maxRows);

      _this.setState({
        textareaStyles: textareaStyles,
        resizeStatus: RESIZE_STATUS.RESIZING
      }, function () {
        cancelAnimationFrame(_this.resizeFrameId);
        _this.resizeFrameId = requestAnimationFrame(function () {
          _this.setState({
            resizeStatus: RESIZE_STATUS.RESIZED
          }, function () {
            _this.resizeFrameId = requestAnimationFrame(function () {
              _this.setState({
                resizeStatus: RESIZE_STATUS.NONE
              });

              _this.fixFirefoxAutoScroll();
            });
          });
        });
      });
    };

    _this.renderTextArea = function () {
      var _this$props2 = _this.props,
          _this$props2$prefixCl = _this$props2.prefixCls,
          prefixCls = _this$props2$prefixCl === void 0 ? 'rc-textarea' : _this$props2$prefixCl,
          autoSize = _this$props2.autoSize,
          onResize = _this$props2.onResize,
          className = _this$props2.className,
          disabled = _this$props2.disabled;
      var _this$state = _this.state,
          textareaStyles = _this$state.textareaStyles,
          resizeStatus = _this$state.resizeStatus;
      var otherProps = (0,rc_util_es_omit__WEBPACK_IMPORTED_MODULE_9__.default)(_this.props, ['prefixCls', 'onPressEnter', 'autoSize', 'defaultValue', 'onResize']);
      var cls = classnames__WEBPACK_IMPORTED_MODULE_10___default()(prefixCls, className, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__.default)({}, "".concat(prefixCls, "-disabled"), disabled)); // Fix https://github.com/ant-design/ant-design/issues/6776
      // Make sure it could be reset when using form.getFieldDecorator

      if ('value' in otherProps) {
        otherProps.value = otherProps.value || '';
      }

      var style = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, _this.props.style), textareaStyles), resizeStatus === RESIZE_STATUS.RESIZING ? // React will warning when mix `overflow` & `overflowY`.
      // We need to define this separately.
      {
        overflowX: 'hidden',
        overflowY: 'hidden'
      } : null);

      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createElement(rc_resize_observer__WEBPACK_IMPORTED_MODULE_8__.default, {
        onResize: _this.handleResize,
        disabled: !(autoSize || onResize)
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createElement("textarea", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, otherProps, {
        className: cls,
        style: style,
        ref: _this.saveTextArea
      })));
    };

    _this.state = {
      textareaStyles: {},
      resizeStatus: RESIZE_STATUS.NONE
    };
    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__.default)(ResizableTextArea, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.resizeTextarea();
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      // Re-render with the new content then recalculate the height as required.
      if (prevProps.value !== this.props.value) {
        this.resizeTextarea();
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      cancelAnimationFrame(this.nextFrameActionId);
      cancelAnimationFrame(this.resizeFrameId);
    } // https://github.com/ant-design/ant-design/issues/21870

  }, {
    key: "fixFirefoxAutoScroll",
    value: function fixFirefoxAutoScroll() {
      try {
        if (document.activeElement === this.textArea) {
          var currentStart = this.textArea.selectionStart;
          var currentEnd = this.textArea.selectionEnd;
          this.textArea.setSelectionRange(currentStart, currentEnd);
        }
      } catch (e) {// Fix error in Chrome:
        // Failed to read the 'selectionStart' property from 'HTMLInputElement'
        // http://stackoverflow.com/q/21177489/3040605
      }
    }
  }, {
    key: "render",
    value: function render() {
      return this.renderTextArea();
    }
  }]);

  return ResizableTextArea;
}(react__WEBPACK_IMPORTED_MODULE_7__.Component);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ResizableTextArea);

/***/ }),

/***/ "./node_modules/rc-textarea/es/calculateNodeHeight.js":
/*!************************************************************!*\
  !*** ./node_modules/rc-textarea/es/calculateNodeHeight.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "calculateNodeStyling": () => (/* binding */ calculateNodeStyling),
/* harmony export */   "default": () => (/* binding */ calculateNodeHeight)
/* harmony export */ });
// Thanks to https://github.com/andreypopp/react-textarea-autosize/

/**
 * calculateNodeHeight(uiTextNode, useCache = false)
 */
var HIDDEN_TEXTAREA_STYLE = "\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n";
var SIZING_STYLE = ['letter-spacing', 'line-height', 'padding-top', 'padding-bottom', 'font-family', 'font-weight', 'font-size', 'font-variant', 'text-rendering', 'text-transform', 'width', 'text-indent', 'padding-left', 'padding-right', 'border-width', 'box-sizing'];
var computedStyleCache = {};
var hiddenTextarea;
function calculateNodeStyling(node) {
  var useCache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var nodeRef = node.getAttribute('id') || node.getAttribute('data-reactid') || node.getAttribute('name');

  if (useCache && computedStyleCache[nodeRef]) {
    return computedStyleCache[nodeRef];
  }

  var style = window.getComputedStyle(node);
  var boxSizing = style.getPropertyValue('box-sizing') || style.getPropertyValue('-moz-box-sizing') || style.getPropertyValue('-webkit-box-sizing');
  var paddingSize = parseFloat(style.getPropertyValue('padding-bottom')) + parseFloat(style.getPropertyValue('padding-top'));
  var borderSize = parseFloat(style.getPropertyValue('border-bottom-width')) + parseFloat(style.getPropertyValue('border-top-width'));
  var sizingStyle = SIZING_STYLE.map(function (name) {
    return "".concat(name, ":").concat(style.getPropertyValue(name));
  }).join(';');
  var nodeInfo = {
    sizingStyle: sizingStyle,
    paddingSize: paddingSize,
    borderSize: borderSize,
    boxSizing: boxSizing
  };

  if (useCache && nodeRef) {
    computedStyleCache[nodeRef] = nodeInfo;
  }

  return nodeInfo;
}
function calculateNodeHeight(uiTextNode) {
  var useCache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var minRows = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
  var maxRows = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

  if (!hiddenTextarea) {
    hiddenTextarea = document.createElement('textarea');
    hiddenTextarea.setAttribute('tab-index', '-1');
    hiddenTextarea.setAttribute('aria-hidden', 'true');
    document.body.appendChild(hiddenTextarea);
  } // Fix wrap="off" issue
  // https://github.com/ant-design/ant-design/issues/6577


  if (uiTextNode.getAttribute('wrap')) {
    hiddenTextarea.setAttribute('wrap', uiTextNode.getAttribute('wrap'));
  } else {
    hiddenTextarea.removeAttribute('wrap');
  } // Copy all CSS properties that have an impact on the height of the content in
  // the textbox


  var _calculateNodeStyling = calculateNodeStyling(uiTextNode, useCache),
      paddingSize = _calculateNodeStyling.paddingSize,
      borderSize = _calculateNodeStyling.borderSize,
      boxSizing = _calculateNodeStyling.boxSizing,
      sizingStyle = _calculateNodeStyling.sizingStyle; // Need to have the overflow attribute to hide the scrollbar otherwise
  // text-lines will not calculated properly as the shadow will technically be
  // narrower for content


  hiddenTextarea.setAttribute('style', "".concat(sizingStyle, ";").concat(HIDDEN_TEXTAREA_STYLE));
  hiddenTextarea.value = uiTextNode.value || uiTextNode.placeholder || '';
  var minHeight = Number.MIN_SAFE_INTEGER;
  var maxHeight = Number.MAX_SAFE_INTEGER;
  var height = hiddenTextarea.scrollHeight;
  var overflowY;

  if (boxSizing === 'border-box') {
    // border-box: add border, since height = content + padding + border
    height += borderSize;
  } else if (boxSizing === 'content-box') {
    // remove padding, since height = content
    height -= paddingSize;
  }

  if (minRows !== null || maxRows !== null) {
    // measure height of a textarea with a single row
    hiddenTextarea.value = ' ';
    var singleRowHeight = hiddenTextarea.scrollHeight - paddingSize;

    if (minRows !== null) {
      minHeight = singleRowHeight * minRows;

      if (boxSizing === 'border-box') {
        minHeight = minHeight + paddingSize + borderSize;
      }

      height = Math.max(minHeight, height);
    }

    if (maxRows !== null) {
      maxHeight = singleRowHeight * maxRows;

      if (boxSizing === 'border-box') {
        maxHeight = maxHeight + paddingSize + borderSize;
      }

      overflowY = height > maxHeight ? '' : 'hidden';
      height = Math.min(maxHeight, height);
    }
  }

  return {
    height: height,
    minHeight: minHeight,
    maxHeight: maxHeight,
    overflowY: overflowY,
    resize: 'none'
  };
}

/***/ }),

/***/ "./node_modules/rc-textarea/es/index.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-textarea/es/index.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ResizableTextArea": () => (/* reexport safe */ _ResizableTextArea__WEBPACK_IMPORTED_MODULE_6__.default),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _ResizableTextArea__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ResizableTextArea */ "./node_modules/rc-textarea/es/ResizableTextArea.js");








var TextArea = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.default)(TextArea, _React$Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.default)(TextArea);

  function TextArea(props) {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.default)(this, TextArea);

    _this = _super.call(this, props);

    _this.focus = function () {
      _this.resizableTextArea.textArea.focus();
    };

    _this.saveTextArea = function (resizableTextArea) {
      _this.resizableTextArea = resizableTextArea;
    };

    _this.handleChange = function (e) {
      var onChange = _this.props.onChange;

      _this.setValue(e.target.value, function () {
        _this.resizableTextArea.resizeTextarea();
      });

      if (onChange) {
        onChange(e);
      }
    };

    _this.handleKeyDown = function (e) {
      var _this$props = _this.props,
          onPressEnter = _this$props.onPressEnter,
          onKeyDown = _this$props.onKeyDown;

      if (e.keyCode === 13 && onPressEnter) {
        onPressEnter(e);
      }

      if (onKeyDown) {
        onKeyDown(e);
      }
    };

    var value = typeof props.value === 'undefined' || props.value === null ? props.defaultValue : props.value;
    _this.state = {
      value: value
    };
    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.default)(TextArea, [{
    key: "setValue",
    value: function setValue(value, callback) {
      if (!('value' in this.props)) {
        this.setState({
          value: value
        }, callback);
      }
    }
  }, {
    key: "blur",
    value: function blur() {
      this.resizableTextArea.textArea.blur();
    }
  }, {
    key: "render",
    value: function render() {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(_ResizableTextArea__WEBPACK_IMPORTED_MODULE_6__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, this.props, {
        value: this.state.value,
        onKeyDown: this.handleKeyDown,
        onChange: this.handleChange,
        ref: this.saveTextArea
      }));
    }
  }], [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(nextProps) {
      if ('value' in nextProps) {
        return {
          value: nextProps.value
        };
      }

      return null;
    }
  }]);

  return TextArea;
}(react__WEBPACK_IMPORTED_MODULE_5__.Component);


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TextArea);

/***/ }),

/***/ "./node_modules/rc-tooltip/es/Content.js":
/*!***********************************************!*\
  !*** ./node_modules/rc-tooltip/es/Content.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");


var Content = function Content(props) {
  var overlay = props.overlay,
      prefixCls = props.prefixCls,
      id = props.id,
      overlayInnerStyle = props.overlayInnerStyle;
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: "".concat(prefixCls, "-inner"),
    id: id,
    role: "tooltip",
    style: overlayInnerStyle
  }, typeof overlay === 'function' ? overlay() : overlay);
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Content);

/***/ }),

/***/ "./node_modules/rc-tooltip/es/Tooltip.js":
/*!***********************************************!*\
  !*** ./node_modules/rc-tooltip/es/Tooltip.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_trigger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-trigger */ "./node_modules/rc-trigger/es/index.js");
/* harmony import */ var _placements__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./placements */ "./node_modules/rc-tooltip/es/placements.js");
/* harmony import */ var _Content__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Content */ "./node_modules/rc-tooltip/es/Content.js");










var Tooltip = function Tooltip(props, ref) {
  var overlayClassName = props.overlayClassName,
      _props$trigger = props.trigger,
      trigger = _props$trigger === void 0 ? ['hover'] : _props$trigger,
      _props$mouseEnterDela = props.mouseEnterDelay,
      mouseEnterDelay = _props$mouseEnterDela === void 0 ? 0 : _props$mouseEnterDela,
      _props$mouseLeaveDela = props.mouseLeaveDelay,
      mouseLeaveDelay = _props$mouseLeaveDela === void 0 ? 0.1 : _props$mouseLeaveDela,
      overlayStyle = props.overlayStyle,
      _props$prefixCls = props.prefixCls,
      prefixCls = _props$prefixCls === void 0 ? 'rc-tooltip' : _props$prefixCls,
      children = props.children,
      onVisibleChange = props.onVisibleChange,
      afterVisibleChange = props.afterVisibleChange,
      transitionName = props.transitionName,
      animation = props.animation,
      motion = props.motion,
      _props$placement = props.placement,
      placement = _props$placement === void 0 ? 'right' : _props$placement,
      _props$align = props.align,
      align = _props$align === void 0 ? {} : _props$align,
      _props$destroyTooltip = props.destroyTooltipOnHide,
      destroyTooltipOnHide = _props$destroyTooltip === void 0 ? false : _props$destroyTooltip,
      defaultVisible = props.defaultVisible,
      getTooltipContainer = props.getTooltipContainer,
      overlayInnerStyle = props.overlayInnerStyle,
      restProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__.default)(props, ["overlayClassName", "trigger", "mouseEnterDelay", "mouseLeaveDelay", "overlayStyle", "prefixCls", "children", "onVisibleChange", "afterVisibleChange", "transitionName", "animation", "motion", "placement", "align", "destroyTooltipOnHide", "defaultVisible", "getTooltipContainer", "overlayInnerStyle"]);

  var domRef = (0,react__WEBPACK_IMPORTED_MODULE_4__.useRef)(null);
  (0,react__WEBPACK_IMPORTED_MODULE_4__.useImperativeHandle)(ref, function () {
    return domRef.current;
  });

  var extraProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, restProps);

  if ('visible' in props) {
    extraProps.popupVisible = props.visible;
  }

  var getPopupElement = function getPopupElement() {
    var _props$arrowContent = props.arrowContent,
        arrowContent = _props$arrowContent === void 0 ? null : _props$arrowContent,
        overlay = props.overlay,
        id = props.id;
    return [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement("div", {
      className: "".concat(prefixCls, "-arrow"),
      key: "arrow"
    }, arrowContent), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement(_Content__WEBPACK_IMPORTED_MODULE_7__.default, {
      key: "content",
      prefixCls: prefixCls,
      id: id,
      overlay: overlay,
      overlayInnerStyle: overlayInnerStyle
    })];
  };

  var destroyTooltip = false;
  var autoDestroy = false;

  if (typeof destroyTooltipOnHide === 'boolean') {
    destroyTooltip = destroyTooltipOnHide;
  } else if (destroyTooltipOnHide && (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_1__.default)(destroyTooltipOnHide) === 'object') {
    var keepParent = destroyTooltipOnHide.keepParent;
    destroyTooltip = keepParent === true;
    autoDestroy = keepParent === false;
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement(rc_trigger__WEBPACK_IMPORTED_MODULE_5__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
    popupClassName: overlayClassName,
    prefixCls: prefixCls,
    popup: getPopupElement,
    action: trigger,
    builtinPlacements: _placements__WEBPACK_IMPORTED_MODULE_6__.placements,
    popupPlacement: placement,
    ref: domRef,
    popupAlign: align,
    getPopupContainer: getTooltipContainer,
    onPopupVisibleChange: onVisibleChange,
    afterPopupVisibleChange: afterVisibleChange,
    popupTransitionName: transitionName,
    popupAnimation: animation,
    popupMotion: motion,
    defaultPopupVisible: defaultVisible,
    destroyPopupOnHide: destroyTooltip,
    autoDestroy: autoDestroy,
    mouseLeaveDelay: mouseLeaveDelay,
    popupStyle: overlayStyle,
    mouseEnterDelay: mouseEnterDelay
  }, extraProps), children);
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_4__.forwardRef)(Tooltip));

/***/ }),

/***/ "./node_modules/rc-tooltip/es/index.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-tooltip/es/index.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Tooltip__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tooltip */ "./node_modules/rc-tooltip/es/Tooltip.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_Tooltip__WEBPACK_IMPORTED_MODULE_0__.default);

/***/ }),

/***/ "./node_modules/rc-tooltip/es/placements.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-tooltip/es/placements.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "placements": () => (/* binding */ placements),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
var autoAdjustOverflow = {
  adjustX: 1,
  adjustY: 1
};
var targetOffset = [0, 0];
var placements = {
  left: {
    points: ['cr', 'cl'],
    overflow: autoAdjustOverflow,
    offset: [-4, 0],
    targetOffset: targetOffset
  },
  right: {
    points: ['cl', 'cr'],
    overflow: autoAdjustOverflow,
    offset: [4, 0],
    targetOffset: targetOffset
  },
  top: {
    points: ['bc', 'tc'],
    overflow: autoAdjustOverflow,
    offset: [0, -4],
    targetOffset: targetOffset
  },
  bottom: {
    points: ['tc', 'bc'],
    overflow: autoAdjustOverflow,
    offset: [0, 4],
    targetOffset: targetOffset
  },
  topLeft: {
    points: ['bl', 'tl'],
    overflow: autoAdjustOverflow,
    offset: [0, -4],
    targetOffset: targetOffset
  },
  leftTop: {
    points: ['tr', 'tl'],
    overflow: autoAdjustOverflow,
    offset: [-4, 0],
    targetOffset: targetOffset
  },
  topRight: {
    points: ['br', 'tr'],
    overflow: autoAdjustOverflow,
    offset: [0, -4],
    targetOffset: targetOffset
  },
  rightTop: {
    points: ['tl', 'tr'],
    overflow: autoAdjustOverflow,
    offset: [4, 0],
    targetOffset: targetOffset
  },
  bottomRight: {
    points: ['tr', 'br'],
    overflow: autoAdjustOverflow,
    offset: [0, 4],
    targetOffset: targetOffset
  },
  rightBottom: {
    points: ['bl', 'br'],
    overflow: autoAdjustOverflow,
    offset: [4, 0],
    targetOffset: targetOffset
  },
  bottomLeft: {
    points: ['tl', 'bl'],
    overflow: autoAdjustOverflow,
    offset: [0, 4],
    targetOffset: targetOffset
  },
  leftBottom: {
    points: ['br', 'bl'],
    overflow: autoAdjustOverflow,
    offset: [-4, 0],
    targetOffset: targetOffset
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (placements);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/Context.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-tree-select/es/Context.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SelectContext": () => (/* binding */ SelectContext)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

var SelectContext = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/OptionList.js":
/*!******************************************************!*\
  !*** ./node_modules/rc-tree-select/es/OptionList.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-util/es/KeyCode */ "./node_modules/rc-util/es/KeyCode.js");
/* harmony import */ var rc_util_es_hooks_useMemo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-util/es/hooks/useMemo */ "./node_modules/rc-util/es/hooks/useMemo.js");
/* harmony import */ var rc_tree__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rc-tree */ "./node_modules/rc-tree/es/index.js");
/* harmony import */ var _Context__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Context */ "./node_modules/rc-tree-select/es/Context.js");
/* harmony import */ var _hooks_useKeyValueMapping__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./hooks/useKeyValueMapping */ "./node_modules/rc-tree-select/es/hooks/useKeyValueMapping.js");
/* harmony import */ var _hooks_useKeyValueMap__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./hooks/useKeyValueMap */ "./node_modules/rc-tree-select/es/hooks/useKeyValueMap.js");










var HIDDEN_STYLE = {
  width: 0,
  height: 0,
  display: 'flex',
  overflow: 'hidden',
  opacity: 0,
  border: 0,
  padding: 0,
  margin: 0
};

var OptionList = function OptionList(props, ref) {
  var prefixCls = props.prefixCls,
      height = props.height,
      itemHeight = props.itemHeight,
      virtual = props.virtual,
      options = props.options,
      flattenOptions = props.flattenOptions,
      multiple = props.multiple,
      searchValue = props.searchValue,
      onSelect = props.onSelect,
      onToggleOpen = props.onToggleOpen,
      open = props.open,
      notFoundContent = props.notFoundContent,
      onMouseEnter = props.onMouseEnter;

  var _React$useContext = react__WEBPACK_IMPORTED_MODULE_3__.useContext(_Context__WEBPACK_IMPORTED_MODULE_7__.SelectContext),
      checkable = _React$useContext.checkable,
      checkedKeys = _React$useContext.checkedKeys,
      halfCheckedKeys = _React$useContext.halfCheckedKeys,
      treeExpandedKeys = _React$useContext.treeExpandedKeys,
      treeDefaultExpandAll = _React$useContext.treeDefaultExpandAll,
      treeDefaultExpandedKeys = _React$useContext.treeDefaultExpandedKeys,
      onTreeExpand = _React$useContext.onTreeExpand,
      treeIcon = _React$useContext.treeIcon,
      showTreeIcon = _React$useContext.showTreeIcon,
      switcherIcon = _React$useContext.switcherIcon,
      treeLine = _React$useContext.treeLine,
      treeNodeFilterProp = _React$useContext.treeNodeFilterProp,
      loadData = _React$useContext.loadData,
      treeLoadedKeys = _React$useContext.treeLoadedKeys,
      treeMotion = _React$useContext.treeMotion,
      onTreeLoad = _React$useContext.onTreeLoad;

  var treeRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef();
  var memoOptions = (0,rc_util_es_hooks_useMemo__WEBPACK_IMPORTED_MODULE_5__.default)(function () {
    return options;
  }, [open, options], function (prev, next) {
    return next[0] && prev[1] !== next[1];
  });

  var _useKeyValueMap = (0,_hooks_useKeyValueMap__WEBPACK_IMPORTED_MODULE_9__.default)(flattenOptions),
      _useKeyValueMap2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useKeyValueMap, 2),
      cacheKeyMap = _useKeyValueMap2[0],
      cacheValueMap = _useKeyValueMap2[1];

  var _useKeyValueMapping = (0,_hooks_useKeyValueMapping__WEBPACK_IMPORTED_MODULE_8__.default)(cacheKeyMap, cacheValueMap),
      _useKeyValueMapping2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useKeyValueMapping, 2),
      getEntityByKey = _useKeyValueMapping2[0],
      getEntityByValue = _useKeyValueMapping2[1]; // ========================== Values ==========================


  var valueKeys = react__WEBPACK_IMPORTED_MODULE_3__.useMemo(function () {
    return checkedKeys.map(function (val) {
      var entity = getEntityByValue(val);
      return entity ? entity.key : null;
    });
  }, [checkedKeys, getEntityByValue]);
  var mergedCheckedKeys = react__WEBPACK_IMPORTED_MODULE_3__.useMemo(function () {
    if (!checkable) {
      return null;
    }

    return {
      checked: valueKeys,
      halfChecked: halfCheckedKeys
    };
  }, [valueKeys, halfCheckedKeys, checkable]); // ========================== Scroll ==========================

  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(function () {
    // Single mode should scroll to current key
    if (open && !multiple && valueKeys.length) {
      var _treeRef$current;

      (_treeRef$current = treeRef.current) === null || _treeRef$current === void 0 ? void 0 : _treeRef$current.scrollTo({
        key: valueKeys[0]
      });
    }
  }, [open]); // ========================== Search ==========================

  var lowerSearchValue = String(searchValue).toLowerCase();

  var filterTreeNode = function filterTreeNode(treeNode) {
    if (!lowerSearchValue) {
      return false;
    }

    return String(treeNode[treeNodeFilterProp]).toLowerCase().includes(lowerSearchValue);
  }; // =========================== Keys ===========================


  var _React$useState = react__WEBPACK_IMPORTED_MODULE_3__.useState(treeDefaultExpandedKeys),
      _React$useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_React$useState, 2),
      expandedKeys = _React$useState2[0],
      setExpandedKeys = _React$useState2[1];

  var _React$useState3 = react__WEBPACK_IMPORTED_MODULE_3__.useState(null),
      _React$useState4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_React$useState3, 2),
      searchExpandedKeys = _React$useState4[0],
      setSearchExpandedKeys = _React$useState4[1];

  var mergedExpandedKeys = react__WEBPACK_IMPORTED_MODULE_3__.useMemo(function () {
    if (treeExpandedKeys) {
      return (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.default)(treeExpandedKeys);
    }

    return searchValue ? searchExpandedKeys : expandedKeys;
  }, [expandedKeys, searchExpandedKeys, lowerSearchValue, treeExpandedKeys]);
  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(function () {
    if (searchValue) {
      setSearchExpandedKeys(flattenOptions.map(function (o) {
        return o.key;
      }));
    }
  }, [searchValue]);

  var onInternalExpand = function onInternalExpand(keys) {
    setExpandedKeys(keys);
    setSearchExpandedKeys(keys);

    if (onTreeExpand) {
      onTreeExpand(keys);
    }
  }; // ========================== Events ==========================


  var onListMouseDown = function onListMouseDown(event) {
    event.preventDefault();
  };

  var onInternalSelect = function onInternalSelect(_, _ref) {
    var key = _ref.node.key;
    var entity = getEntityByKey(key, checkable ? 'checkbox' : 'select');

    if (entity !== null) {
      onSelect(entity.data.value, {
        selected: !checkedKeys.includes(entity.data.value)
      });
    }

    if (!multiple) {
      onToggleOpen(false);
    }
  }; // ========================= Keyboard =========================


  var _React$useState5 = react__WEBPACK_IMPORTED_MODULE_3__.useState(null),
      _React$useState6 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_React$useState5, 2),
      activeKey = _React$useState6[0],
      setActiveKey = _React$useState6[1];

  var activeEntity = getEntityByKey(activeKey);
  react__WEBPACK_IMPORTED_MODULE_3__.useImperativeHandle(ref, function () {
    var _treeRef$current2;

    return {
      scrollTo: (_treeRef$current2 = treeRef.current) === null || _treeRef$current2 === void 0 ? void 0 : _treeRef$current2.scrollTo,
      onKeyDown: function onKeyDown(event) {
        var _treeRef$current3;

        var which = event.which;

        switch (which) {
          // >>> Arrow keys
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.UP:
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.DOWN:
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.LEFT:
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.RIGHT:
            (_treeRef$current3 = treeRef.current) === null || _treeRef$current3 === void 0 ? void 0 : _treeRef$current3.onKeyDown(event);
            break;
          // >>> Select item

          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.ENTER:
            {
              var _ref2 = (activeEntity === null || activeEntity === void 0 ? void 0 : activeEntity.data) || {},
                  selectable = _ref2.selectable,
                  value = _ref2.value;

              if (selectable !== false) {
                onInternalSelect(null, {
                  node: {
                    key: activeKey
                  },
                  selected: !checkedKeys.includes(value)
                });
              }

              break;
            }
          // >>> Close

          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_4__.default.ESC:
            {
              onToggleOpen(false);
            }
        }
      },
      onKeyUp: function onKeyUp() {}
    };
  }); // ========================== Render ==========================

  if (memoOptions.length === 0) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      role: "listbox",
      className: "".concat(prefixCls, "-empty"),
      onMouseDown: onListMouseDown
    }, notFoundContent);
  }

  var treeProps = {};

  if (treeLoadedKeys) {
    treeProps.loadedKeys = treeLoadedKeys;
  }

  if (mergedExpandedKeys) {
    treeProps.expandedKeys = mergedExpandedKeys;
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
    onMouseDown: onListMouseDown,
    onMouseEnter: onMouseEnter
  }, activeEntity && open && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
    style: HIDDEN_STYLE,
    "aria-live": "assertive"
  }, activeEntity.data.value), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(rc_tree__WEBPACK_IMPORTED_MODULE_6__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
    ref: treeRef,
    focusable: false,
    prefixCls: "".concat(prefixCls, "-tree"),
    treeData: memoOptions,
    height: height,
    itemHeight: itemHeight,
    virtual: virtual,
    multiple: multiple,
    icon: treeIcon,
    showIcon: showTreeIcon,
    switcherIcon: switcherIcon,
    showLine: treeLine,
    loadData: searchValue ? null : loadData,
    motion: treeMotion // We handle keys by out instead tree self
    ,
    checkable: checkable,
    checkStrictly: true,
    checkedKeys: mergedCheckedKeys,
    selectedKeys: !checkable ? valueKeys : [],
    defaultExpandAll: treeDefaultExpandAll
  }, treeProps, {
    // Proxy event out
    onActiveChange: setActiveKey,
    onSelect: onInternalSelect,
    onCheck: onInternalSelect,
    onExpand: onInternalExpand,
    onLoad: onTreeLoad,
    filterTreeNode: filterTreeNode
  })));
};

var RefOptionList = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.forwardRef(OptionList);
RefOptionList.displayName = 'OptionList';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RefOptionList);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/TreeNode.js":
/*!****************************************************!*\
  !*** ./node_modules/rc-tree-select/es/TreeNode.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/** This is a placeholder, not real render in dom */
var TreeNode = function TreeNode() {
  return null;
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TreeNode);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/TreeSelect.js":
/*!******************************************************!*\
  !*** ./node_modules/rc-tree-select/es/TreeSelect.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_select_es_generate__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rc-select/es/generate */ "./node_modules/rc-select/es/generate.js");
/* harmony import */ var rc_select_es_utils_valueUtil__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rc-select/es/utils/valueUtil */ "./node_modules/rc-select/es/utils/valueUtil.js");
/* harmony import */ var rc_tree_es_utils_treeUtil__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rc-tree/es/utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");
/* harmony import */ var rc_tree_es_utils_conductUtil__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rc-tree/es/utils/conductUtil */ "./node_modules/rc-tree/es/utils/conductUtil.js");
/* harmony import */ var rc_select_es_interface_generator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rc-select/es/interface/generator */ "./node_modules/rc-select/es/interface/generator.js");
/* harmony import */ var rc_util_es_hooks_useMergedState__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! rc-util/es/hooks/useMergedState */ "./node_modules/rc-util/es/hooks/useMergedState.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _OptionList__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./OptionList */ "./node_modules/rc-tree-select/es/OptionList.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree-select/es/TreeNode.js");
/* harmony import */ var _utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./utils/valueUtil */ "./node_modules/rc-tree-select/es/utils/valueUtil.js");
/* harmony import */ var _utils_warningPropsUtil__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./utils/warningPropsUtil */ "./node_modules/rc-tree-select/es/utils/warningPropsUtil.js");
/* harmony import */ var _Context__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./Context */ "./node_modules/rc-tree-select/es/Context.js");
/* harmony import */ var _hooks_useTreeData__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./hooks/useTreeData */ "./node_modules/rc-tree-select/es/hooks/useTreeData.js");
/* harmony import */ var _hooks_useKeyValueMap__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./hooks/useKeyValueMap */ "./node_modules/rc-tree-select/es/hooks/useKeyValueMap.js");
/* harmony import */ var _hooks_useKeyValueMapping__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./hooks/useKeyValueMapping */ "./node_modules/rc-tree-select/es/hooks/useKeyValueMapping.js");
/* harmony import */ var _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./utils/strategyUtil */ "./node_modules/rc-tree-select/es/utils/strategyUtil.js");
/* harmony import */ var _utils_legacyUtil__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./utils/legacyUtil */ "./node_modules/rc-tree-select/es/utils/legacyUtil.js");
/* harmony import */ var _hooks_useSelectValues__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./hooks/useSelectValues */ "./node_modules/rc-tree-select/es/hooks/useSelectValues.js");





























var OMIT_PROPS = ['expandedKeys', 'treeData', 'treeCheckable', 'showCheckedStrategy', 'searchPlaceholder', 'treeLine', 'treeIcon', 'showTreeIcon', 'switcherIcon', 'treeNodeFilterProp', 'filterTreeNode', 'dropdownPopupAlign', 'treeDefaultExpandAll', 'treeCheckStrictly', 'treeExpandedKeys', 'treeLoadedKeys', 'treeMotion', 'onTreeExpand', 'onTreeLoad', 'loadData', 'treeDataSimpleMode', 'treeNodeLabelProp', 'treeDefaultExpandedKeys'];
var RefSelect = (0,rc_select_es_generate__WEBPACK_IMPORTED_MODULE_10__.default)({
  prefixCls: 'rc-tree-select',
  components: {
    optionList: _OptionList__WEBPACK_IMPORTED_MODULE_17__.default
  },
  // Not use generate since we will handle ourself
  convertChildrenToData: function convertChildrenToData() {
    return null;
  },
  flattenOptions: _utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.flattenOptions,
  // Handle `optionLabelProp` in TreeSelect component
  getLabeledValue: rc_select_es_utils_valueUtil__WEBPACK_IMPORTED_MODULE_11__.getLabeledValue,
  filterOptions: _utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.filterOptions,
  isValueDisabled: _utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.isValueDisabled,
  findValueOption: _utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.findValueOption,
  omitDOMProps: function omitDOMProps(props) {
    var cloneProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_8__.default)({}, props);

    OMIT_PROPS.forEach(function (prop) {
      delete cloneProps[prop];
    });
    return cloneProps;
  }
});
RefSelect.displayName = 'Select';
var RefTreeSelect = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.forwardRef(function (props, ref) {
  var multiple = props.multiple,
      treeCheckable = props.treeCheckable,
      treeCheckStrictly = props.treeCheckStrictly,
      _props$showCheckedStr = props.showCheckedStrategy,
      showCheckedStrategy = _props$showCheckedStr === void 0 ? 'SHOW_CHILD' : _props$showCheckedStr,
      labelInValue = props.labelInValue,
      loadData = props.loadData,
      treeLoadedKeys = props.treeLoadedKeys,
      _props$treeNodeFilter = props.treeNodeFilterProp,
      treeNodeFilterProp = _props$treeNodeFilter === void 0 ? 'value' : _props$treeNodeFilter,
      treeNodeLabelProp = props.treeNodeLabelProp,
      treeDataSimpleMode = props.treeDataSimpleMode,
      treeData = props.treeData,
      treeExpandedKeys = props.treeExpandedKeys,
      treeDefaultExpandedKeys = props.treeDefaultExpandedKeys,
      treeDefaultExpandAll = props.treeDefaultExpandAll,
      children = props.children,
      treeIcon = props.treeIcon,
      showTreeIcon = props.showTreeIcon,
      switcherIcon = props.switcherIcon,
      treeLine = props.treeLine,
      treeMotion = props.treeMotion,
      filterTreeNode = props.filterTreeNode,
      dropdownPopupAlign = props.dropdownPopupAlign,
      onChange = props.onChange,
      onTreeExpand = props.onTreeExpand,
      onTreeLoad = props.onTreeLoad,
      onDropdownVisibleChange = props.onDropdownVisibleChange,
      onSelect = props.onSelect,
      onDeselect = props.onDeselect;
  var mergedCheckable = treeCheckable || treeCheckStrictly;
  var mergedMultiple = multiple || mergedCheckable;
  var treeConduction = treeCheckable && !treeCheckStrictly;
  var mergedLabelInValue = treeCheckStrictly || labelInValue; // ========================== Ref ==========================

  var selectRef = react__WEBPACK_IMPORTED_MODULE_9__.useRef(null);
  react__WEBPACK_IMPORTED_MODULE_9__.useImperativeHandle(ref, function () {
    return {
      scrollTo: selectRef.current.scrollTo,
      focus: selectRef.current.focus,
      blur: selectRef.current.blur
    };
  }); // ======================= Tree Data =======================
  // Legacy both support `label` or `title` if not set.
  // We have to fallback to function to handle this

  var getTreeNodeTitle = function getTreeNodeTitle(node) {
    if (!treeData) {
      return node.title;
    }

    return node.label || node.title;
  };

  var getTreeNodeLabelProp = function getTreeNodeLabelProp(node) {
    if (treeNodeLabelProp) {
      return node[treeNodeLabelProp];
    }

    return getTreeNodeTitle(node);
  };

  var mergedTreeData = (0,_hooks_useTreeData__WEBPACK_IMPORTED_MODULE_22__.default)(treeData, children, {
    getLabelProp: getTreeNodeTitle,
    simpleMode: treeDataSimpleMode
  });
  var flattedOptions = (0,react__WEBPACK_IMPORTED_MODULE_9__.useMemo)(function () {
    return (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.flattenOptions)(mergedTreeData);
  }, [mergedTreeData]);

  var _useKeyValueMap = (0,_hooks_useKeyValueMap__WEBPACK_IMPORTED_MODULE_23__.default)(flattedOptions),
      _useKeyValueMap2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__.default)(_useKeyValueMap, 2),
      cacheKeyMap = _useKeyValueMap2[0],
      cacheValueMap = _useKeyValueMap2[1];

  var _useKeyValueMapping = (0,_hooks_useKeyValueMapping__WEBPACK_IMPORTED_MODULE_24__.default)(cacheKeyMap, cacheValueMap),
      _useKeyValueMapping2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__.default)(_useKeyValueMapping, 2),
      getEntityByKey = _useKeyValueMapping2[0],
      getEntityByValue = _useKeyValueMapping2[1]; // Only generate keyEntities for check conduction when is `treeCheckable`


  var _useMemo = (0,react__WEBPACK_IMPORTED_MODULE_9__.useMemo)(function () {
    if (treeConduction) {
      return (0,rc_tree_es_utils_treeUtil__WEBPACK_IMPORTED_MODULE_12__.convertDataToEntities)(mergedTreeData);
    }

    return {
      keyEntities: null
    };
  }, [mergedTreeData, treeCheckable, treeCheckStrictly]),
      conductKeyEntities = _useMemo.keyEntities; // ========================= Value =========================


  var _useMergedState = (0,rc_util_es_hooks_useMergedState__WEBPACK_IMPORTED_MODULE_15__.default)(props.defaultValue, {
    value: props.value
  }),
      _useMergedState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__.default)(_useMergedState, 2),
      value = _useMergedState2[0],
      setValue = _useMergedState2[1];
  /** Get `missingRawValues` which not exist in the tree yet */


  var splitRawValues = function splitRawValues(newRawValues) {
    var missingRawValues = [];
    var existRawValues = []; // Keep missing value in the cache

    newRawValues.forEach(function (val) {
      if (getEntityByValue(val)) {
        existRawValues.push(val);
      } else {
        missingRawValues.push(val);
      }
    });
    return {
      missingRawValues: missingRawValues,
      existRawValues: existRawValues
    };
  };

  var _useMemo2 = (0,react__WEBPACK_IMPORTED_MODULE_9__.useMemo)(function () {
    var valueHalfCheckedKeys = [];
    var newRawValues = [];
    (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.toArray)(value).forEach(function (item) {
      if (item && (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_6__.default)(item) === 'object' && 'value' in item) {
        if (item.halfChecked && treeCheckStrictly) {
          var entity = getEntityByValue(item.value);
          valueHalfCheckedKeys.push(entity ? entity.key : item.value);
        } else {
          newRawValues.push(item.value);
        }
      } else {
        newRawValues.push(item);
      }
    }); // We need do conduction of values

    if (treeConduction) {
      var _splitRawValues = splitRawValues(newRawValues),
          missingRawValues = _splitRawValues.missingRawValues,
          existRawValues = _splitRawValues.existRawValues;

      var keyList = existRawValues.map(function (val) {
        return getEntityByValue(val).key;
      });

      var _conductCheck = (0,rc_tree_es_utils_conductUtil__WEBPACK_IMPORTED_MODULE_13__.conductCheck)(keyList, true, conductKeyEntities),
          checkedKeys = _conductCheck.checkedKeys,
          halfCheckedKeys = _conductCheck.halfCheckedKeys;

      return [[].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(missingRawValues), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(checkedKeys.map(function (key) {
        return getEntityByKey(key).data.value;
      }))), halfCheckedKeys];
    }

    return [newRawValues, valueHalfCheckedKeys];
  }, [value, mergedMultiple, mergedLabelInValue, treeCheckable, treeCheckStrictly]),
      _useMemo3 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_7__.default)(_useMemo2, 2),
      rawValues = _useMemo3[0],
      rawHalfCheckedKeys = _useMemo3[1];

  var selectValues = (0,_hooks_useSelectValues__WEBPACK_IMPORTED_MODULE_27__.default)(rawValues, {
    treeConduction: treeConduction,
    value: value,
    showCheckedStrategy: showCheckedStrategy,
    conductKeyEntities: conductKeyEntities,
    getEntityByValue: getEntityByValue,
    getEntityByKey: getEntityByKey,
    getLabelProp: getTreeNodeLabelProp
  });

  var triggerChange = function triggerChange(newRawValues, extra, source) {
    setValue(mergedMultiple ? newRawValues : newRawValues[0]);

    if (onChange) {
      var eventValues = newRawValues;

      if (treeConduction && showCheckedStrategy !== 'SHOW_ALL') {
        var keyList = newRawValues.map(function (val) {
          var entity = getEntityByValue(val);
          return entity ? entity.key : val;
        });
        var formattedKeyList = (0,_utils_strategyUtil__WEBPACK_IMPORTED_MODULE_25__.formatStrategyKeys)(keyList, showCheckedStrategy, conductKeyEntities);
        eventValues = formattedKeyList.map(function (key) {
          var entity = getEntityByKey(key);
          return entity ? entity.data.value : key;
        });
      }

      var _ref = extra || {
        triggerValue: undefined,
        selected: undefined
      },
          triggerValue = _ref.triggerValue,
          selected = _ref.selected;

      var returnValues = mergedLabelInValue ? (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.getRawValueLabeled)(eventValues, value, getEntityByValue, getTreeNodeLabelProp) : eventValues; // We need fill half check back

      if (treeCheckStrictly) {
        var halfValues = rawHalfCheckedKeys.map(function (key) {
          var entity = getEntityByKey(key);
          return entity ? entity.data.value : key;
        }).filter(function (val) {
          return !eventValues.includes(val);
        });
        returnValues = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(returnValues), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)((0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.getRawValueLabeled)(halfValues, value, getEntityByValue, getTreeNodeLabelProp)));
      }

      var additionalInfo = {
        // [Legacy] Always return as array contains label & value
        preValue: selectValues,
        triggerValue: triggerValue
      }; // [Legacy] Fill legacy data if user query.
      // This is expansive that we only fill when user query
      // https://github.com/react-component/tree-select/blob/fe33eb7c27830c9ac70cd1fdb1ebbe7bc679c16a/src/Select.jsx

      var showPosition = true;

      if (treeCheckStrictly || source === 'selection' && !selected) {
        showPosition = false;
      }

      (0,_utils_legacyUtil__WEBPACK_IMPORTED_MODULE_26__.fillAdditionalInfo)(additionalInfo, triggerValue, newRawValues, mergedTreeData, showPosition);

      if (mergedCheckable) {
        additionalInfo.checked = selected;
      } else {
        additionalInfo.selected = selected;
      }

      onChange(mergedMultiple ? returnValues : returnValues[0], mergedLabelInValue ? null : eventValues.map(function (val) {
        var entity = getEntityByValue(val);
        return entity ? getTreeNodeLabelProp(entity.data) : null;
      }), additionalInfo);
    }
  };

  var onInternalSelect = function onInternalSelect(selectValue, option, source) {
    var eventValue = mergedLabelInValue ? selectValue : selectValue;

    if (!mergedMultiple) {
      // Single mode always set value
      triggerChange([selectValue], {
        selected: true,
        triggerValue: selectValue
      }, source);
    } else {
      var newRawValues = (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.addValue)(rawValues, selectValue); // Add keys if tree conduction

      if (treeConduction) {
        // Should keep missing values
        var _splitRawValues2 = splitRawValues(newRawValues),
            missingRawValues = _splitRawValues2.missingRawValues,
            existRawValues = _splitRawValues2.existRawValues;

        var keyList = existRawValues.map(function (val) {
          return getEntityByValue(val).key;
        });

        var _conductCheck2 = (0,rc_tree_es_utils_conductUtil__WEBPACK_IMPORTED_MODULE_13__.conductCheck)(keyList, true, conductKeyEntities),
            checkedKeys = _conductCheck2.checkedKeys;

        newRawValues = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(missingRawValues), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(checkedKeys.map(function (key) {
          return getEntityByKey(key).data.value;
        })));
      }

      triggerChange(newRawValues, {
        selected: true,
        triggerValue: selectValue
      }, source);
    }

    if (onSelect) {
      onSelect(eventValue, option);
    }
  };

  var onInternalDeselect = function onInternalDeselect(selectValue, option, source) {
    var eventValue = mergedLabelInValue ? selectValue : selectValue;
    var newRawValues = (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_19__.removeValue)(rawValues, selectValue); // Remove keys if tree conduction

    if (treeConduction) {
      var _splitRawValues3 = splitRawValues(newRawValues),
          missingRawValues = _splitRawValues3.missingRawValues,
          existRawValues = _splitRawValues3.existRawValues;

      var keyList = existRawValues.map(function (val) {
        return getEntityByValue(val).key;
      });

      var _conductCheck3 = (0,rc_tree_es_utils_conductUtil__WEBPACK_IMPORTED_MODULE_13__.conductCheck)(keyList, {
        checked: false,
        halfCheckedKeys: rawHalfCheckedKeys
      }, conductKeyEntities),
          checkedKeys = _conductCheck3.checkedKeys;

      newRawValues = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(missingRawValues), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__.default)(checkedKeys.map(function (key) {
        return getEntityByKey(key).data.value;
      })));
    }

    triggerChange(newRawValues, {
      selected: false,
      triggerValue: selectValue
    }, source);

    if (onDeselect) {
      onDeselect(eventValue, option);
    }
  };

  var onInternalClear = function onInternalClear() {
    triggerChange([], null, 'clear');
  }; // ========================= Open ==========================


  var onInternalDropdownVisibleChange = react__WEBPACK_IMPORTED_MODULE_9__.useCallback(function (open) {
    if (onDropdownVisibleChange) {
      var legacyParam = {};
      Object.defineProperty(legacyParam, 'documentClickClose', {
        get: function get() {
          (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_16__.default)(false, 'Second param of `onDropdownVisibleChange` has been removed.');
          return false;
        }
      });
      onDropdownVisibleChange(open, legacyParam);
    }
  }, [onDropdownVisibleChange]); // ======================== Warning ========================

  if (true) {
    (0,_utils_warningPropsUtil__WEBPACK_IMPORTED_MODULE_20__.default)(props);
  } // ======================== Render =========================
  // We pass some props into select props style


  var selectProps = {
    optionLabelProp: null,
    optionFilterProp: treeNodeFilterProp,
    dropdownAlign: dropdownPopupAlign,
    internalProps: {
      mark: rc_select_es_interface_generator__WEBPACK_IMPORTED_MODULE_14__.INTERNAL_PROPS_MARK,
      onClear: onInternalClear,
      skipTriggerChange: true,
      skipTriggerSelect: true,
      onRawSelect: onInternalSelect,
      onRawDeselect: onInternalDeselect
    }
  };

  if ('filterTreeNode' in props) {
    selectProps.filterOption = filterTreeNode;
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(_Context__WEBPACK_IMPORTED_MODULE_21__.SelectContext.Provider, {
    value: {
      checkable: mergedCheckable,
      loadData: loadData,
      treeLoadedKeys: treeLoadedKeys,
      onTreeLoad: onTreeLoad,
      checkedKeys: rawValues,
      halfCheckedKeys: rawHalfCheckedKeys,
      treeDefaultExpandAll: treeDefaultExpandAll,
      treeExpandedKeys: treeExpandedKeys,
      treeDefaultExpandedKeys: treeDefaultExpandedKeys,
      onTreeExpand: onTreeExpand,
      treeIcon: treeIcon,
      treeMotion: treeMotion,
      showTreeIcon: showTreeIcon,
      switcherIcon: switcherIcon,
      treeLine: treeLine,
      treeNodeFilterProp: treeNodeFilterProp
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(RefSelect, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__.default)({
    ref: selectRef,
    mode: mergedMultiple ? 'multiple' : null
  }, props, selectProps, {
    value: selectValues // We will handle this ourself since we need calculate conduction
    ,
    labelInValue: true,
    options: mergedTreeData,
    onChange: null,
    onSelect: null,
    onDeselect: null,
    onDropdownVisibleChange: onInternalDropdownVisibleChange
  })));
}); // Use class component since typescript not support generic
// by `forwardRef` with function component yet.

var TreeSelect = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__.default)(TreeSelect, _React$Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_3__.default)(TreeSelect);

  function TreeSelect() {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.default)(this, TreeSelect);

    _this = _super.apply(this, arguments);
    _this.selectRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createRef();

    _this.focus = function () {
      _this.selectRef.current.focus();
    };

    _this.blur = function () {
      _this.selectRef.current.blur();
    };

    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.default)(TreeSelect, [{
    key: "render",
    value: function render() {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(RefTreeSelect, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__.default)({
        ref: this.selectRef
      }, this.props));
    }
  }]);

  return TreeSelect;
}(react__WEBPACK_IMPORTED_MODULE_9__.Component);

TreeSelect.TreeNode = _TreeNode__WEBPACK_IMPORTED_MODULE_18__.default;
TreeSelect.SHOW_ALL = _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_25__.SHOW_ALL;
TreeSelect.SHOW_PARENT = _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_25__.SHOW_PARENT;
TreeSelect.SHOW_CHILD = _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_25__.SHOW_CHILD;
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TreeSelect);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/hooks/useKeyValueMap.js":
/*!****************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/hooks/useKeyValueMap.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useKeyValueMap)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

/**
 * Return cached Key Value map with DataNode.
 * Only re-calculate when `flattenOptions` changed.
 */

function useKeyValueMap(flattenOptions) {
  return react__WEBPACK_IMPORTED_MODULE_0__.useMemo(function () {
    var cacheKeyMap = new Map();
    var cacheValueMap = new Map(); // Cache options by key

    flattenOptions.forEach(function (dataNode) {
      cacheKeyMap.set(dataNode.key, dataNode);
      cacheValueMap.set(dataNode.data.value, dataNode);
    });
    return [cacheKeyMap, cacheValueMap];
  }, [flattenOptions]);
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/hooks/useKeyValueMapping.js":
/*!********************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/hooks/useKeyValueMapping.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isDisabled": () => (/* binding */ isDisabled),
/* harmony export */   "default": () => (/* binding */ useKeyValueMapping)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

function isDisabled(dataNode, skipType) {
  if (!dataNode) {
    return true;
  }

  var _dataNode$data = dataNode.data,
      disabled = _dataNode$data.disabled,
      disableCheckbox = _dataNode$data.disableCheckbox;

  switch (skipType) {
    case 'select':
      return disabled;

    case 'checkbox':
      return disabled || disableCheckbox;
  }

  return false;
}
function useKeyValueMapping(cacheKeyMap, cacheValueMap) {
  var getEntityByKey = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function (key) {
    var skipType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'select';
    var ignoreDisabledCheck = arguments.length > 2 ? arguments[2] : undefined;
    var dataNode = cacheKeyMap.get(key);

    if (!ignoreDisabledCheck && isDisabled(dataNode, skipType)) {
      return null;
    }

    return dataNode;
  }, [cacheKeyMap]);
  var getEntityByValue = react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function (value) {
    var skipType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'select';
    var ignoreDisabledCheck = arguments.length > 2 ? arguments[2] : undefined;
    var dataNode = cacheValueMap.get(value);

    if (!ignoreDisabledCheck && isDisabled(dataNode, skipType)) {
      return null;
    }

    return dataNode;
  }, [cacheValueMap]);
  return [getEntityByKey, getEntityByValue];
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/hooks/useSelectValues.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/hooks/useSelectValues.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useSelectValues)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _utils_valueUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/valueUtil */ "./node_modules/rc-tree-select/es/utils/valueUtil.js");
/* harmony import */ var _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/strategyUtil */ "./node_modules/rc-tree-select/es/utils/strategyUtil.js");



/** Return  */

function useSelectValues(rawValues, _ref) {
  var value = _ref.value,
      getEntityByValue = _ref.getEntityByValue,
      getEntityByKey = _ref.getEntityByKey,
      treeConduction = _ref.treeConduction,
      showCheckedStrategy = _ref.showCheckedStrategy,
      conductKeyEntities = _ref.conductKeyEntities,
      getLabelProp = _ref.getLabelProp;
  return react__WEBPACK_IMPORTED_MODULE_0__.useMemo(function () {
    var mergedRawValues = rawValues;

    if (treeConduction) {
      var rawKeys = (0,_utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__.formatStrategyKeys)(rawValues.map(function (val) {
        var entity = getEntityByValue(val);
        return entity ? entity.key : val;
      }), showCheckedStrategy, conductKeyEntities);
      mergedRawValues = rawKeys.map(function (key) {
        var entity = getEntityByKey(key);
        return entity ? entity.data.value : key;
      });
    }

    return (0,_utils_valueUtil__WEBPACK_IMPORTED_MODULE_1__.getRawValueLabeled)(mergedRawValues, value, getEntityByValue, getLabelProp);
  }, [rawValues, value, treeConduction, showCheckedStrategy, getEntityByValue]);
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/hooks/useTreeData.js":
/*!*************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/hooks/useTreeData.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useTreeData)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _utils_legacyUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/legacyUtil */ "./node_modules/rc-tree-select/es/utils/legacyUtil.js");





var MAX_WARNING_TIMES = 10;

function parseSimpleTreeData(treeData, _ref) {
  var id = _ref.id,
      pId = _ref.pId,
      rootPId = _ref.rootPId;
  var keyNodes = {};
  var rootNodeList = []; // Fill in the map

  var nodeList = treeData.map(function (node) {
    var clone = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, node);

    var key = clone[id];
    keyNodes[key] = clone;
    clone.key = clone.key || key;
    return clone;
  }); // Connect tree

  nodeList.forEach(function (node) {
    var parentKey = node[pId];
    var parent = keyNodes[parentKey]; // Fill parent

    if (parent) {
      parent.children = parent.children || [];
      parent.children.push(node);
    } // Fill root tree node


    if (parentKey === rootPId || !parent && rootPId === null) {
      rootNodeList.push(node);
    }
  });
  return rootNodeList;
}
/**
 * Format `treeData` with `value` & `key` which is used for calculation
 */


function formatTreeData(treeData, getLabelProp) {
  var warningTimes = 0;
  var valueSet = new Set();

  function dig(dataNodes) {
    return (dataNodes || []).map(function (node) {
      var key = node.key,
          value = node.value,
          children = node.children,
          rest = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__.default)(node, ["key", "value", "children"]);

      var mergedValue = 'value' in node ? value : key;

      var dataNode = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, rest), {}, {
        key: key !== null && key !== undefined ? key : mergedValue,
        value: mergedValue,
        title: getLabelProp(node)
      }); // Check `key` & `value` and warning user


      if (true) {
        if (key !== null && key !== undefined && value !== undefined && String(key) !== String(value) && warningTimes < MAX_WARNING_TIMES) {
          warningTimes += 1;
          (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_3__.default)(false, "`key` or `value` with TreeNode must be the same or you can remove one of them. key: ".concat(key, ", value: ").concat(value, "."));
        }

        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_3__.default)(!valueSet.has(value), "Same `value` exist in the tree: ".concat(value));
        valueSet.add(value);
      }

      if ('children' in node) {
        dataNode.children = dig(children);
      }

      return dataNode;
    });
  }

  return dig(treeData);
}
/**
 * Convert `treeData` or `children` into formatted `treeData`.
 * Will not re-calculate if `treeData` or `children` not change.
 */


function useTreeData(treeData, children, _ref2) {
  var getLabelProp = _ref2.getLabelProp,
      simpleMode = _ref2.simpleMode;
  var cacheRef = react__WEBPACK_IMPORTED_MODULE_2__.useRef({});

  if (treeData) {
    cacheRef.current.formatTreeData = cacheRef.current.treeData === treeData ? cacheRef.current.formatTreeData : formatTreeData(simpleMode ? parseSimpleTreeData(treeData, (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({
      id: 'id',
      pId: 'pId',
      rootPId: null
    }, simpleMode !== true ? simpleMode : {})) : treeData, getLabelProp);
    cacheRef.current.treeData = treeData;
  } else {
    cacheRef.current.formatTreeData = cacheRef.current.children === children ? cacheRef.current.formatTreeData : formatTreeData((0,_utils_legacyUtil__WEBPACK_IMPORTED_MODULE_4__.convertChildrenToData)(children), getLabelProp);
  }

  return cacheRef.current.formatTreeData;
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/index.js":
/*!*************************************************!*\
  !*** ./node_modules/rc-tree-select/es/index.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TreeNode": () => (/* reexport safe */ _TreeNode__WEBPACK_IMPORTED_MODULE_1__.default),
/* harmony export */   "SHOW_ALL": () => (/* reexport safe */ _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__.SHOW_ALL),
/* harmony export */   "SHOW_CHILD": () => (/* reexport safe */ _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__.SHOW_CHILD),
/* harmony export */   "SHOW_PARENT": () => (/* reexport safe */ _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__.SHOW_PARENT),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _TreeSelect__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TreeSelect */ "./node_modules/rc-tree-select/es/TreeSelect.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree-select/es/TreeNode.js");
/* harmony import */ var _utils_strategyUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/strategyUtil */ "./node_modules/rc-tree-select/es/utils/strategyUtil.js");




/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_TreeSelect__WEBPACK_IMPORTED_MODULE_0__.default);

/***/ }),

/***/ "./node_modules/rc-tree-select/es/utils/legacyUtil.js":
/*!************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/utils/legacyUtil.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "convertChildrenToData": () => (/* binding */ convertChildrenToData),
/* harmony export */   "fillLegacyProps": () => (/* binding */ fillLegacyProps),
/* harmony export */   "fillAdditionalInfo": () => (/* binding */ fillAdditionalInfo)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_Children_toArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rc-util/es/Children/toArray */ "./node_modules/rc-util/es/Children/toArray.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../TreeNode */ "./node_modules/rc-tree-select/es/TreeNode.js");






function convertChildrenToData(nodes) {
  return (0,rc_util_es_Children_toArray__WEBPACK_IMPORTED_MODULE_3__.default)(nodes).map(function (node) {
    if (! /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.isValidElement(node) || !node.type) {
      return null;
    }

    var key = node.key,
        _node$props = node.props,
        children = _node$props.children,
        value = _node$props.value,
        restProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__.default)(_node$props, ["children", "value"]);

    var data = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.default)({
      key: key,
      value: value
    }, restProps);

    var childData = convertChildrenToData(children);

    if (childData.length) {
      data.children = childData;
    }

    return data;
  }).filter(function (data) {
    return data;
  });
}
function fillLegacyProps(dataNode) {
  // Skip if not dataNode exist
  if (!dataNode) {
    return dataNode;
  }

  var cloneNode = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.default)({}, dataNode);

  if (!('props' in cloneNode)) {
    Object.defineProperty(cloneNode, 'props', {
      get: function get() {
        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__.default)(false, 'New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access.');
        return cloneNode;
      }
    });
  }

  return cloneNode;
}
function fillAdditionalInfo(extra, triggerValue, checkedValues, treeData, showPosition) {
  var triggerNode = null;
  var nodeList = null;

  function generateMap() {
    function dig(list) {
      var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '0';
      var parentIncluded = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      return list.map(function (dataNode, index) {
        var pos = "".concat(level, "-").concat(index);
        var included = checkedValues.includes(dataNode.value);
        var children = dig(dataNode.children || [], pos, included);
        var node = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(_TreeNode__WEBPACK_IMPORTED_MODULE_5__.default, dataNode, children.map(function (child) {
          return child.node;
        })); // Link with trigger node

        if (triggerValue === dataNode.value) {
          triggerNode = node;
        }

        if (included) {
          var checkedNode = {
            pos: pos,
            node: node,
            children: children
          };

          if (!parentIncluded) {
            nodeList.push(checkedNode);
          }

          return checkedNode;
        }

        return null;
      }).filter(function (node) {
        return node;
      });
    }

    if (!nodeList) {
      nodeList = [];
      dig(treeData); // Sort to keep the checked node length

      nodeList.sort(function (_ref, _ref2) {
        var val1 = _ref.node.props.value;
        var val2 = _ref2.node.props.value;
        var index1 = checkedValues.indexOf(val1);
        var index2 = checkedValues.indexOf(val2);
        return index1 - index2;
      });
    }
  }

  Object.defineProperty(extra, 'triggerNode', {
    get: function get() {
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__.default)(false, '`triggerNode` is deprecated. Please consider decoupling data with node.');
      generateMap();
      return triggerNode;
    }
  });
  Object.defineProperty(extra, 'allCheckedNodes', {
    get: function get() {
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__.default)(false, '`allCheckedNodes` is deprecated. Please consider decoupling data with node.');
      generateMap();

      if (showPosition) {
        return nodeList;
      }

      return nodeList.map(function (_ref3) {
        var node = _ref3.node;
        return node;
      });
    }
  });
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/utils/strategyUtil.js":
/*!**************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/utils/strategyUtil.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SHOW_ALL": () => (/* binding */ SHOW_ALL),
/* harmony export */   "SHOW_PARENT": () => (/* binding */ SHOW_PARENT),
/* harmony export */   "SHOW_CHILD": () => (/* binding */ SHOW_CHILD),
/* harmony export */   "formatStrategyKeys": () => (/* binding */ formatStrategyKeys)
/* harmony export */ });
/* harmony import */ var _valueUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./valueUtil */ "./node_modules/rc-tree-select/es/utils/valueUtil.js");

var SHOW_ALL = 'SHOW_ALL';
var SHOW_PARENT = 'SHOW_PARENT';
var SHOW_CHILD = 'SHOW_CHILD';
function formatStrategyKeys(keys, strategy, keyEntities) {
  var keySet = new Set(keys);

  if (strategy === SHOW_CHILD) {
    return keys.filter(function (key) {
      var entity = keyEntities[key];

      if (entity && entity.children && entity.children.every(function (_ref) {
        var node = _ref.node;
        return (0,_valueUtil__WEBPACK_IMPORTED_MODULE_0__.isCheckDisabled)(node) || keySet.has(node.key);
      })) {
        return false;
      }

      return true;
    });
  }

  if (strategy === SHOW_PARENT) {
    return keys.filter(function (key) {
      var entity = keyEntities[key];
      var parent = entity ? entity.parent : null;

      if (parent && !(0,_valueUtil__WEBPACK_IMPORTED_MODULE_0__.isCheckDisabled)(parent.node) && keySet.has(parent.node.key)) {
        return false;
      }

      return true;
    });
  }

  return keys;
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/utils/valueUtil.js":
/*!***********************************************************!*\
  !*** ./node_modules/rc-tree-select/es/utils/valueUtil.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "toArray": () => (/* binding */ toArray),
/* harmony export */   "findValueOption": () => (/* binding */ findValueOption),
/* harmony export */   "isValueDisabled": () => (/* binding */ isValueDisabled),
/* harmony export */   "isCheckDisabled": () => (/* binding */ isCheckDisabled),
/* harmony export */   "flattenOptions": () => (/* binding */ flattenOptions),
/* harmony export */   "filterOptions": () => (/* binding */ filterOptions),
/* harmony export */   "getRawValueLabeled": () => (/* binding */ getRawValueLabeled),
/* harmony export */   "addValue": () => (/* binding */ addValue),
/* harmony export */   "removeValue": () => (/* binding */ removeValue)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var rc_tree_es_utils_treeUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rc-tree/es/utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");
/* harmony import */ var _legacyUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./legacyUtil */ "./node_modules/rc-tree-select/es/utils/legacyUtil.js");




function toArray(value) {
  if (Array.isArray(value)) {
    return value;
  }

  return value !== undefined ? [value] : [];
}
function findValueOption(values, options) {
  var optionMap = new Map();
  options.forEach(function (flattenItem) {
    var data = flattenItem.data;
    optionMap.set(data.value, data);
  });
  return values.map(function (val) {
    return (0,_legacyUtil__WEBPACK_IMPORTED_MODULE_3__.fillLegacyProps)(optionMap.get(val));
  });
}
function isValueDisabled(value, options) {
  var option = findValueOption([value], options)[0];

  if (option) {
    return option.disabled;
  }

  return false;
}
function isCheckDisabled(node) {
  return node.disabled || node.disableCheckbox || node.checkable === false;
}

function getLevel(_ref) {
  var parent = _ref.parent;
  var level = 0;
  var current = parent;

  while (current) {
    current = current.parent;
    level += 1;
  }

  return level;
}
/**
 * Before reuse `rc-tree` logic, we need to add key since TreeSelect use `value` instead of `key`.
 */


function flattenOptions(options) {
  // Add missing key
  function fillKey(list) {
    return (list || []).map(function (node) {
      var value = node.value,
          key = node.key,
          children = node.children;

      var clone = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, node), {}, {
        key: 'key' in node ? key : value
      });

      if (children) {
        clone.children = fillKey(children);
      }

      return clone;
    });
  }

  var flattenList = (0,rc_tree_es_utils_treeUtil__WEBPACK_IMPORTED_MODULE_2__.flattenTreeData)(fillKey(options), true);
  return flattenList.map(function (node) {
    return {
      key: node.data.key,
      data: node.data,
      level: getLevel(node)
    };
  });
}

function getDefaultFilterOption(optionFilterProp) {
  return function (searchValue, dataNode) {
    var value = dataNode[optionFilterProp];
    return String(value).toLowerCase().includes(String(searchValue).toLowerCase());
  };
}
/** Filter options and return a new options by the search text */


function filterOptions(searchValue, options, _ref2) {
  var optionFilterProp = _ref2.optionFilterProp,
      filterOption = _ref2.filterOption;

  if (filterOption === false) {
    return options;
  }

  var filterOptionFunc;

  if (typeof filterOption === 'function') {
    filterOptionFunc = filterOption;
  } else {
    filterOptionFunc = getDefaultFilterOption(optionFilterProp);
  }

  function dig(list) {
    var keepAll = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    return list.map(function (dataNode) {
      var children = dataNode.children;
      var match = keepAll || filterOptionFunc(searchValue, (0,_legacyUtil__WEBPACK_IMPORTED_MODULE_3__.fillLegacyProps)(dataNode));
      var childList = dig(children || [], match);

      if (match || childList.length) {
        return (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, dataNode), {}, {
          children: childList
        });
      }

      return null;
    }).filter(function (node) {
      return node;
    });
  }

  return dig(options);
}
function getRawValueLabeled(values, prevValue, getEntityByValue, getLabelProp) {
  var valueMap = new Map();
  toArray(prevValue).forEach(function (item) {
    if (item && (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__.default)(item) === 'object' && 'value' in item) {
      valueMap.set(item.value, item);
    }
  });
  return values.map(function (val) {
    var item = {
      value: val
    };
    var entity = getEntityByValue(val, 'select', true);
    var label = entity ? getLabelProp(entity.data) : val;

    if (valueMap.has(val)) {
      var labeledValue = valueMap.get(val);
      item.label = 'label' in labeledValue ? labeledValue.label : label;

      if ('halfChecked' in labeledValue) {
        item.halfChecked = labeledValue.halfChecked;
      }
    } else {
      item.label = label;
    }

    return item;
  });
}
function addValue(rawValues, value) {
  var values = new Set(rawValues);
  values.add(value);
  return Array.from(values);
}
function removeValue(rawValues, value) {
  var values = new Set(rawValues);
  values.delete(value);
  return Array.from(values);
}

/***/ }),

/***/ "./node_modules/rc-tree-select/es/utils/warningPropsUtil.js":
/*!******************************************************************!*\
  !*** ./node_modules/rc-tree-select/es/utils/warningPropsUtil.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _valueUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./valueUtil */ "./node_modules/rc-tree-select/es/utils/valueUtil.js");




function warningProps(props) {
  var searchPlaceholder = props.searchPlaceholder,
      treeCheckStrictly = props.treeCheckStrictly,
      treeCheckable = props.treeCheckable,
      labelInValue = props.labelInValue,
      value = props.value,
      multiple = props.multiple;
  (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__.default)(!searchPlaceholder, '`searchPlaceholder` has been removed.');

  if (treeCheckStrictly && labelInValue === false) {
    (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__.default)(false, '`treeCheckStrictly` will force set `labelInValue` to `true`.');
  }

  if (labelInValue || treeCheckStrictly) {
    (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__.default)((0,_valueUtil__WEBPACK_IMPORTED_MODULE_2__.toArray)(value).every(function (val) {
      return val && (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__.default)(val) === 'object' && 'value' in val;
    }), 'Invalid prop `value` supplied to `TreeSelect`. You should use { label: string, value: string | number } or [{ label: string, value: string | number }] instead.');
  }

  if (treeCheckStrictly || multiple || treeCheckable) {
    (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__.default)(!value || Array.isArray(value), '`value` should be an array when `TreeSelect` is checkable or multiple.');
  } else {
    (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_1__.default)(!Array.isArray(value), '`value` should not be array when `TreeSelect` is single mode.');
  }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (warningProps);

/***/ }),

/***/ "./node_modules/rc-tree/es/DropIndicator.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-tree/es/DropIndicator.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ DropIndicator)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

function DropIndicator(_ref) {
  var dropPosition = _ref.dropPosition,
      dropLevelOffset = _ref.dropLevelOffset,
      indent = _ref.indent;
  var style = {
    pointerEvents: 'none',
    position: 'absolute',
    right: 0,
    backgroundColor: 'red',
    height: 2
  };

  switch (dropPosition) {
    case -1:
      style.top = 0;
      style.left = -dropLevelOffset * indent;
      break;

    case 1:
      style.bottom = 0;
      style.left = -dropLevelOffset * indent;
      break;

    case 0:
      style.bottom = 0;
      style.left = indent;
      break;
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    style: style
  });
}

/***/ }),

/***/ "./node_modules/rc-tree/es/Indent.js":
/*!*******************************************!*\
  !*** ./node_modules/rc-tree/es/Indent.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__);




var Indent = function Indent(_ref) {
  var prefixCls = _ref.prefixCls,
      level = _ref.level,
      isStart = _ref.isStart,
      isEnd = _ref.isEnd;
  var baseClassName = "".concat(prefixCls, "-indent-unit");
  var list = [];

  for (var i = 0; i < level; i += 1) {
    var _classNames;

    list.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
      key: i,
      className: classnames__WEBPACK_IMPORTED_MODULE_2___default()(baseClassName, (_classNames = {}, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(_classNames, "".concat(baseClassName, "-start"), isStart[i]), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(_classNames, "".concat(baseClassName, "-end"), isEnd[i]), _classNames))
    }));
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("span", {
    "aria-hidden": "true",
    className: "".concat(prefixCls, "-indent")
  }, list);
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Indent);

/***/ }),

/***/ "./node_modules/rc-tree/es/MotionTreeNode.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-tree/es/MotionTreeNode.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var rc_motion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-motion */ "./node_modules/rc-motion/es/index.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree/es/TreeNode.js");
/* harmony import */ var _utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");
/* harmony import */ var _contextTypes__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./contextTypes */ "./node_modules/rc-tree/es/contextTypes.js");











var MotionTreeNode = function MotionTreeNode(_ref, ref) {
  var className = _ref.className,
      style = _ref.style,
      motion = _ref.motion,
      motionNodes = _ref.motionNodes,
      motionType = _ref.motionType,
      onOriginMotionStart = _ref.onMotionStart,
      onOriginMotionEnd = _ref.onMotionEnd,
      active = _ref.active,
      treeNodeRequiredProps = _ref.treeNodeRequiredProps,
      props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_ref, ["className", "style", "motion", "motionNodes", "motionType", "onMotionStart", "onMotionEnd", "active", "treeNodeRequiredProps"]);

  var _React$useState = react__WEBPACK_IMPORTED_MODULE_3__.useState(true),
      _React$useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState, 2),
      visible = _React$useState2[0],
      setVisible = _React$useState2[1];

  var _React$useContext = react__WEBPACK_IMPORTED_MODULE_3__.useContext(_contextTypes__WEBPACK_IMPORTED_MODULE_8__.TreeContext),
      prefixCls = _React$useContext.prefixCls;

  var motionedRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(false);

  var onMotionEnd = function onMotionEnd() {
    if (!motionedRef.current) {
      onOriginMotionEnd();
    }

    motionedRef.current = true;
  };

  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    if (motionNodes && motionType === 'hide' && visible) {
      setVisible(false);
    }
  }, [motionNodes]);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    // Trigger motion only when patched
    if (motionNodes) {
      onOriginMotionStart();
    }

    return function () {
      if (motionNodes) {
        onMotionEnd();
      }
    };
  }, []);

  if (motionNodes) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(rc_motion__WEBPACK_IMPORTED_MODULE_5__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
      ref: ref,
      visible: visible
    }, motion, {
      motionAppear: motionType === 'show',
      onAppearEnd: onMotionEnd,
      onLeaveEnd: onMotionEnd
    }), function (_ref2, motionRef) {
      var motionClassName = _ref2.className,
          motionStyle = _ref2.style;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
        ref: motionRef,
        className: classnames__WEBPACK_IMPORTED_MODULE_4___default()("".concat(prefixCls, "-treenode-motion"), motionClassName),
        style: motionStyle
      }, motionNodes.map(function (treeNode) {
        var _treeNode$data = treeNode.data,
            key = _treeNode$data.key,
            restProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_treeNode$data, ["key"]),
            isStart = treeNode.isStart,
            isEnd = treeNode.isEnd;

        delete restProps.children;
        var treeNodeProps = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__.getTreeNodeProps)(key, treeNodeRequiredProps);
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_TreeNode__WEBPACK_IMPORTED_MODULE_6__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, restProps, treeNodeProps, {
          active: active,
          data: treeNode.data,
          key: key,
          isStart: isStart,
          isEnd: isEnd
        }));
      }));
    });
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_TreeNode__WEBPACK_IMPORTED_MODULE_6__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
    domRef: ref,
    className: className,
    style: style
  }, props, {
    active: active
  }));
};

MotionTreeNode.displayName = 'MotionTreeNode';
var RefMotionTreeNode = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.forwardRef(MotionTreeNode);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RefMotionTreeNode);

/***/ }),

/***/ "./node_modules/rc-tree/es/NodeList.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-tree/es/NodeList.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MOTION_KEY": () => (/* binding */ MOTION_KEY),
/* harmony export */   "MotionEntity": () => (/* binding */ MotionEntity),
/* harmony export */   "getMinimumRangeTransitionRange": () => (/* binding */ getMinimumRangeTransitionRange),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_virtual_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-virtual-list */ "./node_modules/rc-virtual-list/es/index.js");
/* harmony import */ var _MotionTreeNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./MotionTreeNode */ "./node_modules/rc-tree/es/MotionTreeNode.js");
/* harmony import */ var _utils_diffUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/diffUtil */ "./node_modules/rc-tree/es/utils/diffUtil.js");
/* harmony import */ var _utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");




/**
 * Handle virtual list of the TreeNodes.
 */





var HIDDEN_STYLE = {
  width: 0,
  height: 0,
  display: 'flex',
  overflow: 'hidden',
  opacity: 0,
  border: 0,
  padding: 0,
  margin: 0
};

var noop = function noop() {};

var MOTION_KEY = "RC_TREE_MOTION_".concat(Math.random());
var MotionNode = {
  key: MOTION_KEY
};
var MotionEntity = {
  key: MOTION_KEY,
  level: 0,
  index: 0,
  pos: '0',
  node: MotionNode
};
var MotionFlattenData = {
  parent: null,
  children: [],
  pos: MotionEntity.pos,
  data: MotionNode,

  /** Hold empty list here since we do not use it */
  isStart: [],
  isEnd: []
};
/**
 * We only need get visible content items to play the animation.
 */

function getMinimumRangeTransitionRange(list, virtual, height, itemHeight) {
  if (virtual === false || !height) {
    return list;
  }

  return list.slice(0, Math.ceil(height / itemHeight) + 1);
}

function itemKey(item) {
  var key = item.data.key,
      pos = item.pos;
  return (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__.getKey)(key, pos);
}

function getAccessibilityPath(item) {
  var path = String(item.data.key);
  var current = item;

  while (current.parent) {
    current = current.parent;
    path = "".concat(current.data.key, " > ").concat(path);
  }

  return path;
}

var RefNodeList = function RefNodeList(props, ref) {
  var prefixCls = props.prefixCls,
      data = props.data,
      selectable = props.selectable,
      checkable = props.checkable,
      expandedKeys = props.expandedKeys,
      selectedKeys = props.selectedKeys,
      checkedKeys = props.checkedKeys,
      loadedKeys = props.loadedKeys,
      loadingKeys = props.loadingKeys,
      halfCheckedKeys = props.halfCheckedKeys,
      keyEntities = props.keyEntities,
      disabled = props.disabled,
      dragging = props.dragging,
      dragOverNodeKey = props.dragOverNodeKey,
      dropPosition = props.dropPosition,
      motion = props.motion,
      height = props.height,
      itemHeight = props.itemHeight,
      virtual = props.virtual,
      focusable = props.focusable,
      activeItem = props.activeItem,
      focused = props.focused,
      tabIndex = props.tabIndex,
      onKeyDown = props.onKeyDown,
      onFocus = props.onFocus,
      onBlur = props.onBlur,
      onActiveChange = props.onActiveChange,
      onListChangeStart = props.onListChangeStart,
      onListChangeEnd = props.onListChangeEnd,
      domProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(props, ["prefixCls", "data", "selectable", "checkable", "expandedKeys", "selectedKeys", "checkedKeys", "loadedKeys", "loadingKeys", "halfCheckedKeys", "keyEntities", "disabled", "dragging", "dragOverNodeKey", "dropPosition", "motion", "height", "itemHeight", "virtual", "focusable", "activeItem", "focused", "tabIndex", "onKeyDown", "onFocus", "onBlur", "onActiveChange", "onListChangeStart", "onListChangeEnd"]); // =============================== Ref ================================


  var listRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(null);
  var indentMeasurerRef = react__WEBPACK_IMPORTED_MODULE_3__.useRef(null);
  react__WEBPACK_IMPORTED_MODULE_3__.useImperativeHandle(ref, function () {
    return {
      scrollTo: function scrollTo(scroll) {
        listRef.current.scrollTo(scroll);
      },
      getIndentWidth: function getIndentWidth() {
        return indentMeasurerRef.current.offsetWidth;
      }
    };
  }); // ============================== Motion ==============================

  var _React$useState = react__WEBPACK_IMPORTED_MODULE_3__.useState(expandedKeys),
      _React$useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState, 2),
      prevExpandedKeys = _React$useState2[0],
      setPrevExpandedKeys = _React$useState2[1];

  var _React$useState3 = react__WEBPACK_IMPORTED_MODULE_3__.useState(data),
      _React$useState4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState3, 2),
      prevData = _React$useState4[0],
      setPrevData = _React$useState4[1];

  var _React$useState5 = react__WEBPACK_IMPORTED_MODULE_3__.useState(data),
      _React$useState6 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState5, 2),
      transitionData = _React$useState6[0],
      setTransitionData = _React$useState6[1];

  var _React$useState7 = react__WEBPACK_IMPORTED_MODULE_3__.useState([]),
      _React$useState8 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState7, 2),
      transitionRange = _React$useState8[0],
      setTransitionRange = _React$useState8[1];

  var _React$useState9 = react__WEBPACK_IMPORTED_MODULE_3__.useState(null),
      _React$useState10 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.default)(_React$useState9, 2),
      motionType = _React$useState10[0],
      setMotionType = _React$useState10[1];

  function onMotionEnd() {
    setPrevData(data);
    setTransitionData(data);
    setTransitionRange([]);
    setMotionType(null);
    onListChangeEnd();
  } // Do animation if expanded keys changed


  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(function () {
    setPrevExpandedKeys(expandedKeys);
    var diffExpanded = (0,_utils_diffUtil__WEBPACK_IMPORTED_MODULE_6__.findExpandedKeys)(prevExpandedKeys, expandedKeys);

    if (diffExpanded.key !== null) {
      if (diffExpanded.add) {
        var keyIndex = prevData.findIndex(function (_ref) {
          var key = _ref.data.key;
          return key === diffExpanded.key;
        });
        var rangeNodes = getMinimumRangeTransitionRange((0,_utils_diffUtil__WEBPACK_IMPORTED_MODULE_6__.getExpandRange)(prevData, data, diffExpanded.key), virtual, height, itemHeight);
        var newTransitionData = prevData.slice();
        newTransitionData.splice(keyIndex + 1, 0, MotionFlattenData);
        setTransitionData(newTransitionData);
        setTransitionRange(rangeNodes);
        setMotionType('show');
      } else {
        var _keyIndex = data.findIndex(function (_ref2) {
          var key = _ref2.data.key;
          return key === diffExpanded.key;
        });

        var _rangeNodes = getMinimumRangeTransitionRange((0,_utils_diffUtil__WEBPACK_IMPORTED_MODULE_6__.getExpandRange)(data, prevData, diffExpanded.key), virtual, height, itemHeight);

        var _newTransitionData = data.slice();

        _newTransitionData.splice(_keyIndex + 1, 0, MotionFlattenData);

        setTransitionData(_newTransitionData);
        setTransitionRange(_rangeNodes);
        setMotionType('hide');
      }
    } else if (prevData !== data) {
      // If whole data changed, we just refresh the list
      setPrevData(data);
      setTransitionData(data);
    }
  }, [expandedKeys, data]); // We should clean up motion if is changed by dragging

  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(function () {
    if (!dragging) {
      onMotionEnd();
    }
  }, [dragging]);
  var mergedData = motion ? transitionData : data;
  var treeNodeRequiredProps = {
    expandedKeys: expandedKeys,
    selectedKeys: selectedKeys,
    loadedKeys: loadedKeys,
    loadingKeys: loadingKeys,
    checkedKeys: checkedKeys,
    halfCheckedKeys: halfCheckedKeys,
    dragOverNodeKey: dragOverNodeKey,
    dropPosition: dropPosition,
    keyEntities: keyEntities
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(react__WEBPACK_IMPORTED_MODULE_3__.Fragment, null, focused && activeItem && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("span", {
    style: HIDDEN_STYLE,
    "aria-live": "assertive"
  }, getAccessibilityPath(activeItem)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
    role: "tree"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("input", {
    style: HIDDEN_STYLE,
    disabled: focusable === false || disabled,
    tabIndex: focusable !== false ? tabIndex : null,
    onKeyDown: onKeyDown,
    onFocus: onFocus,
    onBlur: onBlur,
    value: "",
    onChange: noop
  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
    className: "".concat(prefixCls, "-treenode"),
    "aria-hidden": true,
    style: {
      position: 'absolute',
      pointerEvents: 'none',
      visibility: 'hidden',
      height: 0,
      overflow: 'hidden'
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
    className: "".concat(prefixCls, "-indent")
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
    ref: indentMeasurerRef,
    className: "".concat(prefixCls, "-indent-unit")
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(rc_virtual_list__WEBPACK_IMPORTED_MODULE_4__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, domProps, {
    data: mergedData,
    itemKey: itemKey,
    height: height,
    fullHeight: false,
    virtual: virtual,
    itemHeight: itemHeight,
    prefixCls: "".concat(prefixCls, "-list"),
    ref: listRef
  }), function (treeNode) {
    var pos = treeNode.pos,
        _treeNode$data = treeNode.data,
        key = _treeNode$data.key,
        restProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_treeNode$data, ["key"]),
        isStart = treeNode.isStart,
        isEnd = treeNode.isEnd;

    var mergedKey = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__.getKey)(key, pos);
    delete restProps.children;
    var treeNodeProps = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_7__.getTreeNodeProps)(mergedKey, treeNodeRequiredProps);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_MotionTreeNode__WEBPACK_IMPORTED_MODULE_5__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, restProps, treeNodeProps, {
      active: !!activeItem && key === activeItem.data.key,
      pos: pos,
      data: treeNode.data,
      isStart: isStart,
      isEnd: isEnd,
      motion: motion,
      motionNodes: key === MOTION_KEY ? transitionRange : null,
      motionType: motionType,
      onMotionStart: onListChangeStart,
      onMotionEnd: onMotionEnd,
      treeNodeRequiredProps: treeNodeRequiredProps,
      onMouseMove: function onMouseMove() {
        onActiveChange(null);
      }
    }));
  }));
};

var NodeList = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.forwardRef(RefNodeList);
NodeList.displayName = 'NodeList';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (NodeList);

/***/ }),

/***/ "./node_modules/rc-tree/es/Tree.js":
/*!*****************************************!*\
  !*** ./node_modules/rc-tree/es/Tree.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rc-util/es/KeyCode */ "./node_modules/rc-util/es/KeyCode.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _contextTypes__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./contextTypes */ "./node_modules/rc-tree/es/contextTypes.js");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./util */ "./node_modules/rc-tree/es/util.js");
/* harmony import */ var _utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");
/* harmony import */ var _NodeList__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./NodeList */ "./node_modules/rc-tree/es/NodeList.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree/es/TreeNode.js");
/* harmony import */ var _utils_conductUtil__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./utils/conductUtil */ "./node_modules/rc-tree/es/utils/conductUtil.js");
/* harmony import */ var _DropIndicator__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./DropIndicator */ "./node_modules/rc-tree/es/DropIndicator.js");









// TODO: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/treeview/treeview-2/treeview-2a.html
// Fully accessibility support












var Tree = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__.default)(Tree, _React$Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_8__.default)(Tree);

  function Tree() {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__.default)(this, Tree);

    _this = _super.apply(this, arguments);
    _this.destroyed = false;
    _this.state = {
      keyEntities: {},
      indent: null,
      selectedKeys: [],
      checkedKeys: [],
      halfCheckedKeys: [],
      loadedKeys: [],
      loadingKeys: [],
      expandedKeys: [],
      dragging: false,
      dragChildrenKeys: [],
      // dropTargetKey is the key of abstract-drop-node
      // the abstract-drop-node is the real drop node when drag and drop
      // not the DOM drag over node
      dropTargetKey: null,
      dropPosition: null,
      dropContainerKey: null,
      dropLevelOffset: null,
      dropTargetPos: null,
      dropAllowed: true,
      // the abstract-drag-over-node
      // if mouse is on the bottom of top dom node or no the top of the bottom dom node
      // abstract-drag-over-node is the top node
      dragOverNodeKey: null,
      treeData: [],
      flattenNodes: [],
      focused: false,
      activeKey: null,
      listChanging: false,
      prevProps: null
    };
    _this.dragStartMousePosition = null;
    _this.listRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createRef();

    _this.onNodeDragStart = function (event, node) {
      var _this$state = _this.state,
          expandedKeys = _this$state.expandedKeys,
          keyEntities = _this$state.keyEntities;
      var onDragStart = _this.props.onDragStart;
      var eventKey = node.props.eventKey;
      _this.dragNode = node;
      _this.dragStartMousePosition = {
        x: event.clientX,
        y: event.clientY
      };
      var newExpandedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(expandedKeys, eventKey);

      _this.setState({
        dragging: true,
        dragChildrenKeys: (0,_util__WEBPACK_IMPORTED_MODULE_14__.getDragChildrenKeys)(eventKey, keyEntities),
        indent: _this.listRef.current.getIndentWidth()
      });

      _this.setExpandedKeys(newExpandedKeys);

      window.addEventListener('dragend', _this.onWindowDragEnd);

      if (onDragStart) {
        onDragStart({
          event: event,
          node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props)
        });
      }
    };
    /**
     * [Legacy] Select handler is smaller than node,
     * so that this will trigger when drag enter node or select handler.
     * This is a little tricky if customize css without padding.
     * Better for use mouse move event to refresh drag state.
     * But let's just keep it to avoid event trigger logic change.
     */


    _this.onNodeDragEnter = function (event, node) {
      var _this$state2 = _this.state,
          expandedKeys = _this$state2.expandedKeys,
          keyEntities = _this$state2.keyEntities,
          dragChildrenKeys = _this$state2.dragChildrenKeys,
          flattenNodes = _this$state2.flattenNodes,
          indent = _this$state2.indent;
      var _this$props = _this.props,
          onDragEnter = _this$props.onDragEnter,
          onExpand = _this$props.onExpand,
          allowDrop = _this$props.allowDrop,
          direction = _this$props.direction;
      var pos = node.props.pos;

      var _assertThisInitialize = (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this),
          dragNode = _assertThisInitialize.dragNode;

      var _calcDropPosition = (0,_util__WEBPACK_IMPORTED_MODULE_14__.calcDropPosition)(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),
          dropPosition = _calcDropPosition.dropPosition,
          dropLevelOffset = _calcDropPosition.dropLevelOffset,
          dropTargetKey = _calcDropPosition.dropTargetKey,
          dropContainerKey = _calcDropPosition.dropContainerKey,
          dropTargetPos = _calcDropPosition.dropTargetPos,
          dropAllowed = _calcDropPosition.dropAllowed,
          dragOverNodeKey = _calcDropPosition.dragOverNodeKey;

      if (!dragNode || // don't allow drop inside its children
      dragChildrenKeys.indexOf(dropTargetKey) !== -1 || // don't allow drop when drop is not allowed caculated by calcDropPosition
      !dropAllowed) {
        _this.setState({
          dragOverNodeKey: null,
          dropPosition: null,
          dropLevelOffset: null,
          dropTargetKey: null,
          dropContainerKey: null,
          dropTargetPos: null,
          dropAllowed: false
        });

        return;
      } // Side effect for delay drag


      if (!_this.delayedDragEnterLogic) {
        _this.delayedDragEnterLogic = {};
      }

      Object.keys(_this.delayedDragEnterLogic).forEach(function (key) {
        clearTimeout(_this.delayedDragEnterLogic[key]);
      });

      if (dragNode.props.eventKey !== node.props.eventKey) {
        // hoist expand logic here
        // since if logic is on the bottom
        // it will be blocked by abstract dragover node check
        //   => if you dragenter from top, you mouse will still be consider as in the top node
        event.persist();
        _this.delayedDragEnterLogic[pos] = window.setTimeout(function () {
          if (!_this.state.dragging) return;

          var newExpandedKeys = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.default)(expandedKeys);

          var entity = keyEntities[node.props.eventKey];

          if (entity && (entity.children || []).length) {
            newExpandedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(expandedKeys, node.props.eventKey);
          }

          if (!('expandedKeys' in _this.props)) {
            _this.setExpandedKeys(newExpandedKeys);
          }

          if (onExpand) {
            onExpand(newExpandedKeys, {
              node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props),
              expanded: true,
              nativeEvent: event.nativeEvent
            });
          }
        }, 800);
      } // Skip if drag node is self


      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {
        _this.setState({
          dragOverNodeKey: null,
          dropPosition: null,
          dropLevelOffset: null,
          dropTargetKey: null,
          dropContainerKey: null,
          dropTargetPos: null,
          dropAllowed: false
        });

        return;
      } // Update drag over node and drag state


      _this.setState({
        dragOverNodeKey: dragOverNodeKey,
        dropPosition: dropPosition,
        dropLevelOffset: dropLevelOffset,
        dropTargetKey: dropTargetKey,
        dropContainerKey: dropContainerKey,
        dropTargetPos: dropTargetPos,
        dropAllowed: dropAllowed
      });

      if (onDragEnter) {
        onDragEnter({
          event: event,
          node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props),
          expandedKeys: expandedKeys
        });
      }
    };

    _this.onNodeDragOver = function (event, node) {
      var _this$state3 = _this.state,
          dragChildrenKeys = _this$state3.dragChildrenKeys,
          flattenNodes = _this$state3.flattenNodes,
          keyEntities = _this$state3.keyEntities,
          expandedKeys = _this$state3.expandedKeys,
          indent = _this$state3.indent;
      var _this$props2 = _this.props,
          onDragOver = _this$props2.onDragOver,
          allowDrop = _this$props2.allowDrop,
          direction = _this$props2.direction;

      var _assertThisInitialize2 = (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this),
          dragNode = _assertThisInitialize2.dragNode;

      var _calcDropPosition2 = (0,_util__WEBPACK_IMPORTED_MODULE_14__.calcDropPosition)(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),
          dropPosition = _calcDropPosition2.dropPosition,
          dropLevelOffset = _calcDropPosition2.dropLevelOffset,
          dropTargetKey = _calcDropPosition2.dropTargetKey,
          dropContainerKey = _calcDropPosition2.dropContainerKey,
          dropAllowed = _calcDropPosition2.dropAllowed,
          dropTargetPos = _calcDropPosition2.dropTargetPos,
          dragOverNodeKey = _calcDropPosition2.dragOverNodeKey;

      if (!dragNode || dragChildrenKeys.indexOf(dropTargetKey) !== -1 || !dropAllowed) {
        // don't allow drop inside its children
        // don't allow drop when drop is not allowed caculated by calcDropPosition
        return;
      } // Update drag position


      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {
        if (!(_this.state.dropPosition === null && _this.state.dropLevelOffset === null && _this.state.dropTargetKey === null && _this.state.dropContainerKey === null && _this.state.dropTargetPos === null && _this.state.dropAllowed === false && _this.state.dragOverNodeKey === null)) {
          _this.setState({
            dropPosition: null,
            dropLevelOffset: null,
            dropTargetKey: null,
            dropContainerKey: null,
            dropTargetPos: null,
            dropAllowed: false,
            dragOverNodeKey: null
          });
        }
      } else if (!(dropPosition === _this.state.dropPosition && dropLevelOffset === _this.state.dropLevelOffset && dropTargetKey === _this.state.dropTargetKey && dropContainerKey === _this.state.dropContainerKey && dropTargetPos === _this.state.dropTargetPos && dropAllowed === _this.state.dropAllowed && dragOverNodeKey === _this.state.dragOverNodeKey)) {
        _this.setState({
          dropPosition: dropPosition,
          dropLevelOffset: dropLevelOffset,
          dropTargetKey: dropTargetKey,
          dropContainerKey: dropContainerKey,
          dropTargetPos: dropTargetPos,
          dropAllowed: dropAllowed,
          dragOverNodeKey: dragOverNodeKey
        });
      }

      if (onDragOver) {
        onDragOver({
          event: event,
          node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props)
        });
      }
    };

    _this.onNodeDragLeave = function (event, node) {
      var onDragLeave = _this.props.onDragLeave;

      if (onDragLeave) {
        onDragLeave({
          event: event,
          node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props)
        });
      }
    }; // since stopPropagation() is called in treeNode
    // if onWindowDrag is called, whice means state is keeped, drag state should be cleared


    _this.onWindowDragEnd = function (event) {
      _this.onNodeDragEnd(event, null, true);

      window.removeEventListener('dragend', _this.onWindowDragEnd);
    }; // if onNodeDragEnd is called, onWindowDragEnd won't be called since stopPropagation() is called


    _this.onNodeDragEnd = function (event, node) {
      var outsideTree = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      var onDragEnd = _this.props.onDragEnd;

      _this.setState({
        dragOverNodeKey: null
      });

      _this.cleanDragState();

      if (onDragEnd && !outsideTree) {
        onDragEnd({
          event: event,
          node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(node.props)
        });
      }

      _this.dragNode = null;
    };

    _this.onNodeDrop = function (event, node) {
      var _this$getActiveItem;

      var outsideTree = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      var _this$state4 = _this.state,
          dragChildrenKeys = _this$state4.dragChildrenKeys,
          dropPosition = _this$state4.dropPosition,
          dropTargetKey = _this$state4.dropTargetKey,
          dropTargetPos = _this$state4.dropTargetPos,
          dropAllowed = _this$state4.dropAllowed;
      if (!dropAllowed) return;
      var onDrop = _this.props.onDrop;

      _this.setState({
        dragOverNodeKey: null
      });

      _this.cleanDragState();

      if (dropTargetKey === null) return;

      var abstractDropNodeProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.getTreeNodeProps)(dropTargetKey, _this.getTreeNodeRequiredProps())), {}, {
        active: ((_this$getActiveItem = _this.getActiveItem()) === null || _this$getActiveItem === void 0 ? void 0 : _this$getActiveItem.data.key) === dropTargetKey,
        data: _this.state.keyEntities[dropTargetKey].node
      });

      var dropToChild = dragChildrenKeys.indexOf(dropTargetKey) !== -1;
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_11__.default)(!dropToChild, "Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");
      var posArr = (0,_util__WEBPACK_IMPORTED_MODULE_14__.posToArr)(dropTargetPos);
      var dropResult = {
        event: event,
        node: (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(abstractDropNodeProps),
        dragNode: _this.dragNode ? (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)(_this.dragNode.props) : null,
        dragNodesKeys: [_this.dragNode.props.eventKey].concat(dragChildrenKeys),
        dropToGap: dropPosition !== 0,
        dropPosition: dropPosition + Number(posArr[posArr.length - 1])
      };

      if (onDrop && !outsideTree) {
        onDrop(dropResult);
      }

      _this.dragNode = null;
    };

    _this.cleanDragState = function () {
      var dragging = _this.state.dragging;

      if (dragging) {
        _this.setState({
          dragging: false,
          dropPosition: null,
          dropContainerKey: null,
          dropTargetKey: null,
          dropLevelOffset: null,
          dropAllowed: true,
          dragOverNodeKey: null
        });
      }

      _this.dragStartMousePosition = null;
    };

    _this.onNodeClick = function (e, treeNode) {
      var onClick = _this.props.onClick;

      if (onClick) {
        onClick(e, treeNode);
      }
    };

    _this.onNodeDoubleClick = function (e, treeNode) {
      var onDoubleClick = _this.props.onDoubleClick;

      if (onDoubleClick) {
        onDoubleClick(e, treeNode);
      }
    };

    _this.onNodeSelect = function (e, treeNode) {
      var selectedKeys = _this.state.selectedKeys;
      var keyEntities = _this.state.keyEntities;
      var _this$props3 = _this.props,
          onSelect = _this$props3.onSelect,
          multiple = _this$props3.multiple;
      var selected = treeNode.selected,
          key = treeNode.key;
      var targetSelected = !selected; // Update selected keys

      if (!targetSelected) {
        selectedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(selectedKeys, key);
      } else if (!multiple) {
        selectedKeys = [key];
      } else {
        selectedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(selectedKeys, key);
      } // [Legacy] Not found related usage in doc or upper libs


      var selectedNodes = selectedKeys.map(function (selectedKey) {
        var entity = keyEntities[selectedKey];
        if (!entity) return null;
        return entity.node;
      }).filter(function (node) {
        return node;
      });

      _this.setUncontrolledState({
        selectedKeys: selectedKeys
      });

      if (onSelect) {
        onSelect(selectedKeys, {
          event: 'select',
          selected: targetSelected,
          node: treeNode,
          selectedNodes: selectedNodes,
          nativeEvent: e.nativeEvent
        });
      }
    };

    _this.onNodeCheck = function (e, treeNode, checked) {
      var _this$state5 = _this.state,
          keyEntities = _this$state5.keyEntities,
          oriCheckedKeys = _this$state5.checkedKeys,
          oriHalfCheckedKeys = _this$state5.halfCheckedKeys;
      var _this$props4 = _this.props,
          checkStrictly = _this$props4.checkStrictly,
          onCheck = _this$props4.onCheck;
      var key = treeNode.key; // Prepare trigger arguments

      var checkedObj;
      var eventObj = {
        event: 'check',
        node: treeNode,
        checked: checked,
        nativeEvent: e.nativeEvent
      };

      if (checkStrictly) {
        var checkedKeys = checked ? (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(oriCheckedKeys, key) : (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(oriCheckedKeys, key);
        var halfCheckedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(oriHalfCheckedKeys, key);
        checkedObj = {
          checked: checkedKeys,
          halfChecked: halfCheckedKeys
        };
        eventObj.checkedNodes = checkedKeys.map(function (checkedKey) {
          return keyEntities[checkedKey];
        }).filter(function (entity) {
          return entity;
        }).map(function (entity) {
          return entity.node;
        });

        _this.setUncontrolledState({
          checkedKeys: checkedKeys
        });
      } else {
        // Always fill first
        var _conductCheck = (0,_utils_conductUtil__WEBPACK_IMPORTED_MODULE_18__.conductCheck)([].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.default)(oriCheckedKeys), [key]), true, keyEntities),
            _checkedKeys = _conductCheck.checkedKeys,
            _halfCheckedKeys = _conductCheck.halfCheckedKeys; // If remove, we do it again to correction


        if (!checked) {
          var keySet = new Set(_checkedKeys);
          keySet.delete(key);

          var _conductCheck2 = (0,_utils_conductUtil__WEBPACK_IMPORTED_MODULE_18__.conductCheck)(Array.from(keySet), {
            checked: false,
            halfCheckedKeys: _halfCheckedKeys
          }, keyEntities);

          _checkedKeys = _conductCheck2.checkedKeys;
          _halfCheckedKeys = _conductCheck2.halfCheckedKeys;
        }

        checkedObj = _checkedKeys; // [Legacy] This is used for `rc-tree-select`

        eventObj.checkedNodes = [];
        eventObj.checkedNodesPositions = [];
        eventObj.halfCheckedKeys = _halfCheckedKeys;

        _checkedKeys.forEach(function (checkedKey) {
          var entity = keyEntities[checkedKey];
          if (!entity) return;
          var node = entity.node,
              pos = entity.pos;
          eventObj.checkedNodes.push(node);
          eventObj.checkedNodesPositions.push({
            node: node,
            pos: pos
          });
        });

        _this.setUncontrolledState({
          checkedKeys: _checkedKeys
        }, false, {
          halfCheckedKeys: _halfCheckedKeys
        });
      }

      if (onCheck) {
        onCheck(checkedObj, eventObj);
      }
    };

    _this.onNodeLoad = function (treeNode) {
      return new Promise(function (resolve) {
        // We need to get the latest state of loading/loaded keys
        _this.setState(function (_ref) {
          var _ref$loadedKeys = _ref.loadedKeys,
              loadedKeys = _ref$loadedKeys === void 0 ? [] : _ref$loadedKeys,
              _ref$loadingKeys = _ref.loadingKeys,
              loadingKeys = _ref$loadingKeys === void 0 ? [] : _ref$loadingKeys;
          var _this$props5 = _this.props,
              loadData = _this$props5.loadData,
              onLoad = _this$props5.onLoad;
          var key = treeNode.key;

          if (!loadData || loadedKeys.indexOf(key) !== -1 || loadingKeys.indexOf(key) !== -1) {
            // react 15 will warn if return null
            return {};
          } // Process load data


          var promise = loadData(treeNode);
          promise.then(function () {
            var _this$state6 = _this.state,
                currentLoadedKeys = _this$state6.loadedKeys,
                currentLoadingKeys = _this$state6.loadingKeys;
            var newLoadedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(currentLoadedKeys, key);
            var newLoadingKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(currentLoadingKeys, key); // onLoad should trigger before internal setState to avoid `loadData` trigger twice.
            // https://github.com/ant-design/ant-design/issues/12464

            if (onLoad) {
              onLoad(newLoadedKeys, {
                event: 'load',
                node: treeNode
              });
            }

            _this.setUncontrolledState({
              loadedKeys: newLoadedKeys
            });

            _this.setState({
              loadingKeys: newLoadingKeys
            });

            resolve();
          });
          return {
            loadingKeys: (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(loadingKeys, key)
          };
        });
      });
    };

    _this.onNodeMouseEnter = function (event, node) {
      var onMouseEnter = _this.props.onMouseEnter;

      if (onMouseEnter) {
        onMouseEnter({
          event: event,
          node: node
        });
      }
    };

    _this.onNodeMouseLeave = function (event, node) {
      var onMouseLeave = _this.props.onMouseLeave;

      if (onMouseLeave) {
        onMouseLeave({
          event: event,
          node: node
        });
      }
    };

    _this.onNodeContextMenu = function (event, node) {
      var onRightClick = _this.props.onRightClick;

      if (onRightClick) {
        event.preventDefault();
        onRightClick({
          event: event,
          node: node
        });
      }
    };

    _this.onFocus = function () {
      var onFocus = _this.props.onFocus;

      _this.setState({
        focused: true
      });

      if (onFocus) {
        onFocus.apply(void 0, arguments);
      }
    };

    _this.onBlur = function () {
      var onBlur = _this.props.onBlur;

      _this.setState({
        focused: false
      });

      _this.onActiveChange(null);

      if (onBlur) {
        onBlur.apply(void 0, arguments);
      }
    };

    _this.getTreeNodeRequiredProps = function () {
      var _this$state7 = _this.state,
          expandedKeys = _this$state7.expandedKeys,
          selectedKeys = _this$state7.selectedKeys,
          loadedKeys = _this$state7.loadedKeys,
          loadingKeys = _this$state7.loadingKeys,
          checkedKeys = _this$state7.checkedKeys,
          halfCheckedKeys = _this$state7.halfCheckedKeys,
          dragOverNodeKey = _this$state7.dragOverNodeKey,
          dropPosition = _this$state7.dropPosition,
          keyEntities = _this$state7.keyEntities;
      return {
        expandedKeys: expandedKeys || [],
        selectedKeys: selectedKeys || [],
        loadedKeys: loadedKeys || [],
        loadingKeys: loadingKeys || [],
        checkedKeys: checkedKeys || [],
        halfCheckedKeys: halfCheckedKeys || [],
        dragOverNodeKey: dragOverNodeKey,
        dropPosition: dropPosition,
        keyEntities: keyEntities
      };
    }; // =========================== Expanded ===========================

    /** Set uncontrolled `expandedKeys`. This will also auto update `flattenNodes`. */


    _this.setExpandedKeys = function (expandedKeys) {
      var treeData = _this.state.treeData;
      var flattenNodes = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.flattenTreeData)(treeData, expandedKeys);

      _this.setUncontrolledState({
        expandedKeys: expandedKeys,
        flattenNodes: flattenNodes
      }, true);
    };

    _this.onNodeExpand = function (e, treeNode) {
      var expandedKeys = _this.state.expandedKeys;
      var listChanging = _this.state.listChanging;
      var _this$props6 = _this.props,
          onExpand = _this$props6.onExpand,
          loadData = _this$props6.loadData;
      var key = treeNode.key,
          expanded = treeNode.expanded; // Do nothing when motion is in progress

      if (listChanging) {
        return;
      } // Update selected keys


      var index = expandedKeys.indexOf(key);
      var targetExpanded = !expanded;
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_11__.default)(expanded && index !== -1 || !expanded && index === -1, 'Expand state not sync with index check');

      if (targetExpanded) {
        expandedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrAdd)(expandedKeys, key);
      } else {
        expandedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.arrDel)(expandedKeys, key);
      }

      _this.setExpandedKeys(expandedKeys);

      if (onExpand) {
        onExpand(expandedKeys, {
          node: treeNode,
          expanded: targetExpanded,
          nativeEvent: e.nativeEvent
        });
      } // Async Load data


      if (targetExpanded && loadData) {
        var loadPromise = _this.onNodeLoad(treeNode);

        if (loadPromise) {
          loadPromise.then(function () {
            // [Legacy] Refresh logic
            var newFlattenTreeData = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.flattenTreeData)(_this.state.treeData, expandedKeys);

            _this.setUncontrolledState({
              flattenNodes: newFlattenTreeData
            });
          });
        }
      }
    };

    _this.onListChangeStart = function () {
      _this.setUncontrolledState({
        listChanging: true
      });
    };

    _this.onListChangeEnd = function () {
      setTimeout(function () {
        _this.setUncontrolledState({
          listChanging: false
        });
      });
    }; // =========================== Keyboard ===========================


    _this.onActiveChange = function (newActiveKey) {
      var activeKey = _this.state.activeKey;
      var onActiveChange = _this.props.onActiveChange;

      if (activeKey === newActiveKey) {
        return;
      }

      _this.setState({
        activeKey: newActiveKey
      });

      if (newActiveKey !== null) {
        _this.scrollTo({
          key: newActiveKey
        });
      }

      if (onActiveChange) {
        onActiveChange(newActiveKey);
      }
    };

    _this.getActiveItem = function () {
      var _this$state8 = _this.state,
          activeKey = _this$state8.activeKey,
          flattenNodes = _this$state8.flattenNodes;

      if (activeKey === null) {
        return null;
      }

      return flattenNodes.find(function (_ref2) {
        var key = _ref2.data.key;
        return key === activeKey;
      }) || null;
    };

    _this.offsetActiveKey = function (offset) {
      var _this$state9 = _this.state,
          flattenNodes = _this$state9.flattenNodes,
          activeKey = _this$state9.activeKey;
      var index = flattenNodes.findIndex(function (_ref3) {
        var key = _ref3.data.key;
        return key === activeKey;
      }); // Align with index

      if (index === -1 && offset < 0) {
        index = flattenNodes.length;
      }

      index = (index + offset + flattenNodes.length) % flattenNodes.length;
      var item = flattenNodes[index];

      if (item) {
        var key = item.data.key;

        _this.onActiveChange(key);
      } else {
        _this.onActiveChange(null);
      }
    };

    _this.onKeyDown = function (event) {
      var _this$state10 = _this.state,
          activeKey = _this$state10.activeKey,
          expandedKeys = _this$state10.expandedKeys,
          checkedKeys = _this$state10.checkedKeys;
      var _this$props7 = _this.props,
          onKeyDown = _this$props7.onKeyDown,
          checkable = _this$props7.checkable,
          selectable = _this$props7.selectable; // >>>>>>>>>> Direction

      switch (event.which) {
        case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.UP:
          {
            _this.offsetActiveKey(-1);

            event.preventDefault();
            break;
          }

        case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.DOWN:
          {
            _this.offsetActiveKey(1);

            event.preventDefault();
            break;
          }
      } // >>>>>>>>>> Expand & Selection


      var activeItem = _this.getActiveItem();

      if (activeItem && activeItem.data) {
        var treeNodeRequiredProps = _this.getTreeNodeRequiredProps();

        var expandable = activeItem.data.isLeaf === false || !!(activeItem.data.children || []).length;
        var eventNode = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertNodePropsToEventData)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.getTreeNodeProps)(activeKey, treeNodeRequiredProps)), {}, {
          data: activeItem.data,
          active: true
        }));

        switch (event.which) {
          // >>> Expand
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.LEFT:
            {
              // Collapse if possible
              if (expandable && expandedKeys.includes(activeKey)) {
                _this.onNodeExpand({}, eventNode);
              } else if (activeItem.parent) {
                _this.onActiveChange(activeItem.parent.data.key);
              }

              event.preventDefault();
              break;
            }

          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.RIGHT:
            {
              // Expand if possible
              if (expandable && !expandedKeys.includes(activeKey)) {
                _this.onNodeExpand({}, eventNode);
              } else if (activeItem.children && activeItem.children.length) {
                _this.onActiveChange(activeItem.children[0].data.key);
              }

              event.preventDefault();
              break;
            }
          // Selection

          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.ENTER:
          case rc_util_es_KeyCode__WEBPACK_IMPORTED_MODULE_10__.default.SPACE:
            {
              if (checkable && !eventNode.disabled && eventNode.checkable !== false && !eventNode.disableCheckbox) {
                _this.onNodeCheck({}, eventNode, !checkedKeys.includes(activeKey));
              } else if (!checkable && selectable && !eventNode.disabled && eventNode.selectable !== false) {
                _this.onNodeSelect({}, eventNode);
              }

              break;
            }
        }
      }

      if (onKeyDown) {
        onKeyDown(event);
      }
    };
    /**
     * Only update the value which is not in props
     */


    _this.setUncontrolledState = function (state) {
      var atomic = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var forceState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

      if (_this.destroyed) {
        return;
      }

      var needSync = false;
      var allPassed = true;
      var newState = {};
      Object.keys(state).forEach(function (name) {
        if (name in _this.props) {
          allPassed = false;
          return;
        }

        needSync = true;
        newState[name] = state[name];
      });

      if (needSync && (!atomic || allPassed)) {
        _this.setState((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, newState), forceState));
      }
    };

    _this.scrollTo = function (scroll) {
      _this.listRef.current.scrollTo(scroll);
    };

    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__.default)(Tree, [{
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      window.removeEventListener('dragend', this.onWindowDragEnd);
      this.destroyed = true;
    }
  }, {
    key: "render",
    value: function render() {
      var _classNames;

      var _this$state11 = this.state,
          focused = _this$state11.focused,
          flattenNodes = _this$state11.flattenNodes,
          keyEntities = _this$state11.keyEntities,
          dragging = _this$state11.dragging,
          activeKey = _this$state11.activeKey,
          dropLevelOffset = _this$state11.dropLevelOffset,
          dropContainerKey = _this$state11.dropContainerKey,
          dropTargetKey = _this$state11.dropTargetKey,
          dropPosition = _this$state11.dropPosition,
          dragOverNodeKey = _this$state11.dragOverNodeKey,
          indent = _this$state11.indent;
      var _this$props8 = this.props,
          prefixCls = _this$props8.prefixCls,
          className = _this$props8.className,
          style = _this$props8.style,
          showLine = _this$props8.showLine,
          focusable = _this$props8.focusable,
          _this$props8$tabIndex = _this$props8.tabIndex,
          tabIndex = _this$props8$tabIndex === void 0 ? 0 : _this$props8$tabIndex,
          selectable = _this$props8.selectable,
          showIcon = _this$props8.showIcon,
          icon = _this$props8.icon,
          switcherIcon = _this$props8.switcherIcon,
          draggable = _this$props8.draggable,
          checkable = _this$props8.checkable,
          checkStrictly = _this$props8.checkStrictly,
          disabled = _this$props8.disabled,
          motion = _this$props8.motion,
          loadData = _this$props8.loadData,
          filterTreeNode = _this$props8.filterTreeNode,
          height = _this$props8.height,
          itemHeight = _this$props8.itemHeight,
          virtual = _this$props8.virtual,
          titleRender = _this$props8.titleRender,
          dropIndicatorRender = _this$props8.dropIndicatorRender,
          onContextMenu = _this$props8.onContextMenu,
          direction = _this$props8.direction;
      var domProps = (0,_util__WEBPACK_IMPORTED_MODULE_14__.getDataAndAria)(this.props);
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(_contextTypes__WEBPACK_IMPORTED_MODULE_13__.TreeContext.Provider, {
        value: {
          prefixCls: prefixCls,
          selectable: selectable,
          showIcon: showIcon,
          icon: icon,
          switcherIcon: switcherIcon,
          draggable: draggable,
          checkable: checkable,
          checkStrictly: checkStrictly,
          disabled: disabled,
          keyEntities: keyEntities,
          dropLevelOffset: dropLevelOffset,
          dropContainerKey: dropContainerKey,
          dropTargetKey: dropTargetKey,
          dropPosition: dropPosition,
          dragOverNodeKey: dragOverNodeKey,
          indent: indent,
          direction: direction,
          dropIndicatorRender: dropIndicatorRender,
          loadData: loadData,
          filterTreeNode: filterTreeNode,
          titleRender: titleRender,
          onNodeClick: this.onNodeClick,
          onNodeDoubleClick: this.onNodeDoubleClick,
          onNodeExpand: this.onNodeExpand,
          onNodeSelect: this.onNodeSelect,
          onNodeCheck: this.onNodeCheck,
          onNodeLoad: this.onNodeLoad,
          onNodeMouseEnter: this.onNodeMouseEnter,
          onNodeMouseLeave: this.onNodeMouseLeave,
          onNodeContextMenu: this.onNodeContextMenu,
          onNodeDragStart: this.onNodeDragStart,
          onNodeDragEnter: this.onNodeDragEnter,
          onNodeDragOver: this.onNodeDragOver,
          onNodeDragLeave: this.onNodeDragLeave,
          onNodeDragEnd: this.onNodeDragEnd,
          onNodeDrop: this.onNodeDrop
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("div", {
        className: classnames__WEBPACK_IMPORTED_MODULE_12___default()(prefixCls, className, (_classNames = {}, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-show-line"), showLine), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-focused"), focused), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-active-focused"), activeKey !== null), _classNames))
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(_NodeList__WEBPACK_IMPORTED_MODULE_16__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
        ref: this.listRef,
        prefixCls: prefixCls,
        style: style,
        data: flattenNodes,
        disabled: disabled,
        selectable: selectable,
        checkable: !!checkable,
        motion: motion,
        dragging: dragging,
        height: height,
        itemHeight: itemHeight,
        virtual: virtual,
        focusable: focusable,
        focused: focused,
        tabIndex: tabIndex,
        activeItem: this.getActiveItem(),
        onFocus: this.onFocus,
        onBlur: this.onBlur,
        onKeyDown: this.onKeyDown,
        onActiveChange: this.onActiveChange,
        onListChangeStart: this.onListChangeStart,
        onListChangeEnd: this.onListChangeEnd,
        onContextMenu: onContextMenu
      }, this.getTreeNodeRequiredProps(), domProps))));
    }
  }], [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(props, prevState) {
      var prevProps = prevState.prevProps;
      var newState = {
        prevProps: props
      };

      function needSync(name) {
        return !prevProps && name in props || prevProps && prevProps[name] !== props[name];
      } // ================== Tree Node ==================


      var treeData; // Check if `treeData` or `children` changed and save into the state.

      if (needSync('treeData')) {
        treeData = props.treeData;
      } else if (needSync('children')) {
        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_11__.default)(false, '`children` of Tree is deprecated. Please use `treeData` instead.');
        treeData = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertTreeToData)(props.children);
      } // Save flatten nodes info and convert `treeData` into keyEntities


      if (treeData) {
        newState.treeData = treeData;
        var entitiesMap = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.convertDataToEntities)(treeData);
        newState.keyEntities = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)({}, _NodeList__WEBPACK_IMPORTED_MODULE_16__.MOTION_KEY, _NodeList__WEBPACK_IMPORTED_MODULE_16__.MotionEntity), entitiesMap.keyEntities); // Warning if treeNode not provide key

        if (true) {
          (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.warningWithoutKey)(treeData);
        }
      }

      var keyEntities = newState.keyEntities || prevState.keyEntities; // ================ expandedKeys =================

      if (needSync('expandedKeys') || prevProps && needSync('autoExpandParent')) {
        newState.expandedKeys = props.autoExpandParent || !prevProps && props.defaultExpandParent ? (0,_util__WEBPACK_IMPORTED_MODULE_14__.conductExpandParent)(props.expandedKeys, keyEntities) : props.expandedKeys;
      } else if (!prevProps && props.defaultExpandAll) {
        var cloneKeyEntities = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, keyEntities);

        delete cloneKeyEntities[_NodeList__WEBPACK_IMPORTED_MODULE_16__.MOTION_KEY];
        newState.expandedKeys = Object.keys(cloneKeyEntities).map(function (key) {
          return cloneKeyEntities[key].key;
        });
      } else if (!prevProps && props.defaultExpandedKeys) {
        newState.expandedKeys = props.autoExpandParent || props.defaultExpandParent ? (0,_util__WEBPACK_IMPORTED_MODULE_14__.conductExpandParent)(props.defaultExpandedKeys, keyEntities) : props.defaultExpandedKeys;
      }

      if (!newState.expandedKeys) {
        delete newState.expandedKeys;
      } // ================ flattenNodes =================


      if (treeData || newState.expandedKeys) {
        var flattenNodes = (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_15__.flattenTreeData)(treeData || prevState.treeData, newState.expandedKeys || prevState.expandedKeys);
        newState.flattenNodes = flattenNodes;
      } // ================ selectedKeys =================


      if (props.selectable) {
        if (needSync('selectedKeys')) {
          newState.selectedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.calcSelectedKeys)(props.selectedKeys, props);
        } else if (!prevProps && props.defaultSelectedKeys) {
          newState.selectedKeys = (0,_util__WEBPACK_IMPORTED_MODULE_14__.calcSelectedKeys)(props.defaultSelectedKeys, props);
        }
      } // ================= checkedKeys =================


      if (props.checkable) {
        var checkedKeyEntity;

        if (needSync('checkedKeys')) {
          checkedKeyEntity = (0,_util__WEBPACK_IMPORTED_MODULE_14__.parseCheckedKeys)(props.checkedKeys) || {};
        } else if (!prevProps && props.defaultCheckedKeys) {
          checkedKeyEntity = (0,_util__WEBPACK_IMPORTED_MODULE_14__.parseCheckedKeys)(props.defaultCheckedKeys) || {};
        } else if (treeData) {
          // If `treeData` changed, we also need check it
          checkedKeyEntity = (0,_util__WEBPACK_IMPORTED_MODULE_14__.parseCheckedKeys)(props.checkedKeys) || {
            checkedKeys: prevState.checkedKeys,
            halfCheckedKeys: prevState.halfCheckedKeys
          };
        }

        if (checkedKeyEntity) {
          var _checkedKeyEntity = checkedKeyEntity,
              _checkedKeyEntity$che = _checkedKeyEntity.checkedKeys,
              checkedKeys = _checkedKeyEntity$che === void 0 ? [] : _checkedKeyEntity$che,
              _checkedKeyEntity$hal = _checkedKeyEntity.halfCheckedKeys,
              halfCheckedKeys = _checkedKeyEntity$hal === void 0 ? [] : _checkedKeyEntity$hal;

          if (!props.checkStrictly) {
            var conductKeys = (0,_utils_conductUtil__WEBPACK_IMPORTED_MODULE_18__.conductCheck)(checkedKeys, true, keyEntities);
            checkedKeys = conductKeys.checkedKeys;
            halfCheckedKeys = conductKeys.halfCheckedKeys;
          }

          newState.checkedKeys = checkedKeys;
          newState.halfCheckedKeys = halfCheckedKeys;
        }
      } // ================= loadedKeys ==================


      if (needSync('loadedKeys')) {
        newState.loadedKeys = props.loadedKeys;
      }

      return newState;
    }
  }]);

  return Tree;
}(react__WEBPACK_IMPORTED_MODULE_9__.Component);

Tree.defaultProps = {
  prefixCls: 'rc-tree',
  showLine: false,
  showIcon: true,
  selectable: true,
  multiple: false,
  checkable: false,
  disabled: false,
  checkStrictly: false,
  draggable: false,
  defaultExpandParent: true,
  autoExpandParent: false,
  defaultExpandAll: false,
  defaultExpandedKeys: [],
  defaultCheckedKeys: [],
  defaultSelectedKeys: [],
  dropIndicatorRender: _DropIndicator__WEBPACK_IMPORTED_MODULE_19__.default,
  allowDrop: function allowDrop() {
    return true;
  }
};
Tree.TreeNode = _TreeNode__WEBPACK_IMPORTED_MODULE_17__.default;
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Tree);

/***/ }),

/***/ "./node_modules/rc-tree/es/TreeNode.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-tree/es/TreeNode.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "InternalTreeNode": () => (/* binding */ InternalTreeNode),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _contextTypes__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./contextTypes */ "./node_modules/rc-tree/es/contextTypes.js");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./util */ "./node_modules/rc-tree/es/util.js");
/* harmony import */ var _Indent__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Indent */ "./node_modules/rc-tree/es/Indent.js");
/* harmony import */ var _utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/treeUtil */ "./node_modules/rc-tree/es/utils/treeUtil.js");










 // @ts-ignore





var ICON_OPEN = 'open';
var ICON_CLOSE = 'close';
var defaultTitle = '---';

var InternalTreeNode = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_7__.default)(InternalTreeNode, _React$Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_8__.default)(InternalTreeNode);

  function InternalTreeNode() {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__.default)(this, InternalTreeNode);

    _this = _super.apply(this, arguments);
    _this.state = {
      dragNodeHighlight: false
    };

    _this.onSelectorClick = function (e) {
      // Click trigger before select/check operation
      var onNodeClick = _this.props.context.onNodeClick;
      onNodeClick(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));

      if (_this.isSelectable()) {
        _this.onSelect(e);
      } else {
        _this.onCheck(e);
      }
    };

    _this.onSelectorDoubleClick = function (e) {
      var onNodeDoubleClick = _this.props.context.onNodeDoubleClick;
      onNodeDoubleClick(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    };

    _this.onSelect = function (e) {
      if (_this.isDisabled()) return;
      var onNodeSelect = _this.props.context.onNodeSelect;
      e.preventDefault();
      onNodeSelect(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    };

    _this.onCheck = function (e) {
      if (_this.isDisabled()) return;
      var _this$props = _this.props,
          disableCheckbox = _this$props.disableCheckbox,
          checked = _this$props.checked;
      var onNodeCheck = _this.props.context.onNodeCheck;
      if (!_this.isCheckable() || disableCheckbox) return;
      e.preventDefault();
      var targetChecked = !checked;
      onNodeCheck(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props), targetChecked);
    };

    _this.onMouseEnter = function (e) {
      var onNodeMouseEnter = _this.props.context.onNodeMouseEnter;
      onNodeMouseEnter(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    };

    _this.onMouseLeave = function (e) {
      var onNodeMouseLeave = _this.props.context.onNodeMouseLeave;
      onNodeMouseLeave(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    };

    _this.onContextMenu = function (e) {
      var onNodeContextMenu = _this.props.context.onNodeContextMenu;
      onNodeContextMenu(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    };

    _this.onDragStart = function (e) {
      var onNodeDragStart = _this.props.context.onNodeDragStart;
      e.stopPropagation();

      _this.setState({
        dragNodeHighlight: true
      });

      onNodeDragStart(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));

      try {
        // ie throw error
        // firefox-need-it
        e.dataTransfer.setData('text/plain', '');
      } catch (error) {// empty
      }
    };

    _this.onDragEnter = function (e) {
      var onNodeDragEnter = _this.props.context.onNodeDragEnter;
      e.preventDefault();
      e.stopPropagation();
      onNodeDragEnter(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));
    };

    _this.onDragOver = function (e) {
      var onNodeDragOver = _this.props.context.onNodeDragOver;
      e.preventDefault();
      e.stopPropagation();
      onNodeDragOver(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));
    };

    _this.onDragLeave = function (e) {
      var onNodeDragLeave = _this.props.context.onNodeDragLeave;
      e.stopPropagation();
      onNodeDragLeave(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));
    };

    _this.onDragEnd = function (e) {
      var onNodeDragEnd = _this.props.context.onNodeDragEnd;
      e.stopPropagation();

      _this.setState({
        dragNodeHighlight: false
      });

      onNodeDragEnd(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));
    };

    _this.onDrop = function (e) {
      var onNodeDrop = _this.props.context.onNodeDrop;
      e.preventDefault();
      e.stopPropagation();

      _this.setState({
        dragNodeHighlight: false
      });

      onNodeDrop(e, (0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__.default)(_this));
    }; // Disabled item still can be switch


    _this.onExpand = function (e) {
      var _this$props2 = _this.props,
          loading = _this$props2.loading,
          onNodeExpand = _this$props2.context.onNodeExpand;
      if (loading) return;
      onNodeExpand(e, (0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
    }; // Drag usage


    _this.setSelectHandle = function (node) {
      _this.selectHandle = node;
    };

    _this.getNodeState = function () {
      var expanded = _this.props.expanded;

      if (_this.isLeaf()) {
        return null;
      }

      return expanded ? ICON_OPEN : ICON_CLOSE;
    };

    _this.hasChildren = function () {
      var eventKey = _this.props.eventKey;
      var keyEntities = _this.props.context.keyEntities;

      var _ref = keyEntities[eventKey] || {},
          children = _ref.children;

      return !!(children || []).length;
    };

    _this.isLeaf = function () {
      var _this$props3 = _this.props,
          isLeaf = _this$props3.isLeaf,
          loaded = _this$props3.loaded;
      var loadData = _this.props.context.loadData;

      var hasChildren = _this.hasChildren();

      if (isLeaf === false) {
        return false;
      }

      return isLeaf || !loadData && !hasChildren || loadData && loaded && !hasChildren;
    };

    _this.isDisabled = function () {
      var disabled = _this.props.disabled;
      var treeDisabled = _this.props.context.disabled;
      return !!(treeDisabled || disabled);
    };

    _this.isCheckable = function () {
      var checkable = _this.props.checkable;
      var treeCheckable = _this.props.context.checkable; // Return false if tree or treeNode is not checkable

      if (!treeCheckable || checkable === false) return false;
      return treeCheckable;
    }; // Load data to avoid default expanded tree without data


    _this.syncLoadData = function (props) {
      var expanded = props.expanded,
          loading = props.loading,
          loaded = props.loaded;
      var _this$props$context = _this.props.context,
          loadData = _this$props$context.loadData,
          onNodeLoad = _this$props$context.onNodeLoad;
      if (loading) return; // read from state to avoid loadData at same time

      if (loadData && expanded && !_this.isLeaf()) {
        // We needn't reload data when has children in sync logic
        // It's only needed in node expanded
        if (!_this.hasChildren() && !loaded) {
          onNodeLoad((0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(_this.props));
        }
      }
    };

    _this.renderSwitcherIconDom = function (isLeaf) {
      var switcherIconFromProps = _this.props.switcherIcon;
      var switcherIconFromCtx = _this.props.context.switcherIcon;
      var switcherIcon = switcherIconFromProps || switcherIconFromCtx; // if switcherIconDom is null, no render switcher span

      if (typeof switcherIcon === 'function') {
        return switcherIcon((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_3__.default)({}, _this.props), {}, {
          isLeaf: isLeaf
        }));
      }

      return switcherIcon;
    }; // Switcher


    _this.renderSwitcher = function () {
      var expanded = _this.props.expanded;
      var prefixCls = _this.props.context.prefixCls;

      if (_this.isLeaf()) {
        // if switcherIconDom is null, no render switcher span
        var _switcherIconDom = _this.renderSwitcherIconDom(true);

        return _switcherIconDom !== false ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
          className: classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(prefixCls, "-switcher"), "".concat(prefixCls, "-switcher-noop"))
        }, _switcherIconDom) : null;
      }

      var switcherCls = classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(prefixCls, "-switcher"), "".concat(prefixCls, "-switcher_").concat(expanded ? ICON_OPEN : ICON_CLOSE));

      var switcherIconDom = _this.renderSwitcherIconDom(false);

      return switcherIconDom !== false ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
        onClick: _this.onExpand,
        className: switcherCls
      }, switcherIconDom) : null;
    }; // Checkbox


    _this.renderCheckbox = function () {
      var _this$props4 = _this.props,
          checked = _this$props4.checked,
          halfChecked = _this$props4.halfChecked,
          disableCheckbox = _this$props4.disableCheckbox;
      var prefixCls = _this.props.context.prefixCls;

      var disabled = _this.isDisabled();

      var checkable = _this.isCheckable();

      if (!checkable) return null; // [Legacy] Custom element should be separate with `checkable` in future

      var $custom = typeof checkable !== 'boolean' ? checkable : null;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
        className: classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(prefixCls, "-checkbox"), checked && "".concat(prefixCls, "-checkbox-checked"), !checked && halfChecked && "".concat(prefixCls, "-checkbox-indeterminate"), (disabled || disableCheckbox) && "".concat(prefixCls, "-checkbox-disabled")),
        onClick: _this.onCheck
      }, $custom);
    };

    _this.renderIcon = function () {
      var loading = _this.props.loading;
      var prefixCls = _this.props.context.prefixCls;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
        className: classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(prefixCls, "-iconEle"), "".concat(prefixCls, "-icon__").concat(_this.getNodeState() || 'docu'), loading && "".concat(prefixCls, "-icon_loading"))
      });
    }; // Icon + Title


    _this.renderSelector = function () {
      var dragNodeHighlight = _this.state.dragNodeHighlight;
      var _this$props5 = _this.props,
          title = _this$props5.title,
          selected = _this$props5.selected,
          icon = _this$props5.icon,
          loading = _this$props5.loading,
          data = _this$props5.data;
      var _this$props$context2 = _this.props.context,
          prefixCls = _this$props$context2.prefixCls,
          showIcon = _this$props$context2.showIcon,
          treeIcon = _this$props$context2.icon,
          draggable = _this$props$context2.draggable,
          loadData = _this$props$context2.loadData,
          titleRender = _this$props$context2.titleRender;

      var disabled = _this.isDisabled();

      var mergedDraggable = typeof draggable === 'function' ? draggable(data) : draggable;
      var wrapClass = "".concat(prefixCls, "-node-content-wrapper"); // Icon - Still show loading icon when loading without showIcon

      var $icon;

      if (showIcon) {
        var currentIcon = icon || treeIcon;
        $icon = currentIcon ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
          className: classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(prefixCls, "-iconEle"), "".concat(prefixCls, "-icon__customize"))
        }, typeof currentIcon === 'function' ? currentIcon(_this.props) : currentIcon) : _this.renderIcon();
      } else if (loadData && loading) {
        $icon = _this.renderIcon();
      } // Title


      var titleNode;

      if (typeof title === 'function') {
        titleNode = title(data);
      } else if (titleRender) {
        titleNode = titleRender(data);
      } else {
        titleNode = title;
      }

      var $title = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
        className: "".concat(prefixCls, "-title")
      }, titleNode);
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("span", {
        ref: _this.setSelectHandle,
        title: typeof title === 'string' ? title : '',
        className: classnames__WEBPACK_IMPORTED_MODULE_10___default()("".concat(wrapClass), "".concat(wrapClass, "-").concat(_this.getNodeState() || 'normal'), !disabled && (selected || dragNodeHighlight) && "".concat(prefixCls, "-node-selected"), !disabled && mergedDraggable && 'draggable'),
        draggable: !disabled && mergedDraggable || undefined,
        "aria-grabbed": !disabled && mergedDraggable || undefined,
        onMouseEnter: _this.onMouseEnter,
        onMouseLeave: _this.onMouseLeave,
        onContextMenu: _this.onContextMenu,
        onClick: _this.onSelectorClick,
        onDoubleClick: _this.onSelectorDoubleClick,
        onDragStart: mergedDraggable ? _this.onDragStart : undefined
      }, $icon, $title, _this.renderDropIndicator());
    };

    _this.renderDropIndicator = function () {
      var _this$props6 = _this.props,
          disabled = _this$props6.disabled,
          eventKey = _this$props6.eventKey;
      var _this$props$context3 = _this.props.context,
          draggable = _this$props$context3.draggable,
          dropLevelOffset = _this$props$context3.dropLevelOffset,
          dropPosition = _this$props$context3.dropPosition,
          prefixCls = _this$props$context3.prefixCls,
          indent = _this$props$context3.indent,
          dropIndicatorRender = _this$props$context3.dropIndicatorRender,
          dragOverNodeKey = _this$props$context3.dragOverNodeKey,
          direction = _this$props$context3.direction;
      var mergedDraggable = draggable !== false; // allowDrop is calculated in Tree.tsx, there is no need for calc it here

      var showIndicator = !disabled && mergedDraggable && dragOverNodeKey === eventKey;
      return showIndicator ? dropIndicatorRender({
        dropPosition: dropPosition,
        dropLevelOffset: dropLevelOffset,
        indent: indent,
        prefixCls: prefixCls,
        direction: direction
      }) : null;
    };

    return _this;
  } // Isomorphic needn't load data in server side


  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__.default)(InternalTreeNode, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.syncLoadData(this.props);
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      this.syncLoadData(this.props);
    }
  }, {
    key: "isSelectable",
    value: function isSelectable() {
      var selectable = this.props.selectable;
      var treeSelectable = this.props.context.selectable; // Ignore when selectable is undefined or null

      if (typeof selectable === 'boolean') {
        return selectable;
      }

      return treeSelectable;
    }
  }, {
    key: "render",
    value: function render() {
      var _classNames;

      var _this$props7 = this.props,
          eventKey = _this$props7.eventKey,
          className = _this$props7.className,
          style = _this$props7.style,
          dragOver = _this$props7.dragOver,
          dragOverGapTop = _this$props7.dragOverGapTop,
          dragOverGapBottom = _this$props7.dragOverGapBottom,
          isLeaf = _this$props7.isLeaf,
          isStart = _this$props7.isStart,
          isEnd = _this$props7.isEnd,
          expanded = _this$props7.expanded,
          selected = _this$props7.selected,
          checked = _this$props7.checked,
          halfChecked = _this$props7.halfChecked,
          loading = _this$props7.loading,
          domRef = _this$props7.domRef,
          active = _this$props7.active,
          data = _this$props7.data,
          onMouseMove = _this$props7.onMouseMove,
          otherProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_this$props7, ["eventKey", "className", "style", "dragOver", "dragOverGapTop", "dragOverGapBottom", "isLeaf", "isStart", "isEnd", "expanded", "selected", "checked", "halfChecked", "loading", "domRef", "active", "data", "onMouseMove"]);

      var _this$props$context4 = this.props.context,
          prefixCls = _this$props$context4.prefixCls,
          filterTreeNode = _this$props$context4.filterTreeNode,
          draggable = _this$props$context4.draggable,
          keyEntities = _this$props$context4.keyEntities,
          dropContainerKey = _this$props$context4.dropContainerKey,
          dropTargetKey = _this$props$context4.dropTargetKey;
      var disabled = this.isDisabled();
      var dataOrAriaAttributeProps = (0,_util__WEBPACK_IMPORTED_MODULE_12__.getDataAndAria)(otherProps);

      var _ref2 = keyEntities[eventKey] || {},
          level = _ref2.level;

      var isEndNode = isEnd[isEnd.length - 1];
      var mergedDraggable = typeof draggable === 'function' ? draggable(data) : draggable;
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement("div", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
        ref: domRef,
        className: classnames__WEBPACK_IMPORTED_MODULE_10___default()(className, "".concat(prefixCls, "-treenode"), (_classNames = {}, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-disabled"), disabled), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-switcher-").concat(expanded ? 'open' : 'close'), !isLeaf), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-checkbox-checked"), checked), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-checkbox-indeterminate"), halfChecked), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-selected"), selected), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-loading"), loading), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-active"), active), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-treenode-leaf-last"), isEndNode), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'drop-target', dropTargetKey === eventKey), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'drop-container', dropContainerKey === eventKey), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'drag-over', !disabled && dragOver), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'drag-over-gap-top', !disabled && dragOverGapTop), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'drag-over-gap-bottom', !disabled && dragOverGapBottom), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, 'filter-node', filterTreeNode && filterTreeNode((0,_utils_treeUtil__WEBPACK_IMPORTED_MODULE_14__.convertNodePropsToEventData)(this.props))), _classNames)),
        style: style,
        onDragEnter: mergedDraggable ? this.onDragEnter : undefined,
        onDragOver: mergedDraggable ? this.onDragOver : undefined,
        onDragLeave: mergedDraggable ? this.onDragLeave : undefined,
        onDrop: mergedDraggable ? this.onDrop : undefined,
        onDragEnd: mergedDraggable ? this.onDragEnd : undefined,
        onMouseMove: onMouseMove
      }, dataOrAriaAttributeProps), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(_Indent__WEBPACK_IMPORTED_MODULE_13__.default, {
        prefixCls: prefixCls,
        level: level,
        isStart: isStart,
        isEnd: isEnd
      }), this.renderSwitcher(), this.renderCheckbox(), this.renderSelector());
    }
  }]);

  return InternalTreeNode;
}(react__WEBPACK_IMPORTED_MODULE_9__.Component);

var ContextTreeNode = function ContextTreeNode(props) {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(_contextTypes__WEBPACK_IMPORTED_MODULE_11__.TreeContext.Consumer, null, function (context) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_9__.createElement(InternalTreeNode, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, props, {
      context: context
    }));
  });
};

ContextTreeNode.displayName = 'TreeNode';
ContextTreeNode.defaultProps = {
  title: defaultTitle
};
ContextTreeNode.isTreeNode = 1;

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ContextTreeNode);

/***/ }),

/***/ "./node_modules/rc-tree/es/contextTypes.js":
/*!*************************************************!*\
  !*** ./node_modules/rc-tree/es/contextTypes.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TreeContext": () => (/* binding */ TreeContext)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/**
 * Webpack has bug for import loop, which is not the same behavior as ES module.
 * When util.js imports the TreeNode for tree generate will cause treeContextTypes be empty.
 */

var TreeContext = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);

/***/ }),

/***/ "./node_modules/rc-tree/es/index.js":
/*!******************************************!*\
  !*** ./node_modules/rc-tree/es/index.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TreeNode": () => (/* reexport safe */ _TreeNode__WEBPACK_IMPORTED_MODULE_1__.default),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Tree__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tree */ "./node_modules/rc-tree/es/Tree.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree/es/TreeNode.js");



/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_Tree__WEBPACK_IMPORTED_MODULE_0__.default);

/***/ }),

/***/ "./node_modules/rc-tree/es/util.js":
/*!*****************************************!*\
  !*** ./node_modules/rc-tree/es/util.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "arrDel": () => (/* binding */ arrDel),
/* harmony export */   "arrAdd": () => (/* binding */ arrAdd),
/* harmony export */   "posToArr": () => (/* binding */ posToArr),
/* harmony export */   "getPosition": () => (/* binding */ getPosition),
/* harmony export */   "isTreeNode": () => (/* binding */ isTreeNode),
/* harmony export */   "getDragChildrenKeys": () => (/* binding */ getDragChildrenKeys),
/* harmony export */   "isLastChild": () => (/* binding */ isLastChild),
/* harmony export */   "isFirstChild": () => (/* binding */ isFirstChild),
/* harmony export */   "calcDropPosition": () => (/* binding */ calcDropPosition),
/* harmony export */   "calcSelectedKeys": () => (/* binding */ calcSelectedKeys),
/* harmony export */   "convertDataToTree": () => (/* binding */ convertDataToTree),
/* harmony export */   "parseCheckedKeys": () => (/* binding */ parseCheckedKeys),
/* harmony export */   "conductExpandParent": () => (/* binding */ conductExpandParent),
/* harmony export */   "getDataAndAria": () => (/* binding */ getDataAndAria)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _TreeNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TreeNode */ "./node_modules/rc-tree/es/TreeNode.js");




/* eslint-disable no-lonely-if */

/**
 * Legacy code. Should avoid to use if you are new to import these code.
 */



function arrDel(list, value) {
  var clone = list.slice();
  var index = clone.indexOf(value);

  if (index >= 0) {
    clone.splice(index, 1);
  }

  return clone;
}
function arrAdd(list, value) {
  var clone = list.slice();

  if (clone.indexOf(value) === -1) {
    clone.push(value);
  }

  return clone;
}
function posToArr(pos) {
  return pos.split('-');
}
function getPosition(level, index) {
  return "".concat(level, "-").concat(index);
}
function isTreeNode(node) {
  return node && node.type && node.type.isTreeNode;
}
function getDragChildrenKeys(dragNodeKey, keyEntities) {
  // not contains self
  // self for left or right drag
  var dragChildrenKeys = [];
  var entity = keyEntities[dragNodeKey];

  function dig() {
    var list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    list.forEach(function (_ref) {
      var key = _ref.key,
          children = _ref.children;
      dragChildrenKeys.push(key);
      dig(children);
    });
  }

  dig(entity.children);
  return dragChildrenKeys;
}
function isLastChild(treeNodeEntity) {
  if (treeNodeEntity.parent) {
    var posArr = posToArr(treeNodeEntity.pos);
    return Number(posArr[posArr.length - 1]) === treeNodeEntity.parent.children.length - 1;
  }

  return false;
}
function isFirstChild(treeNodeEntity) {
  var posArr = posToArr(treeNodeEntity.pos);
  return Number(posArr[posArr.length - 1]) === 0;
} // Only used when drag, not affect SSR.

function calcDropPosition(event, dragNode, targetNode, indent, startMousePosition, allowDrop, flattenedNodes, keyEntities, expandKeys, direction) {
  var _abstractDropNodeEnti;

  var clientX = event.clientX,
      clientY = event.clientY;

  var _event$target$getBoun = event.target.getBoundingClientRect(),
      top = _event$target$getBoun.top,
      height = _event$target$getBoun.height; // optional chain for testing


  var horizontalMouseOffset = (direction === 'rtl' ? -1 : 1) * (((startMousePosition === null || startMousePosition === void 0 ? void 0 : startMousePosition.x) || 0) - clientX);
  var rawDropLevelOffset = (horizontalMouseOffset - 12) / indent; // find abstract drop node by horizontal offset

  var abstractDropNodeEntity = keyEntities[targetNode.props.eventKey];

  if (clientY < top + height / 2) {
    // first half, set abstract drop node to previous node
    var nodeIndex = flattenedNodes.findIndex(function (flattenedNode) {
      return flattenedNode.data.key === abstractDropNodeEntity.key;
    });
    var prevNodeIndex = nodeIndex <= 0 ? 0 : nodeIndex - 1;
    var prevNodeKey = flattenedNodes[prevNodeIndex].data.key;
    abstractDropNodeEntity = keyEntities[prevNodeKey];
  }

  var initialAbstractDropNodeKey = abstractDropNodeEntity.key;
  var abstractDragOverEntity = abstractDropNodeEntity;
  var dragOverNodeKey = abstractDropNodeEntity.key;
  var dropPosition = 0;
  var dropLevelOffset = 0; // Only allow cross level drop when dragging on a non-expanded node

  if (!expandKeys.includes(initialAbstractDropNodeKey)) {
    for (var i = 0; i < rawDropLevelOffset; i += 1) {
      if (isLastChild(abstractDropNodeEntity)) {
        abstractDropNodeEntity = abstractDropNodeEntity.parent;
        dropLevelOffset += 1;
      } else {
        break;
      }
    }
  }

  var abstractDropDataNode = abstractDropNodeEntity.node;
  var dropAllowed = true;

  if (isFirstChild(abstractDropNodeEntity) && abstractDropNodeEntity.level === 0 && clientY < top + height / 2 && allowDrop({
    dropNode: abstractDropDataNode,
    dropPosition: -1
  }) && abstractDropNodeEntity.key === targetNode.props.eventKey) {
    // first half of first node in first level
    dropPosition = -1;
  } else if ((abstractDragOverEntity.children || []).length && expandKeys.includes(dragOverNodeKey)) {
    // drop on expanded node
    // only allow drop inside
    if (allowDrop({
      dropNode: abstractDropDataNode,
      dropPosition: 0
    })) {
      dropPosition = 0;
    } else {
      dropAllowed = false;
    }
  } else if (dropLevelOffset === 0) {
    if (rawDropLevelOffset > -1.5) {
      // | Node     | <- abstractDropNode
      // | -^-===== | <- mousePosition
      // 1. try drop after
      // 2. do not allow drop
      if (allowDrop({
        dropNode: abstractDropDataNode,
        dropPosition: 1
      })) {
        dropPosition = 1;
      } else {
        dropAllowed = false;
      }
    } else {
      // | Node     | <- abstractDropNode
      // | ---==^== | <- mousePosition
      // whether it has children or doesn't has children
      // always
      // 1. try drop inside
      // 2. try drop after
      // 3. do not allow drop
      if (allowDrop({
        dropNode: abstractDropDataNode,
        dropPosition: 0
      })) {
        dropPosition = 0;
      } else if (allowDrop({
        dropNode: abstractDropDataNode,
        dropPosition: 1
      })) {
        dropPosition = 1;
      } else {
        dropAllowed = false;
      }
    }
  } else {
    // | Node1 | <- abstractDropNode
    //      |  Node2  |
    // --^--|----=====| <- mousePosition
    // 1. try insert after Node1
    // 2. do not allow drop
    if (allowDrop({
      dropNode: abstractDropDataNode,
      dropPosition: 1
    })) {
      dropPosition = 1;
    } else {
      dropAllowed = false;
    }
  }

  return {
    dropPosition: dropPosition,
    dropLevelOffset: dropLevelOffset,
    dropTargetKey: abstractDropNodeEntity.key,
    dropTargetPos: abstractDropNodeEntity.pos,
    dragOverNodeKey: dragOverNodeKey,
    dropContainerKey: dropPosition === 0 ? null : ((_abstractDropNodeEnti = abstractDropNodeEntity.parent) === null || _abstractDropNodeEnti === void 0 ? void 0 : _abstractDropNodeEnti.key) || null,
    dropAllowed: dropAllowed
  };
}
/**
 * Return selectedKeys according with multiple prop
 * @param selectedKeys
 * @param props
 * @returns [string]
 */

function calcSelectedKeys(selectedKeys, props) {
  if (!selectedKeys) return undefined;
  var multiple = props.multiple;

  if (multiple) {
    return selectedKeys.slice();
  }

  if (selectedKeys.length) {
    return [selectedKeys[0]];
  }

  return selectedKeys;
}

var internalProcessProps = function internalProcessProps(props) {
  return props;
};

function convertDataToTree(treeData, processor) {
  if (!treeData) return [];

  var _ref2 = processor || {},
      _ref2$processProps = _ref2.processProps,
      processProps = _ref2$processProps === void 0 ? internalProcessProps : _ref2$processProps;

  var list = Array.isArray(treeData) ? treeData : [treeData];
  return list.map(function (_ref3) {
    var children = _ref3.children,
        props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_ref3, ["children"]);

    var childrenNodes = convertDataToTree(children, processor);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(_TreeNode__WEBPACK_IMPORTED_MODULE_5__.default, processProps(props), childrenNodes);
  });
}
/**
 * Parse `checkedKeys` to { checkedKeys, halfCheckedKeys } style
 */

function parseCheckedKeys(keys) {
  if (!keys) {
    return null;
  } // Convert keys to object format


  var keyProps;

  if (Array.isArray(keys)) {
    // [Legacy] Follow the api doc
    keyProps = {
      checkedKeys: keys,
      halfCheckedKeys: undefined
    };
  } else if ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_1__.default)(keys) === 'object') {
    keyProps = {
      checkedKeys: keys.checked || undefined,
      halfCheckedKeys: keys.halfChecked || undefined
    };
  } else {
    (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_4__.default)(false, '`checkedKeys` is not an array or an object');
    return null;
  }

  return keyProps;
}
/**
 * If user use `autoExpandParent` we should get the list of parent node
 * @param keyList
 * @param keyEntities
 */

function conductExpandParent(keyList, keyEntities) {
  var expandedKeys = new Set();

  function conductUp(key) {
    if (expandedKeys.has(key)) return;
    var entity = keyEntities[key];
    if (!entity) return;
    expandedKeys.add(key);
    var parent = entity.parent,
        node = entity.node;
    if (node.disabled) return;

    if (parent) {
      conductUp(parent.key);
    }
  }

  (keyList || []).forEach(function (key) {
    conductUp(key);
  });
  return (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.default)(expandedKeys);
}
/**
 * Returns only the data- and aria- key/value pairs
 */

function getDataAndAria(props) {
  var omitProps = {};
  Object.keys(props).forEach(function (key) {
    if (key.startsWith('data-') || key.startsWith('aria-')) {
      omitProps[key] = props[key];
    }
  });
  return omitProps;
}

/***/ }),

/***/ "./node_modules/rc-tree/es/utils/conductUtil.js":
/*!******************************************************!*\
  !*** ./node_modules/rc-tree/es/utils/conductUtil.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isCheckDisabled": () => (/* binding */ isCheckDisabled),
/* harmony export */   "conductCheck": () => (/* binding */ conductCheck)
/* harmony export */ });
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");


function removeFromCheckedKeys(halfCheckedKeys, checkedKeys) {
  var filteredKeys = new Set();
  halfCheckedKeys.forEach(function (key) {
    if (!checkedKeys.has(key)) {
      filteredKeys.add(key);
    }
  });
  return filteredKeys;
}

function isCheckDisabled(node) {
  var _ref = node || {},
      disabled = _ref.disabled,
      disableCheckbox = _ref.disableCheckbox,
      checkable = _ref.checkable;

  return !!(disabled || disableCheckbox) || checkable === false;
} // Fill miss keys

function fillConductCheck(keys, levelEntities, maxLevel, syntheticGetCheckDisabled) {
  var checkedKeys = new Set(keys);
  var halfCheckedKeys = new Set(); // Add checked keys top to bottom

  for (var level = 0; level <= maxLevel; level += 1) {
    var entities = levelEntities.get(level) || new Set();
    entities.forEach(function (entity) {
      var key = entity.key,
          node = entity.node,
          _entity$children = entity.children,
          children = _entity$children === void 0 ? [] : _entity$children;

      if (checkedKeys.has(key) && !syntheticGetCheckDisabled(node)) {
        children.filter(function (childEntity) {
          return !syntheticGetCheckDisabled(childEntity.node);
        }).forEach(function (childEntity) {
          checkedKeys.add(childEntity.key);
        });
      }
    });
  } // Add checked keys from bottom to top


  var visitedKeys = new Set();

  for (var _level = maxLevel; _level >= 0; _level -= 1) {
    var _entities = levelEntities.get(_level) || new Set();

    _entities.forEach(function (entity) {
      var parent = entity.parent,
          node = entity.node; // Skip if no need to check

      if (syntheticGetCheckDisabled(node) || !entity.parent || visitedKeys.has(entity.parent.key)) {
        return;
      } // Skip if parent is disabled


      if (syntheticGetCheckDisabled(entity.parent.node)) {
        visitedKeys.add(parent.key);
        return;
      }

      var allChecked = true;
      var partialChecked = false;
      (parent.children || []).filter(function (childEntity) {
        return !syntheticGetCheckDisabled(childEntity.node);
      }).forEach(function (_ref2) {
        var key = _ref2.key;
        var checked = checkedKeys.has(key);

        if (allChecked && !checked) {
          allChecked = false;
        }

        if (!partialChecked && (checked || halfCheckedKeys.has(key))) {
          partialChecked = true;
        }
      });

      if (allChecked) {
        checkedKeys.add(parent.key);
      }

      if (partialChecked) {
        halfCheckedKeys.add(parent.key);
      }

      visitedKeys.add(parent.key);
    });
  }

  return {
    checkedKeys: Array.from(checkedKeys),
    halfCheckedKeys: Array.from(removeFromCheckedKeys(halfCheckedKeys, checkedKeys))
  };
} // Remove useless key


function cleanConductCheck(keys, halfKeys, levelEntities, maxLevel, syntheticGetCheckDisabled) {
  var checkedKeys = new Set(keys);
  var halfCheckedKeys = new Set(halfKeys); // Remove checked keys from top to bottom

  for (var level = 0; level <= maxLevel; level += 1) {
    var entities = levelEntities.get(level) || new Set();
    entities.forEach(function (entity) {
      var key = entity.key,
          node = entity.node,
          _entity$children2 = entity.children,
          children = _entity$children2 === void 0 ? [] : _entity$children2;

      if (!checkedKeys.has(key) && !halfCheckedKeys.has(key) && !syntheticGetCheckDisabled(node)) {
        children.filter(function (childEntity) {
          return !syntheticGetCheckDisabled(childEntity.node);
        }).forEach(function (childEntity) {
          checkedKeys.delete(childEntity.key);
        });
      }
    });
  } // Remove checked keys form bottom to top


  halfCheckedKeys = new Set();
  var visitedKeys = new Set();

  for (var _level2 = maxLevel; _level2 >= 0; _level2 -= 1) {
    var _entities2 = levelEntities.get(_level2) || new Set();

    _entities2.forEach(function (entity) {
      var parent = entity.parent,
          node = entity.node; // Skip if no need to check

      if (syntheticGetCheckDisabled(node) || !entity.parent || visitedKeys.has(entity.parent.key)) {
        return;
      } // Skip if parent is disabled


      if (syntheticGetCheckDisabled(entity.parent.node)) {
        visitedKeys.add(parent.key);
        return;
      }

      var allChecked = true;
      var partialChecked = false;
      (parent.children || []).filter(function (childEntity) {
        return !syntheticGetCheckDisabled(childEntity.node);
      }).forEach(function (_ref3) {
        var key = _ref3.key;
        var checked = checkedKeys.has(key);

        if (allChecked && !checked) {
          allChecked = false;
        }

        if (!partialChecked && (checked || halfCheckedKeys.has(key))) {
          partialChecked = true;
        }
      });

      if (!allChecked) {
        checkedKeys.delete(parent.key);
      }

      if (partialChecked) {
        halfCheckedKeys.add(parent.key);
      }

      visitedKeys.add(parent.key);
    });
  }

  return {
    checkedKeys: Array.from(checkedKeys),
    halfCheckedKeys: Array.from(removeFromCheckedKeys(halfCheckedKeys, checkedKeys))
  };
}
/**
 * Conduct with keys.
 * @param keyList current key list
 * @param keyEntities key - dataEntity map
 * @param mode `fill` to fill missing key, `clean` to remove useless key
 */


function conductCheck(keyList, checked, keyEntities, getCheckDisabled) {
  var warningMissKeys = [];
  var syntheticGetCheckDisabled;

  if (getCheckDisabled) {
    syntheticGetCheckDisabled = getCheckDisabled;
  } else {
    syntheticGetCheckDisabled = isCheckDisabled;
  } // We only handle exist keys


  var keys = new Set(keyList.filter(function (key) {
    var hasEntity = !!keyEntities[key];

    if (!hasEntity) {
      warningMissKeys.push(key);
    }

    return hasEntity;
  }));
  var levelEntities = new Map();
  var maxLevel = 0; // Convert entities by level for calculation

  Object.keys(keyEntities).forEach(function (key) {
    var entity = keyEntities[key];
    var level = entity.level;
    var levelSet = levelEntities.get(level);

    if (!levelSet) {
      levelSet = new Set();
      levelEntities.set(level, levelSet);
    }

    levelSet.add(entity);
    maxLevel = Math.max(maxLevel, level);
  });
  (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_0__.default)(!warningMissKeys.length, "Tree missing follow keys: ".concat(warningMissKeys.slice(0, 100).map(function (key) {
    return "'".concat(key, "'");
  }).join(', ')));
  var result;

  if (checked === true) {
    result = fillConductCheck(keys, levelEntities, maxLevel, syntheticGetCheckDisabled);
  } else {
    result = cleanConductCheck(keys, checked.halfCheckedKeys, levelEntities, maxLevel, syntheticGetCheckDisabled);
  }

  return result;
}

/***/ }),

/***/ "./node_modules/rc-tree/es/utils/diffUtil.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-tree/es/utils/diffUtil.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "findExpandedKeys": () => (/* binding */ findExpandedKeys),
/* harmony export */   "getExpandRange": () => (/* binding */ getExpandRange)
/* harmony export */ });
function findExpandedKeys() {
  var prev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var next = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var prevLen = prev.length;
  var nextLen = next.length;

  if (Math.abs(prevLen - nextLen) !== 1) {
    return {
      add: false,
      key: null
    };
  }

  function find(shorter, longer) {
    var cache = new Map();
    shorter.forEach(function (key) {
      cache.set(key, true);
    });
    var keys = longer.filter(function (key) {
      return !cache.has(key);
    });
    return keys.length === 1 ? keys[0] : null;
  }

  if (prevLen < nextLen) {
    return {
      add: true,
      key: find(prev, next)
    };
  }

  return {
    add: false,
    key: find(next, prev)
  };
}
function getExpandRange(shorter, longer, key) {
  var shorterStartIndex = shorter.findIndex(function (_ref) {
    var data = _ref.data;
    return data.key === key;
  });
  var shorterEndNode = shorter[shorterStartIndex + 1];
  var longerStartIndex = longer.findIndex(function (_ref2) {
    var data = _ref2.data;
    return data.key === key;
  });

  if (shorterEndNode) {
    var longerEndIndex = longer.findIndex(function (_ref3) {
      var data = _ref3.data;
      return data.key === shorterEndNode.data.key;
    });
    return longer.slice(longerStartIndex + 1, longerEndIndex);
  }

  return longer.slice(longerStartIndex + 1);
}

/***/ }),

/***/ "./node_modules/rc-tree/es/utils/treeUtil.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-tree/es/utils/treeUtil.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getKey": () => (/* binding */ getKey),
/* harmony export */   "warningWithoutKey": () => (/* binding */ warningWithoutKey),
/* harmony export */   "convertTreeToData": () => (/* binding */ convertTreeToData),
/* harmony export */   "flattenTreeData": () => (/* binding */ flattenTreeData),
/* harmony export */   "traverseDataNodes": () => (/* binding */ traverseDataNodes),
/* harmony export */   "convertDataToEntities": () => (/* binding */ convertDataToEntities),
/* harmony export */   "getTreeNodeProps": () => (/* binding */ getTreeNodeProps),
/* harmony export */   "convertNodePropsToEventData": () => (/* binding */ convertNodePropsToEventData)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var rc_util_es_Children_toArray__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-util/es/Children/toArray */ "./node_modules/rc-util/es/Children/toArray.js");
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../util */ "./node_modules/rc-tree/es/util.js");







function getKey(key, pos) {
  if (key !== null && key !== undefined) {
    return key;
  }

  return pos;
}
/**
 * Warning if TreeNode do not provides key
 */

function warningWithoutKey() {
  var treeData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var keys = new Map();

  function dig(list) {
    var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
    (list || []).forEach(function (treeNode) {
      var key = treeNode.key,
          children = treeNode.children;
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_5__.default)(key !== null && key !== undefined, "Tree node must have a certain key: [".concat(path).concat(key, "]"));
      var recordKey = String(key);
      (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_5__.default)(!keys.has(recordKey) || key === null || key === undefined, "Same 'key' exist in the Tree: ".concat(recordKey));
      keys.set(recordKey, true);
      dig(children, "".concat(path).concat(recordKey, " > "));
    });
  }

  dig(treeData);
}
/**
 * Convert `children` of Tree into `treeData` structure.
 */

function convertTreeToData(rootNodes) {
  function dig(node) {
    var treeNodes = (0,rc_util_es_Children_toArray__WEBPACK_IMPORTED_MODULE_4__.default)(node);
    return treeNodes.map(function (treeNode) {
      // Filter invalidate node
      if (!(0,_util__WEBPACK_IMPORTED_MODULE_6__.isTreeNode)(treeNode)) {
        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_5__.default)(!treeNode, 'Tree/TreeNode can only accept TreeNode as children.');
        return null;
      }

      var key = treeNode.key;

      var _treeNode$props = treeNode.props,
          children = _treeNode$props.children,
          rest = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__.default)(_treeNode$props, ["children"]);

      var dataNode = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({
        key: key
      }, rest);

      var parsedChildren = dig(children);

      if (parsedChildren.length) {
        dataNode.children = parsedChildren;
      }

      return dataNode;
    }).filter(function (dataNode) {
      return dataNode;
    });
  }

  return dig(rootNodes);
}
/**
 * Flat nest tree data into flatten list. This is used for virtual list render.
 * @param treeNodeList Origin data node list
 * @param expandedKeys
 * need expanded keys, provides `true` means all expanded (used in `rc-tree-select`).
 */

function flattenTreeData() {
  var treeNodeList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var expandedKeys = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
  var expandedKeySet = new Set(expandedKeys === true ? [] : expandedKeys);
  var flattenList = [];

  function dig(list) {
    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    return list.map(function (treeNode, index) {
      var pos = (0,_util__WEBPACK_IMPORTED_MODULE_6__.getPosition)(parent ? parent.pos : '0', index);
      var mergedKey = getKey(treeNode.key, pos); // Add FlattenDataNode into list

      var flattenNode = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, treeNode), {}, {
        parent: parent,
        pos: pos,
        children: null,
        data: treeNode,
        isStart: [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.default)(parent ? parent.isStart : []), [index === 0]),
        isEnd: [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.default)(parent ? parent.isEnd : []), [index === list.length - 1])
      });

      flattenList.push(flattenNode); // Loop treeNode children

      if (expandedKeys === true || expandedKeySet.has(mergedKey)) {
        flattenNode.children = dig(treeNode.children || [], flattenNode);
      } else {
        flattenNode.children = [];
      }

      return flattenNode;
    });
  }

  dig(treeNodeList);
  return flattenList;
}
/**
 * Traverse all the data by `treeData`.
 * Please not use it out of the `rc-tree` since we may refactor this code.
 */

function traverseDataNodes(dataNodes, callback, // To avoid too many params, let use config instead of origin param
config) {
  // Init config
  var externalGetKey = null;
  var childrenPropName;

  var configType = (0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__.default)(config);

  if (configType === 'function' || configType === 'string') {
    // Legacy getKey param
    externalGetKey = config;
  } else if (config && configType === 'object') {
    childrenPropName = config.childrenPropName;
    externalGetKey = config.externalGetKey;
  }

  childrenPropName = childrenPropName || 'children'; // Get keys

  var syntheticGetKey;

  if (externalGetKey) {
    if (typeof externalGetKey === 'string') {
      syntheticGetKey = function syntheticGetKey(node) {
        return node[externalGetKey];
      };
    } else if (typeof externalGetKey === 'function') {
      syntheticGetKey = function syntheticGetKey(node) {
        return externalGetKey(node);
      };
    }
  } else {
    syntheticGetKey = function syntheticGetKey(node, pos) {
      return getKey(node.key, pos);
    };
  } // Process


  function processNode(node, index, parent) {
    var children = node ? node[childrenPropName] : dataNodes;
    var pos = node ? (0,_util__WEBPACK_IMPORTED_MODULE_6__.getPosition)(parent.pos, index) : '0'; // Process node if is not root

    if (node) {
      var key = syntheticGetKey(node, pos);
      var data = {
        node: node,
        index: index,
        pos: pos,
        key: key,
        parentPos: parent.node ? parent.pos : null,
        level: parent.level + 1
      };
      callback(data);
    } // Process children node


    if (children) {
      children.forEach(function (subNode, subIndex) {
        processNode(subNode, subIndex, {
          node: node,
          pos: pos,
          level: parent ? parent.level + 1 : -1
        });
      });
    }
  }

  processNode(null);
}
/**
 * Convert `treeData` into entity records.
 */

function convertDataToEntities(dataNodes) {
  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      initWrapper = _ref.initWrapper,
      processEntity = _ref.processEntity,
      onProcessFinished = _ref.onProcessFinished,
      externalGetKey = _ref.externalGetKey,
      childrenPropName = _ref.childrenPropName;

  var
  /** @deprecated Use `config.externalGetKey` instead */
  legacyExternalGetKey = arguments.length > 2 ? arguments[2] : undefined;
  // Init config
  var mergedExternalGetKey = externalGetKey || legacyExternalGetKey;
  var posEntities = {};
  var keyEntities = {};
  var wrapper = {
    posEntities: posEntities,
    keyEntities: keyEntities
  };

  if (initWrapper) {
    wrapper = initWrapper(wrapper) || wrapper;
  }

  traverseDataNodes(dataNodes, function (item) {
    var node = item.node,
        index = item.index,
        pos = item.pos,
        key = item.key,
        parentPos = item.parentPos,
        level = item.level;
    var entity = {
      node: node,
      index: index,
      key: key,
      pos: pos,
      level: level
    };
    var mergedKey = getKey(key, pos);
    posEntities[pos] = entity;
    keyEntities[mergedKey] = entity; // Fill children

    entity.parent = posEntities[parentPos];

    if (entity.parent) {
      entity.parent.children = entity.parent.children || [];
      entity.parent.children.push(entity);
    }

    if (processEntity) {
      processEntity(entity, wrapper);
    }
  }, {
    externalGetKey: mergedExternalGetKey,
    childrenPropName: childrenPropName
  });

  if (onProcessFinished) {
    onProcessFinished(wrapper);
  }

  return wrapper;
}
/**
 * Get TreeNode props with Tree props.
 */

function getTreeNodeProps(key, _ref2) {
  var expandedKeys = _ref2.expandedKeys,
      selectedKeys = _ref2.selectedKeys,
      loadedKeys = _ref2.loadedKeys,
      loadingKeys = _ref2.loadingKeys,
      checkedKeys = _ref2.checkedKeys,
      halfCheckedKeys = _ref2.halfCheckedKeys,
      dragOverNodeKey = _ref2.dragOverNodeKey,
      dropPosition = _ref2.dropPosition,
      keyEntities = _ref2.keyEntities;
  var entity = keyEntities[key];
  var treeNodeProps = {
    eventKey: key,
    expanded: expandedKeys.indexOf(key) !== -1,
    selected: selectedKeys.indexOf(key) !== -1,
    loaded: loadedKeys.indexOf(key) !== -1,
    loading: loadingKeys.indexOf(key) !== -1,
    checked: checkedKeys.indexOf(key) !== -1,
    halfChecked: halfCheckedKeys.indexOf(key) !== -1,
    pos: String(entity ? entity.pos : ''),
    // [Legacy] Drag props
    // Since the interaction of drag is changed, the semantic of the props are
    // not accuracy, I think it should be finally removed
    dragOver: dragOverNodeKey === key && dropPosition === 0,
    dragOverGapTop: dragOverNodeKey === key && dropPosition === -1,
    dragOverGapBottom: dragOverNodeKey === key && dropPosition === 1
  };
  return treeNodeProps;
}
function convertNodePropsToEventData(props) {
  var data = props.data,
      expanded = props.expanded,
      selected = props.selected,
      checked = props.checked,
      loaded = props.loaded,
      loading = props.loading,
      halfChecked = props.halfChecked,
      dragOver = props.dragOver,
      dragOverGapTop = props.dragOverGapTop,
      dragOverGapBottom = props.dragOverGapBottom,
      pos = props.pos,
      active = props.active;

  var eventData = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__.default)({}, data), {}, {
    expanded: expanded,
    selected: selected,
    checked: checked,
    loaded: loaded,
    loading: loading,
    halfChecked: halfChecked,
    dragOver: dragOver,
    dragOverGapTop: dragOverGapTop,
    dragOverGapBottom: dragOverGapBottom,
    pos: pos,
    active: active
  });

  if (!('props' in eventData)) {
    Object.defineProperty(eventData, 'props', {
      get: function get() {
        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_5__.default)(false, 'Second param return from event is node data instead of TreeNode instance. Please read value directly instead of reading from `props`.');
        return props;
      }
    });
  }

  return eventData;
}

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/Mask.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/Mask.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Mask)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var rc_motion__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-motion */ "./node_modules/rc-motion/es/index.js");
/* harmony import */ var _utils_legacyUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/legacyUtil */ "./node_modules/rc-trigger/es/utils/legacyUtil.js");






function Mask(props) {
  var prefixCls = props.prefixCls,
      visible = props.visible,
      zIndex = props.zIndex,
      mask = props.mask,
      maskMotion = props.maskMotion,
      maskAnimation = props.maskAnimation,
      maskTransitionName = props.maskTransitionName;

  if (!mask) {
    return null;
  }

  var motion = {};

  if (maskMotion || maskTransitionName || maskAnimation) {
    motion = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({
      motionAppear: true
    }, (0,_utils_legacyUtil__WEBPACK_IMPORTED_MODULE_5__.getMotion)({
      motion: maskMotion,
      prefixCls: prefixCls,
      transitionName: maskTransitionName,
      animation: maskAnimation
    }));
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(rc_motion__WEBPACK_IMPORTED_MODULE_4__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, motion, {
    visible: visible,
    removeOnLeave: true
  }), function (_ref) {
    var className = _ref.className;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      style: {
        zIndex: zIndex
      },
      className: classnames__WEBPACK_IMPORTED_MODULE_3___default()("".concat(prefixCls, "-mask"), className)
    });
  });
}

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/MobilePopupInner.js":
/*!**************************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/MobilePopupInner.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_motion__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rc-motion */ "./node_modules/rc-motion/es/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);





var MobilePopupInner = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.forwardRef(function (props, ref) {
  var prefixCls = props.prefixCls,
      visible = props.visible,
      zIndex = props.zIndex,
      children = props.children,
      _props$mobile = props.mobile;
  _props$mobile = _props$mobile === void 0 ? {} : _props$mobile;
  var popupClassName = _props$mobile.popupClassName,
      popupStyle = _props$mobile.popupStyle,
      _props$mobile$popupMo = _props$mobile.popupMotion,
      popupMotion = _props$mobile$popupMo === void 0 ? {} : _props$mobile$popupMo,
      popupRender = _props$mobile.popupRender;
  var elementRef = react__WEBPACK_IMPORTED_MODULE_2__.useRef(); // ========================= Refs =========================

  react__WEBPACK_IMPORTED_MODULE_2__.useImperativeHandle(ref, function () {
    return {
      forceAlign: function forceAlign() {},
      getElement: function getElement() {
        return elementRef.current;
      }
    };
  }); // ======================== Render ========================

  var mergedStyle = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({
    zIndex: zIndex
  }, popupStyle);

  var childNode = children; // Wrapper when multiple children

  if (react__WEBPACK_IMPORTED_MODULE_2__.Children.count(children) > 1) {
    childNode = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      className: "".concat(prefixCls, "-content")
    }, children);
  } // Mobile support additional render


  if (popupRender) {
    childNode = popupRender(childNode);
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement(rc_motion__WEBPACK_IMPORTED_MODULE_3__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
    visible: visible,
    ref: elementRef,
    removeOnLeave: true
  }, popupMotion), function (_ref, motionRef) {
    var motionClassName = _ref.className,
        motionStyle = _ref.style;
    var mergedClassName = classnames__WEBPACK_IMPORTED_MODULE_4___default()(prefixCls, popupClassName, motionClassName);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2__.createElement("div", {
      ref: motionRef,
      className: mergedClassName,
      style: (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, motionStyle), mergedStyle)
    }, childNode);
  });
});
MobilePopupInner.displayName = 'MobilePopupInner';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MobilePopupInner);

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/PopupInner.js":
/*!********************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/PopupInner.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_align__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-align */ "./node_modules/rc-align/es/index.js");
/* harmony import */ var rc_motion__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-motion */ "./node_modules/rc-motion/es/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _useVisibleStatus__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./useVisibleStatus */ "./node_modules/rc-trigger/es/Popup/useVisibleStatus.js");
/* harmony import */ var _utils_legacyUtil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/legacyUtil */ "./node_modules/rc-trigger/es/utils/legacyUtil.js");
/* harmony import */ var _useStretchStyle__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./useStretchStyle */ "./node_modules/rc-trigger/es/Popup/useStretchStyle.js");











var PopupInner = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.forwardRef(function (props, ref) {
  var visible = props.visible,
      prefixCls = props.prefixCls,
      className = props.className,
      style = props.style,
      children = props.children,
      zIndex = props.zIndex,
      stretch = props.stretch,
      destroyPopupOnHide = props.destroyPopupOnHide,
      forceRender = props.forceRender,
      align = props.align,
      point = props.point,
      getRootDomNode = props.getRootDomNode,
      getClassNameFromAlign = props.getClassNameFromAlign,
      onAlign = props.onAlign,
      onMouseEnter = props.onMouseEnter,
      onMouseLeave = props.onMouseLeave,
      onMouseDown = props.onMouseDown,
      onTouchStart = props.onTouchStart;
  var alignRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)();
  var elementRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)();

  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(),
      _useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useState, 2),
      alignedClassName = _useState2[0],
      setAlignedClassName = _useState2[1]; // ======================= Measure ========================


  var _useStretchStyle = (0,_useStretchStyle__WEBPACK_IMPORTED_MODULE_9__.default)(stretch),
      _useStretchStyle2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useStretchStyle, 2),
      stretchStyle = _useStretchStyle2[0],
      measureStretchStyle = _useStretchStyle2[1];

  function doMeasure() {
    if (stretch) {
      measureStretchStyle(getRootDomNode());
    }
  } // ======================== Status ========================


  var _useVisibleStatus = (0,_useVisibleStatus__WEBPACK_IMPORTED_MODULE_7__.default)(visible, doMeasure),
      _useVisibleStatus2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useVisibleStatus, 2),
      status = _useVisibleStatus2[0],
      goNextStatus = _useVisibleStatus2[1]; // ======================== Aligns ========================


  var prepareResolveRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(); // `target` on `rc-align` can accept as a function to get the bind element or a point.
  // ref: https://www.npmjs.com/package/rc-align

  function getAlignTarget() {
    if (point) {
      return point;
    }

    return getRootDomNode;
  }

  function forceAlign() {
    var _alignRef$current;

    (_alignRef$current = alignRef.current) === null || _alignRef$current === void 0 ? void 0 : _alignRef$current.forceAlign();
  }

  function onInternalAlign(popupDomNode, matchAlign) {
    if (status === 'align') {
      var nextAlignedClassName = getClassNameFromAlign(matchAlign);
      setAlignedClassName(nextAlignedClassName); // Repeat until not more align needed

      if (alignedClassName !== nextAlignedClassName) {
        Promise.resolve().then(function () {
          forceAlign();
        });
      } else {
        goNextStatus(function () {
          var _prepareResolveRef$cu;

          (_prepareResolveRef$cu = prepareResolveRef.current) === null || _prepareResolveRef$cu === void 0 ? void 0 : _prepareResolveRef$cu.call(prepareResolveRef);
        });
      }

      onAlign === null || onAlign === void 0 ? void 0 : onAlign(popupDomNode, matchAlign);
    }
  } // ======================== Motion ========================


  var motion = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, (0,_utils_legacyUtil__WEBPACK_IMPORTED_MODULE_8__.getMotion)(props));

  ['onAppearEnd', 'onEnterEnd', 'onLeaveEnd'].forEach(function (eventName) {
    var originHandler = motion[eventName];

    motion[eventName] = function (element, event) {
      goNextStatus();
      return originHandler === null || originHandler === void 0 ? void 0 : originHandler(element, event);
    };
  });

  function onShowPrepare() {
    return new Promise(function (resolve) {
      prepareResolveRef.current = resolve;
    });
  } // Go to stable directly when motion not provided


  react__WEBPACK_IMPORTED_MODULE_3__.useEffect(function () {
    if (!motion.motionName && status === 'motion') {
      goNextStatus();
    }
  }, [motion.motionName, status]); // ========================= Refs =========================

  react__WEBPACK_IMPORTED_MODULE_3__.useImperativeHandle(ref, function () {
    return {
      forceAlign: forceAlign,
      getElement: function getElement() {
        return elementRef.current;
      }
    };
  }); // ======================== Render ========================

  var mergedStyle = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, stretchStyle), {}, {
    zIndex: zIndex,
    opacity: status === 'motion' || status === 'stable' || !visible ? undefined : 0,
    pointerEvents: status === 'stable' ? undefined : 'none'
  }, style); // Align status


  var alignDisabled = true;

  if ((align === null || align === void 0 ? void 0 : align.points) && (status === 'align' || status === 'stable')) {
    alignDisabled = false;
  }

  var childNode = children; // Wrapper when multiple children

  if (react__WEBPACK_IMPORTED_MODULE_3__.Children.count(children) > 1) {
    childNode = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      className: "".concat(prefixCls, "-content")
    }, children);
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(rc_motion__WEBPACK_IMPORTED_MODULE_5__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({
    visible: visible,
    ref: elementRef,
    leavedClassName: "".concat(prefixCls, "-hidden")
  }, motion, {
    onAppearPrepare: onShowPrepare,
    onEnterPrepare: onShowPrepare,
    removeOnLeave: destroyPopupOnHide,
    forceRender: forceRender
  }), function (_ref, motionRef) {
    var motionClassName = _ref.className,
        motionStyle = _ref.style;
    var mergedClassName = classnames__WEBPACK_IMPORTED_MODULE_6___default()(prefixCls, className, alignedClassName, motionClassName);
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement(rc_align__WEBPACK_IMPORTED_MODULE_4__.default, {
      target: getAlignTarget(),
      key: "popup",
      ref: alignRef,
      monitorWindowResize: true,
      disabled: alignDisabled,
      align: align,
      onAlign: onInternalAlign
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3__.createElement("div", {
      ref: motionRef,
      className: mergedClassName,
      onMouseEnter: onMouseEnter,
      onMouseLeave: onMouseLeave,
      onMouseDownCapture: onMouseDown,
      onTouchStartCapture: onTouchStart,
      style: (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, motionStyle), mergedStyle)
    }, childNode));
  });
});
PopupInner.displayName = 'PopupInner';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PopupInner);

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/index.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/index.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_isMobile__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rc-util/es/isMobile */ "./node_modules/rc-util/es/isMobile.js");
/* harmony import */ var _Mask__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Mask */ "./node_modules/rc-trigger/es/Popup/Mask.js");
/* harmony import */ var _PopupInner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./PopupInner */ "./node_modules/rc-trigger/es/Popup/PopupInner.js");
/* harmony import */ var _MobilePopupInner__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./MobilePopupInner */ "./node_modules/rc-trigger/es/Popup/MobilePopupInner.js");










var Popup = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.forwardRef(function (_ref, ref) {
  var visible = _ref.visible,
      mobile = _ref.mobile,
      props = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_3__.default)(_ref, ["visible", "mobile"]);

  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(visible),
      _useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useState, 2),
      innerVisible = _useState2[0],
      serInnerVisible = _useState2[1];

  var _useState3 = (0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(false),
      _useState4 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useState3, 2),
      inMobile = _useState4[0],
      setInMobile = _useState4[1];

  var cloneProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__.default)({}, props), {}, {
    visible: innerVisible
  }); // We check mobile in visible changed here.
  // And this also delay set `innerVisible` to avoid popup component render flash


  (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function () {
    serInnerVisible(visible);

    if (visible && mobile) {
      setInMobile((0,rc_util_es_isMobile__WEBPACK_IMPORTED_MODULE_5__.default)());
    }
  }, [visible, mobile]);
  var popupNode = inMobile ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement(_MobilePopupInner__WEBPACK_IMPORTED_MODULE_8__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, cloneProps, {
    mobile: mobile,
    ref: ref
  })) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement(_PopupInner__WEBPACK_IMPORTED_MODULE_7__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, cloneProps, {
    ref: ref
  })); // We can use fragment directly but this may failed some selector usage. Keep as origin logic

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_4__.createElement(_Mask__WEBPACK_IMPORTED_MODULE_6__.default, cloneProps), popupNode);
});
Popup.displayName = 'Popup';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Popup);

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/useStretchStyle.js":
/*!*************************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/useStretchStyle.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (stretch) {
  var _React$useState = react__WEBPACK_IMPORTED_MODULE_1__.useState({
    width: 0,
    height: 0
  }),
      _React$useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.default)(_React$useState, 2),
      targetSize = _React$useState2[0],
      setTargetSize = _React$useState2[1];

  function measureStretch(element) {
    setTargetSize({
      width: element.offsetWidth,
      height: element.offsetHeight
    });
  } // Merge stretch style


  var style = react__WEBPACK_IMPORTED_MODULE_1__.useMemo(function () {
    var sizeStyle = {};

    if (stretch) {
      var width = targetSize.width,
          height = targetSize.height; // Stretch with target

      if (stretch.indexOf('height') !== -1 && height) {
        sizeStyle.height = height;
      } else if (stretch.indexOf('minHeight') !== -1 && height) {
        sizeStyle.minHeight = height;
      }

      if (stretch.indexOf('width') !== -1 && width) {
        sizeStyle.width = width;
      } else if (stretch.indexOf('minWidth') !== -1 && width) {
        sizeStyle.minWidth = width;
      }
    }

    return sizeStyle;
  }, [stretch, targetSize]);
  return [style, measureStretch];
});

/***/ }),

/***/ "./node_modules/rc-trigger/es/Popup/useVisibleStatus.js":
/*!**************************************************************!*\
  !*** ./node_modules/rc-trigger/es/Popup/useVisibleStatus.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js");
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var rc_util_es_raf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rc-util/es/raf */ "./node_modules/rc-util/es/raf.js");





var StatusQueue = ['measure', 'align', null, 'motion'];
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (visible, doMeasure) {
  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null),
      _useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.default)(_useState, 2),
      status = _useState2[0],
      setInternalStatus = _useState2[1];

  var rafRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)();
  var destroyRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(false);

  function setStatus(nextStatus) {
    if (!destroyRef.current) {
      setInternalStatus(nextStatus);
    }
  }

  function cancelRaf() {
    rc_util_es_raf__WEBPACK_IMPORTED_MODULE_4__.default.cancel(rafRef.current);
  }

  function goNextStatus(callback) {
    cancelRaf();
    rafRef.current = (0,rc_util_es_raf__WEBPACK_IMPORTED_MODULE_4__.default)(function () {
      // Only align should be manually trigger
      setStatus(function (prev) {
        switch (status) {
          case 'align':
            return 'motion';

          case 'motion':
            return 'stable';

          default:
        }

        return prev;
      });
      callback === null || callback === void 0 ? void 0 : callback();
    });
  } // Init status


  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    setStatus('measure');
  }, [visible]); // Go next status

  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    switch (status) {
      case 'measure':
        doMeasure();
        break;

      default:
    }

    if (status) {
      rafRef.current = (0,rc_util_es_raf__WEBPACK_IMPORTED_MODULE_4__.default)( /*#__PURE__*/(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.default)( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee() {
        var index, nextStatus;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                index = StatusQueue.indexOf(status);
                nextStatus = StatusQueue[index + 1];

                if (nextStatus && index !== -1) {
                  setStatus(nextStatus);
                }

              case 3:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      })));
    }
  }, [status]);
  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    return function () {
      destroyRef.current = true;
      cancelRaf();
    };
  }, []);
  return [status, goNextStatus];
});

/***/ }),

/***/ "./node_modules/rc-trigger/es/context.js":
/*!***********************************************!*\
  !*** ./node_modules/rc-trigger/es/context.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

var TriggerContext = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TriggerContext);

/***/ }),

/***/ "./node_modules/rc-trigger/es/index.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-trigger/es/index.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "generateTrigger": () => (/* binding */ generateTrigger),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-dom */ "./node_modules/react-dom/index.js");
/* harmony import */ var rc_util_es_raf__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rc-util/es/raf */ "./node_modules/rc-util/es/raf.js");
/* harmony import */ var rc_util_es_Dom_contains__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rc-util/es/Dom/contains */ "./node_modules/rc-util/es/Dom/contains.js");
/* harmony import */ var rc_util_es_Dom_findDOMNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rc-util/es/Dom/findDOMNode */ "./node_modules/rc-util/es/Dom/findDOMNode.js");
/* harmony import */ var rc_util_es_ref__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rc-util/es/ref */ "./node_modules/rc-util/es/ref.js");
/* harmony import */ var rc_util_es_Dom_addEventListener__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rc-util/es/Dom/addEventListener */ "./node_modules/rc-util/es/Dom/addEventListener.js");
/* harmony import */ var rc_util_es_Portal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rc-util/es/Portal */ "./node_modules/rc-util/es/Portal.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var _utils_alignUtil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/alignUtil */ "./node_modules/rc-trigger/es/utils/alignUtil.js");
/* harmony import */ var _Popup__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Popup */ "./node_modules/rc-trigger/es/Popup/index.js");
/* harmony import */ var _context__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./context */ "./node_modules/rc-trigger/es/context.js");




















function noop() {}

function returnEmptyString() {
  return '';
}

function returnDocument(element) {
  if (element) {
    return element.ownerDocument;
  }

  return window.document;
}

var ALL_HANDLERS = ['onClick', 'onMouseDown', 'onTouchStart', 'onMouseEnter', 'onMouseLeave', 'onFocus', 'onBlur', 'onContextMenu'];
/**
 * Internal usage. Do not use in your code since this will be removed.
 */

function generateTrigger(PortalComponent) {
  var Trigger = /*#__PURE__*/function (_React$Component) {
    (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.default)(Trigger, _React$Component);

    var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__.default)(Trigger);

    function Trigger(props) {
      var _this;

      (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__.default)(this, Trigger);

      _this = _super.call(this, props);
      _this.popupRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createRef();
      _this.triggerRef = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createRef();

      _this.onMouseEnter = function (e) {
        var mouseEnterDelay = _this.props.mouseEnterDelay;

        _this.fireEvents('onMouseEnter', e);

        _this.delaySetPopupVisible(true, mouseEnterDelay, mouseEnterDelay ? null : e);
      };

      _this.onMouseMove = function (e) {
        _this.fireEvents('onMouseMove', e);

        _this.setPoint(e);
      };

      _this.onMouseLeave = function (e) {
        _this.fireEvents('onMouseLeave', e);

        _this.delaySetPopupVisible(false, _this.props.mouseLeaveDelay);
      };

      _this.onPopupMouseEnter = function () {
        _this.clearDelayTimer();
      };

      _this.onPopupMouseLeave = function (e) {
        var _this$popupRef$curren;

        // https://github.com/react-component/trigger/pull/13
        // react bug?
        if (e.relatedTarget && !e.relatedTarget.setTimeout && (0,rc_util_es_Dom_contains__WEBPACK_IMPORTED_MODULE_10__.default)((_this$popupRef$curren = _this.popupRef.current) === null || _this$popupRef$curren === void 0 ? void 0 : _this$popupRef$curren.getElement(), e.relatedTarget)) {
          return;
        }

        _this.delaySetPopupVisible(false, _this.props.mouseLeaveDelay);
      };

      _this.onFocus = function (e) {
        _this.fireEvents('onFocus', e); // incase focusin and focusout


        _this.clearDelayTimer();

        if (_this.isFocusToShow()) {
          _this.focusTime = Date.now();

          _this.delaySetPopupVisible(true, _this.props.focusDelay);
        }
      };

      _this.onMouseDown = function (e) {
        _this.fireEvents('onMouseDown', e);

        _this.preClickTime = Date.now();
      };

      _this.onTouchStart = function (e) {
        _this.fireEvents('onTouchStart', e);

        _this.preTouchTime = Date.now();
      };

      _this.onBlur = function (e) {
        _this.fireEvents('onBlur', e);

        _this.clearDelayTimer();

        if (_this.isBlurToHide()) {
          _this.delaySetPopupVisible(false, _this.props.blurDelay);
        }
      };

      _this.onContextMenu = function (e) {
        e.preventDefault();

        _this.fireEvents('onContextMenu', e);

        _this.setPopupVisible(true, e);
      };

      _this.onContextMenuClose = function () {
        if (_this.isContextMenuToShow()) {
          _this.close();
        }
      };

      _this.onClick = function (event) {
        _this.fireEvents('onClick', event); // focus will trigger click


        if (_this.focusTime) {
          var preTime;

          if (_this.preClickTime && _this.preTouchTime) {
            preTime = Math.min(_this.preClickTime, _this.preTouchTime);
          } else if (_this.preClickTime) {
            preTime = _this.preClickTime;
          } else if (_this.preTouchTime) {
            preTime = _this.preTouchTime;
          }

          if (Math.abs(preTime - _this.focusTime) < 20) {
            return;
          }

          _this.focusTime = 0;
        }

        _this.preClickTime = 0;
        _this.preTouchTime = 0; // Only prevent default when all the action is click.
        // https://github.com/ant-design/ant-design/issues/17043
        // https://github.com/ant-design/ant-design/issues/17291

        if (_this.isClickToShow() && (_this.isClickToHide() || _this.isBlurToHide()) && event && event.preventDefault) {
          event.preventDefault();
        }

        var nextVisible = !_this.state.popupVisible;

        if (_this.isClickToHide() && !nextVisible || nextVisible && _this.isClickToShow()) {
          _this.setPopupVisible(!_this.state.popupVisible, event);
        }
      };

      _this.onPopupMouseDown = function () {
        _this.hasPopupMouseDown = true;
        clearTimeout(_this.mouseDownTimeout);
        _this.mouseDownTimeout = window.setTimeout(function () {
          _this.hasPopupMouseDown = false;
        }, 0);

        if (_this.context) {
          var _this$context;

          (_this$context = _this.context).onPopupMouseDown.apply(_this$context, arguments);
        }
      };

      _this.onDocumentClick = function (event) {
        if (_this.props.mask && !_this.props.maskClosable) {
          return;
        }

        var target = event.target;

        var root = _this.getRootDomNode();

        var popupNode = _this.getPopupDomNode();

        if ( // mousedown on the target should also close popup when action is contextMenu.
        // https://github.com/ant-design/ant-design/issues/29853
        (!(0,rc_util_es_Dom_contains__WEBPACK_IMPORTED_MODULE_10__.default)(root, target) || _this.isContextMenuOnly()) && !(0,rc_util_es_Dom_contains__WEBPACK_IMPORTED_MODULE_10__.default)(popupNode, target) && !_this.hasPopupMouseDown) {
          _this.close();
        }
      };

      _this.getRootDomNode = function () {
        var getTriggerDOMNode = _this.props.getTriggerDOMNode;

        if (getTriggerDOMNode) {
          return getTriggerDOMNode(_this.triggerRef.current);
        }

        try {
          var domNode = (0,rc_util_es_Dom_findDOMNode__WEBPACK_IMPORTED_MODULE_11__.default)(_this.triggerRef.current);

          if (domNode) {
            return domNode;
          }
        } catch (err) {// Do nothing
        }

        return react_dom__WEBPACK_IMPORTED_MODULE_8__.findDOMNode((0,_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.default)(_this));
      };

      _this.getPopupClassNameFromAlign = function (align) {
        var className = [];
        var _this$props = _this.props,
            popupPlacement = _this$props.popupPlacement,
            builtinPlacements = _this$props.builtinPlacements,
            prefixCls = _this$props.prefixCls,
            alignPoint = _this$props.alignPoint,
            getPopupClassNameFromAlign = _this$props.getPopupClassNameFromAlign;

        if (popupPlacement && builtinPlacements) {
          className.push((0,_utils_alignUtil__WEBPACK_IMPORTED_MODULE_16__.getAlignPopupClassName)(builtinPlacements, prefixCls, align, alignPoint));
        }

        if (getPopupClassNameFromAlign) {
          className.push(getPopupClassNameFromAlign(align));
        }

        return className.join(' ');
      };

      _this.getComponent = function () {
        var _this$props2 = _this.props,
            prefixCls = _this$props2.prefixCls,
            destroyPopupOnHide = _this$props2.destroyPopupOnHide,
            popupClassName = _this$props2.popupClassName,
            onPopupAlign = _this$props2.onPopupAlign,
            popupMotion = _this$props2.popupMotion,
            popupAnimation = _this$props2.popupAnimation,
            popupTransitionName = _this$props2.popupTransitionName,
            popupStyle = _this$props2.popupStyle,
            mask = _this$props2.mask,
            maskAnimation = _this$props2.maskAnimation,
            maskTransitionName = _this$props2.maskTransitionName,
            maskMotion = _this$props2.maskMotion,
            zIndex = _this$props2.zIndex,
            popup = _this$props2.popup,
            stretch = _this$props2.stretch,
            alignPoint = _this$props2.alignPoint,
            mobile = _this$props2.mobile,
            forceRender = _this$props2.forceRender;
        var _this$state = _this.state,
            popupVisible = _this$state.popupVisible,
            point = _this$state.point;

        var align = _this.getPopupAlign();

        var mouseProps = {};

        if (_this.isMouseEnterToShow()) {
          mouseProps.onMouseEnter = _this.onPopupMouseEnter;
        }

        if (_this.isMouseLeaveToHide()) {
          mouseProps.onMouseLeave = _this.onPopupMouseLeave;
        }

        mouseProps.onMouseDown = _this.onPopupMouseDown;
        mouseProps.onTouchStart = _this.onPopupMouseDown;
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createElement(_Popup__WEBPACK_IMPORTED_MODULE_17__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__.default)({
          prefixCls: prefixCls,
          destroyPopupOnHide: destroyPopupOnHide,
          visible: popupVisible,
          point: alignPoint && point,
          className: popupClassName,
          align: align,
          onAlign: onPopupAlign,
          animation: popupAnimation,
          getClassNameFromAlign: _this.getPopupClassNameFromAlign
        }, mouseProps, {
          stretch: stretch,
          getRootDomNode: _this.getRootDomNode,
          style: popupStyle,
          mask: mask,
          zIndex: zIndex,
          transitionName: popupTransitionName,
          maskAnimation: maskAnimation,
          maskTransitionName: maskTransitionName,
          maskMotion: maskMotion,
          ref: _this.popupRef,
          motion: popupMotion,
          mobile: mobile,
          forceRender: forceRender
        }), typeof popup === 'function' ? popup() : popup);
      };

      _this.attachParent = function (popupContainer) {
        rc_util_es_raf__WEBPACK_IMPORTED_MODULE_9__.default.cancel(_this.attachId);
        var _this$props3 = _this.props,
            getPopupContainer = _this$props3.getPopupContainer,
            getDocument = _this$props3.getDocument;

        var domNode = _this.getRootDomNode();

        var mountNode;

        if (!getPopupContainer) {
          mountNode = getDocument(_this.getRootDomNode()).body;
        } else if (domNode || getPopupContainer.length === 0) {
          // Compatible for legacy getPopupContainer with domNode argument.
          // If no need `domNode` argument, will call directly.
          // https://codesandbox.io/s/eloquent-mclean-ss93m?file=/src/App.js
          mountNode = getPopupContainer(domNode);
        }

        if (mountNode) {
          mountNode.appendChild(popupContainer);
        } else {
          // Retry after frame render in case parent not ready
          _this.attachId = (0,rc_util_es_raf__WEBPACK_IMPORTED_MODULE_9__.default)(function () {
            _this.attachParent(popupContainer);
          });
        }
      };

      _this.getContainer = function () {
        var getDocument = _this.props.getDocument;
        var popupContainer = getDocument(_this.getRootDomNode()).createElement('div'); // Make sure default popup container will never cause scrollbar appearing
        // https://github.com/react-component/trigger/issues/41

        popupContainer.style.position = 'absolute';
        popupContainer.style.top = '0';
        popupContainer.style.left = '0';
        popupContainer.style.width = '100%';

        _this.attachParent(popupContainer);

        return popupContainer;
      };

      _this.setPoint = function (point) {
        var alignPoint = _this.props.alignPoint;
        if (!alignPoint || !point) return;

        _this.setState({
          point: {
            pageX: point.pageX,
            pageY: point.pageY
          }
        });
      };

      _this.handlePortalUpdate = function () {
        if (_this.state.prevPopupVisible !== _this.state.popupVisible) {
          _this.props.afterPopupVisibleChange(_this.state.popupVisible);
        }
      };

      _this.triggerContextValue = {
        onPopupMouseDown: _this.onPopupMouseDown
      };
      var popupVisible;

      if ('popupVisible' in props) {
        popupVisible = !!props.popupVisible;
      } else {
        popupVisible = !!props.defaultPopupVisible;
      }

      _this.state = {
        prevPopupVisible: popupVisible,
        popupVisible: popupVisible
      };
      ALL_HANDLERS.forEach(function (h) {
        _this["fire".concat(h)] = function (e) {
          _this.fireEvents(h, e);
        };
      });
      return _this;
    }

    (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_3__.default)(Trigger, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        this.componentDidUpdate();
      }
    }, {
      key: "componentDidUpdate",
      value: function componentDidUpdate() {
        var props = this.props;
        var state = this.state; // We must listen to `mousedown` or `touchstart`, edge case:
        // https://github.com/ant-design/ant-design/issues/5804
        // https://github.com/react-component/calendar/issues/250
        // https://github.com/react-component/trigger/issues/50

        if (state.popupVisible) {
          var currentDocument;

          if (!this.clickOutsideHandler && (this.isClickToHide() || this.isContextMenuToShow())) {
            currentDocument = props.getDocument(this.getRootDomNode());
            this.clickOutsideHandler = (0,rc_util_es_Dom_addEventListener__WEBPACK_IMPORTED_MODULE_13__.default)(currentDocument, 'mousedown', this.onDocumentClick);
          } // always hide on mobile


          if (!this.touchOutsideHandler) {
            currentDocument = currentDocument || props.getDocument(this.getRootDomNode());
            this.touchOutsideHandler = (0,rc_util_es_Dom_addEventListener__WEBPACK_IMPORTED_MODULE_13__.default)(currentDocument, 'touchstart', this.onDocumentClick);
          } // close popup when trigger type contains 'onContextMenu' and document is scrolling.


          if (!this.contextMenuOutsideHandler1 && this.isContextMenuToShow()) {
            currentDocument = currentDocument || props.getDocument(this.getRootDomNode());
            this.contextMenuOutsideHandler1 = (0,rc_util_es_Dom_addEventListener__WEBPACK_IMPORTED_MODULE_13__.default)(currentDocument, 'scroll', this.onContextMenuClose);
          } // close popup when trigger type contains 'onContextMenu' and window is blur.


          if (!this.contextMenuOutsideHandler2 && this.isContextMenuToShow()) {
            this.contextMenuOutsideHandler2 = (0,rc_util_es_Dom_addEventListener__WEBPACK_IMPORTED_MODULE_13__.default)(window, 'blur', this.onContextMenuClose);
          }

          return;
        }

        this.clearOutsideHandler();
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        this.clearDelayTimer();
        this.clearOutsideHandler();
        clearTimeout(this.mouseDownTimeout);
        rc_util_es_raf__WEBPACK_IMPORTED_MODULE_9__.default.cancel(this.attachId);
      }
    }, {
      key: "getPopupDomNode",
      value: function getPopupDomNode() {
        var _this$popupRef$curren2;

        // for test
        return ((_this$popupRef$curren2 = this.popupRef.current) === null || _this$popupRef$curren2 === void 0 ? void 0 : _this$popupRef$curren2.getElement()) || null;
      }
    }, {
      key: "getPopupAlign",
      value: function getPopupAlign() {
        var props = this.props;
        var popupPlacement = props.popupPlacement,
            popupAlign = props.popupAlign,
            builtinPlacements = props.builtinPlacements;

        if (popupPlacement && builtinPlacements) {
          return (0,_utils_alignUtil__WEBPACK_IMPORTED_MODULE_16__.getAlignFromPlacement)(builtinPlacements, popupPlacement, popupAlign);
        }

        return popupAlign;
      }
      /**
       * @param popupVisible    Show or not the popup element
       * @param event           SyntheticEvent, used for `pointAlign`
       */

    }, {
      key: "setPopupVisible",
      value: function setPopupVisible(popupVisible, event) {
        var alignPoint = this.props.alignPoint;
        var prevPopupVisible = this.state.popupVisible;
        this.clearDelayTimer();

        if (prevPopupVisible !== popupVisible) {
          if (!('popupVisible' in this.props)) {
            this.setState({
              popupVisible: popupVisible,
              prevPopupVisible: prevPopupVisible
            });
          }

          this.props.onPopupVisibleChange(popupVisible);
        } // Always record the point position since mouseEnterDelay will delay the show


        if (alignPoint && event && popupVisible) {
          this.setPoint(event);
        }
      }
    }, {
      key: "delaySetPopupVisible",
      value: function delaySetPopupVisible(visible, delayS, event) {
        var _this2 = this;

        var delay = delayS * 1000;
        this.clearDelayTimer();

        if (delay) {
          var point = event ? {
            pageX: event.pageX,
            pageY: event.pageY
          } : null;
          this.delayTimer = window.setTimeout(function () {
            _this2.setPopupVisible(visible, point);

            _this2.clearDelayTimer();
          }, delay);
        } else {
          this.setPopupVisible(visible, event);
        }
      }
    }, {
      key: "clearDelayTimer",
      value: function clearDelayTimer() {
        if (this.delayTimer) {
          clearTimeout(this.delayTimer);
          this.delayTimer = null;
        }
      }
    }, {
      key: "clearOutsideHandler",
      value: function clearOutsideHandler() {
        if (this.clickOutsideHandler) {
          this.clickOutsideHandler.remove();
          this.clickOutsideHandler = null;
        }

        if (this.contextMenuOutsideHandler1) {
          this.contextMenuOutsideHandler1.remove();
          this.contextMenuOutsideHandler1 = null;
        }

        if (this.contextMenuOutsideHandler2) {
          this.contextMenuOutsideHandler2.remove();
          this.contextMenuOutsideHandler2 = null;
        }

        if (this.touchOutsideHandler) {
          this.touchOutsideHandler.remove();
          this.touchOutsideHandler = null;
        }
      }
    }, {
      key: "createTwoChains",
      value: function createTwoChains(event) {
        var childPros = this.props.children.props;
        var props = this.props;

        if (childPros[event] && props[event]) {
          return this["fire".concat(event)];
        }

        return childPros[event] || props[event];
      }
    }, {
      key: "isClickToShow",
      value: function isClickToShow() {
        var _this$props4 = this.props,
            action = _this$props4.action,
            showAction = _this$props4.showAction;
        return action.indexOf('click') !== -1 || showAction.indexOf('click') !== -1;
      }
    }, {
      key: "isContextMenuOnly",
      value: function isContextMenuOnly() {
        var action = this.props.action;
        return action === 'contextMenu' || action.length === 1 && action[0] === 'contextMenu';
      }
    }, {
      key: "isContextMenuToShow",
      value: function isContextMenuToShow() {
        var _this$props5 = this.props,
            action = _this$props5.action,
            showAction = _this$props5.showAction;
        return action.indexOf('contextMenu') !== -1 || showAction.indexOf('contextMenu') !== -1;
      }
    }, {
      key: "isClickToHide",
      value: function isClickToHide() {
        var _this$props6 = this.props,
            action = _this$props6.action,
            hideAction = _this$props6.hideAction;
        return action.indexOf('click') !== -1 || hideAction.indexOf('click') !== -1;
      }
    }, {
      key: "isMouseEnterToShow",
      value: function isMouseEnterToShow() {
        var _this$props7 = this.props,
            action = _this$props7.action,
            showAction = _this$props7.showAction;
        return action.indexOf('hover') !== -1 || showAction.indexOf('mouseEnter') !== -1;
      }
    }, {
      key: "isMouseLeaveToHide",
      value: function isMouseLeaveToHide() {
        var _this$props8 = this.props,
            action = _this$props8.action,
            hideAction = _this$props8.hideAction;
        return action.indexOf('hover') !== -1 || hideAction.indexOf('mouseLeave') !== -1;
      }
    }, {
      key: "isFocusToShow",
      value: function isFocusToShow() {
        var _this$props9 = this.props,
            action = _this$props9.action,
            showAction = _this$props9.showAction;
        return action.indexOf('focus') !== -1 || showAction.indexOf('focus') !== -1;
      }
    }, {
      key: "isBlurToHide",
      value: function isBlurToHide() {
        var _this$props10 = this.props,
            action = _this$props10.action,
            hideAction = _this$props10.hideAction;
        return action.indexOf('focus') !== -1 || hideAction.indexOf('blur') !== -1;
      }
    }, {
      key: "forcePopupAlign",
      value: function forcePopupAlign() {
        if (this.state.popupVisible) {
          var _this$popupRef$curren3;

          (_this$popupRef$curren3 = this.popupRef.current) === null || _this$popupRef$curren3 === void 0 ? void 0 : _this$popupRef$curren3.forceAlign();
        }
      }
    }, {
      key: "fireEvents",
      value: function fireEvents(type, e) {
        var childCallback = this.props.children.props[type];

        if (childCallback) {
          childCallback(e);
        }

        var callback = this.props[type];

        if (callback) {
          callback(e);
        }
      }
    }, {
      key: "close",
      value: function close() {
        this.setPopupVisible(false);
      }
    }, {
      key: "render",
      value: function render() {
        var popupVisible = this.state.popupVisible;
        var _this$props11 = this.props,
            children = _this$props11.children,
            forceRender = _this$props11.forceRender,
            alignPoint = _this$props11.alignPoint,
            className = _this$props11.className,
            autoDestroy = _this$props11.autoDestroy;
        var child = react__WEBPACK_IMPORTED_MODULE_7__.Children.only(children);
        var newChildProps = {
          key: 'trigger'
        }; // ============================== Visible Handlers ==============================
        // >>> ContextMenu

        if (this.isContextMenuToShow()) {
          newChildProps.onContextMenu = this.onContextMenu;
        } else {
          newChildProps.onContextMenu = this.createTwoChains('onContextMenu');
        } // >>> Click


        if (this.isClickToHide() || this.isClickToShow()) {
          newChildProps.onClick = this.onClick;
          newChildProps.onMouseDown = this.onMouseDown;
          newChildProps.onTouchStart = this.onTouchStart;
        } else {
          newChildProps.onClick = this.createTwoChains('onClick');
          newChildProps.onMouseDown = this.createTwoChains('onMouseDown');
          newChildProps.onTouchStart = this.createTwoChains('onTouchStart');
        } // >>> Hover(enter)


        if (this.isMouseEnterToShow()) {
          newChildProps.onMouseEnter = this.onMouseEnter; // Point align

          if (alignPoint) {
            newChildProps.onMouseMove = this.onMouseMove;
          }
        } else {
          newChildProps.onMouseEnter = this.createTwoChains('onMouseEnter');
        } // >>> Hover(leave)


        if (this.isMouseLeaveToHide()) {
          newChildProps.onMouseLeave = this.onMouseLeave;
        } else {
          newChildProps.onMouseLeave = this.createTwoChains('onMouseLeave');
        } // >>> Focus


        if (this.isFocusToShow() || this.isBlurToHide()) {
          newChildProps.onFocus = this.onFocus;
          newChildProps.onBlur = this.onBlur;
        } else {
          newChildProps.onFocus = this.createTwoChains('onFocus');
          newChildProps.onBlur = this.createTwoChains('onBlur');
        } // =================================== Render ===================================


        var childrenClassName = classnames__WEBPACK_IMPORTED_MODULE_15___default()(child && child.props && child.props.className, className);

        if (childrenClassName) {
          newChildProps.className = childrenClassName;
        }

        var cloneProps = (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.default)({}, newChildProps);

        if ((0,rc_util_es_ref__WEBPACK_IMPORTED_MODULE_12__.supportRef)(child)) {
          cloneProps.ref = (0,rc_util_es_ref__WEBPACK_IMPORTED_MODULE_12__.composeRef)(this.triggerRef, child.ref);
        }

        var trigger = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.cloneElement(child, cloneProps);
        var portal; // prevent unmounting after it's rendered

        if (popupVisible || this.popupRef.current || forceRender) {
          portal = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createElement(PortalComponent, {
            key: "portal",
            getContainer: this.getContainer,
            didUpdate: this.handlePortalUpdate
          }, this.getComponent());
        }

        if (!popupVisible && autoDestroy) {
          portal = null;
        }

        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_7__.createElement(_context__WEBPACK_IMPORTED_MODULE_18__.default.Provider, {
          value: this.triggerContextValue
        }, trigger, portal);
      }
    }], [{
      key: "getDerivedStateFromProps",
      value: function getDerivedStateFromProps(_ref, prevState) {
        var popupVisible = _ref.popupVisible;
        var newState = {};

        if (popupVisible !== undefined && prevState.popupVisible !== popupVisible) {
          newState.popupVisible = popupVisible;
          newState.prevPopupVisible = prevState.popupVisible;
        }

        return newState;
      }
    }]);

    return Trigger;
  }(react__WEBPACK_IMPORTED_MODULE_7__.Component);

  Trigger.contextType = _context__WEBPACK_IMPORTED_MODULE_18__.default;
  Trigger.defaultProps = {
    prefixCls: 'rc-trigger-popup',
    getPopupClassNameFromAlign: returnEmptyString,
    getDocument: returnDocument,
    onPopupVisibleChange: noop,
    afterPopupVisibleChange: noop,
    onPopupAlign: noop,
    popupClassName: '',
    mouseEnterDelay: 0,
    mouseLeaveDelay: 0.1,
    focusDelay: 0,
    blurDelay: 0.15,
    popupStyle: {},
    destroyPopupOnHide: false,
    popupAlign: {},
    defaultPopupVisible: false,
    mask: false,
    maskClosable: true,
    action: [],
    showAction: [],
    hideAction: [],
    autoDestroy: false
  };
  return Trigger;
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (generateTrigger(rc_util_es_Portal__WEBPACK_IMPORTED_MODULE_14__.default));

/***/ }),

/***/ "./node_modules/rc-trigger/es/utils/alignUtil.js":
/*!*******************************************************!*\
  !*** ./node_modules/rc-trigger/es/utils/alignUtil.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getAlignFromPlacement": () => (/* binding */ getAlignFromPlacement),
/* harmony export */   "getAlignPopupClassName": () => (/* binding */ getAlignPopupClassName)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ "./node_modules/@babel/runtime/helpers/esm/objectSpread2.js");


function isPointsEq(a1, a2, isAlignPoint) {
  if (isAlignPoint) {
    return a1[0] === a2[0];
  }

  return a1[0] === a2[0] && a1[1] === a2[1];
}

function getAlignFromPlacement(builtinPlacements, placementStr, align) {
  var baseAlign = builtinPlacements[placementStr] || {};
  return (0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.default)((0,_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__.default)({}, baseAlign), align);
}
function getAlignPopupClassName(builtinPlacements, prefixCls, align, isAlignPoint) {
  var points = align.points;
  var placements = Object.keys(builtinPlacements);

  for (var i = 0; i < placements.length; i += 1) {
    var placement = placements[i];

    if (isPointsEq(builtinPlacements[placement].points, points, isAlignPoint)) {
      return "".concat(prefixCls, "-placement-").concat(placement);
    }
  }

  return '';
}

/***/ }),

/***/ "./node_modules/rc-trigger/es/utils/legacyUtil.js":
/*!********************************************************!*\
  !*** ./node_modules/rc-trigger/es/utils/legacyUtil.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getMotion": () => (/* binding */ getMotion)
/* harmony export */ });
function getMotion(_ref) {
  var prefixCls = _ref.prefixCls,
      motion = _ref.motion,
      animation = _ref.animation,
      transitionName = _ref.transitionName;

  if (motion) {
    return motion;
  }

  if (animation) {
    return {
      motionName: "".concat(prefixCls, "-").concat(animation)
    };
  }

  if (transitionName) {
    return {
      motionName: transitionName
    };
  }

  return null;
}

/***/ }),

/***/ "./node_modules/rc-upload/es/AjaxUploader.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-upload/es/AjaxUploader.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectWithoutProperties */ "./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js");
/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! classnames */ "./node_modules/classnames/index.js");
/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var rc_util_es_pickAttrs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rc-util/es/pickAttrs */ "./node_modules/rc-util/es/pickAttrs.js");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./request */ "./node_modules/rc-upload/es/request.js");
/* harmony import */ var _uid__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./uid */ "./node_modules/rc-upload/es/uid.js");
/* harmony import */ var _attr_accept__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./attr-accept */ "./node_modules/rc-upload/es/attr-accept.js");
/* harmony import */ var _traverseFileTree__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./traverseFileTree */ "./node_modules/rc-upload/es/traverseFileTree.js");



















var AjaxUploader = /*#__PURE__*/function (_Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_9__.default)(AjaxUploader, _Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_10__.default)(AjaxUploader);

  function AjaxUploader() {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.default)(this, AjaxUploader);

    _this = _super.apply(this, arguments);
    _this.state = {
      uid: (0,_uid__WEBPACK_IMPORTED_MODULE_15__.default)()
    };
    _this.reqs = {};

    _this.onChange = function (e) {
      var _this$props = _this.props,
          accept = _this$props.accept,
          directory = _this$props.directory;
      var files = e.target.files;

      var acceptedFiles = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__.default)(files).filter(function (file) {
        return !directory || (0,_attr_accept__WEBPACK_IMPORTED_MODULE_16__.default)(file, accept);
      });

      _this.uploadFiles(acceptedFiles);

      _this.reset();
    };

    _this.onClick = function (e) {
      var el = _this.fileInput;

      if (!el) {
        return;
      }

      var _this$props2 = _this.props,
          children = _this$props2.children,
          onClick = _this$props2.onClick;

      if (children && children.type === 'button') {
        var parent = el.parentNode;
        parent.focus();
        parent.querySelector('button').blur();
      }

      el.click();

      if (onClick) {
        onClick(e);
      }
    };

    _this.onKeyDown = function (e) {
      if (e.key === 'Enter') {
        _this.onClick(e);
      }
    };

    _this.onFileDrop = function (e) {
      var multiple = _this.props.multiple;
      e.preventDefault();

      if (e.type === 'dragover') {
        return;
      }

      if (_this.props.directory) {
        (0,_traverseFileTree__WEBPACK_IMPORTED_MODULE_17__.default)(Array.prototype.slice.call(e.dataTransfer.items), _this.uploadFiles, function (_file) {
          return (0,_attr_accept__WEBPACK_IMPORTED_MODULE_16__.default)(_file, _this.props.accept);
        });
      } else {
        var files = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__.default)(e.dataTransfer.files).filter(function (file) {
          return (0,_attr_accept__WEBPACK_IMPORTED_MODULE_16__.default)(file, _this.props.accept);
        });

        if (multiple === false) {
          files = files.slice(0, 1);
        }

        _this.uploadFiles(files);
      }
    };

    _this.uploadFiles = function (files) {
      var originFiles = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_6__.default)(files);

      var postFiles = originFiles.map(function (file) {
        // eslint-disable-next-line no-param-reassign
        file.uid = (0,_uid__WEBPACK_IMPORTED_MODULE_15__.default)();
        return _this.processFile(file, originFiles);
      }); // Batch upload files

      Promise.all(postFiles).then(function (fileList) {
        var onBatchStart = _this.props.onBatchStart;
        onBatchStart === null || onBatchStart === void 0 ? void 0 : onBatchStart(fileList.map(function (_ref) {
          var origin = _ref.origin,
              parsedFile = _ref.parsedFile;
          return {
            file: origin,
            parsedFile: parsedFile
          };
        }));
        fileList.filter(function (file) {
          return file.parsedFile !== null;
        }).forEach(function (file) {
          _this.post(file);
        });
      });
    };
    /**
     * Process file before upload. When all the file is ready, we start upload.
     */


    _this.processFile = /*#__PURE__*/function () {
      var _ref2 = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__.default)( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default().mark(function _callee(file, fileList) {
        var beforeUpload, transformedFile, action, mergedAction, data, mergedData, parsedData, parsedFile, mergedParsedFile;
        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_3___default().wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                beforeUpload = _this.props.beforeUpload;
                transformedFile = file;

                if (!beforeUpload) {
                  _context.next = 14;
                  break;
                }

                _context.prev = 3;
                _context.next = 6;
                return beforeUpload(file, fileList);

              case 6:
                transformedFile = _context.sent;
                _context.next = 12;
                break;

              case 9:
                _context.prev = 9;
                _context.t0 = _context["catch"](3);
                // Rejection will also trade as false
                transformedFile = false;

              case 12:
                if (!(transformedFile === false)) {
                  _context.next = 14;
                  break;
                }

                return _context.abrupt("return", {
                  origin: file,
                  parsedFile: null,
                  action: null,
                  data: null
                });

              case 14:
                // Get latest action
                action = _this.props.action;

                if (!(typeof action === 'function')) {
                  _context.next = 21;
                  break;
                }

                _context.next = 18;
                return action(file);

              case 18:
                mergedAction = _context.sent;
                _context.next = 22;
                break;

              case 21:
                mergedAction = action;

              case 22:
                // Get latest data
                data = _this.props.data;

                if (!(typeof data === 'function')) {
                  _context.next = 29;
                  break;
                }

                _context.next = 26;
                return data(file);

              case 26:
                mergedData = _context.sent;
                _context.next = 30;
                break;

              case 29:
                mergedData = data;

              case 30:
                parsedData = // string type is from legacy `transformFile`.
                // Not sure if this will work since no related test case works with it
                ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_4__.default)(transformedFile) === 'object' || typeof transformedFile === 'string') && transformedFile ? transformedFile : file;

                if (parsedData instanceof File) {
                  parsedFile = parsedData;
                } else {
                  parsedFile = new File([parsedData], file.name, {
                    type: file.type
                  });
                }

                mergedParsedFile = parsedFile;
                mergedParsedFile.uid = file.uid;
                return _context.abrupt("return", {
                  origin: file,
                  data: mergedData,
                  parsedFile: mergedParsedFile,
                  action: mergedAction
                });

              case 35:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, null, [[3, 9]]);
      }));

      return function (_x, _x2) {
        return _ref2.apply(this, arguments);
      };
    }();

    _this.saveFileInput = function (node) {
      _this.fileInput = node;
    };

    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_8__.default)(AjaxUploader, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this._isMounted = true;
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this._isMounted = false;
      this.abort();
    }
  }, {
    key: "post",
    value: function post(_ref3) {
      var _this2 = this;

      var data = _ref3.data,
          origin = _ref3.origin,
          action = _ref3.action,
          parsedFile = _ref3.parsedFile;

      if (!this._isMounted) {
        return;
      }

      var _this$props3 = this.props,
          onStart = _this$props3.onStart,
          customRequest = _this$props3.customRequest,
          name = _this$props3.name,
          headers = _this$props3.headers,
          withCredentials = _this$props3.withCredentials,
          method = _this$props3.method;
      var uid = origin.uid;
      var request = customRequest || _request__WEBPACK_IMPORTED_MODULE_14__.default;
      var requestOption = {
        action: action,
        filename: name,
        data: data,
        file: parsedFile,
        headers: headers,
        withCredentials: withCredentials,
        method: method || 'post',
        onProgress: function onProgress(e) {
          var onProgress = _this2.props.onProgress;
          onProgress === null || onProgress === void 0 ? void 0 : onProgress(e, parsedFile);
        },
        onSuccess: function onSuccess(ret, xhr) {
          var onSuccess = _this2.props.onSuccess;
          onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(ret, parsedFile, xhr);
          delete _this2.reqs[uid];
        },
        onError: function onError(err, ret) {
          var onError = _this2.props.onError;
          onError === null || onError === void 0 ? void 0 : onError(err, ret, parsedFile);
          delete _this2.reqs[uid];
        }
      };
      onStart(origin);
      this.reqs[uid] = request(requestOption);
    }
  }, {
    key: "reset",
    value: function reset() {
      this.setState({
        uid: (0,_uid__WEBPACK_IMPORTED_MODULE_15__.default)()
      });
    }
  }, {
    key: "abort",
    value: function abort(file) {
      var reqs = this.reqs;

      if (file) {
        var uid = file.uid ? file.uid : file;

        if (reqs[uid] && reqs[uid].abort) {
          reqs[uid].abort();
        }

        delete reqs[uid];
      } else {
        Object.keys(reqs).forEach(function (uid) {
          if (reqs[uid] && reqs[uid].abort) {
            reqs[uid].abort();
          }

          delete reqs[uid];
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _classNames;

      var _this$props4 = this.props,
          Tag = _this$props4.component,
          prefixCls = _this$props4.prefixCls,
          className = _this$props4.className,
          disabled = _this$props4.disabled,
          id = _this$props4.id,
          style = _this$props4.style,
          multiple = _this$props4.multiple,
          accept = _this$props4.accept,
          children = _this$props4.children,
          directory = _this$props4.directory,
          openFileDialogOnClick = _this$props4.openFileDialogOnClick,
          onMouseEnter = _this$props4.onMouseEnter,
          onMouseLeave = _this$props4.onMouseLeave,
          capture = _this$props4.capture,
          otherProps = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_2__.default)(_this$props4, ["component", "prefixCls", "className", "disabled", "id", "style", "multiple", "accept", "children", "directory", "openFileDialogOnClick", "onMouseEnter", "onMouseLeave", "capture"]);

      var cls = classnames__WEBPACK_IMPORTED_MODULE_12___default()((_classNames = {}, (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, prefixCls, true), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, "".concat(prefixCls, "-disabled"), disabled), (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__.default)(_classNames, className, className), _classNames)); // because input don't have directory/webkitdirectory type declaration

      var dirProps = directory ? {
        directory: 'directory',
        webkitdirectory: 'webkitdirectory'
      } : {};
      var events = disabled ? {} : {
        onClick: openFileDialogOnClick ? this.onClick : function () {},
        onKeyDown: openFileDialogOnClick ? this.onKeyDown : function () {},
        onMouseEnter: onMouseEnter,
        onMouseLeave: onMouseLeave,
        onDrop: this.onFileDrop,
        onDragOver: this.onFileDrop,
        tabIndex: '0'
      };
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_11__.createElement(Tag, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, events, {
        className: cls,
        role: "button",
        style: style
      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_11__.createElement("input", (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, (0,rc_util_es_pickAttrs__WEBPACK_IMPORTED_MODULE_13__.default)(otherProps, {
        aria: true,
        data: true
      }), {
        id: id,
        type: "file",
        ref: this.saveFileInput,
        onClick: function onClick(e) {
          return e.stopPropagation();
        } // https://github.com/ant-design/ant-design/issues/19948
        ,
        key: this.state.uid,
        style: {
          display: 'none'
        },
        accept: accept
      }, dirProps, {
        multiple: multiple,
        onChange: this.onChange
      }, capture != null ? {
        capture: capture
      } : {})), children);
    }
  }]);

  return AjaxUploader;
}(react__WEBPACK_IMPORTED_MODULE_11__.Component);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AjaxUploader);

/***/ }),

/***/ "./node_modules/rc-upload/es/Upload.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-upload/es/Upload.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createSuper */ "./node_modules/@babel/runtime/helpers/esm/createSuper.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _AjaxUploader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AjaxUploader */ "./node_modules/rc-upload/es/AjaxUploader.js");






/* eslint react/prop-types:0 */



function empty() {}

var Upload = /*#__PURE__*/function (_Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_3__.default)(Upload, _Component);

  var _super = (0,_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_4__.default)(Upload);

  function Upload() {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.default)(this, Upload);

    _this = _super.apply(this, arguments);

    _this.saveUploader = function (node) {
      _this.uploader = node;
    };

    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.default)(Upload, [{
    key: "abort",
    value: function abort(file) {
      this.uploader.abort(file);
    }
  }, {
    key: "render",
    value: function render() {
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__.createElement(_AjaxUploader__WEBPACK_IMPORTED_MODULE_6__.default, (0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({}, this.props, {
        ref: this.saveUploader
      }));
    }
  }]);

  return Upload;
}(react__WEBPACK_IMPORTED_MODULE_5__.Component);

Upload.defaultProps = {
  component: 'span',
  prefixCls: 'rc-upload',
  data: {},
  headers: {},
  name: 'file',
  multipart: false,
  onStart: empty,
  onError: empty,
  onSuccess: empty,
  multiple: false,
  beforeUpload: null,
  customRequest: null,
  withCredentials: false,
  openFileDialogOnClick: true
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Upload);

/***/ }),

/***/ "./node_modules/rc-upload/es/attr-accept.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-upload/es/attr-accept.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var rc_util_es_warning__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rc-util/es/warning */ "./node_modules/rc-util/es/warning.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (file, acceptedFiles) {
  if (file && acceptedFiles) {
    var acceptedFilesArray = Array.isArray(acceptedFiles) ? acceptedFiles : acceptedFiles.split(',');
    var fileName = file.name || '';
    var mimeType = file.type || '';
    var baseMimeType = mimeType.replace(/\/.*$/, '');
    return acceptedFilesArray.some(function (type) {
      var validType = type.trim(); // This is something like */*,*  allow all files

      if (/^\*(\/\*)?$/.test(type)) {
        return true;
      } // like .jpg, .png


      if (validType.charAt(0) === '.') {
        var lowerFileName = fileName.toLowerCase();
        var lowerType = validType.toLowerCase();
        var affixList = [lowerType];

        if (lowerType === '.jpg' || lowerType === '.jpeg') {
          affixList = ['.jpg', 'jpeg'];
        }

        return affixList.some(function (affix) {
          return lowerFileName.endsWith(affix);
        });
      } // This is something like a image/* mime type


      if (/\/\*$/.test(validType)) {
        return baseMimeType === validType.replace(/\/.*$/, '');
      } // Full match


      if (mimeType === validType) {
        return true;
      } // Invalidate type should skip


      if (/^\w+$/.test(validType)) {
        (0,rc_util_es_warning__WEBPACK_IMPORTED_MODULE_0__.default)(false, "Upload takes an invalidate 'accept' type '".concat(validType, "'.Skip for check."));
        return true;
      }

      return false;
    });
  }

  return true;
});

/***/ }),

/***/ "./node_modules/rc-upload/es/index.js":
/*!********************************************!*\
  !*** ./node_modules/rc-upload/es/index.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Upload__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Upload */ "./node_modules/rc-upload/es/Upload.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_Upload__WEBPACK_IMPORTED_MODULE_0__.default);

/***/ }),

/***/ "./node_modules/rc-upload/es/request.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-upload/es/request.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ upload)
/* harmony export */ });
function getError(option, xhr) {
  var msg = "cannot ".concat(option.method, " ").concat(option.action, " ").concat(xhr.status, "'");
  var err = new Error(msg);
  err.status = xhr.status;
  err.method = option.method;
  err.url = option.action;
  return err;
}

function getBody(xhr) {
  var text = xhr.responseText || xhr.response;

  if (!text) {
    return text;
  }

  try {
    return JSON.parse(text);
  } catch (e) {
    return text;
  }
}

function upload(option) {
  // eslint-disable-next-line no-undef
  var xhr = new XMLHttpRequest();

  if (option.onProgress && xhr.upload) {
    xhr.upload.onprogress = function progress(e) {
      if (e.total > 0) {
        e.percent = e.loaded / e.total * 100;
      }

      option.onProgress(e);
    };
  } // eslint-disable-next-line no-undef


  var formData = new FormData();

  if (option.data) {
    Object.keys(option.data).forEach(function (key) {
      var value = option.data[key]; // support key-value array data

      if (Array.isArray(value)) {
        value.forEach(function (item) {
          // { list: [ 11, 22 ] }
          // formData.append('list[]', 11);
          formData.append("".concat(key, "[]"), item);
        });
        return;
      }

      formData.append(key, option.data[key]);
    });
  } // eslint-disable-next-line no-undef


  if (option.file instanceof Blob) {
    formData.append(option.filename, option.file, option.file.name);
  } else {
    formData.append(option.filename, option.file);
  }

  xhr.onerror = function error(e) {
    option.onError(e);
  };

  xhr.onload = function onload() {
    // allow success when 2xx status
    // see https://github.com/react-component/upload/issues/34
    if (xhr.status < 200 || xhr.status >= 300) {
      return option.onError(getError(option, xhr), getBody(xhr));
    }

    return option.onSuccess(getBody(xhr), xhr);
  };

  xhr.open(option.method, option.action, true); // Has to be after `.open()`. See https://github.com/enyo/dropzone/issues/179

  if (option.withCredentials && 'withCredentials' in xhr) {
    xhr.withCredentials = true;
  }

  var headers = option.headers || {}; // when set headers['X-Requested-With'] = null , can close default XHR header
  // see https://github.com/react-component/upload/issues/33

  if (headers['X-Requested-With'] !== null) {
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
  }

  Object.keys(headers).forEach(function (h) {
    if (headers[h] !== null) {
      xhr.setRequestHeader(h, headers[h]);
    }
  });
  xhr.send(formData);
  return {
    abort: function abort() {
      xhr.abort();
    }
  };
}

/***/ }),

/***/ "./node_modules/rc-upload/es/traverseFileTree.js":
/*!*******************************************************!*\
  !*** ./node_modules/rc-upload/es/traverseFileTree.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
function loopFiles(item, callback) {
  var dirReader = item.createReader();
  var fileList = [];

  function sequence() {
    dirReader.readEntries(function (entries) {
      var entryList = Array.prototype.slice.apply(entries);
      fileList = fileList.concat(entryList); // Check if all the file has been viewed

      var isFinished = !entryList.length;

      if (isFinished) {
        callback(fileList);
      } else {
        sequence();
      }
    });
  }

  sequence();
}

var traverseFileTree = function traverseFileTree(files, callback, isAccepted) {
  // eslint-disable-next-line @typescript-eslint/naming-convention
  var _traverseFileTree = function _traverseFileTree(item, path) {
    // eslint-disable-next-line no-param-reassign
    item.path = path || '';

    if (item.isFile) {
      item.file(function (file) {
        if (isAccepted(file)) {
          // https://github.com/ant-design/ant-design/issues/16426
          if (item.fullPath && !file.webkitRelativePath) {
            Object.defineProperties(file, {
              webkitRelativePath: {
                writable: true
              }
            }); // eslint-disable-next-line no-param-reassign

            file.webkitRelativePath = item.fullPath.replace(/^\//, '');
            Object.defineProperties(file, {
              webkitRelativePath: {
                writable: false
              }
            });
          }

          callback([file]);
        }
      });
    } else if (item.isDirectory) {
      loopFiles(item, function (entries) {
        entries.forEach(function (entryItem) {
          _traverseFileTree(entryItem, "".concat(path).concat(item.name, "/"));
        });
      });
    }
  };

  files.forEach(function (file) {
    _traverseFileTree(file.webkitGetAsEntry());
  });
};

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (traverseFileTree);

/***/ }),

/***/ "./node_modules/rc-upload/es/uid.js":
/*!******************************************!*\
  !*** ./node_modules/rc-upload/es/uid.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ uid)
/* harmony export */ });
var now = +new Date();
var index = 0;
function uid() {
  // eslint-disable-next-line no-plusplus
  return "rc-upload-".concat(now, "-").concat(++index);
}

/***/ }),

/***/ "./node_modules/rc-util/es/Children/toArray.js":
/*!*****************************************************!*\
  !*** ./node_modules/rc-util/es/Children/toArray.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ toArray)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react_is__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-is */ "./node_modules/react-is/index.js");


function toArray(children) {
  var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var ret = [];
  react__WEBPACK_IMPORTED_MODULE_0__.Children.forEach(children, function (child) {
    if ((child === undefined || child === null) && !option.keepEmpty) {
      return;
    }

    if (Array.isArray(child)) {
      ret = ret.concat(toArray(child));
    } else if ((0,react_is__WEBPACK_IMPORTED_MODULE_1__.isFragment)(child) && child.props) {
      ret = ret.concat(toArray(child.props.children, option));
    } else {
      ret.push(child);
    }
  });
  return ret;
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/addEventListener.js":
/*!*********************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/addEventListener.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ addEventListenerWrap)
/* harmony export */ });
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-dom */ "./node_modules/react-dom/index.js");

function addEventListenerWrap(target, eventType, cb, option) {
  /* eslint camelcase: 2 */
  var callback = react_dom__WEBPACK_IMPORTED_MODULE_0__.unstable_batchedUpdates ? function run(e) {
    react_dom__WEBPACK_IMPORTED_MODULE_0__.unstable_batchedUpdates(cb, e);
  } : cb;

  if (target.addEventListener) {
    target.addEventListener(eventType, callback, option);
  }

  return {
    remove: function remove() {
      if (target.removeEventListener) {
        target.removeEventListener(eventType, callback);
      }
    }
  };
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/canUseDom.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/canUseDom.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ canUseDom)
/* harmony export */ });
function canUseDom() {
  return !!(typeof window !== 'undefined' && window.document && window.document.createElement);
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/contains.js":
/*!*************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/contains.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ contains)
/* harmony export */ });
function contains(root, n) {
  if (!root) {
    return false;
  }

  return root.contains(n);
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/css.js":
/*!********************************************!*\
  !*** ./node_modules/rc-util/es/Dom/css.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "get": () => (/* binding */ get),
/* harmony export */   "set": () => (/* binding */ set),
/* harmony export */   "getOuterWidth": () => (/* binding */ getOuterWidth),
/* harmony export */   "getOuterHeight": () => (/* binding */ getOuterHeight),
/* harmony export */   "getDocSize": () => (/* binding */ getDocSize),
/* harmony export */   "getClientSize": () => (/* binding */ getClientSize),
/* harmony export */   "getScroll": () => (/* binding */ getScroll),
/* harmony export */   "getOffset": () => (/* binding */ getOffset)
/* harmony export */ });
/* eslint-disable no-nested-ternary */
var PIXEL_PATTERN = /margin|padding|width|height|max|min|offset/;
var removePixel = {
  left: true,
  top: true
};
var floatMap = {
  cssFloat: 1,
  styleFloat: 1,
  float: 1
};

function getComputedStyle(node) {
  return node.nodeType === 1 ? node.ownerDocument.defaultView.getComputedStyle(node, null) : {};
}

function getStyleValue(node, type, value) {
  type = type.toLowerCase();

  if (value === 'auto') {
    if (type === 'height') {
      return node.offsetHeight;
    }

    if (type === 'width') {
      return node.offsetWidth;
    }
  }

  if (!(type in removePixel)) {
    removePixel[type] = PIXEL_PATTERN.test(type);
  }

  return removePixel[type] ? parseFloat(value) || 0 : value;
}

function get(node, name) {
  var length = arguments.length;
  var style = getComputedStyle(node);
  name = floatMap[name] ? 'cssFloat' in node.style ? 'cssFloat' : 'styleFloat' : name;
  return length === 1 ? style : getStyleValue(node, name, style[name] || node.style[name]);
}
function set(node, name, value) {
  var length = arguments.length;
  name = floatMap[name] ? 'cssFloat' in node.style ? 'cssFloat' : 'styleFloat' : name;

  if (length === 3) {
    if (typeof value === 'number' && PIXEL_PATTERN.test(name)) {
      value = "".concat(value, "px");
    }

    node.style[name] = value; // Number

    return value;
  }

  for (var x in name) {
    if (name.hasOwnProperty(x)) {
      set(node, x, name[x]);
    }
  }

  return getComputedStyle(node);
}
function getOuterWidth(el) {
  if (el === document.body) {
    return document.documentElement.clientWidth;
  }

  return el.offsetWidth;
}
function getOuterHeight(el) {
  if (el === document.body) {
    return window.innerHeight || document.documentElement.clientHeight;
  }

  return el.offsetHeight;
}
function getDocSize() {
  var width = Math.max(document.documentElement.scrollWidth, document.body.scrollWidth);
  var height = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);
  return {
    width: width,
    height: height
  };
}
function getClientSize() {
  var width = document.documentElement.clientWidth;
  var height = window.innerHeight || document.documentElement.clientHeight;
  return {
    width: width,
    height: height
  };
}
function getScroll() {
  return {
    scrollLeft: Math.max(document.documentElement.scrollLeft, document.body.scrollLeft),
    scrollTop: Math.max(document.documentElement.scrollTop, document.body.scrollTop)
  };
}
function getOffset(node) {
  var box = node.getBoundingClientRect();
  var docElem = document.documentElement; // < ie8  win.pageXOffset,  docElem.scrollLeft

  return {
    left: box.left + (window.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || document.body.clientLeft || 0),
    top: box.top + (window.pageYOffset || docElem.scrollTop) - (docElem.clientTop || document.body.clientTop || 0)
  };
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/dynamicCSS.js":
/*!***************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/dynamicCSS.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "injectCSS": () => (/* binding */ injectCSS),
/* harmony export */   "updateCSS": () => (/* binding */ updateCSS)
/* harmony export */ });
/* harmony import */ var _canUseDom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./canUseDom */ "./node_modules/rc-util/es/Dom/canUseDom.js");

var MARK_KEY = "rc-util-key";

function getContainer(option) {
  if (option.attachTo) {
    return option.attachTo;
  }

  var head = document.querySelector('head');
  return head || document.body;
}

function injectCSS(css) {
  var _option$csp;

  var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!(0,_canUseDom__WEBPACK_IMPORTED_MODULE_0__.default)()) {
    return null;
  }

  var styleNode = document.createElement('style');

  if ((_option$csp = option.csp) === null || _option$csp === void 0 ? void 0 : _option$csp.nonce) {
    var _option$csp2;

    styleNode.nonce = (_option$csp2 = option.csp) === null || _option$csp2 === void 0 ? void 0 : _option$csp2.nonce;
  }

  styleNode.innerHTML = css;
  var container = getContainer(option);
  var firstChild = container.firstChild;

  if (option.prepend && container.prepend) {
    // Use `prepend` first
    container.prepend(styleNode);
  } else if (option.prepend && firstChild) {
    // Fallback to `insertBefore` like IE not support `prepend`
    container.insertBefore(styleNode, firstChild);
  } else {
    container.appendChild(styleNode);
  }

  return styleNode;
}
var containerCache = new Map();
function updateCSS(css, key) {
  var option = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  var container = getContainer(option); // Get real parent

  if (!containerCache.has(container)) {
    var placeholderStyle = injectCSS('', option);
    var parentNode = placeholderStyle.parentNode;
    containerCache.set(container, parentNode);
    parentNode.removeChild(placeholderStyle);
  }

  var existNode = Array.from(containerCache.get(container).children).find(function (node) {
    return node.tagName === 'STYLE' && node[MARK_KEY] === key;
  });

  if (existNode) {
    var _option$csp3, _option$csp4;

    if (((_option$csp3 = option.csp) === null || _option$csp3 === void 0 ? void 0 : _option$csp3.nonce) && existNode.nonce !== ((_option$csp4 = option.csp) === null || _option$csp4 === void 0 ? void 0 : _option$csp4.nonce)) {
      var _option$csp5;

      existNode.nonce = (_option$csp5 = option.csp) === null || _option$csp5 === void 0 ? void 0 : _option$csp5.nonce;
    }

    if (existNode.innerHTML !== css) {
      existNode.innerHTML = css;
    }

    return existNode;
  }

  var newNode = injectCSS(css, option);
  newNode[MARK_KEY] = key;
  return newNode;
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/findDOMNode.js":
/*!****************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/findDOMNode.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ findDOMNode)
/* harmony export */ });
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-dom */ "./node_modules/react-dom/index.js");

/**
 * Return if a node is a DOM node. Else will return by `findDOMNode`
 */

function findDOMNode(node) {
  if (node instanceof HTMLElement) {
    return node;
  }

  return react_dom__WEBPACK_IMPORTED_MODULE_0__.findDOMNode(node);
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/focus.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-util/es/Dom/focus.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getFocusNodeList": () => (/* binding */ getFocusNodeList),
/* harmony export */   "saveLastFocusNode": () => (/* binding */ saveLastFocusNode),
/* harmony export */   "clearLastFocusNode": () => (/* binding */ clearLastFocusNode),
/* harmony export */   "backLastFocusNode": () => (/* binding */ backLastFocusNode),
/* harmony export */   "limitTabRange": () => (/* binding */ limitTabRange)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _isVisible__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./isVisible */ "./node_modules/rc-util/es/Dom/isVisible.js");



function focusable(node) {
  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

  if ((0,_isVisible__WEBPACK_IMPORTED_MODULE_1__.default)(node)) {
    var nodeName = node.nodeName.toLowerCase();
    var isFocusableElement = // Focusable element
    ['input', 'select', 'textarea', 'button'].includes(nodeName) || // Editable element
    node.isContentEditable || // Anchor with href element
    nodeName === 'a' && !!node.getAttribute('href'); // Get tabIndex

    var tabIndexAttr = node.getAttribute('tabindex');
    var tabIndexNum = Number(tabIndexAttr); // Parse as number if validate

    var tabIndex = null;

    if (tabIndexAttr && !Number.isNaN(tabIndexNum)) {
      tabIndex = tabIndexNum;
    } else if (isFocusableElement && tabIndex === null) {
      tabIndex = 0;
    } // Block focusable if disabled


    if (isFocusableElement && node.disabled) {
      tabIndex = null;
    }

    return tabIndex !== null && (tabIndex >= 0 || includePositive && tabIndex < 0);
  }

  return false;
}

function getFocusNodeList(node) {
  var includePositive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

  var res = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.default)(node.querySelectorAll('*')).filter(function (child) {
    return focusable(child, includePositive);
  });

  if (focusable(node, includePositive)) {
    res.unshift(node);
  }

  return res;
}
var lastFocusElement = null;
/** @deprecated Do not use since this may failed when used in async */

function saveLastFocusNode() {
  lastFocusElement = document.activeElement;
}
/** @deprecated Do not use since this may failed when used in async */

function clearLastFocusNode() {
  lastFocusElement = null;
}
/** @deprecated Do not use since this may failed when used in async */

function backLastFocusNode() {
  if (lastFocusElement) {
    try {
      // 
      lastFocusElement.focus();
      /* eslint-disable no-empty */
    } catch (e) {// empty
    }
    /* eslint-enable no-empty */

  }
}
function limitTabRange(node, e) {
  if (e.keyCode === 9) {
    var tabNodeList = getFocusNodeList(node);
    var lastTabNode = tabNodeList[e.shiftKey ? 0 : tabNodeList.length - 1];
    var leavingTab = lastTabNode === document.activeElement || node === document.activeElement;

    if (leavingTab) {
      var target = tabNodeList[e.shiftKey ? tabNodeList.length - 1 : 0];
      target.focus();
      e.preventDefault();
    }
  }
}

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/isVisible.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/isVisible.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (element) {
  if (!element) {
    return false;
  }

  if (element.offsetParent) {
    return true;
  }

  if (element.getBBox) {
    var box = element.getBBox();

    if (box.width || box.height) {
      return true;
    }
  }

  if (element.getBoundingClientRect) {
    var _box = element.getBoundingClientRect();

    if (_box.width || _box.height) {
      return true;
    }
  }

  return false;
});

/***/ }),

/***/ "./node_modules/rc-util/es/Dom/scrollLocker.js":
/*!*****************************************************!*\
  !*** ./node_modules/rc-util/es/Dom/scrollLocker.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ ScrollLocker)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _getScrollBarSize__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../getScrollBarSize */ "./node_modules/rc-util/es/getScrollBarSize.js");
/* harmony import */ var _setStyle__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../setStyle */ "./node_modules/rc-util/es/setStyle.js");




var locks = [];
var scrollingEffectClassName = 'ant-scrolling-effect';
var scrollingEffectClassNameReg = new RegExp("".concat(scrollingEffectClassName), 'g');
var uuid = 0; // https://github.com/ant-design/ant-design/issues/19340
// https://github.com/ant-design/ant-design/issues/19332

var cacheStyle = new Map();

var ScrollLocker = function ScrollLocker(options) {
  var _this = this;

  (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.default)(this, ScrollLocker);

  this.getContainer = function () {
    var _this$options;

    return (_this$options = _this.options) === null || _this$options === void 0 ? void 0 : _this$options.container;
  }; // if options change...


  this.reLock = function (options) {
    var findLock = locks.find(function (_ref) {
      var target = _ref.target;
      return target === _this.lockTarget;
    });

    if (findLock) {
      _this.unLock();
    }

    _this.options = options;

    if (findLock) {
      findLock.options = options;

      _this.lock();
    }
  };

  this.lock = function () {
    var _this$options3;

    // If lockTarget exist return
    if (locks.some(function (_ref2) {
      var target = _ref2.target;
      return target === _this.lockTarget;
    })) {
      return;
    } // If same container effect, return


    if (locks.some(function (_ref3) {
      var _this$options2;

      var options = _ref3.options;
      return (options === null || options === void 0 ? void 0 : options.container) === ((_this$options2 = _this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.container);
    })) {
      locks = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.default)(locks), [{
        target: _this.lockTarget,
        options: _this.options
      }]);
      return;
    }

    var scrollBarSize = 0;
    var container = ((_this$options3 = _this.options) === null || _this$options3 === void 0 ? void 0 : _this$options3.container) || document.body;

    if (container === document.body && window.innerWidth - document.documentElement.clientWidth > 0 || container.scrollHeight > container.clientHeight) {
      scrollBarSize = (0,_getScrollBarSize__WEBPACK_IMPORTED_MODULE_2__.default)();
    }

    var containerClassName = container.className;

    if (locks.filter(function (_ref4) {
      var _this$options4;

      var options = _ref4.options;
      return (options === null || options === void 0 ? void 0 : options.container) === ((_this$options4 = _this.options) === null || _this$options4 === void 0 ? void 0 : _this$options4.container);
    }).length === 0) {
      cacheStyle.set(container, (0,_setStyle__WEBPACK_IMPORTED_MODULE_3__.default)({
        width: "calc(100% - ".concat(scrollBarSize, "px)"),
        overflow: 'hidden',
        overflowX: 'hidden',
        overflowY: 'hidden'
      }, {
        element: container
      }));
    } // https://github.com/ant-design/ant-design/issues/19729


    if (!scrollingEffectClassNameReg.test(containerClassName)) {
      var addClassName = "".concat(containerClassName, " ").concat(scrollingEffectClassName);
      container.className = addClassName.trim();
    }

    locks = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.default)(locks), [{
      target: _this.lockTarget,
      options: _this.options
    }]);
  };

  this.unLock = function () {
    var _this$options5;

    var findLock = locks.find(function (_ref5) {
      var target = _ref5.target;
      return target === _this.lockTarget;
    });
    locks = locks.filter(function (_ref6) {
      var target = _ref6.target;
      return target !== _this.lockTarget;
    });

    if (!findLock || locks.some(function (_ref7) {
      var _findLock$options;

      var options = _ref7.options;
      return (options === null || options === void 0 ? void 0 : options.container) === ((_findLock$options = findLock.options) === null || _findLock$options === void 0 ? void 0 : _findLock$options.container);
    })) {
      return;
    } // Remove Effect


    var container = ((_this$options5 = _this.options) === null || _this$options5 === void 0 ? void 0 : _this$options5.container) || document.body;
    var containerClassName = container.className;
    if (!scrollingEffectClassNameReg.test(containerClassName)) return;
    (0,_setStyle__WEBPACK_IMPORTED_MODULE_3__.default)(cacheStyle.get(container), {
      element: container
    });
    cacheStyle.delete(container);
    container.className = container.className.replace(scrollingEffectClassNameReg, '').trim();
  }; // eslint-disable-next-line no-plusplus


  this.lockTarget = uuid++;
  this.options = options;
};



/***/ }),

/***/ "./node_modules/rc-util/es/KeyCode.js":
/*!********************************************!*\
  !*** ./node_modules/rc-util/es/KeyCode.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/**
 * @ignore
 * some key-codes definition and utils from closure-library
 * @author yiminghe@gmail.com
 */
var KeyCode = {
  /**
   * MAC_ENTER
   */
  MAC_ENTER: 3,

  /**
   * BACKSPACE
   */
  BACKSPACE: 8,

  /**
   * TAB
   */
  TAB: 9,

  /**
   * NUMLOCK on FF/Safari Mac
   */
  NUM_CENTER: 12,

  /**
   * ENTER
   */
  ENTER: 13,

  /**
   * SHIFT
   */
  SHIFT: 16,

  /**
   * CTRL
   */
  CTRL: 17,

  /**
   * ALT
   */
  ALT: 18,

  /**
   * PAUSE
   */
  PAUSE: 19,

  /**
   * CAPS_LOCK
   */
  CAPS_LOCK: 20,

  /**
   * ESC
   */
  ESC: 27,

  /**
   * SPACE
   */
  SPACE: 32,

  /**
   * PAGE_UP
   */
  PAGE_UP: 33,

  /**
   * PAGE_DOWN
   */
  PAGE_DOWN: 34,

  /**
   * END
   */
  END: 35,

  /**
   * HOME
   */
  HOME: 36,

  /**
   * LEFT
   */
  LEFT: 37,

  /**
   * UP
   */
  UP: 38,

  /**
   * RIGHT
   */
  RIGHT: 39,

  /**
   * DOWN
   */
  DOWN: 40,

  /**
   * PRINT_SCREEN
   */
  PRINT_SCREEN: 44,

  /**
   * INSERT
   */
  INSERT: 45,

  /**
   * DELETE
   */
  DELETE: 46,

  /**
   * ZERO
   */
  ZERO: 48,

  /**
   * ONE
   */
  ONE: 49,

  /**
   * TWO
   */
  TWO: 50,

  /**
   * THREE
   */
  THREE: 51,

  /**
   * FOUR
   */
  FOUR: 52,

  /**
   * FIVE
   */
  FIVE: 53,

  /**
   * SIX
   */
  SIX: 54,

  /**
   * SEVEN
   */
  SEVEN: 55,

  /**
   * EIGHT
   */
  EIGHT: 56,

  /**
   * NINE
   */
  NINE: 57,

  /**
   * QUESTION_MARK
   */
  QUESTION_MARK: 63,

  /**
   * A
   */
  A: 65,

  /**
   * B
   */
  B: 66,

  /**
   * C
   */
  C: 67,

  /**
   * D
   */
  D: 68,

  /**
   * E
   */
  E: 69,

  /**
   * F
   */
  F: 70,

  /**
   * G
   */
  G: 71,

  /**
   * H
   */
  H: 72,

  /**
   * I
   */
  I: 73,

  /**
   * J
   */
  J: 74,

  /**
   * K
   */
  K: 75,

  /**
   * L
   */
  L: 76,

  /**
   * M
   */
  M: 77,

  /**
   * N
   */
  N: 78,

  /**
   * O
   */
  O: 79,

  /**
   * P
   */
  P: 80,

  /**
   * Q
   */
  Q: 81,

  /**
   * R
   */
  R: 82,

  /**
   * S
   */
  S: 83,

  /**
   * T
   */
  T: 84,

  /**
   * U
   */
  U: 85,

  /**
   * V
   */
  V: 86,

  /**
   * W
   */
  W: 87,

  /**
   * X
   */
  X: 88,

  /**
   * Y
   */
  Y: 89,

  /**
   * Z
   */
  Z: 90,

  /**
   * META
   */
  META: 91,

  /**
   * WIN_KEY_RIGHT
   */
  WIN_KEY_RIGHT: 92,

  /**
   * CONTEXT_MENU
   */
  CONTEXT_MENU: 93,

  /**
   * NUM_ZERO
   */
  NUM_ZERO: 96,

  /**
   * NUM_ONE
   */
  NUM_ONE: 97,

  /**
   * NUM_TWO
   */
  NUM_TWO: 98,

  /**
   * NUM_THREE
   */
  NUM_THREE: 99,

  /**
   * NUM_FOUR
   */
  NUM_FOUR: 100,

  /**
   * NUM_FIVE
   */
  NUM_FIVE: 101,

  /**
   * NUM_SIX
   */
  NUM_SIX: 102,

  /**
   * NUM_SEVEN
   */
  NUM_SEVEN: 103,

  /**
   * NUM_EIGHT
   */
  NUM_EIGHT: 104,

  /**
   * NUM_NINE
   */
  NUM_NINE: 105,

  /**
   * NUM_MULTIPLY
   */
  NUM_MULTIPLY: 106,

  /**
   * NUM_PLUS
   */
  NUM_PLUS: 107,

  /**
   * NUM_MINUS
   */
  NUM_MINUS: 109,

  /**
   * NUM_PERIOD
   */
  NUM_PERIOD: 110,

  /**
   * NUM_DIVISION
   */
  NUM_DIVISION: 111,

  /**
   * F1
   */
  F1: 112,

  /**
   * F2
   */
  F2: 113,

  /**
   * F3
   */
  F3: 114,

  /**
   * F4
   */
  F4: 115,

  /**
   * F5
   */
  F5: 116,

  /**
   * F6
   */
  F6: 117,

  /**
   * F7
   */
  F7: 118,

  /**
   * F8
   */
  F8: 119,

  /**
   * F9
   */
  F9: 120,

  /**
   * F10
   */
  F10: 121,

  /**
   * F11
   */
  F11: 122,

  /**
   * F12
   */
  F12: 123,

  /**
   * NUMLOCK
   */
  NUMLOCK: 144,

  /**
   * SEMICOLON
   */
  SEMICOLON: 186,

  /**
   * DASH
   */
  DASH: 189,

  /**
   * EQUALS
   */
  EQUALS: 187,

  /**
   * COMMA
   */
  COMMA: 188,

  /**
   * PERIOD
   */
  PERIOD: 190,

  /**
   * SLASH
   */
  SLASH: 191,

  /**
   * APOSTROPHE
   */
  APOSTROPHE: 192,

  /**
   * SINGLE_QUOTE
   */
  SINGLE_QUOTE: 222,

  /**
   * OPEN_SQUARE_BRACKET
   */
  OPEN_SQUARE_BRACKET: 219,

  /**
   * BACKSLASH
   */
  BACKSLASH: 220,

  /**
   * CLOSE_SQUARE_BRACKET
   */
  CLOSE_SQUARE_BRACKET: 221,

  /**
   * WIN_KEY
   */
  WIN_KEY: 224,

  /**
   * MAC_FF_META
   */
  MAC_FF_META: 224,

  /**
   * WIN_IME
   */
  WIN_IME: 229,
  // ======================== Function ========================

  /**
   * whether text and modified key is entered at the same time.
   */
  isTextModifyingKeyEvent: function isTextModifyingKeyEvent(e) {
    var keyCode = e.keyCode;

    if (e.altKey && !e.ctrlKey || e.metaKey || // Function keys don't generate text
    keyCode >= KeyCode.F1 && keyCode <= KeyCode.F12) {
      return false;
    } // The following keys are quite harmless, even in combination with
    // CTRL, ALT or SHIFT.


    switch (keyCode) {
      case KeyCode.ALT:
      case KeyCode.CAPS_LOCK:
      case KeyCode.CONTEXT_MENU:
      case KeyCode.CTRL:
      case KeyCode.DOWN:
      case KeyCode.END:
      case KeyCode.ESC:
      case KeyCode.HOME:
      case KeyCode.INSERT:
      case KeyCode.LEFT:
      case KeyCode.MAC_FF_META:
      case KeyCode.META:
      case KeyCode.NUMLOCK:
      case KeyCode.NUM_CENTER:
      case KeyCode.PAGE_DOWN:
      case KeyCode.PAGE_UP:
      case KeyCode.PAUSE:
      case KeyCode.PRINT_SCREEN:
      case KeyCode.RIGHT:
      case KeyCode.SHIFT:
      case KeyCode.UP:
      case KeyCode.WIN_KEY:
      case KeyCode.WIN_KEY_RIGHT:
        return false;

      default:
        return true;
    }
  },

  /**
   * whether character is entered.
   */
  isCharacterKey: function isCharacterKey(keyCode) {
    if (keyCode >= KeyCode.ZERO && keyCode <= KeyCode.NINE) {
      return true;
    }

    if (keyCode >= KeyCode.NUM_ZERO && keyCode <= KeyCode.NUM_MULTIPLY) {
      return true;
    }

    if (keyCode >= KeyCode.A && keyCode <= KeyCode.Z) {
      return true;
    } // Safari sends zero key code for non-latin characters.


    if (window.navigator.userAgent.indexOf('WebKit') !== -1 && keyCode === 0) {
      return true;
    }

    switch (keyCode) {
      case KeyCode.SPACE:
      case KeyCode.QUESTION_MARK:
      case KeyCode.NUM_PLUS:
      case KeyCode.NUM_MINUS:
      case KeyCode.NUM_PERIOD:
      case KeyCode.NUM_DIVISION:
      case KeyCode.SEMICOLON:
      case KeyCode.DASH:
      case KeyCode.EQUALS:
      case KeyCode.COMMA:
      case KeyCode.PERIOD:
      case KeyCode.SLASH:
      case KeyCode.APOSTROPHE:
      case KeyCode.SINGLE_QUOTE:
      case KeyCode.OPEN_SQUARE_BRACKET:
      case KeyCode.BACKSLASH:
      case KeyCode.CLOSE_SQUARE_BRACKET:
        return true;

      default:
        return false;
    }
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (KeyCode);

/***/ }),

/***/ "./node_modules/rc-util/es/Portal.js":
/*!*******************************************!*\
  !*** ./node_modules/rc-util/es/Portal.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ "./node_modules/react-dom/index.js");
/* harmony import */ var _Dom_canUseDom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Dom/canUseDom */ "./node_modules/rc-util/es/Dom/canUseDom.js");



var Portal = (0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(function (props, ref) {
  var didUpdate = props.didUpdate,
      getContainer = props.getContainer,
      children = props.children;
  var containerRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(); // Ref return nothing, only for wrapper check exist

  (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, function () {
    return {};
  }); // Create container in client side with sync to avoid useEffect not get ref

  var initRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);

  if (!initRef.current && (0,_Dom_canUseDom__WEBPACK_IMPORTED_MODULE_2__.default)()) {
    containerRef.current = getContainer();
    initRef.current = true;
  } // [Legacy] Used by `rc-trigger`


  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {
    didUpdate === null || didUpdate === void 0 ? void 0 : didUpdate(props);
  });
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {
    return function () {
      var _containerRef$current, _containerRef$current2;

      // [Legacy] This should not be handle by Portal but parent PortalWrapper instead.
      // Since some component use `Portal` directly, we have to keep the logic here.
      (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : (_containerRef$current2 = _containerRef$current.parentNode) === null || _containerRef$current2 === void 0 ? void 0 : _containerRef$current2.removeChild(containerRef.current);
    };
  }, []);
  return containerRef.current ? react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal(children, containerRef.current) : null;
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Portal);

/***/ }),

/***/ "./node_modules/rc-util/es/PortalWrapper.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-util/es/PortalWrapper.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getOpenCount": () => (/* binding */ getOpenCount),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/classCallCheck */ "./node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/createClass */ "./node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/inherits */ "./node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/esm/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js");
/* harmony import */ var _babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/esm/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var _raf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./raf */ "./node_modules/rc-util/es/raf.js");
/* harmony import */ var _Portal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Portal */ "./node_modules/rc-util/es/Portal.js");
/* harmony import */ var _Dom_canUseDom__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Dom/canUseDom */ "./node_modules/rc-util/es/Dom/canUseDom.js");
/* harmony import */ var _switchScrollingEffect__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./switchScrollingEffect */ "./node_modules/rc-util/es/switchScrollingEffect.js");
/* harmony import */ var _setStyle__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./setStyle */ "./node_modules/rc-util/es/setStyle.js");
/* harmony import */ var _Dom_scrollLocker__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Dom/scrollLocker */ "./node_modules/rc-util/es/Dom/scrollLocker.js");







function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0,_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0,_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0,_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

/* eslint-disable no-underscore-dangle,react/require-default-props */







var openCount = 0;
var supportDom = (0,_Dom_canUseDom__WEBPACK_IMPORTED_MODULE_9__.default)();
/** @private Test usage only */

function getOpenCount() {
  return  false ? 0 : 0;
} // https://github.com/ant-design/ant-design/issues/19340
// https://github.com/ant-design/ant-design/issues/19332

var cacheOverflow = {};

var getParent = function getParent(getContainer) {
  if (!supportDom) {
    return null;
  }

  if (getContainer) {
    if (typeof getContainer === 'string') {
      return document.querySelectorAll(getContainer)[0];
    }

    if (typeof getContainer === 'function') {
      return getContainer();
    }

    if ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_5__.default)(getContainer) === 'object' && getContainer instanceof window.HTMLElement) {
      return getContainer;
    }
  }

  return document.body;
};

var PortalWrapper = /*#__PURE__*/function (_React$Component) {
  (0,_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_2__.default)(PortalWrapper, _React$Component);

  var _super = _createSuper(PortalWrapper);

  function PortalWrapper(props) {
    var _this;

    (0,_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.default)(this, PortalWrapper);

    _this = _super.call(this, props);
    _this.componentRef = react__WEBPACK_IMPORTED_MODULE_6__.createRef();

    _this.updateScrollLocker = function (prevProps) {
      var _ref = prevProps || {},
          prevVisible = _ref.visible;

      var _this$props = _this.props,
          getContainer = _this$props.getContainer,
          visible = _this$props.visible;

      if (visible && visible !== prevVisible && supportDom && getParent(getContainer) !== _this.scrollLocker.getContainer()) {
        _this.scrollLocker.reLock({
          container: getParent(getContainer)
        });
      }
    };

    _this.updateOpenCount = function (prevProps) {
      var _ref2 = prevProps || {},
          prevVisible = _ref2.visible,
          prevGetContainer = _ref2.getContainer;

      var _this$props2 = _this.props,
          visible = _this$props2.visible,
          getContainer = _this$props2.getContainer; // Update count

      if (visible !== prevVisible && supportDom && getParent(getContainer) === document.body) {
        if (visible && !prevVisible) {
          openCount += 1;
        } else if (prevProps) {
          openCount -= 1;
        }
      } // Clean up container if needed


      var getContainerIsFunc = typeof getContainer === 'function' && typeof prevGetContainer === 'function';

      if (getContainerIsFunc ? getContainer.toString() !== prevGetContainer.toString() : getContainer !== prevGetContainer) {
        _this.removeCurrentContainer();
      }
    };

    _this.attachToParent = function () {
      var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (force || _this.container && !_this.container.parentNode) {
        var parent = getParent(_this.props.getContainer);

        if (parent) {
          parent.appendChild(_this.container);
          return true;
        }

        return false;
      }

      return true;
    };

    _this.getContainer = function () {
      if (!supportDom) {
        return null;
      }

      if (!_this.container) {
        _this.container = document.createElement('div');

        _this.attachToParent(true);
      }

      _this.setWrapperClassName();

      return _this.container;
    };

    _this.setWrapperClassName = function () {
      var wrapperClassName = _this.props.wrapperClassName;

      if (_this.container && wrapperClassName && wrapperClassName !== _this.container.className) {
        _this.container.className = wrapperClassName;
      }
    };

    _this.removeCurrentContainer = function () {
      var _this$container, _this$container$paren;

      // Portal will remove from `parentNode`.
      // Let's handle this again to avoid refactor issue.
      (_this$container = _this.container) === null || _this$container === void 0 ? void 0 : (_this$container$paren = _this$container.parentNode) === null || _this$container$paren === void 0 ? void 0 : _this$container$paren.removeChild(_this.container);
    };
    /**
     * Enhance ./switchScrollingEffect
     * 1. Simulate document body scroll bar with
     * 2. Record body has overflow style and recover when all of PortalWrapper invisible
     * 3. Disable body scroll when PortalWrapper has open
     *
     * @memberof PortalWrapper
     */


    _this.switchScrollingEffect = function () {
      if (openCount === 1 && !Object.keys(cacheOverflow).length) {
        (0,_switchScrollingEffect__WEBPACK_IMPORTED_MODULE_10__.default)(); // Must be set after switchScrollingEffect

        cacheOverflow = (0,_setStyle__WEBPACK_IMPORTED_MODULE_11__.default)({
          overflow: 'hidden',
          overflowX: 'hidden',
          overflowY: 'hidden'
        });
      } else if (!openCount) {
        (0,_setStyle__WEBPACK_IMPORTED_MODULE_11__.default)(cacheOverflow);
        cacheOverflow = {};
        (0,_switchScrollingEffect__WEBPACK_IMPORTED_MODULE_10__.default)(true);
      }
    };

    _this.scrollLocker = new _Dom_scrollLocker__WEBPACK_IMPORTED_MODULE_12__.default({
      container: getParent(props.getContainer)
    });
    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.default)(PortalWrapper, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this2 = this;

      this.updateOpenCount();

      if (!this.attachToParent()) {
        this.rafId = (0,_raf__WEBPACK_IMPORTED_MODULE_7__.default)(function () {
          _this2.forceUpdate();
        });
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      this.updateOpenCount(prevProps);
      this.updateScrollLocker(prevProps);
      this.setWrapperClassName();
      this.attachToParent();
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      var _this$props3 = this.props,
          visible = _this$props3.visible,
          getContainer = _this$props3.getContainer;

      if (supportDom && getParent(getContainer) === document.body) {
        //  render  func 
        openCount = visible && openCount ? openCount - 1 : openCount;
      }

      this.removeCurrentContainer();
      _raf__WEBPACK_IMPORTED_MODULE_7__.default.cancel(this.rafId);
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props4 = this.props,
          children = _this$props4.children,
          forceRender = _this$props4.forceRender,
          visible = _this$props4.visible;
      var portal = null;
      var childProps = {
        getOpenCount: function getOpenCount() {
          return openCount;
        },
        getContainer: this.getContainer,
        switchScrollingEffect: this.switchScrollingEffect,
        scrollLocker: this.scrollLocker
      };

      if (forceRender || visible || this.componentRef.current) {
        portal = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__.createElement(_Portal__WEBPACK_IMPORTED_MODULE_8__.default, {
          getContainer: this.getContainer,
          ref: this.componentRef
        }, children(childProps));
      }

      return portal;
    }
  }]);

  return PortalWrapper;
}(react__WEBPACK_IMPORTED_MODULE_6__.Component);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PortalWrapper);

/***/ }),

/***/ "./node_modules/rc-util/es/getScrollBarSize.js":
/*!*****************************************************!*\
  !*** ./node_modules/rc-util/es/getScrollBarSize.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ getScrollBarSize),
/* harmony export */   "getTargetScrollBarSize": () => (/* binding */ getTargetScrollBarSize)
/* harmony export */ });
/* eslint-disable no-param-reassign */
var cached;
function getScrollBarSize(fresh) {
  if (typeof document === 'undefined') {
    return 0;
  }

  if (fresh || cached === undefined) {
    var inner = document.createElement('div');
    inner.style.width = '100%';
    inner.style.height = '200px';
    var outer = document.createElement('div');
    var outerStyle = outer.style;
    outerStyle.position = 'absolute';
    outerStyle.top = '0';
    outerStyle.left = '0';
    outerStyle.pointerEvents = 'none';
    outerStyle.visibility = 'hidden';
    outerStyle.width = '200px';
    outerStyle.height = '150px';
    outerStyle.overflow = 'hidden';
    outer.appendChild(inner);
    document.body.appendChild(outer);
    var widthContained = inner.offsetWidth;
    outer.style.overflow = 'scroll';
    var widthScroll = inner.offsetWidth;

    if (widthContained === widthScroll) {
      widthScroll = outer.clientWidth;
    }

    document.body.removeChild(outer);
    cached = widthContained - widthScroll;
  }

  return cached;
}

function ensureSize(str) {
  var match = str.match(/^(.*)px$/);
  var value = Number(match === null || match === void 0 ? void 0 : match[1]);
  return Number.isNaN(value) ? getScrollBarSize() : value;
}

function getTargetScrollBarSize(target) {
  if (typeof document === 'undefined' || !target || !(target instanceof Element)) {
    return {
      width: 0,
      height: 0
    };
  }

  var _getComputedStyle = getComputedStyle(target, '::-webkit-scrollbar'),
      width = _getComputedStyle.width,
      height = _getComputedStyle.height;

  return {
    width: ensureSize(width),
    height: ensureSize(height)
  };
}

/***/ }),

/***/ "./node_modules/rc-util/es/hooks/useMemo.js":
/*!**************************************************!*\
  !*** ./node_modules/rc-util/es/hooks/useMemo.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useMemo)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");

function useMemo(getValue, condition, shouldUpdate) {
  var cacheRef = react__WEBPACK_IMPORTED_MODULE_0__.useRef({});

  if (!('value' in cacheRef.current) || shouldUpdate(cacheRef.current.condition, condition)) {
    cacheRef.current.value = getValue();
    cacheRef.current.condition = condition;
  }

  return cacheRef.current.value;
}

/***/ }),

/***/ "./node_modules/rc-util/es/hooks/useMergedState.js":
/*!*********************************************************!*\
  !*** ./node_modules/rc-util/es/hooks/useMergedState.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ useControlledState)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");


function useControlledState(defaultStateValue, option) {
  var _ref = option || {},
      defaultValue = _ref.defaultValue,
      value = _ref.value,
      onChange = _ref.onChange,
      postState = _ref.postState;

  var _React$useState = react__WEBPACK_IMPORTED_MODULE_1__.useState(function () {
    if (value !== undefined) {
      return value;
    }

    if (defaultValue !== undefined) {
      return typeof defaultValue === 'function' ? defaultValue() : defaultValue;
    }

    return typeof defaultStateValue === 'function' ? defaultStateValue() : defaultStateValue;
  }),
      _React$useState2 = (0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.default)(_React$useState, 2),
      innerValue = _React$useState2[0],
      setInnerValue = _React$useState2[1];

  var mergedValue = value !== undefined ? value : innerValue;

  if (postState) {
    mergedValue = postState(mergedValue);
  }

  function triggerChange(newValue) {
    setInnerValue(newValue);

    if (mergedValue !== newValue && onChange) {
      onChange(newValue, mergedValue);
    }
  } // Effect of reset value to `undefined`


  var firstRenderRef = react__WEBPACK_IMPORTED_MODULE_1__.useRef(true);
  react__WEBPACK_IMPORTED_MODULE_1__.useEffect(function () {
    if (firstRenderRef.current) {
      firstRenderRef.current = false;
      return;
    }

    if (value === undefined) {
      setInnerValue(value);
    }
  }, [value]);
  return [mergedValue, triggerChange];
}

/***/ }),

/***/ "./node_modules/rc-util/es/isMobile.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-util/es/isMobile.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function () {
  if (typeof navigator === 'undefined' || typeof window === 'undefined') {
    return false;
  }

  var agent = navigator.userAgent || navigator.vendor || window.opera;

  if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(agent) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(agent === null || agent === void 0 ? void 0 : agent.substr(0, 4))) {
    return true;
  }

  return false;
});

/***/ }),

/***/ "./node_modules/rc-util/es/omit.js":
/*!*****************************************!*\
  !*** ./node_modules/rc-util/es/omit.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ omit)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");


function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function omit(obj, fields) {
  var clone = _objectSpread({}, obj);

  if (Array.isArray(fields)) {
    fields.forEach(function (key) {
      delete clone[key];
    });
  }

  return clone;
}

/***/ }),

/***/ "./node_modules/rc-util/es/pickAttrs.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-util/es/pickAttrs.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ pickAttrs)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");


function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var attributes = "accept acceptCharset accessKey action allowFullScreen allowTransparency\n    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge\n    charSet checked classID className colSpan cols content contentEditable contextMenu\n    controls coords crossOrigin data dateTime default defer dir disabled download draggable\n    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder\n    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity\n    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media\n    mediaGroup method min minLength multiple muted name noValidate nonce open\n    optimum pattern placeholder poster preload radioGroup readOnly rel required\n    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected\n    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style\n    summary tabIndex target title type useMap value width wmode wrap";
var eventsName = "onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown\n    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick\n    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown\n    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel\n    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough\n    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata\n    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError";
var propList = "".concat(attributes, " ").concat(eventsName).split(/[\s\n]+/);
/* eslint-enable max-len */

var ariaPrefix = 'aria-';
var dataPrefix = 'data-';

function match(key, prefix) {
  return key.indexOf(prefix) === 0;
}
/**
 * Picker props from exist props with filter
 * @param props Passed props
 * @param ariaOnly boolean | { aria?: boolean; data?: boolean; attr?: boolean; } filter config
 */


function pickAttrs(props) {
  var ariaOnly = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var mergedConfig;

  if (ariaOnly === false) {
    mergedConfig = {
      aria: true,
      data: true,
      attr: true
    };
  } else if (ariaOnly === true) {
    mergedConfig = {
      aria: true
    };
  } else {
    mergedConfig = _objectSpread({}, ariaOnly);
  }

  var attrs = {};
  Object.keys(props).forEach(function (key) {
    if ( // Aria
    mergedConfig.aria && (key === 'role' || match(key, ariaPrefix)) || // Data
    mergedConfig.data && match(key, dataPrefix) || // Attr
    mergedConfig.attr && propList.includes(key)) {
      attrs[key] = props[key];
    }
  });
  return attrs;
}

/***/ }),

/***/ "./node_modules/rc-util/es/raf.js":
/*!****************************************!*\
  !*** ./node_modules/rc-util/es/raf.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ wrapperRaf)
/* harmony export */ });
var raf = function raf(callback) {
  return +setTimeout(callback, 16);
};

var caf = function caf(num) {
  return clearTimeout(num);
};

if (typeof window !== 'undefined' && 'requestAnimationFrame' in window) {
  raf = function raf(callback) {
    return window.requestAnimationFrame(callback);
  };

  caf = function caf(handle) {
    return window.cancelAnimationFrame(handle);
  };
}

var rafUUID = 0;
var rafIds = new Map();

function cleanup(id) {
  rafIds.delete(id);
}

function wrapperRaf(callback) {
  var times = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
  rafUUID += 1;
  var id = rafUUID;

  function callRef(leftTimes) {
    if (leftTimes === 0) {
      // Clean up
      cleanup(id); // Trigger

      callback();
    } else {
      // Next raf
      var realId = raf(function () {
        callRef(leftTimes - 1);
      }); // Bind real raf id

      rafIds.set(id, realId);
    }
  }

  callRef(times);
  return id;
}

wrapperRaf.cancel = function (id) {
  var realId = rafIds.get(id);
  cleanup(realId);
  return caf(realId);
};

/***/ }),

/***/ "./node_modules/rc-util/es/ref.js":
/*!****************************************!*\
  !*** ./node_modules/rc-util/es/ref.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "fillRef": () => (/* binding */ fillRef),
/* harmony export */   "composeRef": () => (/* binding */ composeRef),
/* harmony export */   "supportRef": () => (/* binding */ supportRef)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var react_is__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-is */ "./node_modules/react-is/index.js");


function fillRef(ref, node) {
  if (typeof ref === 'function') {
    ref(node);
  } else if ((0,_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__.default)(ref) === 'object' && ref && 'current' in ref) {
    ref.current = node;
  }
}
/**
 * Merge refs into one ref function to support ref passing.
 */

function composeRef() {
  for (var _len = arguments.length, refs = new Array(_len), _key = 0; _key < _len; _key++) {
    refs[_key] = arguments[_key];
  }

  return function (node) {
    refs.forEach(function (ref) {
      fillRef(ref, node);
    });
  };
}
function supportRef(nodeOrComponent) {
  var _type$prototype, _nodeOrComponent$prot;

  var type = (0,react_is__WEBPACK_IMPORTED_MODULE_1__.isMemo)(nodeOrComponent) ? nodeOrComponent.type.type : nodeOrComponent.type; // Function component node

  if (typeof type === 'function' && !((_type$prototype = type.prototype) === null || _type$prototype === void 0 ? void 0 : _type$prototype.render)) {
    return false;
  } // Class component


  if (typeof nodeOrComponent === 'function' && !((_nodeOrComponent$prot = nodeOrComponent.prototype) === null || _nodeOrComponent$prot === void 0 ? void 0 : _nodeOrComponent$prot.render)) {
    return false;
  }

  return true;
}
/* eslint-enable */

/***/ }),

/***/ "./node_modules/rc-util/es/setStyle.js":
/*!*********************************************!*\
  !*** ./node_modules/rc-util/es/setStyle.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/**
 * Easy to set element style, return previous style
 * IE browser compatible(IE browser doesn't merge overflow style, need to set it separately)
 * https://github.com/ant-design/ant-design/issues/19393
 *
 */
function setStyle(style) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!style) {
    return {};
  }

  var _options$element = options.element,
      element = _options$element === void 0 ? document.body : _options$element;
  var oldStyle = {};
  var styleKeys = Object.keys(style); // IE browser compatible

  styleKeys.forEach(function (key) {
    oldStyle[key] = element.style[key];
  });
  styleKeys.forEach(function (key) {
    element.style[key] = style[key];
  });
  return oldStyle;
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (setStyle);

/***/ }),

/***/ "./node_modules/rc-util/es/switchScrollingEffect.js":
/*!**********************************************************!*\
  !*** ./node_modules/rc-util/es/switchScrollingEffect.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _getScrollBarSize__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getScrollBarSize */ "./node_modules/rc-util/es/getScrollBarSize.js");
/* harmony import */ var _setStyle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./setStyle */ "./node_modules/rc-util/es/setStyle.js");



function isBodyOverflowing() {
  return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight) && window.innerWidth > document.body.offsetWidth;
}

var cacheStyle = {};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (function (close) {
  if (!isBodyOverflowing() && !close) {
    return;
  } // https://github.com/ant-design/ant-design/issues/19729


  var scrollingEffectClassName = 'ant-scrolling-effect';
  var scrollingEffectClassNameReg = new RegExp("".concat(scrollingEffectClassName), 'g');
  var bodyClassName = document.body.className;

  if (close) {
    if (!scrollingEffectClassNameReg.test(bodyClassName)) return;
    (0,_setStyle__WEBPACK_IMPORTED_MODULE_1__.default)(cacheStyle);
    cacheStyle = {};
    document.body.className = bodyClassName.replace(scrollingEffectClassNameReg, '').trim();
    return;
  }

  var scrollBarSize = (0,_getScrollBarSize__WEBPACK_IMPORTED_MODULE_0__.default)();

  if (scrollBarSize) {
    cacheStyle = (0,_setStyle__WEBPACK_IMPORTED_MODULE_1__.default)({
      position: 'relative',
      width: "calc(100% - ".concat(scrollBarSize, "px)")
    });

    if (!scrollingEffectClassNameReg.test(bodyClassName)) {
      var addClassName = "".concat(bodyClassName, " ").concat(scrollingEffectClassName);
      document.body.className = addClassName.trim();
    }
  }
});

/***/ }),

/***/ "./node_modules/rc-util/es/utils/get.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-util/es/utils/get.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ get)
/* harmony export */ });
function get(entity, path) {
  var current = entity;

  for (var i = 0; i < path.length; i += 1) {
    if (current === null || current === undefined) {
      return undefined;
    }

    current = current[path[i]];
  }

  return current;
}

/***/ }),

/***/ "./node_modules/rc-util/es/utils/set.js":
/*!**********************************************!*\
  !*** ./node_modules/rc-util/es/utils/set.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ set)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toConsumableArray */ "./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/esm/toArray */ "./node_modules/@babel/runtime/helpers/esm/toArray.js");
/* harmony import */ var _get__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./get */ "./node_modules/rc-util/es/utils/get.js");




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }



function internalSet(entity, paths, value, removeIfUndefined) {
  if (!paths.length) {
    return value;
  }

  var _paths = (0,_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_2__.default)(paths),
      path = _paths[0],
      restPath = _paths.slice(1);

  var clone;

  if (!entity && typeof path === 'number') {
    clone = [];
  } else if (Array.isArray(entity)) {
    clone = (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.default)(entity);
  } else {
    clone = _objectSpread({}, entity);
  } // Delete prop if `removeIfUndefined` and value is undefined


  if (removeIfUndefined && value === undefined && restPath.length === 1) {
    delete clone[path][restPath[0]];
  } else {
    clone[path] = internalSet(clone[path], restPath, value, removeIfUndefined);
  }

  return clone;
}

function set(entity, paths, value) {
  var removeIfUndefined = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

  // Do nothing if `removeIfUndefined` and parent object not exist
  if (paths.length && removeIfUndefined && value === undefined && !(0,_get__WEBPACK_IMPORTED_MODULE_3__.default)(entity, paths.slice(0, -1))) {
    return entity;
  }

  return internalSet(entity, paths, value, removeIfUndefined);
}

/***/ }),

/***/ "./node_modules/rc-util/es/warning.js":
/*!********************************************!*\
  !*** ./node_modules/rc-util/es/warning.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "warning": () => (/* binding */ warning),
/* harmony export */   "note": () => (/* binding */ note),
/* harmony export */   "resetWarned": () => (/* binding */ resetWarned),
/* harmony export */   "call": () => (/* binding */ call),
/* harmony export */   "warningOnce": () => (/* binding */ warningOnce),
/* harmony export */   "noteOnce": () => (/* binding */ noteOnce),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* eslint-disable no-console */
var warned = {};
function warning(valid, message) {
  // Support uglify
  if ( true && !valid && console !== undefined) {
    console.error("Warning: ".concat(message));
  }
}
function note(valid, message) {
  // Support uglify
  if ( true && !valid && console !== undefined) {
    console.warn("Note: ".concat(message));
  }
}
function resetWarned() {
  warned = {};
}
function call(method, valid, message) {
  if (!valid && !warned[message]) {
    method(false, message);
    warned[message] = true;
  }
}
function warningOnce(valid, message) {
  call(warning, valid, message);
}
function noteOnce(valid, message) {
  call(note, valid, message);
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (warningOnce);
/* eslint-enable */

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdGV4dGFyZWEvZXMvUmVzaXphYmxlVGV4dEFyZWEuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRleHRhcmVhL2VzL2NhbGN1bGF0ZU5vZGVIZWlnaHQuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRleHRhcmVhL2VzL2luZGV4LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10b29sdGlwL2VzL0NvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRvb2x0aXAvZXMvVG9vbHRpcC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdG9vbHRpcC9lcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdG9vbHRpcC9lcy9wbGFjZW1lbnRzLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlLXNlbGVjdC9lcy9Db250ZXh0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlLXNlbGVjdC9lcy9PcHRpb25MaXN0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlLXNlbGVjdC9lcy9UcmVlTm9kZS5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJlZS1zZWxlY3QvZXMvVHJlZVNlbGVjdC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJlZS1zZWxlY3QvZXMvaG9va3MvdXNlS2V5VmFsdWVNYXAuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUtc2VsZWN0L2VzL2hvb2tzL3VzZUtleVZhbHVlTWFwcGluZy5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJlZS1zZWxlY3QvZXMvaG9va3MvdXNlU2VsZWN0VmFsdWVzLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlLXNlbGVjdC9lcy9ob29rcy91c2VUcmVlRGF0YS5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJlZS1zZWxlY3QvZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUtc2VsZWN0L2VzL3V0aWxzL2xlZ2FjeVV0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUtc2VsZWN0L2VzL3V0aWxzL3N0cmF0ZWd5VXRpbC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJlZS1zZWxlY3QvZXMvdXRpbHMvdmFsdWVVdGlsLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlLXNlbGVjdC9lcy91dGlscy93YXJuaW5nUHJvcHNVdGlsLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL0Ryb3BJbmRpY2F0b3IuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvSW5kZW50LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL01vdGlvblRyZWVOb2RlLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL05vZGVMaXN0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL1RyZWUuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvVHJlZU5vZGUuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvY29udGV4dFR5cGVzLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL2luZGV4LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmVlL2VzL3V0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvdXRpbHMvY29uZHVjdFV0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvdXRpbHMvZGlmZlV0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyZWUvZXMvdXRpbHMvdHJlZVV0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyaWdnZXIvZXMvUG9wdXAvTWFzay5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJpZ2dlci9lcy9Qb3B1cC9Nb2JpbGVQb3B1cElubmVyLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmlnZ2VyL2VzL1BvcHVwL1BvcHVwSW5uZXIuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyaWdnZXIvZXMvUG9wdXAvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyaWdnZXIvZXMvUG9wdXAvdXNlU3RyZXRjaFN0eWxlLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy10cmlnZ2VyL2VzL1BvcHVwL3VzZVZpc2libGVTdGF0dXMuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyaWdnZXIvZXMvY29udGV4dC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJpZ2dlci9lcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdHJpZ2dlci9lcy91dGlscy9hbGlnblV0aWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXRyaWdnZXIvZXMvdXRpbHMvbGVnYWN5VXRpbC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXBsb2FkL2VzL0FqYXhVcGxvYWRlci5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXBsb2FkL2VzL1VwbG9hZC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXBsb2FkL2VzL2F0dHItYWNjZXB0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11cGxvYWQvZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXVwbG9hZC9lcy9yZXF1ZXN0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11cGxvYWQvZXMvdHJhdmVyc2VGaWxlVHJlZS5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXBsb2FkL2VzL3VpZC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9DaGlsZHJlbi90b0FycmF5LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL0RvbS9hZGRFdmVudExpc3RlbmVyLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL0RvbS9jYW5Vc2VEb20uanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvRG9tL2NvbnRhaW5zLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL0RvbS9jc3MuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvRG9tL2R5bmFtaWNDU1MuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvRG9tL2ZpbmRET01Ob2RlLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL0RvbS9mb2N1cy5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9Eb20vaXNWaXNpYmxlLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL0RvbS9zY3JvbGxMb2NrZXIuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvS2V5Q29kZS5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9Qb3J0YWwuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvUG9ydGFsV3JhcHBlci5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9nZXRTY3JvbGxCYXJTaXplLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL2hvb2tzL3VzZU1lbW8uanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvaG9va3MvdXNlTWVyZ2VkU3RhdGUuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvaXNNb2JpbGUuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvb21pdC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9waWNrQXR0cnMuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvcmFmLmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL3JlZi5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9zZXRTdHlsZS5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy9zd2l0Y2hTY3JvbGxpbmdFZmZlY3QuanMiLCJ3ZWJwYWNrOi8vQHRudHgvcmVtaW5kLy4vbm9kZV9tb2R1bGVzL3JjLXV0aWwvZXMvdXRpbHMvZ2V0LmpzIiwid2VicGFjazovL0B0bnR4L3JlbWluZC8uL25vZGVfbW9kdWxlcy9yYy11dGlsL2VzL3V0aWxzL3NldC5qcyIsIndlYnBhY2s6Ly9AdG50eC9yZW1pbmQvLi9ub2RlX21vZHVsZXMvcmMtdXRpbC9lcy93YXJuaW5nLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTBEO0FBQ1c7QUFDRztBQUNBO0FBQ047QUFDTjtBQUNNO0FBQ25DO0FBQ2lCO0FBQ2I7QUFDQztBQUNvQjs7QUFFeEQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNDQUFzQzs7QUFFdkM7QUFDQSxFQUFFLDRFQUFTOztBQUVYLGVBQWUsK0VBQVk7O0FBRTNCO0FBQ0E7O0FB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QWlCLHdFQUFxQjtBQUN0Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBLFNBQVM7OztBQUdUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7O0FBRUE7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFD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QTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTtBQUNBLElBQUksa0RBQVE7QUFDWjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTs7O0FBR0o7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQzVJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZSxPQUFPLEU7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzltQnFEO0FBQzFDO0FBQ087QUFDeEMsYUFBYSxpREFBVTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsNkNBQU0sR0FBRzs7QUFFOUIsRUFBRSwwREFBbUI7QUFDckI7QUFDQSxHQUFHLEVBQUU7O0FBRUwsZ0JBQWdCLDZDQUFNOztBQUV0QiwwQkFBMEIsdURBQVM7QUFDbkM7QUFDQTtBQUNBLEdBQUc7OztBQUdILEVBQUUsZ0RBQVM7QUFDWDtBQUNBLEdBQUc7QUFDSCxFQUFFLGdEQUFTO0FBQ1g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxnQ0FBZ0MsbURBQXFCO0FBQ3JELENBQUM7QUFDRCxpRUFBZSxNQUFNLEU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbkNtRDtBQUNOO0FBQ047QUFDa0M7QUFDdEI7QUFDaEI7O0FBRXhELGdDQUFnQyw2REFBNkQseUNBQXlDLGFBQWEsa0ZBQWUsa0JBQWtCLGlDQUFpQyxpQkFBaUIsa0ZBQWUsbUJBQW1CLHlEQUF5RCxFQUFFLE9BQU8sdUNBQXVDLEVBQUUsUUFBUSw2RkFBMEIsZUFBZSxHQUFHOztBQUV2YSxzQ0FBc0Msd0VBQXdFLDBDQUEwQyw4Q0FBOEMsTUFBTSx3RUFBd0UsR0FBRyxhQUFhLEVBQUUsWUFBWSxjQUFjLEVBQUU7O0FBRWxVO0FBQytCO0FBQ1A7QUFDTTtBQUNVO0FBQ29CO0FBQzFCO0FBQ1k7QUFDOUM7QUFDQSxpQkFBaUIsdURBQVM7QUFDMUI7O0FBRU87QUFDUCxTQUFTLE1BQStCLEdBQUcsQ0FBUztBQUNwRCxDQUFDO0FBQ0Q7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLFFBQVEsMEVBQU87QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUUsNEVBQVM7O0FBRVg7O0FBRUE7QUFDQTs7QUFFQSxJQUFJLGtGQUFlOztBQUVuQjtBQUNBLHlCQUF5Qiw0Q0FBZTs7QUFFeEM7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1EQUFtRDs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPOzs7QUFHUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxRQUFRLGdFQUFxQixHQUFHOztBQUVoQyx3QkFBd0IsbURBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxRQUFRLG1EQUFRO0FBQ2hCO0FBQ0EsUUFBUSxnRUFBcUI7QUFDN0I7QUFDQTs7QUFFQSw2QkFBNkIsdURBQVk7QUFDekM7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQSxFQUFFLCtFQUFZO0FBQ2Q7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EscUJBQXFCLDZDQUFHO0FBQ3hCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE1BQU0sZ0RBQVU7QUFDaEI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4QkFBOEIsZ0RBQW1CLENBQUMsNENBQU07QUFDeEQ7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLENBQUMsQ0FBQyw0Q0FBZTs7QUFFakIsaUVBQWUsYUFBYSxFOzs7Ozs7Ozs7Ozs7Ozs7O0FDNVA1QjtBQUNBO0FBQ2U7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQzs7Ozs7Ozs7Ozs7Ozs7OztBQzVEK0I7QUFDaEI7QUFDZixpQkFBaUIseUNBQVksR0FBRzs7QUFFaEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDOzs7Ozs7Ozs7Ozs7Ozs7OztBQ1ZzRTtBQUN2QztBQUNoQjtBQUNmLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx3QkFBd0IsMkNBQWM7QUFDdEM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsaUZBQWM7QUFDdkM7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOzs7QUFHSCx1QkFBdUIseUNBQVk7QUFDbkMsRUFBRSw0Q0FBZTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxDOzs7Ozs7Ozs7Ozs7Ozs7QUNuREEsaUVBQWdCO0FBQ2hCO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEU7Ozs7Ozs7Ozs7Ozs7Ozs7QUNadUU7O0FBRXhFLDBDQUEwQyxnQ0FBZ0Msb0NBQW9DLG9EQUFvRCw4REFBOEQsZ0VBQWdFLEVBQUUsRUFBRSxnQ0FBZ0MsRUFBRSxhQUFhOztBQUVuVixnQ0FBZ0MsZ0JBQWdCLHNCQUFzQixPQUFPLHVEQUF1RCxhQUFhLHVEQUF1RCxDQUFDLGtGQUFlLDJCQUEyQixFQUFFLEVBQUUsRUFBRSw2Q0FBNkMsMkVBQTJFLEVBQUUsT0FBTyxpREFBaUQsa0ZBQWtGLEVBQUUsRUFBRSxFQUFFLEVBQUUsZUFBZTs7QUFFcmdCO0FBQ2YsOEJBQThCOztBQUU5QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxDOzs7Ozs7Ozs7Ozs7Ozs7O0FDaEJ3RTs7QUFFeEUsMENBQTBDLGdDQUFnQyxvQ0FBb0Msb0RBQW9ELDhEQUE4RCxnRUFBZ0UsRUFBRSxFQUFFLGdDQUFnQyxFQUFFLGFBQWE7O0FBRW5WLGdDQUFnQyxnQkFBZ0Isc0JBQXNCLE9BQU8sdURBQXVELGFBQWEsdURBQXVELENBQUMsa0ZBQWUsMkJBQTJCLEVBQUUsRUFBRSxFQUFFLDZDQUE2QywyRUFBMkUsRUFBRSxPQUFPLGlEQUFpRCxrRkFBa0YsRUFBRSxFQUFFLEVBQUUsRUFBRSxlQUFlOztBQUVwaEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0JBQWdCLGdCQUFnQixnQkFBZ0IsRUFBRTtBQUNoRjs7O0FBR2U7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsbUNBQW1DO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxDOzs7Ozs7Ozs7Ozs7Ozs7QUNwREE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFZTtBQUNmO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7O0FBRWxCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU8sRUFBRTs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3REd0Q7QUFDdEI7QUFDM0I7QUFDUDtBQUNBO0FBQ0EsR0FBRyxVQUFVLDBFQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQLHFFQUFxRSxhQUFhO0FBQ2xGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDTztBQUNQOztBQUVBLGFBQWEsZ0RBQU0scUVBQXFFOztBQUV4RjtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtQjs7Ozs7Ozs7Ozs7Ozs7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUEsaUVBQWUsUUFBUSxFOzs7Ozs7Ozs7Ozs7Ozs7OztBQzNCMkI7QUFDaEI7O0FBRWxDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlFQUFnQjtBQUNoQjtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJLGtEQUFRO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0JBQXNCLDBEQUFnQjs7QUFFdEM7QUFDQSxpQkFBaUIsa0RBQVE7QUFDekI7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsRTs7Ozs7Ozs7Ozs7Ozs7O0FDdkNjO0FBQ2Y7O0FBRUEsaUJBQWlCLGlCQUFpQjtBQUNsQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNad0U7QUFDTTtBQUNwQjs7QUFFMUQsMENBQTBDLGdDQUFnQyxvQ0FBb0Msb0RBQW9ELDhEQUE4RCxnRUFBZ0UsRUFBRSxFQUFFLGdDQUFnQyxFQUFFLGFBQWE7O0FBRW5WLGdDQUFnQyxnQkFBZ0Isc0JBQXNCLE9BQU8sdURBQXVELGFBQWEsdURBQXVELENBQUMsa0ZBQWUsMkJBQTJCLEVBQUUsRUFBRSxFQUFFLDZDQUE2QywyRUFBMkUsRUFBRSxPQUFPLGlEQUFpRCxrRkFBa0YsRUFBRSxFQUFFLEVBQUUsRUFBRSxlQUFlOztBQUU1Zjs7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSwyRUFBUTtBQUN2QjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsWUFBWSxxRkFBa0I7QUFDOUIsR0FBRztBQUNILDRCQUE0QjtBQUM1QixHQUFHOzs7QUFHSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFZTtBQUNmOztBQUVBO0FBQ0EsbUVBQW1FLDZDQUFHO0FBQ3RFO0FBQ0E7O0FBRUE7QUFDQSxDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoREE7QUFDQTtBQUNPO0FBQ1A7QUFDQSxNQUFNLEtBQXFDO0FBQzNDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSxNQUFNLEtBQXFDO0FBQzNDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGlFQUFlLFdBQVcsRUFBQztBQUMzQixtQiIsImZpbGUiOiJ2ZW5kb3JzLW5vZGVfbW9kdWxlc19yYy10LjNmMzNiNGVjYTFhZDJlNmU5MTExLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMlwiO1xuaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHlcIjtcbmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrXCI7XG5pbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzc1wiO1xuaW1wb3J0IF9pbmhlcml0cyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHNcIjtcbmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVzaXplT2JzZXJ2ZXIgZnJvbSAncmMtcmVzaXplLW9ic2VydmVyJztcbmltcG9ydCBvbWl0IGZyb20gXCJyYy11dGlsL2VzL29taXRcIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IGNhbGN1bGF0ZU5vZGVIZWlnaHQgZnJvbSAnLi9jYWxjdWxhdGVOb2RlSGVpZ2h0JzsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuXG52YXIgUkVTSVpFX1NUQVRVUztcblxuKGZ1bmN0aW9uIChSRVNJWkVfU1RBVFVTKSB7XG4gIFJFU0laRV9TVEFUVVNbUkVTSVpFX1NUQVRVU1tcIk5PTkVcIl0gPSAwXSA9IFwiTk9ORVwiO1xuICBSRVNJWkVfU1RBVFVTW1JFU0laRV9TVEFUVVNbXCJSRVNJWklOR1wiXSA9IDFdID0gXCJSRVNJWklOR1wiO1xuICBSRVNJWkVfU1RBVFVTW1JFU0laRV9TVEFUVVNbXCJSRVNJWkVEXCJdID0gMl0gPSBcIlJFU0laRURcIjtcbn0pKFJFU0laRV9TVEFUVVMgfHwgKFJFU0laRV9TVEFUVVMgPSB7fSkpO1xuXG52YXIgUmVzaXphYmxlVGV4dEFyZWEgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKFJlc2l6YWJsZVRleHRBcmVhLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFJlc2l6YWJsZVRleHRBcmVhKTtcblxuICBmdW5jdGlvbiBSZXNpemFibGVUZXh0QXJlYShwcm9wcykge1xuICAgIHZhciBfdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZXNpemFibGVUZXh0QXJlYSk7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTtcblxuICAgIF90aGlzLnNhdmVUZXh0QXJlYSA9IGZ1bmN0aW9uICh0ZXh0QXJlYSkge1xuICAgICAgX3RoaXMudGV4dEFyZWEgPSB0ZXh0QXJlYTtcbiAgICB9O1xuXG4gICAgX3RoaXMuaGFuZGxlUmVzaXplID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgIHZhciByZXNpemVTdGF0dXMgPSBfdGhpcy5zdGF0ZS5yZXNpemVTdGF0dXM7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBhdXRvU2l6ZSA9IF90aGlzJHByb3BzLmF1dG9TaXplLFxuICAgICAgICAgIG9uUmVzaXplID0gX3RoaXMkcHJvcHMub25SZXNpemU7XG5cbiAgICAgIGlmIChyZXNpemVTdGF0dXMgIT09IFJFU0laRV9TVEFUVVMuTk9ORSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2Ygb25SZXNpemUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgb25SZXNpemUoc2l6ZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhdXRvU2l6ZSkge1xuICAgICAgICBfdGhpcy5yZXNpemVPbk5leHRGcmFtZSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5yZXNpemVPbk5leHRGcmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF90aGlzLm5leHRGcmFtZUFjdGlvbklkKTtcbiAgICAgIF90aGlzLm5leHRGcmFtZUFjdGlvbklkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKF90aGlzLnJlc2l6ZVRleHRhcmVhKTtcbiAgICB9O1xuXG4gICAgX3RoaXMucmVzaXplVGV4dGFyZWEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgYXV0b1NpemUgPSBfdGhpcy5wcm9wcy5hdXRvU2l6ZTtcblxuICAgICAgaWYgKCFhdXRvU2l6ZSB8fCAhX3RoaXMudGV4dEFyZWEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWluUm93cyA9IGF1dG9TaXplLm1pblJvd3MsXG4gICAgICAgICAgbWF4Um93cyA9IGF1dG9TaXplLm1heFJvd3M7XG4gICAgICB2YXIgdGV4dGFyZWFTdHlsZXMgPSBjYWxjdWxhdGVOb2RlSGVpZ2h0KF90aGlzLnRleHRBcmVhLCBmYWxzZSwgbWluUm93cywgbWF4Um93cyk7XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdGV4dGFyZWFTdHlsZXM6IHRleHRhcmVhU3R5bGVzLFxuICAgICAgICByZXNpemVTdGF0dXM6IFJFU0laRV9TVEFUVVMuUkVTSVpJTkdcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoX3RoaXMucmVzaXplRnJhbWVJZCk7XG4gICAgICAgIF90aGlzLnJlc2l6ZUZyYW1lSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHJlc2l6ZVN0YXR1czogUkVTSVpFX1NUQVRVUy5SRVNJWkVEXG4gICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMucmVzaXplRnJhbWVJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICByZXNpemVTdGF0dXM6IFJFU0laRV9TVEFUVVMuTk9ORVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBfdGhpcy5maXhGaXJlZm94QXV0b1Njcm9sbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIF90aGlzLnJlbmRlclRleHRBcmVhID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIF90aGlzJHByb3BzMiRwcmVmaXhDbCA9IF90aGlzJHByb3BzMi5wcmVmaXhDbHMsXG4gICAgICAgICAgcHJlZml4Q2xzID0gX3RoaXMkcHJvcHMyJHByZWZpeENsID09PSB2b2lkIDAgPyAncmMtdGV4dGFyZWEnIDogX3RoaXMkcHJvcHMyJHByZWZpeENsLFxuICAgICAgICAgIGF1dG9TaXplID0gX3RoaXMkcHJvcHMyLmF1dG9TaXplLFxuICAgICAgICAgIG9uUmVzaXplID0gX3RoaXMkcHJvcHMyLm9uUmVzaXplLFxuICAgICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzMi5jbGFzc05hbWUsXG4gICAgICAgICAgZGlzYWJsZWQgPSBfdGhpcyRwcm9wczIuZGlzYWJsZWQ7XG4gICAgICB2YXIgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICB0ZXh0YXJlYVN0eWxlcyA9IF90aGlzJHN0YXRlLnRleHRhcmVhU3R5bGVzLFxuICAgICAgICAgIHJlc2l6ZVN0YXR1cyA9IF90aGlzJHN0YXRlLnJlc2l6ZVN0YXR1cztcbiAgICAgIHZhciBvdGhlclByb3BzID0gb21pdChfdGhpcy5wcm9wcywgWydwcmVmaXhDbHMnLCAnb25QcmVzc0VudGVyJywgJ2F1dG9TaXplJywgJ2RlZmF1bHRWYWx1ZScsICdvblJlc2l6ZSddKTtcbiAgICAgIHZhciBjbHMgPSBjbGFzc05hbWVzKHByZWZpeENscywgY2xhc3NOYW1lLCBfZGVmaW5lUHJvcGVydHkoe30sIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItZGlzYWJsZWRcIiksIGRpc2FibGVkKSk7IC8vIEZpeCBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy82Nzc2XG4gICAgICAvLyBNYWtlIHN1cmUgaXQgY291bGQgYmUgcmVzZXQgd2hlbiB1c2luZyBmb3JtLmdldEZpZWxkRGVjb3JhdG9yXG5cbiAgICAgIGlmICgndmFsdWUnIGluIG90aGVyUHJvcHMpIHtcbiAgICAgICAgb3RoZXJQcm9wcy52YWx1ZSA9IG90aGVyUHJvcHMudmFsdWUgfHwgJyc7XG4gICAgICB9XG5cbiAgICAgIHZhciBzdHlsZSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBfdGhpcy5wcm9wcy5zdHlsZSksIHRleHRhcmVhU3R5bGVzKSwgcmVzaXplU3RhdHVzID09PSBSRVNJWkVfU1RBVFVTLlJFU0laSU5HID8gLy8gUmVhY3Qgd2lsbCB3YXJuaW5nIHdoZW4gbWl4IGBvdmVyZmxvd2AgJiBgb3ZlcmZsb3dZYC5cbiAgICAgIC8vIFdlIG5lZWQgdG8gZGVmaW5lIHRoaXMgc2VwYXJhdGVseS5cbiAgICAgIHtcbiAgICAgICAgb3ZlcmZsb3dYOiAnaGlkZGVuJyxcbiAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJ1xuICAgICAgfSA6IG51bGwpO1xuXG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmVzaXplT2JzZXJ2ZXIsIHtcbiAgICAgICAgb25SZXNpemU6IF90aGlzLmhhbmRsZVJlc2l6ZSxcbiAgICAgICAgZGlzYWJsZWQ6ICEoYXV0b1NpemUgfHwgb25SZXNpemUpXG4gICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIsIF9leHRlbmRzKHt9LCBvdGhlclByb3BzLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xzLFxuICAgICAgICBzdHlsZTogc3R5bGUsXG4gICAgICAgIHJlZjogX3RoaXMuc2F2ZVRleHRBcmVhXG4gICAgICB9KSkpO1xuICAgIH07XG5cbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHRleHRhcmVhU3R5bGVzOiB7fSxcbiAgICAgIHJlc2l6ZVN0YXR1czogUkVTSVpFX1NUQVRVUy5OT05FXG4gICAgfTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoUmVzaXphYmxlVGV4dEFyZWEsIFt7XG4gICAga2V5OiBcImNvbXBvbmVudERpZE1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5yZXNpemVUZXh0YXJlYSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjb21wb25lbnREaWRVcGRhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgLy8gUmUtcmVuZGVyIHdpdGggdGhlIG5ldyBjb250ZW50IHRoZW4gcmVjYWxjdWxhdGUgdGhlIGhlaWdodCBhcyByZXF1aXJlZC5cbiAgICAgIGlmIChwcmV2UHJvcHMudmFsdWUgIT09IHRoaXMucHJvcHMudmFsdWUpIHtcbiAgICAgICAgdGhpcy5yZXNpemVUZXh0YXJlYSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjb21wb25lbnRXaWxsVW5tb3VudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMubmV4dEZyYW1lQWN0aW9uSWQpO1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yZXNpemVGcmFtZUlkKTtcbiAgICB9IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbnQtZGVzaWduL2FudC1kZXNpZ24vaXNzdWVzLzIxODcwXG5cbiAgfSwge1xuICAgIGtleTogXCJmaXhGaXJlZm94QXV0b1Njcm9sbFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBmaXhGaXJlZm94QXV0b1Njcm9sbCgpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSB0aGlzLnRleHRBcmVhKSB7XG4gICAgICAgICAgdmFyIGN1cnJlbnRTdGFydCA9IHRoaXMudGV4dEFyZWEuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgdmFyIGN1cnJlbnRFbmQgPSB0aGlzLnRleHRBcmVhLnNlbGVjdGlvbkVuZDtcbiAgICAgICAgICB0aGlzLnRleHRBcmVhLnNldFNlbGVjdGlvblJhbmdlKGN1cnJlbnRTdGFydCwgY3VycmVudEVuZCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHsvLyBGaXggZXJyb3IgaW4gQ2hyb21lOlxuICAgICAgICAvLyBGYWlsZWQgdG8gcmVhZCB0aGUgJ3NlbGVjdGlvblN0YXJ0JyBwcm9wZXJ0eSBmcm9tICdIVE1MSW5wdXRFbGVtZW50J1xuICAgICAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcS8yMTE3NzQ4OS8zMDQwNjA1XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJUZXh0QXJlYSgpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBSZXNpemFibGVUZXh0QXJlYTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcblxuZXhwb3J0IGRlZmF1bHQgUmVzaXphYmxlVGV4dEFyZWE7IiwiLy8gVGhhbmtzIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmRyZXlwb3BwL3JlYWN0LXRleHRhcmVhLWF1dG9zaXplL1xuXG4vKipcbiAqIGNhbGN1bGF0ZU5vZGVIZWlnaHQodWlUZXh0Tm9kZSwgdXNlQ2FjaGUgPSBmYWxzZSlcbiAqL1xudmFyIEhJRERFTl9URVhUQVJFQV9TVFlMRSA9IFwiXFxuICBtaW4taGVpZ2h0OjAgIWltcG9ydGFudDtcXG4gIG1heC1oZWlnaHQ6bm9uZSAhaW1wb3J0YW50O1xcbiAgaGVpZ2h0OjAgIWltcG9ydGFudDtcXG4gIHZpc2liaWxpdHk6aGlkZGVuICFpbXBvcnRhbnQ7XFxuICBvdmVyZmxvdzpoaWRkZW4gIWltcG9ydGFudDtcXG4gIHBvc2l0aW9uOmFic29sdXRlICFpbXBvcnRhbnQ7XFxuICB6LWluZGV4Oi0xMDAwICFpbXBvcnRhbnQ7XFxuICB0b3A6MCAhaW1wb3J0YW50O1xcbiAgcmlnaHQ6MCAhaW1wb3J0YW50XFxuXCI7XG52YXIgU0laSU5HX1NUWUxFID0gWydsZXR0ZXItc3BhY2luZycsICdsaW5lLWhlaWdodCcsICdwYWRkaW5nLXRvcCcsICdwYWRkaW5nLWJvdHRvbScsICdmb250LWZhbWlseScsICdmb250LXdlaWdodCcsICdmb250LXNpemUnLCAnZm9udC12YXJpYW50JywgJ3RleHQtcmVuZGVyaW5nJywgJ3RleHQtdHJhbnNmb3JtJywgJ3dpZHRoJywgJ3RleHQtaW5kZW50JywgJ3BhZGRpbmctbGVmdCcsICdwYWRkaW5nLXJpZ2h0JywgJ2JvcmRlci13aWR0aCcsICdib3gtc2l6aW5nJ107XG52YXIgY29tcHV0ZWRTdHlsZUNhY2hlID0ge307XG52YXIgaGlkZGVuVGV4dGFyZWE7XG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlTm9kZVN0eWxpbmcobm9kZSkge1xuICB2YXIgdXNlQ2FjaGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlO1xuICB2YXIgbm9kZVJlZiA9IG5vZGUuZ2V0QXR0cmlidXRlKCdpZCcpIHx8IG5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXJlYWN0aWQnKSB8fCBub2RlLmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuXG4gIGlmICh1c2VDYWNoZSAmJiBjb21wdXRlZFN0eWxlQ2FjaGVbbm9kZVJlZl0pIHtcbiAgICByZXR1cm4gY29tcHV0ZWRTdHlsZUNhY2hlW25vZGVSZWZdO1xuICB9XG5cbiAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gIHZhciBib3hTaXppbmcgPSBzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3gtc2l6aW5nJykgfHwgc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLW1vei1ib3gtc2l6aW5nJykgfHwgc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLXdlYmtpdC1ib3gtc2l6aW5nJyk7XG4gIHZhciBwYWRkaW5nU2l6ZSA9IHBhcnNlRmxvYXQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1ib3R0b20nKSkgKyBwYXJzZUZsb2F0KHN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctdG9wJykpO1xuICB2YXIgYm9yZGVyU2l6ZSA9IHBhcnNlRmxvYXQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLWJvdHRvbS13aWR0aCcpKSArIHBhcnNlRmxvYXQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXRvcC13aWR0aCcpKTtcbiAgdmFyIHNpemluZ1N0eWxlID0gU0laSU5HX1NUWUxFLm1hcChmdW5jdGlvbiAobmFtZSkge1xuICAgIHJldHVybiBcIlwiLmNvbmNhdChuYW1lLCBcIjpcIikuY29uY2F0KHN0eWxlLmdldFByb3BlcnR5VmFsdWUobmFtZSkpO1xuICB9KS5qb2luKCc7Jyk7XG4gIHZhciBub2RlSW5mbyA9IHtcbiAgICBzaXppbmdTdHlsZTogc2l6aW5nU3R5bGUsXG4gICAgcGFkZGluZ1NpemU6IHBhZGRpbmdTaXplLFxuICAgIGJvcmRlclNpemU6IGJvcmRlclNpemUsXG4gICAgYm94U2l6aW5nOiBib3hTaXppbmdcbiAgfTtcblxuICBpZiAodXNlQ2FjaGUgJiYgbm9kZVJlZikge1xuICAgIGNvbXB1dGVkU3R5bGVDYWNoZVtub2RlUmVmXSA9IG5vZGVJbmZvO1xuICB9XG5cbiAgcmV0dXJuIG5vZGVJbmZvO1xufVxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2FsY3VsYXRlTm9kZUhlaWdodCh1aVRleHROb2RlKSB7XG4gIHZhciB1c2VDYWNoZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG4gIHZhciBtaW5Sb3dzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsO1xuICB2YXIgbWF4Um93cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogbnVsbDtcblxuICBpZiAoIWhpZGRlblRleHRhcmVhKSB7XG4gICAgaGlkZGVuVGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgIGhpZGRlblRleHRhcmVhLnNldEF0dHJpYnV0ZSgndGFiLWluZGV4JywgJy0xJyk7XG4gICAgaGlkZGVuVGV4dGFyZWEuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChoaWRkZW5UZXh0YXJlYSk7XG4gIH0gLy8gRml4IHdyYXA9XCJvZmZcIiBpc3N1ZVxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy82NTc3XG5cblxuICBpZiAodWlUZXh0Tm9kZS5nZXRBdHRyaWJ1dGUoJ3dyYXAnKSkge1xuICAgIGhpZGRlblRleHRhcmVhLnNldEF0dHJpYnV0ZSgnd3JhcCcsIHVpVGV4dE5vZGUuZ2V0QXR0cmlidXRlKCd3cmFwJykpO1xuICB9IGVsc2Uge1xuICAgIGhpZGRlblRleHRhcmVhLnJlbW92ZUF0dHJpYnV0ZSgnd3JhcCcpO1xuICB9IC8vIENvcHkgYWxsIENTUyBwcm9wZXJ0aWVzIHRoYXQgaGF2ZSBhbiBpbXBhY3Qgb24gdGhlIGhlaWdodCBvZiB0aGUgY29udGVudCBpblxuICAvLyB0aGUgdGV4dGJveFxuXG5cbiAgdmFyIF9jYWxjdWxhdGVOb2RlU3R5bGluZyA9IGNhbGN1bGF0ZU5vZGVTdHlsaW5nKHVpVGV4dE5vZGUsIHVzZUNhY2hlKSxcbiAgICAgIHBhZGRpbmdTaXplID0gX2NhbGN1bGF0ZU5vZGVTdHlsaW5nLnBhZGRpbmdTaXplLFxuICAgICAgYm9yZGVyU2l6ZSA9IF9jYWxjdWxhdGVOb2RlU3R5bGluZy5ib3JkZXJTaXplLFxuICAgICAgYm94U2l6aW5nID0gX2NhbGN1bGF0ZU5vZGVTdHlsaW5nLmJveFNpemluZyxcbiAgICAgIHNpemluZ1N0eWxlID0gX2NhbGN1bGF0ZU5vZGVTdHlsaW5nLnNpemluZ1N0eWxlOyAvLyBOZWVkIHRvIGhhdmUgdGhlIG92ZXJmbG93IGF0dHJpYnV0ZSB0byBoaWRlIHRoZSBzY3JvbGxiYXIgb3RoZXJ3aXNlXG4gIC8vIHRleHQtbGluZXMgd2lsbCBub3QgY2FsY3VsYXRlZCBwcm9wZXJseSBhcyB0aGUgc2hhZG93IHdpbGwgdGVjaG5pY2FsbHkgYmVcbiAgLy8gbmFycm93ZXIgZm9yIGNvbnRlbnRcblxuXG4gIGhpZGRlblRleHRhcmVhLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBcIlwiLmNvbmNhdChzaXppbmdTdHlsZSwgXCI7XCIpLmNvbmNhdChISURERU5fVEVYVEFSRUFfU1RZTEUpKTtcbiAgaGlkZGVuVGV4dGFyZWEudmFsdWUgPSB1aVRleHROb2RlLnZhbHVlIHx8IHVpVGV4dE5vZGUucGxhY2Vob2xkZXIgfHwgJyc7XG4gIHZhciBtaW5IZWlnaHQgPSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjtcbiAgdmFyIG1heEhlaWdodCA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSO1xuICB2YXIgaGVpZ2h0ID0gaGlkZGVuVGV4dGFyZWEuc2Nyb2xsSGVpZ2h0O1xuICB2YXIgb3ZlcmZsb3dZO1xuXG4gIGlmIChib3hTaXppbmcgPT09ICdib3JkZXItYm94Jykge1xuICAgIC8vIGJvcmRlci1ib3g6IGFkZCBib3JkZXIsIHNpbmNlIGhlaWdodCA9IGNvbnRlbnQgKyBwYWRkaW5nICsgYm9yZGVyXG4gICAgaGVpZ2h0ICs9IGJvcmRlclNpemU7XG4gIH0gZWxzZSBpZiAoYm94U2l6aW5nID09PSAnY29udGVudC1ib3gnKSB7XG4gICAgLy8gcmVtb3ZlIHBhZGRpbmcsIHNpbmNlIGhlaWdodCA9IGNvbnRlbnRcbiAgICBoZWlnaHQgLT0gcGFkZGluZ1NpemU7XG4gIH1cblxuICBpZiAobWluUm93cyAhPT0gbnVsbCB8fCBtYXhSb3dzICE9PSBudWxsKSB7XG4gICAgLy8gbWVhc3VyZSBoZWlnaHQgb2YgYSB0ZXh0YXJlYSB3aXRoIGEgc2luZ2xlIHJvd1xuICAgIGhpZGRlblRleHRhcmVhLnZhbHVlID0gJyAnO1xuICAgIHZhciBzaW5nbGVSb3dIZWlnaHQgPSBoaWRkZW5UZXh0YXJlYS5zY3JvbGxIZWlnaHQgLSBwYWRkaW5nU2l6ZTtcblxuICAgIGlmIChtaW5Sb3dzICE9PSBudWxsKSB7XG4gICAgICBtaW5IZWlnaHQgPSBzaW5nbGVSb3dIZWlnaHQgKiBtaW5Sb3dzO1xuXG4gICAgICBpZiAoYm94U2l6aW5nID09PSAnYm9yZGVyLWJveCcpIHtcbiAgICAgICAgbWluSGVpZ2h0ID0gbWluSGVpZ2h0ICsgcGFkZGluZ1NpemUgKyBib3JkZXJTaXplO1xuICAgICAgfVxuXG4gICAgICBoZWlnaHQgPSBNYXRoLm1heChtaW5IZWlnaHQsIGhlaWdodCk7XG4gICAgfVxuXG4gICAgaWYgKG1heFJvd3MgIT09IG51bGwpIHtcbiAgICAgIG1heEhlaWdodCA9IHNpbmdsZVJvd0hlaWdodCAqIG1heFJvd3M7XG5cbiAgICAgIGlmIChib3hTaXppbmcgPT09ICdib3JkZXItYm94Jykge1xuICAgICAgICBtYXhIZWlnaHQgPSBtYXhIZWlnaHQgKyBwYWRkaW5nU2l6ZSArIGJvcmRlclNpemU7XG4gICAgICB9XG5cbiAgICAgIG92ZXJmbG93WSA9IGhlaWdodCA+IG1heEhlaWdodCA/ICcnIDogJ2hpZGRlbic7XG4gICAgICBoZWlnaHQgPSBNYXRoLm1pbihtYXhIZWlnaHQsIGhlaWdodCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICBtaW5IZWlnaHQ6IG1pbkhlaWdodCxcbiAgICBtYXhIZWlnaHQ6IG1heEhlaWdodCxcbiAgICBvdmVyZmxvd1k6IG92ZXJmbG93WSxcbiAgICByZXNpemU6ICdub25lJ1xuICB9O1xufSIsImltcG9ydCBfZXh0ZW5kcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kc1wiO1xuaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2tcIjtcbmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzXCI7XG5pbXBvcnQgX2luaGVyaXRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0c1wiO1xuaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXJcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZXNpemFibGVUZXh0QXJlYSBmcm9tICcuL1Jlc2l6YWJsZVRleHRBcmVhJztcblxudmFyIFRleHRBcmVhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhUZXh0QXJlYSwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihUZXh0QXJlYSk7XG5cbiAgZnVuY3Rpb24gVGV4dEFyZWEocHJvcHMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGV4dEFyZWEpO1xuXG4gICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcyk7XG5cbiAgICBfdGhpcy5mb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLnJlc2l6YWJsZVRleHRBcmVhLnRleHRBcmVhLmZvY3VzKCk7XG4gICAgfTtcblxuICAgIF90aGlzLnNhdmVUZXh0QXJlYSA9IGZ1bmN0aW9uIChyZXNpemFibGVUZXh0QXJlYSkge1xuICAgICAgX3RoaXMucmVzaXphYmxlVGV4dEFyZWEgPSByZXNpemFibGVUZXh0QXJlYTtcbiAgICB9O1xuXG4gICAgX3RoaXMuaGFuZGxlQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBvbkNoYW5nZSA9IF90aGlzLnByb3BzLm9uQ2hhbmdlO1xuXG4gICAgICBfdGhpcy5zZXRWYWx1ZShlLnRhcmdldC52YWx1ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5yZXNpemFibGVUZXh0QXJlYS5yZXNpemVUZXh0YXJlYSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvbkNoYW5nZSkge1xuICAgICAgICBvbkNoYW5nZShlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMuaGFuZGxlS2V5RG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBvblByZXNzRW50ZXIgPSBfdGhpcyRwcm9wcy5vblByZXNzRW50ZXIsXG4gICAgICAgICAgb25LZXlEb3duID0gX3RoaXMkcHJvcHMub25LZXlEb3duO1xuXG4gICAgICBpZiAoZS5rZXlDb2RlID09PSAxMyAmJiBvblByZXNzRW50ZXIpIHtcbiAgICAgICAgb25QcmVzc0VudGVyKGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAob25LZXlEb3duKSB7XG4gICAgICAgIG9uS2V5RG93bihlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHZhbHVlID0gdHlwZW9mIHByb3BzLnZhbHVlID09PSAndW5kZWZpbmVkJyB8fCBwcm9wcy52YWx1ZSA9PT0gbnVsbCA/IHByb3BzLmRlZmF1bHRWYWx1ZSA6IHByb3BzLnZhbHVlO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgdmFsdWU6IHZhbHVlXG4gICAgfTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoVGV4dEFyZWEsIFt7XG4gICAga2V5OiBcInNldFZhbHVlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldFZhbHVlKHZhbHVlLCBjYWxsYmFjaykge1xuICAgICAgaWYgKCEoJ3ZhbHVlJyBpbiB0aGlzLnByb3BzKSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgfSwgY2FsbGJhY2spO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJibHVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGJsdXIoKSB7XG4gICAgICB0aGlzLnJlc2l6YWJsZVRleHRBcmVhLnRleHRBcmVhLmJsdXIoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChSZXNpemFibGVUZXh0QXJlYSwgX2V4dGVuZHMoe30sIHRoaXMucHJvcHMsIHtcbiAgICAgICAgdmFsdWU6IHRoaXMuc3RhdGUudmFsdWUsXG4gICAgICAgIG9uS2V5RG93bjogdGhpcy5oYW5kbGVLZXlEb3duLFxuICAgICAgICBvbkNoYW5nZTogdGhpcy5oYW5kbGVDaGFuZ2UsXG4gICAgICAgIHJlZjogdGhpcy5zYXZlVGV4dEFyZWFcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1dLCBbe1xuICAgIGtleTogXCJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzKG5leHRQcm9wcykge1xuICAgICAgaWYgKCd2YWx1ZScgaW4gbmV4dFByb3BzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdmFsdWU6IG5leHRQcm9wcy52YWx1ZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVGV4dEFyZWE7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5cbmV4cG9ydCB7IFJlc2l6YWJsZVRleHRBcmVhIH07XG5leHBvcnQgZGVmYXVsdCBUZXh0QXJlYTsiLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbnZhciBDb250ZW50ID0gZnVuY3Rpb24gQ29udGVudChwcm9wcykge1xuICB2YXIgb3ZlcmxheSA9IHByb3BzLm92ZXJsYXksXG4gICAgICBwcmVmaXhDbHMgPSBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBpZCA9IHByb3BzLmlkLFxuICAgICAgb3ZlcmxheUlubmVyU3R5bGUgPSBwcm9wcy5vdmVybGF5SW5uZXJTdHlsZTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItaW5uZXJcIiksXG4gICAgaWQ6IGlkLFxuICAgIHJvbGU6IFwidG9vbHRpcFwiLFxuICAgIHN0eWxlOiBvdmVybGF5SW5uZXJTdHlsZVxuICB9LCB0eXBlb2Ygb3ZlcmxheSA9PT0gJ2Z1bmN0aW9uJyA/IG92ZXJsYXkoKSA6IG92ZXJsYXkpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgQ29udGVudDsiLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfdHlwZW9mIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2ZcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RXaXRob3V0UHJvcGVydGllc1wiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlUmVmLCB1c2VJbXBlcmF0aXZlSGFuZGxlLCBmb3J3YXJkUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFRyaWdnZXIgZnJvbSAncmMtdHJpZ2dlcic7XG5pbXBvcnQgeyBwbGFjZW1lbnRzIH0gZnJvbSAnLi9wbGFjZW1lbnRzJztcbmltcG9ydCBDb250ZW50IGZyb20gJy4vQ29udGVudCc7XG5cbnZhciBUb29sdGlwID0gZnVuY3Rpb24gVG9vbHRpcChwcm9wcywgcmVmKSB7XG4gIHZhciBvdmVybGF5Q2xhc3NOYW1lID0gcHJvcHMub3ZlcmxheUNsYXNzTmFtZSxcbiAgICAgIF9wcm9wcyR0cmlnZ2VyID0gcHJvcHMudHJpZ2dlcixcbiAgICAgIHRyaWdnZXIgPSBfcHJvcHMkdHJpZ2dlciA9PT0gdm9pZCAwID8gWydob3ZlciddIDogX3Byb3BzJHRyaWdnZXIsXG4gICAgICBfcHJvcHMkbW91c2VFbnRlckRlbGEgPSBwcm9wcy5tb3VzZUVudGVyRGVsYXksXG4gICAgICBtb3VzZUVudGVyRGVsYXkgPSBfcHJvcHMkbW91c2VFbnRlckRlbGEgPT09IHZvaWQgMCA/IDAgOiBfcHJvcHMkbW91c2VFbnRlckRlbGEsXG4gICAgICBfcHJvcHMkbW91c2VMZWF2ZURlbGEgPSBwcm9wcy5tb3VzZUxlYXZlRGVsYXksXG4gICAgICBtb3VzZUxlYXZlRGVsYXkgPSBfcHJvcHMkbW91c2VMZWF2ZURlbGEgPT09IHZvaWQgMCA/IDAuMSA6IF9wcm9wcyRtb3VzZUxlYXZlRGVsYSxcbiAgICAgIG92ZXJsYXlTdHlsZSA9IHByb3BzLm92ZXJsYXlTdHlsZSxcbiAgICAgIF9wcm9wcyRwcmVmaXhDbHMgPSBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBwcmVmaXhDbHMgPSBfcHJvcHMkcHJlZml4Q2xzID09PSB2b2lkIDAgPyAncmMtdG9vbHRpcCcgOiBfcHJvcHMkcHJlZml4Q2xzLFxuICAgICAgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbixcbiAgICAgIG9uVmlzaWJsZUNoYW5nZSA9IHByb3BzLm9uVmlzaWJsZUNoYW5nZSxcbiAgICAgIGFmdGVyVmlzaWJsZUNoYW5nZSA9IHByb3BzLmFmdGVyVmlzaWJsZUNoYW5nZSxcbiAgICAgIHRyYW5zaXRpb25OYW1lID0gcHJvcHMudHJhbnNpdGlvbk5hbWUsXG4gICAgICBhbmltYXRpb24gPSBwcm9wcy5hbmltYXRpb24sXG4gICAgICBtb3Rpb24gPSBwcm9wcy5tb3Rpb24sXG4gICAgICBfcHJvcHMkcGxhY2VtZW50ID0gcHJvcHMucGxhY2VtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX3Byb3BzJHBsYWNlbWVudCA9PT0gdm9pZCAwID8gJ3JpZ2h0JyA6IF9wcm9wcyRwbGFjZW1lbnQsXG4gICAgICBfcHJvcHMkYWxpZ24gPSBwcm9wcy5hbGlnbixcbiAgICAgIGFsaWduID0gX3Byb3BzJGFsaWduID09PSB2b2lkIDAgPyB7fSA6IF9wcm9wcyRhbGlnbixcbiAgICAgIF9wcm9wcyRkZXN0cm95VG9vbHRpcCA9IHByb3BzLmRlc3Ryb3lUb29sdGlwT25IaWRlLFxuICAgICAgZGVzdHJveVRvb2x0aXBPbkhpZGUgPSBfcHJvcHMkZGVzdHJveVRvb2x0aXAgPT09IHZvaWQgMCA/IGZhbHNlIDogX3Byb3BzJGRlc3Ryb3lUb29sdGlwLFxuICAgICAgZGVmYXVsdFZpc2libGUgPSBwcm9wcy5kZWZhdWx0VmlzaWJsZSxcbiAgICAgIGdldFRvb2x0aXBDb250YWluZXIgPSBwcm9wcy5nZXRUb29sdGlwQ29udGFpbmVyLFxuICAgICAgb3ZlcmxheUlubmVyU3R5bGUgPSBwcm9wcy5vdmVybGF5SW5uZXJTdHlsZSxcbiAgICAgIHJlc3RQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhwcm9wcywgW1wib3ZlcmxheUNsYXNzTmFtZVwiLCBcInRyaWdnZXJcIiwgXCJtb3VzZUVudGVyRGVsYXlcIiwgXCJtb3VzZUxlYXZlRGVsYXlcIiwgXCJvdmVybGF5U3R5bGVcIiwgXCJwcmVmaXhDbHNcIiwgXCJjaGlsZHJlblwiLCBcIm9uVmlzaWJsZUNoYW5nZVwiLCBcImFmdGVyVmlzaWJsZUNoYW5nZVwiLCBcInRyYW5zaXRpb25OYW1lXCIsIFwiYW5pbWF0aW9uXCIsIFwibW90aW9uXCIsIFwicGxhY2VtZW50XCIsIFwiYWxpZ25cIiwgXCJkZXN0cm95VG9vbHRpcE9uSGlkZVwiLCBcImRlZmF1bHRWaXNpYmxlXCIsIFwiZ2V0VG9vbHRpcENvbnRhaW5lclwiLCBcIm92ZXJsYXlJbm5lclN0eWxlXCJdKTtcblxuICB2YXIgZG9tUmVmID0gdXNlUmVmKG51bGwpO1xuICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkb21SZWYuY3VycmVudDtcbiAgfSk7XG5cbiAgdmFyIGV4dHJhUHJvcHMgPSBfb2JqZWN0U3ByZWFkKHt9LCByZXN0UHJvcHMpO1xuXG4gIGlmICgndmlzaWJsZScgaW4gcHJvcHMpIHtcbiAgICBleHRyYVByb3BzLnBvcHVwVmlzaWJsZSA9IHByb3BzLnZpc2libGU7XG4gIH1cblxuICB2YXIgZ2V0UG9wdXBFbGVtZW50ID0gZnVuY3Rpb24gZ2V0UG9wdXBFbGVtZW50KCkge1xuICAgIHZhciBfcHJvcHMkYXJyb3dDb250ZW50ID0gcHJvcHMuYXJyb3dDb250ZW50LFxuICAgICAgICBhcnJvd0NvbnRlbnQgPSBfcHJvcHMkYXJyb3dDb250ZW50ID09PSB2b2lkIDAgPyBudWxsIDogX3Byb3BzJGFycm93Q29udGVudCxcbiAgICAgICAgb3ZlcmxheSA9IHByb3BzLm92ZXJsYXksXG4gICAgICAgIGlkID0gcHJvcHMuaWQ7XG4gICAgcmV0dXJuIFsvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItYXJyb3dcIiksXG4gICAgICBrZXk6IFwiYXJyb3dcIlxuICAgIH0sIGFycm93Q29udGVudCksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENvbnRlbnQsIHtcbiAgICAgIGtleTogXCJjb250ZW50XCIsXG4gICAgICBwcmVmaXhDbHM6IHByZWZpeENscyxcbiAgICAgIGlkOiBpZCxcbiAgICAgIG92ZXJsYXk6IG92ZXJsYXksXG4gICAgICBvdmVybGF5SW5uZXJTdHlsZTogb3ZlcmxheUlubmVyU3R5bGVcbiAgICB9KV07XG4gIH07XG5cbiAgdmFyIGRlc3Ryb3lUb29sdGlwID0gZmFsc2U7XG4gIHZhciBhdXRvRGVzdHJveSA9IGZhbHNlO1xuXG4gIGlmICh0eXBlb2YgZGVzdHJveVRvb2x0aXBPbkhpZGUgPT09ICdib29sZWFuJykge1xuICAgIGRlc3Ryb3lUb29sdGlwID0gZGVzdHJveVRvb2x0aXBPbkhpZGU7XG4gIH0gZWxzZSBpZiAoZGVzdHJveVRvb2x0aXBPbkhpZGUgJiYgX3R5cGVvZihkZXN0cm95VG9vbHRpcE9uSGlkZSkgPT09ICdvYmplY3QnKSB7XG4gICAgdmFyIGtlZXBQYXJlbnQgPSBkZXN0cm95VG9vbHRpcE9uSGlkZS5rZWVwUGFyZW50O1xuICAgIGRlc3Ryb3lUb29sdGlwID0ga2VlcFBhcmVudCA9PT0gdHJ1ZTtcbiAgICBhdXRvRGVzdHJveSA9IGtlZXBQYXJlbnQgPT09IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyaWdnZXIsIF9leHRlbmRzKHtcbiAgICBwb3B1cENsYXNzTmFtZTogb3ZlcmxheUNsYXNzTmFtZSxcbiAgICBwcmVmaXhDbHM6IHByZWZpeENscyxcbiAgICBwb3B1cDogZ2V0UG9wdXBFbGVtZW50LFxuICAgIGFjdGlvbjogdHJpZ2dlcixcbiAgICBidWlsdGluUGxhY2VtZW50czogcGxhY2VtZW50cyxcbiAgICBwb3B1cFBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgIHJlZjogZG9tUmVmLFxuICAgIHBvcHVwQWxpZ246IGFsaWduLFxuICAgIGdldFBvcHVwQ29udGFpbmVyOiBnZXRUb29sdGlwQ29udGFpbmVyLFxuICAgIG9uUG9wdXBWaXNpYmxlQ2hhbmdlOiBvblZpc2libGVDaGFuZ2UsXG4gICAgYWZ0ZXJQb3B1cFZpc2libGVDaGFuZ2U6IGFmdGVyVmlzaWJsZUNoYW5nZSxcbiAgICBwb3B1cFRyYW5zaXRpb25OYW1lOiB0cmFuc2l0aW9uTmFtZSxcbiAgICBwb3B1cEFuaW1hdGlvbjogYW5pbWF0aW9uLFxuICAgIHBvcHVwTW90aW9uOiBtb3Rpb24sXG4gICAgZGVmYXVsdFBvcHVwVmlzaWJsZTogZGVmYXVsdFZpc2libGUsXG4gICAgZGVzdHJveVBvcHVwT25IaWRlOiBkZXN0cm95VG9vbHRpcCxcbiAgICBhdXRvRGVzdHJveTogYXV0b0Rlc3Ryb3ksXG4gICAgbW91c2VMZWF2ZURlbGF5OiBtb3VzZUxlYXZlRGVsYXksXG4gICAgcG9wdXBTdHlsZTogb3ZlcmxheVN0eWxlLFxuICAgIG1vdXNlRW50ZXJEZWxheTogbW91c2VFbnRlckRlbGF5XG4gIH0sIGV4dHJhUHJvcHMpLCBjaGlsZHJlbik7XG59O1xuXG5leHBvcnQgZGVmYXVsdCAvKiNfX1BVUkVfXyovZm9yd2FyZFJlZihUb29sdGlwKTsiLCJpbXBvcnQgVG9vbHRpcCBmcm9tICcuL1Rvb2x0aXAnO1xuZXhwb3J0IGRlZmF1bHQgVG9vbHRpcDsiLCJ2YXIgYXV0b0FkanVzdE92ZXJmbG93ID0ge1xuICBhZGp1c3RYOiAxLFxuICBhZGp1c3RZOiAxXG59O1xudmFyIHRhcmdldE9mZnNldCA9IFswLCAwXTtcbmV4cG9ydCB2YXIgcGxhY2VtZW50cyA9IHtcbiAgbGVmdDoge1xuICAgIHBvaW50czogWydjcicsICdjbCddLFxuICAgIG92ZXJmbG93OiBhdXRvQWRqdXN0T3ZlcmZsb3csXG4gICAgb2Zmc2V0OiBbLTQsIDBdLFxuICAgIHRhcmdldE9mZnNldDogdGFyZ2V0T2Zmc2V0XG4gIH0sXG4gIHJpZ2h0OiB7XG4gICAgcG9pbnRzOiBbJ2NsJywgJ2NyJ10sXG4gICAgb3ZlcmZsb3c6IGF1dG9BZGp1c3RPdmVyZmxvdyxcbiAgICBvZmZzZXQ6IFs0LCAwXSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICB0b3A6IHtcbiAgICBwb2ludHM6IFsnYmMnLCAndGMnXSxcbiAgICBvdmVyZmxvdzogYXV0b0FkanVzdE92ZXJmbG93LFxuICAgIG9mZnNldDogWzAsIC00XSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICBib3R0b206IHtcbiAgICBwb2ludHM6IFsndGMnLCAnYmMnXSxcbiAgICBvdmVyZmxvdzogYXV0b0FkanVzdE92ZXJmbG93LFxuICAgIG9mZnNldDogWzAsIDRdLFxuICAgIHRhcmdldE9mZnNldDogdGFyZ2V0T2Zmc2V0XG4gIH0sXG4gIHRvcExlZnQ6IHtcbiAgICBwb2ludHM6IFsnYmwnLCAndGwnXSxcbiAgICBvdmVyZmxvdzogYXV0b0FkanVzdE92ZXJmbG93LFxuICAgIG9mZnNldDogWzAsIC00XSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICBsZWZ0VG9wOiB7XG4gICAgcG9pbnRzOiBbJ3RyJywgJ3RsJ10sXG4gICAgb3ZlcmZsb3c6IGF1dG9BZGp1c3RPdmVyZmxvdyxcbiAgICBvZmZzZXQ6IFstNCwgMF0sXG4gICAgdGFyZ2V0T2Zmc2V0OiB0YXJnZXRPZmZzZXRcbiAgfSxcbiAgdG9wUmlnaHQ6IHtcbiAgICBwb2ludHM6IFsnYnInLCAndHInXSxcbiAgICBvdmVyZmxvdzogYXV0b0FkanVzdE92ZXJmbG93LFxuICAgIG9mZnNldDogWzAsIC00XSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICByaWdodFRvcDoge1xuICAgIHBvaW50czogWyd0bCcsICd0ciddLFxuICAgIG92ZXJmbG93OiBhdXRvQWRqdXN0T3ZlcmZsb3csXG4gICAgb2Zmc2V0OiBbNCwgMF0sXG4gICAgdGFyZ2V0T2Zmc2V0OiB0YXJnZXRPZmZzZXRcbiAgfSxcbiAgYm90dG9tUmlnaHQ6IHtcbiAgICBwb2ludHM6IFsndHInLCAnYnInXSxcbiAgICBvdmVyZmxvdzogYXV0b0FkanVzdE92ZXJmbG93LFxuICAgIG9mZnNldDogWzAsIDRdLFxuICAgIHRhcmdldE9mZnNldDogdGFyZ2V0T2Zmc2V0XG4gIH0sXG4gIHJpZ2h0Qm90dG9tOiB7XG4gICAgcG9pbnRzOiBbJ2JsJywgJ2JyJ10sXG4gICAgb3ZlcmZsb3c6IGF1dG9BZGp1c3RPdmVyZmxvdyxcbiAgICBvZmZzZXQ6IFs0LCAwXSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICBib3R0b21MZWZ0OiB7XG4gICAgcG9pbnRzOiBbJ3RsJywgJ2JsJ10sXG4gICAgb3ZlcmZsb3c6IGF1dG9BZGp1c3RPdmVyZmxvdyxcbiAgICBvZmZzZXQ6IFswLCA0XSxcbiAgICB0YXJnZXRPZmZzZXQ6IHRhcmdldE9mZnNldFxuICB9LFxuICBsZWZ0Qm90dG9tOiB7XG4gICAgcG9pbnRzOiBbJ2JyJywgJ2JsJ10sXG4gICAgb3ZlcmZsb3c6IGF1dG9BZGp1c3RPdmVyZmxvdyxcbiAgICBvZmZzZXQ6IFstNCwgMF0sXG4gICAgdGFyZ2V0T2Zmc2V0OiB0YXJnZXRPZmZzZXRcbiAgfVxufTtcbmV4cG9ydCBkZWZhdWx0IHBsYWNlbWVudHM7IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuZXhwb3J0IHZhciBTZWxlY3RDb250ZXh0ID0gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUNvbnRleHQobnVsbCk7IiwiaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheVwiO1xuaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5XCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgS2V5Q29kZSBmcm9tIFwicmMtdXRpbC9lcy9LZXlDb2RlXCI7XG5pbXBvcnQgdXNlTWVtbyBmcm9tIFwicmMtdXRpbC9lcy9ob29rcy91c2VNZW1vXCI7XG5pbXBvcnQgVHJlZSBmcm9tICdyYy10cmVlJztcbmltcG9ydCB7IFNlbGVjdENvbnRleHQgfSBmcm9tICcuL0NvbnRleHQnO1xuaW1wb3J0IHVzZUtleVZhbHVlTWFwcGluZyBmcm9tICcuL2hvb2tzL3VzZUtleVZhbHVlTWFwcGluZyc7XG5pbXBvcnQgdXNlS2V5VmFsdWVNYXAgZnJvbSAnLi9ob29rcy91c2VLZXlWYWx1ZU1hcCc7XG52YXIgSElEREVOX1NUWUxFID0ge1xuICB3aWR0aDogMCxcbiAgaGVpZ2h0OiAwLFxuICBkaXNwbGF5OiAnZmxleCcsXG4gIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgb3BhY2l0eTogMCxcbiAgYm9yZGVyOiAwLFxuICBwYWRkaW5nOiAwLFxuICBtYXJnaW46IDBcbn07XG5cbnZhciBPcHRpb25MaXN0ID0gZnVuY3Rpb24gT3B0aW9uTGlzdChwcm9wcywgcmVmKSB7XG4gIHZhciBwcmVmaXhDbHMgPSBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBoZWlnaHQgPSBwcm9wcy5oZWlnaHQsXG4gICAgICBpdGVtSGVpZ2h0ID0gcHJvcHMuaXRlbUhlaWdodCxcbiAgICAgIHZpcnR1YWwgPSBwcm9wcy52aXJ0dWFsLFxuICAgICAgb3B0aW9ucyA9IHByb3BzLm9wdGlvbnMsXG4gICAgICBmbGF0dGVuT3B0aW9ucyA9IHByb3BzLmZsYXR0ZW5PcHRpb25zLFxuICAgICAgbXVsdGlwbGUgPSBwcm9wcy5tdWx0aXBsZSxcbiAgICAgIHNlYXJjaFZhbHVlID0gcHJvcHMuc2VhcmNoVmFsdWUsXG4gICAgICBvblNlbGVjdCA9IHByb3BzLm9uU2VsZWN0LFxuICAgICAgb25Ub2dnbGVPcGVuID0gcHJvcHMub25Ub2dnbGVPcGVuLFxuICAgICAgb3BlbiA9IHByb3BzLm9wZW4sXG4gICAgICBub3RGb3VuZENvbnRlbnQgPSBwcm9wcy5ub3RGb3VuZENvbnRlbnQsXG4gICAgICBvbk1vdXNlRW50ZXIgPSBwcm9wcy5vbk1vdXNlRW50ZXI7XG5cbiAgdmFyIF9SZWFjdCR1c2VDb250ZXh0ID0gUmVhY3QudXNlQ29udGV4dChTZWxlY3RDb250ZXh0KSxcbiAgICAgIGNoZWNrYWJsZSA9IF9SZWFjdCR1c2VDb250ZXh0LmNoZWNrYWJsZSxcbiAgICAgIGNoZWNrZWRLZXlzID0gX1JlYWN0JHVzZUNvbnRleHQuY2hlY2tlZEtleXMsXG4gICAgICBoYWxmQ2hlY2tlZEtleXMgPSBfUmVhY3QkdXNlQ29udGV4dC5oYWxmQ2hlY2tlZEtleXMsXG4gICAgICB0cmVlRXhwYW5kZWRLZXlzID0gX1JlYWN0JHVzZUNvbnRleHQudHJlZUV4cGFuZGVkS2V5cyxcbiAgICAgIHRyZWVEZWZhdWx0RXhwYW5kQWxsID0gX1JlYWN0JHVzZUNvbnRleHQudHJlZURlZmF1bHRFeHBhbmRBbGwsXG4gICAgICB0cmVlRGVmYXVsdEV4cGFuZGVkS2V5cyA9IF9SZWFjdCR1c2VDb250ZXh0LnRyZWVEZWZhdWx0RXhwYW5kZWRLZXlzLFxuICAgICAgb25UcmVlRXhwYW5kID0gX1JlYWN0JHVzZUNvbnRleHQub25UcmVlRXhwYW5kLFxuICAgICAgdHJlZUljb24gPSBfUmVhY3QkdXNlQ29udGV4dC50cmVlSWNvbixcbiAgICAgIHNob3dUcmVlSWNvbiA9IF9SZWFjdCR1c2VDb250ZXh0LnNob3dUcmVlSWNvbixcbiAgICAgIHN3aXRjaGVySWNvbiA9IF9SZWFjdCR1c2VDb250ZXh0LnN3aXRjaGVySWNvbixcbiAgICAgIHRyZWVMaW5lID0gX1JlYWN0JHVzZUNvbnRleHQudHJlZUxpbmUsXG4gICAgICB0cmVlTm9kZUZpbHRlclByb3AgPSBfUmVhY3QkdXNlQ29udGV4dC50cmVlTm9kZUZpbHRlclByb3AsXG4gICAgICBsb2FkRGF0YSA9IF9SZWFjdCR1c2VDb250ZXh0LmxvYWREYXRhLFxuICAgICAgdHJlZUxvYWRlZEtleXMgPSBfUmVhY3QkdXNlQ29udGV4dC50cmVlTG9hZGVkS2V5cyxcbiAgICAgIHRyZWVNb3Rpb24gPSBfUmVhY3QkdXNlQ29udGV4dC50cmVlTW90aW9uLFxuICAgICAgb25UcmVlTG9hZCA9IF9SZWFjdCR1c2VDb250ZXh0Lm9uVHJlZUxvYWQ7XG5cbiAgdmFyIHRyZWVSZWYgPSBSZWFjdC51c2VSZWYoKTtcbiAgdmFyIG1lbW9PcHRpb25zID0gdXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH0sIFtvcGVuLCBvcHRpb25zXSwgZnVuY3Rpb24gKHByZXYsIG5leHQpIHtcbiAgICByZXR1cm4gbmV4dFswXSAmJiBwcmV2WzFdICE9PSBuZXh0WzFdO1xuICB9KTtcblxuICB2YXIgX3VzZUtleVZhbHVlTWFwID0gdXNlS2V5VmFsdWVNYXAoZmxhdHRlbk9wdGlvbnMpLFxuICAgICAgX3VzZUtleVZhbHVlTWFwMiA9IF9zbGljZWRUb0FycmF5KF91c2VLZXlWYWx1ZU1hcCwgMiksXG4gICAgICBjYWNoZUtleU1hcCA9IF91c2VLZXlWYWx1ZU1hcDJbMF0sXG4gICAgICBjYWNoZVZhbHVlTWFwID0gX3VzZUtleVZhbHVlTWFwMlsxXTtcblxuICB2YXIgX3VzZUtleVZhbHVlTWFwcGluZyA9IHVzZUtleVZhbHVlTWFwcGluZyhjYWNoZUtleU1hcCwgY2FjaGVWYWx1ZU1hcCksXG4gICAgICBfdXNlS2V5VmFsdWVNYXBwaW5nMiA9IF9zbGljZWRUb0FycmF5KF91c2VLZXlWYWx1ZU1hcHBpbmcsIDIpLFxuICAgICAgZ2V0RW50aXR5QnlLZXkgPSBfdXNlS2V5VmFsdWVNYXBwaW5nMlswXSxcbiAgICAgIGdldEVudGl0eUJ5VmFsdWUgPSBfdXNlS2V5VmFsdWVNYXBwaW5nMlsxXTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT0gVmFsdWVzID09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuICB2YXIgdmFsdWVLZXlzID0gUmVhY3QudXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNoZWNrZWRLZXlzLm1hcChmdW5jdGlvbiAodmFsKSB7XG4gICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5QnlWYWx1ZSh2YWwpO1xuICAgICAgcmV0dXJuIGVudGl0eSA/IGVudGl0eS5rZXkgOiBudWxsO1xuICAgIH0pO1xuICB9LCBbY2hlY2tlZEtleXMsIGdldEVudGl0eUJ5VmFsdWVdKTtcbiAgdmFyIG1lcmdlZENoZWNrZWRLZXlzID0gUmVhY3QudXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFjaGVja2FibGUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBjaGVja2VkOiB2YWx1ZUtleXMsXG4gICAgICBoYWxmQ2hlY2tlZDogaGFsZkNoZWNrZWRLZXlzXG4gICAgfTtcbiAgfSwgW3ZhbHVlS2V5cywgaGFsZkNoZWNrZWRLZXlzLCBjaGVja2FibGVdKTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT0gU2Nyb2xsID09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICAvLyBTaW5nbGUgbW9kZSBzaG91bGQgc2Nyb2xsIHRvIGN1cnJlbnQga2V5XG4gICAgaWYgKG9wZW4gJiYgIW11bHRpcGxlICYmIHZhbHVlS2V5cy5sZW5ndGgpIHtcbiAgICAgIHZhciBfdHJlZVJlZiRjdXJyZW50O1xuXG4gICAgICAoX3RyZWVSZWYkY3VycmVudCA9IHRyZWVSZWYuY3VycmVudCkgPT09IG51bGwgfHwgX3RyZWVSZWYkY3VycmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RyZWVSZWYkY3VycmVudC5zY3JvbGxUbyh7XG4gICAgICAgIGtleTogdmFsdWVLZXlzWzBdXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIFtvcGVuXSk7IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09IFNlYXJjaCA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBsb3dlclNlYXJjaFZhbHVlID0gU3RyaW5nKHNlYXJjaFZhbHVlKS50b0xvd2VyQ2FzZSgpO1xuXG4gIHZhciBmaWx0ZXJUcmVlTm9kZSA9IGZ1bmN0aW9uIGZpbHRlclRyZWVOb2RlKHRyZWVOb2RlKSB7XG4gICAgaWYgKCFsb3dlclNlYXJjaFZhbHVlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIFN0cmluZyh0cmVlTm9kZVt0cmVlTm9kZUZpbHRlclByb3BdKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyU2VhcmNoVmFsdWUpO1xuICB9OyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT0gS2V5cyA9PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4gIHZhciBfUmVhY3QkdXNlU3RhdGUgPSBSZWFjdC51c2VTdGF0ZSh0cmVlRGVmYXVsdEV4cGFuZGVkS2V5cyksXG4gICAgICBfUmVhY3QkdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlLCAyKSxcbiAgICAgIGV4cGFuZGVkS2V5cyA9IF9SZWFjdCR1c2VTdGF0ZTJbMF0sXG4gICAgICBzZXRFeHBhbmRlZEtleXMgPSBfUmVhY3QkdXNlU3RhdGUyWzFdO1xuXG4gIHZhciBfUmVhY3QkdXNlU3RhdGUzID0gUmVhY3QudXNlU3RhdGUobnVsbCksXG4gICAgICBfUmVhY3QkdXNlU3RhdGU0ID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlMywgMiksXG4gICAgICBzZWFyY2hFeHBhbmRlZEtleXMgPSBfUmVhY3QkdXNlU3RhdGU0WzBdLFxuICAgICAgc2V0U2VhcmNoRXhwYW5kZWRLZXlzID0gX1JlYWN0JHVzZVN0YXRlNFsxXTtcblxuICB2YXIgbWVyZ2VkRXhwYW5kZWRLZXlzID0gUmVhY3QudXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRyZWVFeHBhbmRlZEtleXMpIHtcbiAgICAgIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkodHJlZUV4cGFuZGVkS2V5cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlYXJjaFZhbHVlID8gc2VhcmNoRXhwYW5kZWRLZXlzIDogZXhwYW5kZWRLZXlzO1xuICB9LCBbZXhwYW5kZWRLZXlzLCBzZWFyY2hFeHBhbmRlZEtleXMsIGxvd2VyU2VhcmNoVmFsdWUsIHRyZWVFeHBhbmRlZEtleXNdKTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoc2VhcmNoVmFsdWUpIHtcbiAgICAgIHNldFNlYXJjaEV4cGFuZGVkS2V5cyhmbGF0dGVuT3B0aW9ucy5tYXAoZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgcmV0dXJuIG8ua2V5O1xuICAgICAgfSkpO1xuICAgIH1cbiAgfSwgW3NlYXJjaFZhbHVlXSk7XG5cbiAgdmFyIG9uSW50ZXJuYWxFeHBhbmQgPSBmdW5jdGlvbiBvbkludGVybmFsRXhwYW5kKGtleXMpIHtcbiAgICBzZXRFeHBhbmRlZEtleXMoa2V5cyk7XG4gICAgc2V0U2VhcmNoRXhwYW5kZWRLZXlzKGtleXMpO1xuXG4gICAgaWYgKG9uVHJlZUV4cGFuZCkge1xuICAgICAgb25UcmVlRXhwYW5kKGtleXMpO1xuICAgIH1cbiAgfTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT0gRXZlbnRzID09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblxuICB2YXIgb25MaXN0TW91c2VEb3duID0gZnVuY3Rpb24gb25MaXN0TW91c2VEb3duKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfTtcblxuICB2YXIgb25JbnRlcm5hbFNlbGVjdCA9IGZ1bmN0aW9uIG9uSW50ZXJuYWxTZWxlY3QoXywgX3JlZikge1xuICAgIHZhciBrZXkgPSBfcmVmLm5vZGUua2V5O1xuICAgIHZhciBlbnRpdHkgPSBnZXRFbnRpdHlCeUtleShrZXksIGNoZWNrYWJsZSA/ICdjaGVja2JveCcgOiAnc2VsZWN0Jyk7XG5cbiAgICBpZiAoZW50aXR5ICE9PSBudWxsKSB7XG4gICAgICBvblNlbGVjdChlbnRpdHkuZGF0YS52YWx1ZSwge1xuICAgICAgICBzZWxlY3RlZDogIWNoZWNrZWRLZXlzLmluY2x1ZGVzKGVudGl0eS5kYXRhLnZhbHVlKVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFtdWx0aXBsZSkge1xuICAgICAgb25Ub2dnbGVPcGVuKGZhbHNlKTtcbiAgICB9XG4gIH07IC8vID09PT09PT09PT09PT09PT09PT09PT09PT0gS2V5Ym9hcmQgPT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgdmFyIF9SZWFjdCR1c2VTdGF0ZTUgPSBSZWFjdC51c2VTdGF0ZShudWxsKSxcbiAgICAgIF9SZWFjdCR1c2VTdGF0ZTYgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGU1LCAyKSxcbiAgICAgIGFjdGl2ZUtleSA9IF9SZWFjdCR1c2VTdGF0ZTZbMF0sXG4gICAgICBzZXRBY3RpdmVLZXkgPSBfUmVhY3QkdXNlU3RhdGU2WzFdO1xuXG4gIHZhciBhY3RpdmVFbnRpdHkgPSBnZXRFbnRpdHlCeUtleShhY3RpdmVLZXkpO1xuICBSZWFjdC51c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfdHJlZVJlZiRjdXJyZW50MjtcblxuICAgIHJldHVybiB7XG4gICAgICBzY3JvbGxUbzogKF90cmVlUmVmJGN1cnJlbnQyID0gdHJlZVJlZi5jdXJyZW50KSA9PT0gbnVsbCB8fCBfdHJlZVJlZiRjdXJyZW50MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RyZWVSZWYkY3VycmVudDIuc2Nyb2xsVG8sXG4gICAgICBvbktleURvd246IGZ1bmN0aW9uIG9uS2V5RG93bihldmVudCkge1xuICAgICAgICB2YXIgX3RyZWVSZWYkY3VycmVudDM7XG5cbiAgICAgICAgdmFyIHdoaWNoID0gZXZlbnQud2hpY2g7XG5cbiAgICAgICAgc3dpdGNoICh3aGljaCkge1xuICAgICAgICAgIC8vID4+PiBBcnJvdyBrZXlzXG4gICAgICAgICAgY2FzZSBLZXlDb2RlLlVQOlxuICAgICAgICAgIGNhc2UgS2V5Q29kZS5ET1dOOlxuICAgICAgICAgIGNhc2UgS2V5Q29kZS5MRUZUOlxuICAgICAgICAgIGNhc2UgS2V5Q29kZS5SSUdIVDpcbiAgICAgICAgICAgIChfdHJlZVJlZiRjdXJyZW50MyA9IHRyZWVSZWYuY3VycmVudCkgPT09IG51bGwgfHwgX3RyZWVSZWYkY3VycmVudDMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90cmVlUmVmJGN1cnJlbnQzLm9uS2V5RG93bihldmVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAvLyA+Pj4gU2VsZWN0IGl0ZW1cblxuICAgICAgICAgIGNhc2UgS2V5Q29kZS5FTlRFUjpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFyIF9yZWYyID0gKGFjdGl2ZUVudGl0eSA9PT0gbnVsbCB8fCBhY3RpdmVFbnRpdHkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFjdGl2ZUVudGl0eS5kYXRhKSB8fCB7fSxcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGUgPSBfcmVmMi5zZWxlY3RhYmxlLFxuICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfcmVmMi52YWx1ZTtcblxuICAgICAgICAgICAgICBpZiAoc2VsZWN0YWJsZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBvbkludGVybmFsU2VsZWN0KG51bGwsIHtcbiAgICAgICAgICAgICAgICAgIG5vZGU6IHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiBhY3RpdmVLZXlcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZDogIWNoZWNrZWRLZXlzLmluY2x1ZGVzKHZhbHVlKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLy8gPj4+IENsb3NlXG5cbiAgICAgICAgICBjYXNlIEtleUNvZGUuRVNDOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBvblRvZ2dsZU9wZW4oZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25LZXlVcDogZnVuY3Rpb24gb25LZXlVcCgpIHt9XG4gICAgfTtcbiAgfSk7IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09IFJlbmRlciA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGlmIChtZW1vT3B0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgICAgcm9sZTogXCJsaXN0Ym94XCIsXG4gICAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItZW1wdHlcIiksXG4gICAgICBvbk1vdXNlRG93bjogb25MaXN0TW91c2VEb3duXG4gICAgfSwgbm90Rm91bmRDb250ZW50KTtcbiAgfVxuXG4gIHZhciB0cmVlUHJvcHMgPSB7fTtcblxuICBpZiAodHJlZUxvYWRlZEtleXMpIHtcbiAgICB0cmVlUHJvcHMubG9hZGVkS2V5cyA9IHRyZWVMb2FkZWRLZXlzO1xuICB9XG5cbiAgaWYgKG1lcmdlZEV4cGFuZGVkS2V5cykge1xuICAgIHRyZWVQcm9wcy5leHBhbmRlZEtleXMgPSBtZXJnZWRFeHBhbmRlZEtleXM7XG4gIH1cblxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIG9uTW91c2VEb3duOiBvbkxpc3RNb3VzZURvd24sXG4gICAgb25Nb3VzZUVudGVyOiBvbk1vdXNlRW50ZXJcbiAgfSwgYWN0aXZlRW50aXR5ICYmIG9wZW4gJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtcbiAgICBzdHlsZTogSElEREVOX1NUWUxFLFxuICAgIFwiYXJpYS1saXZlXCI6IFwiYXNzZXJ0aXZlXCJcbiAgfSwgYWN0aXZlRW50aXR5LmRhdGEudmFsdWUpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmVlLCBfZXh0ZW5kcyh7XG4gICAgcmVmOiB0cmVlUmVmLFxuICAgIGZvY3VzYWJsZTogZmFsc2UsXG4gICAgcHJlZml4Q2xzOiBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVcIiksXG4gICAgdHJlZURhdGE6IG1lbW9PcHRpb25zLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIGl0ZW1IZWlnaHQ6IGl0ZW1IZWlnaHQsXG4gICAgdmlydHVhbDogdmlydHVhbCxcbiAgICBtdWx0aXBsZTogbXVsdGlwbGUsXG4gICAgaWNvbjogdHJlZUljb24sXG4gICAgc2hvd0ljb246IHNob3dUcmVlSWNvbixcbiAgICBzd2l0Y2hlckljb246IHN3aXRjaGVySWNvbixcbiAgICBzaG93TGluZTogdHJlZUxpbmUsXG4gICAgbG9hZERhdGE6IHNlYXJjaFZhbHVlID8gbnVsbCA6IGxvYWREYXRhLFxuICAgIG1vdGlvbjogdHJlZU1vdGlvbiAvLyBXZSBoYW5kbGUga2V5cyBieSBvdXQgaW5zdGVhZCB0cmVlIHNlbGZcbiAgICAsXG4gICAgY2hlY2thYmxlOiBjaGVja2FibGUsXG4gICAgY2hlY2tTdHJpY3RseTogdHJ1ZSxcbiAgICBjaGVja2VkS2V5czogbWVyZ2VkQ2hlY2tlZEtleXMsXG4gICAgc2VsZWN0ZWRLZXlzOiAhY2hlY2thYmxlID8gdmFsdWVLZXlzIDogW10sXG4gICAgZGVmYXVsdEV4cGFuZEFsbDogdHJlZURlZmF1bHRFeHBhbmRBbGxcbiAgfSwgdHJlZVByb3BzLCB7XG4gICAgLy8gUHJveHkgZXZlbnQgb3V0XG4gICAgb25BY3RpdmVDaGFuZ2U6IHNldEFjdGl2ZUtleSxcbiAgICBvblNlbGVjdDogb25JbnRlcm5hbFNlbGVjdCxcbiAgICBvbkNoZWNrOiBvbkludGVybmFsU2VsZWN0LFxuICAgIG9uRXhwYW5kOiBvbkludGVybmFsRXhwYW5kLFxuICAgIG9uTG9hZDogb25UcmVlTG9hZCxcbiAgICBmaWx0ZXJUcmVlTm9kZTogZmlsdGVyVHJlZU5vZGVcbiAgfSkpKTtcbn07XG5cbnZhciBSZWZPcHRpb25MaXN0ID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoT3B0aW9uTGlzdCk7XG5SZWZPcHRpb25MaXN0LmRpc3BsYXlOYW1lID0gJ09wdGlvbkxpc3QnO1xuZXhwb3J0IGRlZmF1bHQgUmVmT3B0aW9uTGlzdDsiLCIvKiogVGhpcyBpcyBhIHBsYWNlaG9sZGVyLCBub3QgcmVhbCByZW5kZXIgaW4gZG9tICovXG52YXIgVHJlZU5vZGUgPSBmdW5jdGlvbiBUcmVlTm9kZSgpIHtcbiAgcmV0dXJuIG51bGw7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBUcmVlTm9kZTsiLCJpbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVja1wiO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3NcIjtcbmltcG9ydCBfaW5oZXJpdHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzXCI7XG5pbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlclwiO1xuaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheVwiO1xuaW1wb3J0IF90eXBlb2YgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZlwiO1xuaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5XCI7XG5pbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMlwiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlTWVtbyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBnZW5lcmF0ZVNlbGVjdG9yIGZyb20gXCJyYy1zZWxlY3QvZXMvZ2VuZXJhdGVcIjtcbmltcG9ydCB7IGdldExhYmVsZWRWYWx1ZSB9IGZyb20gXCJyYy1zZWxlY3QvZXMvdXRpbHMvdmFsdWVVdGlsXCI7XG5pbXBvcnQgeyBjb252ZXJ0RGF0YVRvRW50aXRpZXMgfSBmcm9tIFwicmMtdHJlZS9lcy91dGlscy90cmVlVXRpbFwiO1xuaW1wb3J0IHsgY29uZHVjdENoZWNrIH0gZnJvbSBcInJjLXRyZWUvZXMvdXRpbHMvY29uZHVjdFV0aWxcIjtcbmltcG9ydCB7IElOVEVSTkFMX1BST1BTX01BUksgfSBmcm9tIFwicmMtc2VsZWN0L2VzL2ludGVyZmFjZS9nZW5lcmF0b3JcIjtcbmltcG9ydCB1c2VNZXJnZWRTdGF0ZSBmcm9tIFwicmMtdXRpbC9lcy9ob29rcy91c2VNZXJnZWRTdGF0ZVwiO1xuaW1wb3J0IHdhcm5pbmcgZnJvbSBcInJjLXV0aWwvZXMvd2FybmluZ1wiO1xuaW1wb3J0IE9wdGlvbkxpc3QgZnJvbSAnLi9PcHRpb25MaXN0JztcbmltcG9ydCBUcmVlTm9kZSBmcm9tICcuL1RyZWVOb2RlJztcbmltcG9ydCB7IGZsYXR0ZW5PcHRpb25zLCBmaWx0ZXJPcHRpb25zLCBpc1ZhbHVlRGlzYWJsZWQsIGZpbmRWYWx1ZU9wdGlvbiwgYWRkVmFsdWUsIHJlbW92ZVZhbHVlLCBnZXRSYXdWYWx1ZUxhYmVsZWQsIHRvQXJyYXkgfSBmcm9tICcuL3V0aWxzL3ZhbHVlVXRpbCc7XG5pbXBvcnQgd2FybmluZ1Byb3BzIGZyb20gJy4vdXRpbHMvd2FybmluZ1Byb3BzVXRpbCc7XG5pbXBvcnQgeyBTZWxlY3RDb250ZXh0IH0gZnJvbSAnLi9Db250ZXh0JztcbmltcG9ydCB1c2VUcmVlRGF0YSBmcm9tICcuL2hvb2tzL3VzZVRyZWVEYXRhJztcbmltcG9ydCB1c2VLZXlWYWx1ZU1hcCBmcm9tICcuL2hvb2tzL3VzZUtleVZhbHVlTWFwJztcbmltcG9ydCB1c2VLZXlWYWx1ZU1hcHBpbmcgZnJvbSAnLi9ob29rcy91c2VLZXlWYWx1ZU1hcHBpbmcnO1xuaW1wb3J0IHsgZm9ybWF0U3RyYXRlZ3lLZXlzLCBTSE9XX0FMTCwgU0hPV19QQVJFTlQsIFNIT1dfQ0hJTEQgfSBmcm9tICcuL3V0aWxzL3N0cmF0ZWd5VXRpbCc7XG5pbXBvcnQgeyBmaWxsQWRkaXRpb25hbEluZm8gfSBmcm9tICcuL3V0aWxzL2xlZ2FjeVV0aWwnO1xuaW1wb3J0IHVzZVNlbGVjdFZhbHVlcyBmcm9tICcuL2hvb2tzL3VzZVNlbGVjdFZhbHVlcyc7XG52YXIgT01JVF9QUk9QUyA9IFsnZXhwYW5kZWRLZXlzJywgJ3RyZWVEYXRhJywgJ3RyZWVDaGVja2FibGUnLCAnc2hvd0NoZWNrZWRTdHJhdGVneScsICdzZWFyY2hQbGFjZWhvbGRlcicsICd0cmVlTGluZScsICd0cmVlSWNvbicsICdzaG93VHJlZUljb24nLCAnc3dpdGNoZXJJY29uJywgJ3RyZWVOb2RlRmlsdGVyUHJvcCcsICdmaWx0ZXJUcmVlTm9kZScsICdkcm9wZG93blBvcHVwQWxpZ24nLCAndHJlZURlZmF1bHRFeHBhbmRBbGwnLCAndHJlZUNoZWNrU3RyaWN0bHknLCAndHJlZUV4cGFuZGVkS2V5cycsICd0cmVlTG9hZGVkS2V5cycsICd0cmVlTW90aW9uJywgJ29uVHJlZUV4cGFuZCcsICdvblRyZWVMb2FkJywgJ2xvYWREYXRhJywgJ3RyZWVEYXRhU2ltcGxlTW9kZScsICd0cmVlTm9kZUxhYmVsUHJvcCcsICd0cmVlRGVmYXVsdEV4cGFuZGVkS2V5cyddO1xudmFyIFJlZlNlbGVjdCA9IGdlbmVyYXRlU2VsZWN0b3Ioe1xuICBwcmVmaXhDbHM6ICdyYy10cmVlLXNlbGVjdCcsXG4gIGNvbXBvbmVudHM6IHtcbiAgICBvcHRpb25MaXN0OiBPcHRpb25MaXN0XG4gIH0sXG4gIC8vIE5vdCB1c2UgZ2VuZXJhdGUgc2luY2Ugd2Ugd2lsbCBoYW5kbGUgb3Vyc2VsZlxuICBjb252ZXJ0Q2hpbGRyZW5Ub0RhdGE6IGZ1bmN0aW9uIGNvbnZlcnRDaGlsZHJlblRvRGF0YSgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcbiAgZmxhdHRlbk9wdGlvbnM6IGZsYXR0ZW5PcHRpb25zLFxuICAvLyBIYW5kbGUgYG9wdGlvbkxhYmVsUHJvcGAgaW4gVHJlZVNlbGVjdCBjb21wb25lbnRcbiAgZ2V0TGFiZWxlZFZhbHVlOiBnZXRMYWJlbGVkVmFsdWUsXG4gIGZpbHRlck9wdGlvbnM6IGZpbHRlck9wdGlvbnMsXG4gIGlzVmFsdWVEaXNhYmxlZDogaXNWYWx1ZURpc2FibGVkLFxuICBmaW5kVmFsdWVPcHRpb246IGZpbmRWYWx1ZU9wdGlvbixcbiAgb21pdERPTVByb3BzOiBmdW5jdGlvbiBvbWl0RE9NUHJvcHMocHJvcHMpIHtcbiAgICB2YXIgY2xvbmVQcm9wcyA9IF9vYmplY3RTcHJlYWQoe30sIHByb3BzKTtcblxuICAgIE9NSVRfUFJPUFMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuICAgICAgZGVsZXRlIGNsb25lUHJvcHNbcHJvcF07XG4gICAgfSk7XG4gICAgcmV0dXJuIGNsb25lUHJvcHM7XG4gIH1cbn0pO1xuUmVmU2VsZWN0LmRpc3BsYXlOYW1lID0gJ1NlbGVjdCc7XG52YXIgUmVmVHJlZVNlbGVjdCA9IC8qI19fUFVSRV9fKi9SZWFjdC5mb3J3YXJkUmVmKGZ1bmN0aW9uIChwcm9wcywgcmVmKSB7XG4gIHZhciBtdWx0aXBsZSA9IHByb3BzLm11bHRpcGxlLFxuICAgICAgdHJlZUNoZWNrYWJsZSA9IHByb3BzLnRyZWVDaGVja2FibGUsXG4gICAgICB0cmVlQ2hlY2tTdHJpY3RseSA9IHByb3BzLnRyZWVDaGVja1N0cmljdGx5LFxuICAgICAgX3Byb3BzJHNob3dDaGVja2VkU3RyID0gcHJvcHMuc2hvd0NoZWNrZWRTdHJhdGVneSxcbiAgICAgIHNob3dDaGVja2VkU3RyYXRlZ3kgPSBfcHJvcHMkc2hvd0NoZWNrZWRTdHIgPT09IHZvaWQgMCA/ICdTSE9XX0NISUxEJyA6IF9wcm9wcyRzaG93Q2hlY2tlZFN0cixcbiAgICAgIGxhYmVsSW5WYWx1ZSA9IHByb3BzLmxhYmVsSW5WYWx1ZSxcbiAgICAgIGxvYWREYXRhID0gcHJvcHMubG9hZERhdGEsXG4gICAgICB0cmVlTG9hZGVkS2V5cyA9IHByb3BzLnRyZWVMb2FkZWRLZXlzLFxuICAgICAgX3Byb3BzJHRyZWVOb2RlRmlsdGVyID0gcHJvcHMudHJlZU5vZGVGaWx0ZXJQcm9wLFxuICAgICAgdHJlZU5vZGVGaWx0ZXJQcm9wID0gX3Byb3BzJHRyZWVOb2RlRmlsdGVyID09PSB2b2lkIDAgPyAndmFsdWUnIDogX3Byb3BzJHRyZWVOb2RlRmlsdGVyLFxuICAgICAgdHJlZU5vZGVMYWJlbFByb3AgPSBwcm9wcy50cmVlTm9kZUxhYmVsUHJvcCxcbiAgICAgIHRyZWVEYXRhU2ltcGxlTW9kZSA9IHByb3BzLnRyZWVEYXRhU2ltcGxlTW9kZSxcbiAgICAgIHRyZWVEYXRhID0gcHJvcHMudHJlZURhdGEsXG4gICAgICB0cmVlRXhwYW5kZWRLZXlzID0gcHJvcHMudHJlZUV4cGFuZGVkS2V5cyxcbiAgICAgIHRyZWVEZWZhdWx0RXhwYW5kZWRLZXlzID0gcHJvcHMudHJlZURlZmF1bHRFeHBhbmRlZEtleXMsXG4gICAgICB0cmVlRGVmYXVsdEV4cGFuZEFsbCA9IHByb3BzLnRyZWVEZWZhdWx0RXhwYW5kQWxsLFxuICAgICAgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbixcbiAgICAgIHRyZWVJY29uID0gcHJvcHMudHJlZUljb24sXG4gICAgICBzaG93VHJlZUljb24gPSBwcm9wcy5zaG93VHJlZUljb24sXG4gICAgICBzd2l0Y2hlckljb24gPSBwcm9wcy5zd2l0Y2hlckljb24sXG4gICAgICB0cmVlTGluZSA9IHByb3BzLnRyZWVMaW5lLFxuICAgICAgdHJlZU1vdGlvbiA9IHByb3BzLnRyZWVNb3Rpb24sXG4gICAgICBmaWx0ZXJUcmVlTm9kZSA9IHByb3BzLmZpbHRlclRyZWVOb2RlLFxuICAgICAgZHJvcGRvd25Qb3B1cEFsaWduID0gcHJvcHMuZHJvcGRvd25Qb3B1cEFsaWduLFxuICAgICAgb25DaGFuZ2UgPSBwcm9wcy5vbkNoYW5nZSxcbiAgICAgIG9uVHJlZUV4cGFuZCA9IHByb3BzLm9uVHJlZUV4cGFuZCxcbiAgICAgIG9uVHJlZUxvYWQgPSBwcm9wcy5vblRyZWVMb2FkLFxuICAgICAgb25Ecm9wZG93blZpc2libGVDaGFuZ2UgPSBwcm9wcy5vbkRyb3Bkb3duVmlzaWJsZUNoYW5nZSxcbiAgICAgIG9uU2VsZWN0ID0gcHJvcHMub25TZWxlY3QsXG4gICAgICBvbkRlc2VsZWN0ID0gcHJvcHMub25EZXNlbGVjdDtcbiAgdmFyIG1lcmdlZENoZWNrYWJsZSA9IHRyZWVDaGVja2FibGUgfHwgdHJlZUNoZWNrU3RyaWN0bHk7XG4gIHZhciBtZXJnZWRNdWx0aXBsZSA9IG11bHRpcGxlIHx8IG1lcmdlZENoZWNrYWJsZTtcbiAgdmFyIHRyZWVDb25kdWN0aW9uID0gdHJlZUNoZWNrYWJsZSAmJiAhdHJlZUNoZWNrU3RyaWN0bHk7XG4gIHZhciBtZXJnZWRMYWJlbEluVmFsdWUgPSB0cmVlQ2hlY2tTdHJpY3RseSB8fCBsYWJlbEluVmFsdWU7IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09IFJlZiA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBzZWxlY3RSZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIFJlYWN0LnVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjcm9sbFRvOiBzZWxlY3RSZWYuY3VycmVudC5zY3JvbGxUbyxcbiAgICAgIGZvY3VzOiBzZWxlY3RSZWYuY3VycmVudC5mb2N1cyxcbiAgICAgIGJsdXI6IHNlbGVjdFJlZi5jdXJyZW50LmJsdXJcbiAgICB9O1xuICB9KTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT0gVHJlZSBEYXRhID09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIExlZ2FjeSBib3RoIHN1cHBvcnQgYGxhYmVsYCBvciBgdGl0bGVgIGlmIG5vdCBzZXQuXG4gIC8vIFdlIGhhdmUgdG8gZmFsbGJhY2sgdG8gZnVuY3Rpb24gdG8gaGFuZGxlIHRoaXNcblxuICB2YXIgZ2V0VHJlZU5vZGVUaXRsZSA9IGZ1bmN0aW9uIGdldFRyZWVOb2RlVGl0bGUobm9kZSkge1xuICAgIGlmICghdHJlZURhdGEpIHtcbiAgICAgIHJldHVybiBub2RlLnRpdGxlO1xuICAgIH1cblxuICAgIHJldHVybiBub2RlLmxhYmVsIHx8IG5vZGUudGl0bGU7XG4gIH07XG5cbiAgdmFyIGdldFRyZWVOb2RlTGFiZWxQcm9wID0gZnVuY3Rpb24gZ2V0VHJlZU5vZGVMYWJlbFByb3Aobm9kZSkge1xuICAgIGlmICh0cmVlTm9kZUxhYmVsUHJvcCkge1xuICAgICAgcmV0dXJuIG5vZGVbdHJlZU5vZGVMYWJlbFByb3BdO1xuICAgIH1cblxuICAgIHJldHVybiBnZXRUcmVlTm9kZVRpdGxlKG5vZGUpO1xuICB9O1xuXG4gIHZhciBtZXJnZWRUcmVlRGF0YSA9IHVzZVRyZWVEYXRhKHRyZWVEYXRhLCBjaGlsZHJlbiwge1xuICAgIGdldExhYmVsUHJvcDogZ2V0VHJlZU5vZGVUaXRsZSxcbiAgICBzaW1wbGVNb2RlOiB0cmVlRGF0YVNpbXBsZU1vZGVcbiAgfSk7XG4gIHZhciBmbGF0dGVkT3B0aW9ucyA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmbGF0dGVuT3B0aW9ucyhtZXJnZWRUcmVlRGF0YSk7XG4gIH0sIFttZXJnZWRUcmVlRGF0YV0pO1xuXG4gIHZhciBfdXNlS2V5VmFsdWVNYXAgPSB1c2VLZXlWYWx1ZU1hcChmbGF0dGVkT3B0aW9ucyksXG4gICAgICBfdXNlS2V5VmFsdWVNYXAyID0gX3NsaWNlZFRvQXJyYXkoX3VzZUtleVZhbHVlTWFwLCAyKSxcbiAgICAgIGNhY2hlS2V5TWFwID0gX3VzZUtleVZhbHVlTWFwMlswXSxcbiAgICAgIGNhY2hlVmFsdWVNYXAgPSBfdXNlS2V5VmFsdWVNYXAyWzFdO1xuXG4gIHZhciBfdXNlS2V5VmFsdWVNYXBwaW5nID0gdXNlS2V5VmFsdWVNYXBwaW5nKGNhY2hlS2V5TWFwLCBjYWNoZVZhbHVlTWFwKSxcbiAgICAgIF91c2VLZXlWYWx1ZU1hcHBpbmcyID0gX3NsaWNlZFRvQXJyYXkoX3VzZUtleVZhbHVlTWFwcGluZywgMiksXG4gICAgICBnZXRFbnRpdHlCeUtleSA9IF91c2VLZXlWYWx1ZU1hcHBpbmcyWzBdLFxuICAgICAgZ2V0RW50aXR5QnlWYWx1ZSA9IF91c2VLZXlWYWx1ZU1hcHBpbmcyWzFdOyAvLyBPbmx5IGdlbmVyYXRlIGtleUVudGl0aWVzIGZvciBjaGVjayBjb25kdWN0aW9uIHdoZW4gaXMgYHRyZWVDaGVja2FibGVgXG5cblxuICB2YXIgX3VzZU1lbW8gPSB1c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHJlZUNvbmR1Y3Rpb24pIHtcbiAgICAgIHJldHVybiBjb252ZXJ0RGF0YVRvRW50aXRpZXMobWVyZ2VkVHJlZURhdGEpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBrZXlFbnRpdGllczogbnVsbFxuICAgIH07XG4gIH0sIFttZXJnZWRUcmVlRGF0YSwgdHJlZUNoZWNrYWJsZSwgdHJlZUNoZWNrU3RyaWN0bHldKSxcbiAgICAgIGNvbmR1Y3RLZXlFbnRpdGllcyA9IF91c2VNZW1vLmtleUVudGl0aWVzOyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09IFZhbHVlID09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4gIHZhciBfdXNlTWVyZ2VkU3RhdGUgPSB1c2VNZXJnZWRTdGF0ZShwcm9wcy5kZWZhdWx0VmFsdWUsIHtcbiAgICB2YWx1ZTogcHJvcHMudmFsdWVcbiAgfSksXG4gICAgICBfdXNlTWVyZ2VkU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZU1lcmdlZFN0YXRlLCAyKSxcbiAgICAgIHZhbHVlID0gX3VzZU1lcmdlZFN0YXRlMlswXSxcbiAgICAgIHNldFZhbHVlID0gX3VzZU1lcmdlZFN0YXRlMlsxXTtcbiAgLyoqIEdldCBgbWlzc2luZ1Jhd1ZhbHVlc2Agd2hpY2ggbm90IGV4aXN0IGluIHRoZSB0cmVlIHlldCAqL1xuXG5cbiAgdmFyIHNwbGl0UmF3VmFsdWVzID0gZnVuY3Rpb24gc3BsaXRSYXdWYWx1ZXMobmV3UmF3VmFsdWVzKSB7XG4gICAgdmFyIG1pc3NpbmdSYXdWYWx1ZXMgPSBbXTtcbiAgICB2YXIgZXhpc3RSYXdWYWx1ZXMgPSBbXTsgLy8gS2VlcCBtaXNzaW5nIHZhbHVlIGluIHRoZSBjYWNoZVxuXG4gICAgbmV3UmF3VmFsdWVzLmZvckVhY2goZnVuY3Rpb24gKHZhbCkge1xuICAgICAgaWYgKGdldEVudGl0eUJ5VmFsdWUodmFsKSkge1xuICAgICAgICBleGlzdFJhd1ZhbHVlcy5wdXNoKHZhbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaXNzaW5nUmF3VmFsdWVzLnB1c2godmFsKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgbWlzc2luZ1Jhd1ZhbHVlczogbWlzc2luZ1Jhd1ZhbHVlcyxcbiAgICAgIGV4aXN0UmF3VmFsdWVzOiBleGlzdFJhd1ZhbHVlc1xuICAgIH07XG4gIH07XG5cbiAgdmFyIF91c2VNZW1vMiA9IHVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHZhciB2YWx1ZUhhbGZDaGVja2VkS2V5cyA9IFtdO1xuICAgIHZhciBuZXdSYXdWYWx1ZXMgPSBbXTtcbiAgICB0b0FycmF5KHZhbHVlKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpZiAoaXRlbSAmJiBfdHlwZW9mKGl0ZW0pID09PSAnb2JqZWN0JyAmJiAndmFsdWUnIGluIGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uaGFsZkNoZWNrZWQgJiYgdHJlZUNoZWNrU3RyaWN0bHkpIHtcbiAgICAgICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5QnlWYWx1ZShpdGVtLnZhbHVlKTtcbiAgICAgICAgICB2YWx1ZUhhbGZDaGVja2VkS2V5cy5wdXNoKGVudGl0eSA/IGVudGl0eS5rZXkgOiBpdGVtLnZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdSYXdWYWx1ZXMucHVzaChpdGVtLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3UmF3VmFsdWVzLnB1c2goaXRlbSk7XG4gICAgICB9XG4gICAgfSk7IC8vIFdlIG5lZWQgZG8gY29uZHVjdGlvbiBvZiB2YWx1ZXNcblxuICAgIGlmICh0cmVlQ29uZHVjdGlvbikge1xuICAgICAgdmFyIF9zcGxpdFJhd1ZhbHVlcyA9IHNwbGl0UmF3VmFsdWVzKG5ld1Jhd1ZhbHVlcyksXG4gICAgICAgICAgbWlzc2luZ1Jhd1ZhbHVlcyA9IF9zcGxpdFJhd1ZhbHVlcy5taXNzaW5nUmF3VmFsdWVzLFxuICAgICAgICAgIGV4aXN0UmF3VmFsdWVzID0gX3NwbGl0UmF3VmFsdWVzLmV4aXN0UmF3VmFsdWVzO1xuXG4gICAgICB2YXIga2V5TGlzdCA9IGV4aXN0UmF3VmFsdWVzLm1hcChmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHJldHVybiBnZXRFbnRpdHlCeVZhbHVlKHZhbCkua2V5O1xuICAgICAgfSk7XG5cbiAgICAgIHZhciBfY29uZHVjdENoZWNrID0gY29uZHVjdENoZWNrKGtleUxpc3QsIHRydWUsIGNvbmR1Y3RLZXlFbnRpdGllcyksXG4gICAgICAgICAgY2hlY2tlZEtleXMgPSBfY29uZHVjdENoZWNrLmNoZWNrZWRLZXlzLFxuICAgICAgICAgIGhhbGZDaGVja2VkS2V5cyA9IF9jb25kdWN0Q2hlY2suaGFsZkNoZWNrZWRLZXlzO1xuXG4gICAgICByZXR1cm4gW1tdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkobWlzc2luZ1Jhd1ZhbHVlcyksIF90b0NvbnN1bWFibGVBcnJheShjaGVja2VkS2V5cy5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gZ2V0RW50aXR5QnlLZXkoa2V5KS5kYXRhLnZhbHVlO1xuICAgICAgfSkpKSwgaGFsZkNoZWNrZWRLZXlzXTtcbiAgICB9XG5cbiAgICByZXR1cm4gW25ld1Jhd1ZhbHVlcywgdmFsdWVIYWxmQ2hlY2tlZEtleXNdO1xuICB9LCBbdmFsdWUsIG1lcmdlZE11bHRpcGxlLCBtZXJnZWRMYWJlbEluVmFsdWUsIHRyZWVDaGVja2FibGUsIHRyZWVDaGVja1N0cmljdGx5XSksXG4gICAgICBfdXNlTWVtbzMgPSBfc2xpY2VkVG9BcnJheShfdXNlTWVtbzIsIDIpLFxuICAgICAgcmF3VmFsdWVzID0gX3VzZU1lbW8zWzBdLFxuICAgICAgcmF3SGFsZkNoZWNrZWRLZXlzID0gX3VzZU1lbW8zWzFdO1xuXG4gIHZhciBzZWxlY3RWYWx1ZXMgPSB1c2VTZWxlY3RWYWx1ZXMocmF3VmFsdWVzLCB7XG4gICAgdHJlZUNvbmR1Y3Rpb246IHRyZWVDb25kdWN0aW9uLFxuICAgIHZhbHVlOiB2YWx1ZSxcbiAgICBzaG93Q2hlY2tlZFN0cmF0ZWd5OiBzaG93Q2hlY2tlZFN0cmF0ZWd5LFxuICAgIGNvbmR1Y3RLZXlFbnRpdGllczogY29uZHVjdEtleUVudGl0aWVzLFxuICAgIGdldEVudGl0eUJ5VmFsdWU6IGdldEVudGl0eUJ5VmFsdWUsXG4gICAgZ2V0RW50aXR5QnlLZXk6IGdldEVudGl0eUJ5S2V5LFxuICAgIGdldExhYmVsUHJvcDogZ2V0VHJlZU5vZGVMYWJlbFByb3BcbiAgfSk7XG5cbiAgdmFyIHRyaWdnZXJDaGFuZ2UgPSBmdW5jdGlvbiB0cmlnZ2VyQ2hhbmdlKG5ld1Jhd1ZhbHVlcywgZXh0cmEsIHNvdXJjZSkge1xuICAgIHNldFZhbHVlKG1lcmdlZE11bHRpcGxlID8gbmV3UmF3VmFsdWVzIDogbmV3UmF3VmFsdWVzWzBdKTtcblxuICAgIGlmIChvbkNoYW5nZSkge1xuICAgICAgdmFyIGV2ZW50VmFsdWVzID0gbmV3UmF3VmFsdWVzO1xuXG4gICAgICBpZiAodHJlZUNvbmR1Y3Rpb24gJiYgc2hvd0NoZWNrZWRTdHJhdGVneSAhPT0gJ1NIT1dfQUxMJykge1xuICAgICAgICB2YXIga2V5TGlzdCA9IG5ld1Jhd1ZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgIHZhciBlbnRpdHkgPSBnZXRFbnRpdHlCeVZhbHVlKHZhbCk7XG4gICAgICAgICAgcmV0dXJuIGVudGl0eSA/IGVudGl0eS5rZXkgOiB2YWw7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgZm9ybWF0dGVkS2V5TGlzdCA9IGZvcm1hdFN0cmF0ZWd5S2V5cyhrZXlMaXN0LCBzaG93Q2hlY2tlZFN0cmF0ZWd5LCBjb25kdWN0S2V5RW50aXRpZXMpO1xuICAgICAgICBldmVudFZhbHVlcyA9IGZvcm1hdHRlZEtleUxpc3QubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5QnlLZXkoa2V5KTtcbiAgICAgICAgICByZXR1cm4gZW50aXR5ID8gZW50aXR5LmRhdGEudmFsdWUgOiBrZXk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB2YXIgX3JlZiA9IGV4dHJhIHx8IHtcbiAgICAgICAgdHJpZ2dlclZhbHVlOiB1bmRlZmluZWQsXG4gICAgICAgIHNlbGVjdGVkOiB1bmRlZmluZWRcbiAgICAgIH0sXG4gICAgICAgICAgdHJpZ2dlclZhbHVlID0gX3JlZi50cmlnZ2VyVmFsdWUsXG4gICAgICAgICAgc2VsZWN0ZWQgPSBfcmVmLnNlbGVjdGVkO1xuXG4gICAgICB2YXIgcmV0dXJuVmFsdWVzID0gbWVyZ2VkTGFiZWxJblZhbHVlID8gZ2V0UmF3VmFsdWVMYWJlbGVkKGV2ZW50VmFsdWVzLCB2YWx1ZSwgZ2V0RW50aXR5QnlWYWx1ZSwgZ2V0VHJlZU5vZGVMYWJlbFByb3ApIDogZXZlbnRWYWx1ZXM7IC8vIFdlIG5lZWQgZmlsbCBoYWxmIGNoZWNrIGJhY2tcblxuICAgICAgaWYgKHRyZWVDaGVja1N0cmljdGx5KSB7XG4gICAgICAgIHZhciBoYWxmVmFsdWVzID0gcmF3SGFsZkNoZWNrZWRLZXlzLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgdmFyIGVudGl0eSA9IGdldEVudGl0eUJ5S2V5KGtleSk7XG4gICAgICAgICAgcmV0dXJuIGVudGl0eSA/IGVudGl0eS5kYXRhLnZhbHVlIDoga2V5O1xuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgIHJldHVybiAhZXZlbnRWYWx1ZXMuaW5jbHVkZXModmFsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVyblZhbHVlcyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkocmV0dXJuVmFsdWVzKSwgX3RvQ29uc3VtYWJsZUFycmF5KGdldFJhd1ZhbHVlTGFiZWxlZChoYWxmVmFsdWVzLCB2YWx1ZSwgZ2V0RW50aXR5QnlWYWx1ZSwgZ2V0VHJlZU5vZGVMYWJlbFByb3ApKSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBhZGRpdGlvbmFsSW5mbyA9IHtcbiAgICAgICAgLy8gW0xlZ2FjeV0gQWx3YXlzIHJldHVybiBhcyBhcnJheSBjb250YWlucyBsYWJlbCAmIHZhbHVlXG4gICAgICAgIHByZVZhbHVlOiBzZWxlY3RWYWx1ZXMsXG4gICAgICAgIHRyaWdnZXJWYWx1ZTogdHJpZ2dlclZhbHVlXG4gICAgICB9OyAvLyBbTGVnYWN5XSBGaWxsIGxlZ2FjeSBkYXRhIGlmIHVzZXIgcXVlcnkuXG4gICAgICAvLyBUaGlzIGlzIGV4cGFuc2l2ZSB0aGF0IHdlIG9ubHkgZmlsbCB3aGVuIHVzZXIgcXVlcnlcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdC1jb21wb25lbnQvdHJlZS1zZWxlY3QvYmxvYi9mZTMzZWI3YzI3ODMwYzlhYzcwY2QxZmRiMWViYmU3YmM2NzljMTZhL3NyYy9TZWxlY3QuanN4XG5cbiAgICAgIHZhciBzaG93UG9zaXRpb24gPSB0cnVlO1xuXG4gICAgICBpZiAodHJlZUNoZWNrU3RyaWN0bHkgfHwgc291cmNlID09PSAnc2VsZWN0aW9uJyAmJiAhc2VsZWN0ZWQpIHtcbiAgICAgICAgc2hvd1Bvc2l0aW9uID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGZpbGxBZGRpdGlvbmFsSW5mbyhhZGRpdGlvbmFsSW5mbywgdHJpZ2dlclZhbHVlLCBuZXdSYXdWYWx1ZXMsIG1lcmdlZFRyZWVEYXRhLCBzaG93UG9zaXRpb24pO1xuXG4gICAgICBpZiAobWVyZ2VkQ2hlY2thYmxlKSB7XG4gICAgICAgIGFkZGl0aW9uYWxJbmZvLmNoZWNrZWQgPSBzZWxlY3RlZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkZGl0aW9uYWxJbmZvLnNlbGVjdGVkID0gc2VsZWN0ZWQ7XG4gICAgICB9XG5cbiAgICAgIG9uQ2hhbmdlKG1lcmdlZE11bHRpcGxlID8gcmV0dXJuVmFsdWVzIDogcmV0dXJuVmFsdWVzWzBdLCBtZXJnZWRMYWJlbEluVmFsdWUgPyBudWxsIDogZXZlbnRWYWx1ZXMubWFwKGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgdmFyIGVudGl0eSA9IGdldEVudGl0eUJ5VmFsdWUodmFsKTtcbiAgICAgICAgcmV0dXJuIGVudGl0eSA/IGdldFRyZWVOb2RlTGFiZWxQcm9wKGVudGl0eS5kYXRhKSA6IG51bGw7XG4gICAgICB9KSwgYWRkaXRpb25hbEluZm8pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25JbnRlcm5hbFNlbGVjdCA9IGZ1bmN0aW9uIG9uSW50ZXJuYWxTZWxlY3Qoc2VsZWN0VmFsdWUsIG9wdGlvbiwgc291cmNlKSB7XG4gICAgdmFyIGV2ZW50VmFsdWUgPSBtZXJnZWRMYWJlbEluVmFsdWUgPyBzZWxlY3RWYWx1ZSA6IHNlbGVjdFZhbHVlO1xuXG4gICAgaWYgKCFtZXJnZWRNdWx0aXBsZSkge1xuICAgICAgLy8gU2luZ2xlIG1vZGUgYWx3YXlzIHNldCB2YWx1ZVxuICAgICAgdHJpZ2dlckNoYW5nZShbc2VsZWN0VmFsdWVdLCB7XG4gICAgICAgIHNlbGVjdGVkOiB0cnVlLFxuICAgICAgICB0cmlnZ2VyVmFsdWU6IHNlbGVjdFZhbHVlXG4gICAgICB9LCBzb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgbmV3UmF3VmFsdWVzID0gYWRkVmFsdWUocmF3VmFsdWVzLCBzZWxlY3RWYWx1ZSk7IC8vIEFkZCBrZXlzIGlmIHRyZWUgY29uZHVjdGlvblxuXG4gICAgICBpZiAodHJlZUNvbmR1Y3Rpb24pIHtcbiAgICAgICAgLy8gU2hvdWxkIGtlZXAgbWlzc2luZyB2YWx1ZXNcbiAgICAgICAgdmFyIF9zcGxpdFJhd1ZhbHVlczIgPSBzcGxpdFJhd1ZhbHVlcyhuZXdSYXdWYWx1ZXMpLFxuICAgICAgICAgICAgbWlzc2luZ1Jhd1ZhbHVlcyA9IF9zcGxpdFJhd1ZhbHVlczIubWlzc2luZ1Jhd1ZhbHVlcyxcbiAgICAgICAgICAgIGV4aXN0UmF3VmFsdWVzID0gX3NwbGl0UmF3VmFsdWVzMi5leGlzdFJhd1ZhbHVlcztcblxuICAgICAgICB2YXIga2V5TGlzdCA9IGV4aXN0UmF3VmFsdWVzLm1hcChmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgcmV0dXJuIGdldEVudGl0eUJ5VmFsdWUodmFsKS5rZXk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBfY29uZHVjdENoZWNrMiA9IGNvbmR1Y3RDaGVjayhrZXlMaXN0LCB0cnVlLCBjb25kdWN0S2V5RW50aXRpZXMpLFxuICAgICAgICAgICAgY2hlY2tlZEtleXMgPSBfY29uZHVjdENoZWNrMi5jaGVja2VkS2V5cztcblxuICAgICAgICBuZXdSYXdWYWx1ZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG1pc3NpbmdSYXdWYWx1ZXMpLCBfdG9Db25zdW1hYmxlQXJyYXkoY2hlY2tlZEtleXMubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0RW50aXR5QnlLZXkoa2V5KS5kYXRhLnZhbHVlO1xuICAgICAgICB9KSkpO1xuICAgICAgfVxuXG4gICAgICB0cmlnZ2VyQ2hhbmdlKG5ld1Jhd1ZhbHVlcywge1xuICAgICAgICBzZWxlY3RlZDogdHJ1ZSxcbiAgICAgICAgdHJpZ2dlclZhbHVlOiBzZWxlY3RWYWx1ZVxuICAgICAgfSwgc291cmNlKTtcbiAgICB9XG5cbiAgICBpZiAob25TZWxlY3QpIHtcbiAgICAgIG9uU2VsZWN0KGV2ZW50VmFsdWUsIG9wdGlvbik7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkludGVybmFsRGVzZWxlY3QgPSBmdW5jdGlvbiBvbkludGVybmFsRGVzZWxlY3Qoc2VsZWN0VmFsdWUsIG9wdGlvbiwgc291cmNlKSB7XG4gICAgdmFyIGV2ZW50VmFsdWUgPSBtZXJnZWRMYWJlbEluVmFsdWUgPyBzZWxlY3RWYWx1ZSA6IHNlbGVjdFZhbHVlO1xuICAgIHZhciBuZXdSYXdWYWx1ZXMgPSByZW1vdmVWYWx1ZShyYXdWYWx1ZXMsIHNlbGVjdFZhbHVlKTsgLy8gUmVtb3ZlIGtleXMgaWYgdHJlZSBjb25kdWN0aW9uXG5cbiAgICBpZiAodHJlZUNvbmR1Y3Rpb24pIHtcbiAgICAgIHZhciBfc3BsaXRSYXdWYWx1ZXMzID0gc3BsaXRSYXdWYWx1ZXMobmV3UmF3VmFsdWVzKSxcbiAgICAgICAgICBtaXNzaW5nUmF3VmFsdWVzID0gX3NwbGl0UmF3VmFsdWVzMy5taXNzaW5nUmF3VmFsdWVzLFxuICAgICAgICAgIGV4aXN0UmF3VmFsdWVzID0gX3NwbGl0UmF3VmFsdWVzMy5leGlzdFJhd1ZhbHVlcztcblxuICAgICAgdmFyIGtleUxpc3QgPSBleGlzdFJhd1ZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gZ2V0RW50aXR5QnlWYWx1ZSh2YWwpLmtleTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgX2NvbmR1Y3RDaGVjazMgPSBjb25kdWN0Q2hlY2soa2V5TGlzdCwge1xuICAgICAgICBjaGVja2VkOiBmYWxzZSxcbiAgICAgICAgaGFsZkNoZWNrZWRLZXlzOiByYXdIYWxmQ2hlY2tlZEtleXNcbiAgICAgIH0sIGNvbmR1Y3RLZXlFbnRpdGllcyksXG4gICAgICAgICAgY2hlY2tlZEtleXMgPSBfY29uZHVjdENoZWNrMy5jaGVja2VkS2V5cztcblxuICAgICAgbmV3UmF3VmFsdWVzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShtaXNzaW5nUmF3VmFsdWVzKSwgX3RvQ29uc3VtYWJsZUFycmF5KGNoZWNrZWRLZXlzLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBnZXRFbnRpdHlCeUtleShrZXkpLmRhdGEudmFsdWU7XG4gICAgICB9KSkpO1xuICAgIH1cblxuICAgIHRyaWdnZXJDaGFuZ2UobmV3UmF3VmFsdWVzLCB7XG4gICAgICBzZWxlY3RlZDogZmFsc2UsXG4gICAgICB0cmlnZ2VyVmFsdWU6IHNlbGVjdFZhbHVlXG4gICAgfSwgc291cmNlKTtcblxuICAgIGlmIChvbkRlc2VsZWN0KSB7XG4gICAgICBvbkRlc2VsZWN0KGV2ZW50VmFsdWUsIG9wdGlvbik7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkludGVybmFsQ2xlYXIgPSBmdW5jdGlvbiBvbkludGVybmFsQ2xlYXIoKSB7XG4gICAgdHJpZ2dlckNoYW5nZShbXSwgbnVsbCwgJ2NsZWFyJyk7XG4gIH07IC8vID09PT09PT09PT09PT09PT09PT09PT09PT0gT3BlbiA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgdmFyIG9uSW50ZXJuYWxEcm9wZG93blZpc2libGVDaGFuZ2UgPSBSZWFjdC51c2VDYWxsYmFjayhmdW5jdGlvbiAob3Blbikge1xuICAgIGlmIChvbkRyb3Bkb3duVmlzaWJsZUNoYW5nZSkge1xuICAgICAgdmFyIGxlZ2FjeVBhcmFtID0ge307XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobGVnYWN5UGFyYW0sICdkb2N1bWVudENsaWNrQ2xvc2UnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgIHdhcm5pbmcoZmFsc2UsICdTZWNvbmQgcGFyYW0gb2YgYG9uRHJvcGRvd25WaXNpYmxlQ2hhbmdlYCBoYXMgYmVlbiByZW1vdmVkLicpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBvbkRyb3Bkb3duVmlzaWJsZUNoYW5nZShvcGVuLCBsZWdhY3lQYXJhbSk7XG4gICAgfVxuICB9LCBbb25Ecm9wZG93blZpc2libGVDaGFuZ2VdKTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09IFdhcm5pbmcgPT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICB3YXJuaW5nUHJvcHMocHJvcHMpO1xuICB9IC8vID09PT09PT09PT09PT09PT09PT09PT09PSBSZW5kZXIgPT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBXZSBwYXNzIHNvbWUgcHJvcHMgaW50byBzZWxlY3QgcHJvcHMgc3R5bGVcblxuXG4gIHZhciBzZWxlY3RQcm9wcyA9IHtcbiAgICBvcHRpb25MYWJlbFByb3A6IG51bGwsXG4gICAgb3B0aW9uRmlsdGVyUHJvcDogdHJlZU5vZGVGaWx0ZXJQcm9wLFxuICAgIGRyb3Bkb3duQWxpZ246IGRyb3Bkb3duUG9wdXBBbGlnbixcbiAgICBpbnRlcm5hbFByb3BzOiB7XG4gICAgICBtYXJrOiBJTlRFUk5BTF9QUk9QU19NQVJLLFxuICAgICAgb25DbGVhcjogb25JbnRlcm5hbENsZWFyLFxuICAgICAgc2tpcFRyaWdnZXJDaGFuZ2U6IHRydWUsXG4gICAgICBza2lwVHJpZ2dlclNlbGVjdDogdHJ1ZSxcbiAgICAgIG9uUmF3U2VsZWN0OiBvbkludGVybmFsU2VsZWN0LFxuICAgICAgb25SYXdEZXNlbGVjdDogb25JbnRlcm5hbERlc2VsZWN0XG4gICAgfVxuICB9O1xuXG4gIGlmICgnZmlsdGVyVHJlZU5vZGUnIGluIHByb3BzKSB7XG4gICAgc2VsZWN0UHJvcHMuZmlsdGVyT3B0aW9uID0gZmlsdGVyVHJlZU5vZGU7XG4gIH1cblxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0Q29udGV4dC5Qcm92aWRlciwge1xuICAgIHZhbHVlOiB7XG4gICAgICBjaGVja2FibGU6IG1lcmdlZENoZWNrYWJsZSxcbiAgICAgIGxvYWREYXRhOiBsb2FkRGF0YSxcbiAgICAgIHRyZWVMb2FkZWRLZXlzOiB0cmVlTG9hZGVkS2V5cyxcbiAgICAgIG9uVHJlZUxvYWQ6IG9uVHJlZUxvYWQsXG4gICAgICBjaGVja2VkS2V5czogcmF3VmFsdWVzLFxuICAgICAgaGFsZkNoZWNrZWRLZXlzOiByYXdIYWxmQ2hlY2tlZEtleXMsXG4gICAgICB0cmVlRGVmYXVsdEV4cGFuZEFsbDogdHJlZURlZmF1bHRFeHBhbmRBbGwsXG4gICAgICB0cmVlRXhwYW5kZWRLZXlzOiB0cmVlRXhwYW5kZWRLZXlzLFxuICAgICAgdHJlZURlZmF1bHRFeHBhbmRlZEtleXM6IHRyZWVEZWZhdWx0RXhwYW5kZWRLZXlzLFxuICAgICAgb25UcmVlRXhwYW5kOiBvblRyZWVFeHBhbmQsXG4gICAgICB0cmVlSWNvbjogdHJlZUljb24sXG4gICAgICB0cmVlTW90aW9uOiB0cmVlTW90aW9uLFxuICAgICAgc2hvd1RyZWVJY29uOiBzaG93VHJlZUljb24sXG4gICAgICBzd2l0Y2hlckljb246IHN3aXRjaGVySWNvbixcbiAgICAgIHRyZWVMaW5lOiB0cmVlTGluZSxcbiAgICAgIHRyZWVOb2RlRmlsdGVyUHJvcDogdHJlZU5vZGVGaWx0ZXJQcm9wXG4gICAgfVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChSZWZTZWxlY3QsIF9leHRlbmRzKHtcbiAgICByZWY6IHNlbGVjdFJlZixcbiAgICBtb2RlOiBtZXJnZWRNdWx0aXBsZSA/ICdtdWx0aXBsZScgOiBudWxsXG4gIH0sIHByb3BzLCBzZWxlY3RQcm9wcywge1xuICAgIHZhbHVlOiBzZWxlY3RWYWx1ZXMgLy8gV2Ugd2lsbCBoYW5kbGUgdGhpcyBvdXJzZWxmIHNpbmNlIHdlIG5lZWQgY2FsY3VsYXRlIGNvbmR1Y3Rpb25cbiAgICAsXG4gICAgbGFiZWxJblZhbHVlOiB0cnVlLFxuICAgIG9wdGlvbnM6IG1lcmdlZFRyZWVEYXRhLFxuICAgIG9uQ2hhbmdlOiBudWxsLFxuICAgIG9uU2VsZWN0OiBudWxsLFxuICAgIG9uRGVzZWxlY3Q6IG51bGwsXG4gICAgb25Ecm9wZG93blZpc2libGVDaGFuZ2U6IG9uSW50ZXJuYWxEcm9wZG93blZpc2libGVDaGFuZ2VcbiAgfSkpKTtcbn0pOyAvLyBVc2UgY2xhc3MgY29tcG9uZW50IHNpbmNlIHR5cGVzY3JpcHQgbm90IHN1cHBvcnQgZ2VuZXJpY1xuLy8gYnkgYGZvcndhcmRSZWZgIHdpdGggZnVuY3Rpb24gY29tcG9uZW50IHlldC5cblxudmFyIFRyZWVTZWxlY3QgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKFRyZWVTZWxlY3QsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVHJlZVNlbGVjdCk7XG5cbiAgZnVuY3Rpb24gVHJlZVNlbGVjdCgpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJlZVNlbGVjdCk7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIF90aGlzLnNlbGVjdFJlZiA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVSZWYoKTtcblxuICAgIF90aGlzLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc2VsZWN0UmVmLmN1cnJlbnQuZm9jdXMoKTtcbiAgICB9O1xuXG4gICAgX3RoaXMuYmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzLnNlbGVjdFJlZi5jdXJyZW50LmJsdXIoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFRyZWVTZWxlY3QsIFt7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUmVmVHJlZVNlbGVjdCwgX2V4dGVuZHMoe1xuICAgICAgICByZWY6IHRoaXMuc2VsZWN0UmVmXG4gICAgICB9LCB0aGlzLnByb3BzKSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFRyZWVTZWxlY3Q7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5cblRyZWVTZWxlY3QuVHJlZU5vZGUgPSBUcmVlTm9kZTtcblRyZWVTZWxlY3QuU0hPV19BTEwgPSBTSE9XX0FMTDtcblRyZWVTZWxlY3QuU0hPV19QQVJFTlQgPSBTSE9XX1BBUkVOVDtcblRyZWVTZWxlY3QuU0hPV19DSElMRCA9IFNIT1dfQ0hJTEQ7XG5leHBvcnQgZGVmYXVsdCBUcmVlU2VsZWN0OyIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0Jztcbi8qKlxuICogUmV0dXJuIGNhY2hlZCBLZXkgVmFsdWUgbWFwIHdpdGggRGF0YU5vZGUuXG4gKiBPbmx5IHJlLWNhbGN1bGF0ZSB3aGVuIGBmbGF0dGVuT3B0aW9uc2AgY2hhbmdlZC5cbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VLZXlWYWx1ZU1hcChmbGF0dGVuT3B0aW9ucykge1xuICByZXR1cm4gUmVhY3QudXNlTWVtbyhmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhY2hlS2V5TWFwID0gbmV3IE1hcCgpO1xuICAgIHZhciBjYWNoZVZhbHVlTWFwID0gbmV3IE1hcCgpOyAvLyBDYWNoZSBvcHRpb25zIGJ5IGtleVxuXG4gICAgZmxhdHRlbk9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YU5vZGUpIHtcbiAgICAgIGNhY2hlS2V5TWFwLnNldChkYXRhTm9kZS5rZXksIGRhdGFOb2RlKTtcbiAgICAgIGNhY2hlVmFsdWVNYXAuc2V0KGRhdGFOb2RlLmRhdGEudmFsdWUsIGRhdGFOb2RlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gW2NhY2hlS2V5TWFwLCBjYWNoZVZhbHVlTWFwXTtcbiAgfSwgW2ZsYXR0ZW5PcHRpb25zXSk7XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuZXhwb3J0IGZ1bmN0aW9uIGlzRGlzYWJsZWQoZGF0YU5vZGUsIHNraXBUeXBlKSB7XG4gIGlmICghZGF0YU5vZGUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHZhciBfZGF0YU5vZGUkZGF0YSA9IGRhdGFOb2RlLmRhdGEsXG4gICAgICBkaXNhYmxlZCA9IF9kYXRhTm9kZSRkYXRhLmRpc2FibGVkLFxuICAgICAgZGlzYWJsZUNoZWNrYm94ID0gX2RhdGFOb2RlJGRhdGEuZGlzYWJsZUNoZWNrYm94O1xuXG4gIHN3aXRjaCAoc2tpcFR5cGUpIHtcbiAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgcmV0dXJuIGRpc2FibGVkO1xuXG4gICAgY2FzZSAnY2hlY2tib3gnOlxuICAgICAgcmV0dXJuIGRpc2FibGVkIHx8IGRpc2FibGVDaGVja2JveDtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVzZUtleVZhbHVlTWFwcGluZyhjYWNoZUtleU1hcCwgY2FjaGVWYWx1ZU1hcCkge1xuICB2YXIgZ2V0RW50aXR5QnlLZXkgPSBSZWFjdC51c2VDYWxsYmFjayhmdW5jdGlvbiAoa2V5KSB7XG4gICAgdmFyIHNraXBUeXBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnc2VsZWN0JztcbiAgICB2YXIgaWdub3JlRGlzYWJsZWRDaGVjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkO1xuICAgIHZhciBkYXRhTm9kZSA9IGNhY2hlS2V5TWFwLmdldChrZXkpO1xuXG4gICAgaWYgKCFpZ25vcmVEaXNhYmxlZENoZWNrICYmIGlzRGlzYWJsZWQoZGF0YU5vZGUsIHNraXBUeXBlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGFOb2RlO1xuICB9LCBbY2FjaGVLZXlNYXBdKTtcbiAgdmFyIGdldEVudGl0eUJ5VmFsdWUgPSBSZWFjdC51c2VDYWxsYmFjayhmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB2YXIgc2tpcFR5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICdzZWxlY3QnO1xuICAgIHZhciBpZ25vcmVEaXNhYmxlZENoZWNrID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGRhdGFOb2RlID0gY2FjaGVWYWx1ZU1hcC5nZXQodmFsdWUpO1xuXG4gICAgaWYgKCFpZ25vcmVEaXNhYmxlZENoZWNrICYmIGlzRGlzYWJsZWQoZGF0YU5vZGUsIHNraXBUeXBlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGFOb2RlO1xuICB9LCBbY2FjaGVWYWx1ZU1hcF0pO1xuICByZXR1cm4gW2dldEVudGl0eUJ5S2V5LCBnZXRFbnRpdHlCeVZhbHVlXTtcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBnZXRSYXdWYWx1ZUxhYmVsZWQgfSBmcm9tICcuLi91dGlscy92YWx1ZVV0aWwnO1xuaW1wb3J0IHsgZm9ybWF0U3RyYXRlZ3lLZXlzIH0gZnJvbSAnLi4vdXRpbHMvc3RyYXRlZ3lVdGlsJztcbi8qKiBSZXR1cm4gICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVzZVNlbGVjdFZhbHVlcyhyYXdWYWx1ZXMsIF9yZWYpIHtcbiAgdmFyIHZhbHVlID0gX3JlZi52YWx1ZSxcbiAgICAgIGdldEVudGl0eUJ5VmFsdWUgPSBfcmVmLmdldEVudGl0eUJ5VmFsdWUsXG4gICAgICBnZXRFbnRpdHlCeUtleSA9IF9yZWYuZ2V0RW50aXR5QnlLZXksXG4gICAgICB0cmVlQ29uZHVjdGlvbiA9IF9yZWYudHJlZUNvbmR1Y3Rpb24sXG4gICAgICBzaG93Q2hlY2tlZFN0cmF0ZWd5ID0gX3JlZi5zaG93Q2hlY2tlZFN0cmF0ZWd5LFxuICAgICAgY29uZHVjdEtleUVudGl0aWVzID0gX3JlZi5jb25kdWN0S2V5RW50aXRpZXMsXG4gICAgICBnZXRMYWJlbFByb3AgPSBfcmVmLmdldExhYmVsUHJvcDtcbiAgcmV0dXJuIFJlYWN0LnVzZU1lbW8oZnVuY3Rpb24gKCkge1xuICAgIHZhciBtZXJnZWRSYXdWYWx1ZXMgPSByYXdWYWx1ZXM7XG5cbiAgICBpZiAodHJlZUNvbmR1Y3Rpb24pIHtcbiAgICAgIHZhciByYXdLZXlzID0gZm9ybWF0U3RyYXRlZ3lLZXlzKHJhd1ZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5QnlWYWx1ZSh2YWwpO1xuICAgICAgICByZXR1cm4gZW50aXR5ID8gZW50aXR5LmtleSA6IHZhbDtcbiAgICAgIH0pLCBzaG93Q2hlY2tlZFN0cmF0ZWd5LCBjb25kdWN0S2V5RW50aXRpZXMpO1xuICAgICAgbWVyZ2VkUmF3VmFsdWVzID0gcmF3S2V5cy5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgZW50aXR5ID0gZ2V0RW50aXR5QnlLZXkoa2V5KTtcbiAgICAgICAgcmV0dXJuIGVudGl0eSA/IGVudGl0eS5kYXRhLnZhbHVlIDoga2V5O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldFJhd1ZhbHVlTGFiZWxlZChtZXJnZWRSYXdWYWx1ZXMsIHZhbHVlLCBnZXRFbnRpdHlCeVZhbHVlLCBnZXRMYWJlbFByb3ApO1xuICB9LCBbcmF3VmFsdWVzLCB2YWx1ZSwgdHJlZUNvbmR1Y3Rpb24sIHNob3dDaGVja2VkU3RyYXRlZ3ksIGdldEVudGl0eUJ5VmFsdWVdKTtcbn0iLCJpbXBvcnQgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RXaXRob3V0UHJvcGVydGllc1wiO1xuaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDJcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB3YXJuaW5nIGZyb20gXCJyYy11dGlsL2VzL3dhcm5pbmdcIjtcbmltcG9ydCB7IGNvbnZlcnRDaGlsZHJlblRvRGF0YSB9IGZyb20gJy4uL3V0aWxzL2xlZ2FjeVV0aWwnO1xudmFyIE1BWF9XQVJOSU5HX1RJTUVTID0gMTA7XG5cbmZ1bmN0aW9uIHBhcnNlU2ltcGxlVHJlZURhdGEodHJlZURhdGEsIF9yZWYpIHtcbiAgdmFyIGlkID0gX3JlZi5pZCxcbiAgICAgIHBJZCA9IF9yZWYucElkLFxuICAgICAgcm9vdFBJZCA9IF9yZWYucm9vdFBJZDtcbiAgdmFyIGtleU5vZGVzID0ge307XG4gIHZhciByb290Tm9kZUxpc3QgPSBbXTsgLy8gRmlsbCBpbiB0aGUgbWFwXG5cbiAgdmFyIG5vZGVMaXN0ID0gdHJlZURhdGEubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgdmFyIGNsb25lID0gX29iamVjdFNwcmVhZCh7fSwgbm9kZSk7XG5cbiAgICB2YXIga2V5ID0gY2xvbmVbaWRdO1xuICAgIGtleU5vZGVzW2tleV0gPSBjbG9uZTtcbiAgICBjbG9uZS5rZXkgPSBjbG9uZS5rZXkgfHwga2V5O1xuICAgIHJldHVybiBjbG9uZTtcbiAgfSk7IC8vIENvbm5lY3QgdHJlZVxuXG4gIG5vZGVMaXN0LmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICB2YXIgcGFyZW50S2V5ID0gbm9kZVtwSWRdO1xuICAgIHZhciBwYXJlbnQgPSBrZXlOb2Rlc1twYXJlbnRLZXldOyAvLyBGaWxsIHBhcmVudFxuXG4gICAgaWYgKHBhcmVudCkge1xuICAgICAgcGFyZW50LmNoaWxkcmVuID0gcGFyZW50LmNoaWxkcmVuIHx8IFtdO1xuICAgICAgcGFyZW50LmNoaWxkcmVuLnB1c2gobm9kZSk7XG4gICAgfSAvLyBGaWxsIHJvb3QgdHJlZSBub2RlXG5cblxuICAgIGlmIChwYXJlbnRLZXkgPT09IHJvb3RQSWQgfHwgIXBhcmVudCAmJiByb290UElkID09PSBudWxsKSB7XG4gICAgICByb290Tm9kZUxpc3QucHVzaChub2RlKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcm9vdE5vZGVMaXN0O1xufVxuLyoqXG4gKiBGb3JtYXQgYHRyZWVEYXRhYCB3aXRoIGB2YWx1ZWAgJiBga2V5YCB3aGljaCBpcyB1c2VkIGZvciBjYWxjdWxhdGlvblxuICovXG5cblxuZnVuY3Rpb24gZm9ybWF0VHJlZURhdGEodHJlZURhdGEsIGdldExhYmVsUHJvcCkge1xuICB2YXIgd2FybmluZ1RpbWVzID0gMDtcbiAgdmFyIHZhbHVlU2V0ID0gbmV3IFNldCgpO1xuXG4gIGZ1bmN0aW9uIGRpZyhkYXRhTm9kZXMpIHtcbiAgICByZXR1cm4gKGRhdGFOb2RlcyB8fCBbXSkubWFwKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICB2YXIga2V5ID0gbm9kZS5rZXksXG4gICAgICAgICAgdmFsdWUgPSBub2RlLnZhbHVlLFxuICAgICAgICAgIGNoaWxkcmVuID0gbm9kZS5jaGlsZHJlbixcbiAgICAgICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKG5vZGUsIFtcImtleVwiLCBcInZhbHVlXCIsIFwiY2hpbGRyZW5cIl0pO1xuXG4gICAgICB2YXIgbWVyZ2VkVmFsdWUgPSAndmFsdWUnIGluIG5vZGUgPyB2YWx1ZSA6IGtleTtcblxuICAgICAgdmFyIGRhdGFOb2RlID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCByZXN0KSwge30sIHtcbiAgICAgICAga2V5OiBrZXkgIT09IG51bGwgJiYga2V5ICE9PSB1bmRlZmluZWQgPyBrZXkgOiBtZXJnZWRWYWx1ZSxcbiAgICAgICAgdmFsdWU6IG1lcmdlZFZhbHVlLFxuICAgICAgICB0aXRsZTogZ2V0TGFiZWxQcm9wKG5vZGUpXG4gICAgICB9KTsgLy8gQ2hlY2sgYGtleWAgJiBgdmFsdWVgIGFuZCB3YXJuaW5nIHVzZXJcblxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBpZiAoa2V5ICE9PSBudWxsICYmIGtleSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgU3RyaW5nKGtleSkgIT09IFN0cmluZyh2YWx1ZSkgJiYgd2FybmluZ1RpbWVzIDwgTUFYX1dBUk5JTkdfVElNRVMpIHtcbiAgICAgICAgICB3YXJuaW5nVGltZXMgKz0gMTtcbiAgICAgICAgICB3YXJuaW5nKGZhbHNlLCBcImBrZXlgIG9yIGB2YWx1ZWAgd2l0aCBUcmVlTm9kZSBtdXN0IGJlIHRoZSBzYW1lIG9yIHlvdSBjYW4gcmVtb3ZlIG9uZSBvZiB0aGVtLiBrZXk6IFwiLmNvbmNhdChrZXksIFwiLCB2YWx1ZTogXCIpLmNvbmNhdCh2YWx1ZSwgXCIuXCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdhcm5pbmcoIXZhbHVlU2V0Lmhhcyh2YWx1ZSksIFwiU2FtZSBgdmFsdWVgIGV4aXN0IGluIHRoZSB0cmVlOiBcIi5jb25jYXQodmFsdWUpKTtcbiAgICAgICAgdmFsdWVTZXQuYWRkKHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCdjaGlsZHJlbicgaW4gbm9kZSkge1xuICAgICAgICBkYXRhTm9kZS5jaGlsZHJlbiA9IGRpZyhjaGlsZHJlbik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhTm9kZTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBkaWcodHJlZURhdGEpO1xufVxuLyoqXG4gKiBDb252ZXJ0IGB0cmVlRGF0YWAgb3IgYGNoaWxkcmVuYCBpbnRvIGZvcm1hdHRlZCBgdHJlZURhdGFgLlxuICogV2lsbCBub3QgcmUtY2FsY3VsYXRlIGlmIGB0cmVlRGF0YWAgb3IgYGNoaWxkcmVuYCBub3QgY2hhbmdlLlxuICovXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlVHJlZURhdGEodHJlZURhdGEsIGNoaWxkcmVuLCBfcmVmMikge1xuICB2YXIgZ2V0TGFiZWxQcm9wID0gX3JlZjIuZ2V0TGFiZWxQcm9wLFxuICAgICAgc2ltcGxlTW9kZSA9IF9yZWYyLnNpbXBsZU1vZGU7XG4gIHZhciBjYWNoZVJlZiA9IFJlYWN0LnVzZVJlZih7fSk7XG5cbiAgaWYgKHRyZWVEYXRhKSB7XG4gICAgY2FjaGVSZWYuY3VycmVudC5mb3JtYXRUcmVlRGF0YSA9IGNhY2hlUmVmLmN1cnJlbnQudHJlZURhdGEgPT09IHRyZWVEYXRhID8gY2FjaGVSZWYuY3VycmVudC5mb3JtYXRUcmVlRGF0YSA6IGZvcm1hdFRyZWVEYXRhKHNpbXBsZU1vZGUgPyBwYXJzZVNpbXBsZVRyZWVEYXRhKHRyZWVEYXRhLCBfb2JqZWN0U3ByZWFkKHtcbiAgICAgIGlkOiAnaWQnLFxuICAgICAgcElkOiAncElkJyxcbiAgICAgIHJvb3RQSWQ6IG51bGxcbiAgICB9LCBzaW1wbGVNb2RlICE9PSB0cnVlID8gc2ltcGxlTW9kZSA6IHt9KSkgOiB0cmVlRGF0YSwgZ2V0TGFiZWxQcm9wKTtcbiAgICBjYWNoZVJlZi5jdXJyZW50LnRyZWVEYXRhID0gdHJlZURhdGE7XG4gIH0gZWxzZSB7XG4gICAgY2FjaGVSZWYuY3VycmVudC5mb3JtYXRUcmVlRGF0YSA9IGNhY2hlUmVmLmN1cnJlbnQuY2hpbGRyZW4gPT09IGNoaWxkcmVuID8gY2FjaGVSZWYuY3VycmVudC5mb3JtYXRUcmVlRGF0YSA6IGZvcm1hdFRyZWVEYXRhKGNvbnZlcnRDaGlsZHJlblRvRGF0YShjaGlsZHJlbiksIGdldExhYmVsUHJvcCk7XG4gIH1cblxuICByZXR1cm4gY2FjaGVSZWYuY3VycmVudC5mb3JtYXRUcmVlRGF0YTtcbn0iLCJpbXBvcnQgVHJlZVNlbGVjdCBmcm9tICcuL1RyZWVTZWxlY3QnO1xuaW1wb3J0IFRyZWVOb2RlIGZyb20gJy4vVHJlZU5vZGUnO1xuaW1wb3J0IHsgU0hPV19BTEwsIFNIT1dfQ0hJTEQsIFNIT1dfUEFSRU5UIH0gZnJvbSAnLi91dGlscy9zdHJhdGVneVV0aWwnO1xuZXhwb3J0IHsgVHJlZU5vZGUsIFNIT1dfQUxMLCBTSE9XX0NISUxELCBTSE9XX1BBUkVOVCB9O1xuZXhwb3J0IGRlZmF1bHQgVHJlZVNlbGVjdDsiLCJpbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMlwiO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB0b0FycmF5IGZyb20gXCJyYy11dGlsL2VzL0NoaWxkcmVuL3RvQXJyYXlcIjtcbmltcG9ydCB3YXJuaW5nIGZyb20gXCJyYy11dGlsL2VzL3dhcm5pbmdcIjtcbmltcG9ydCBUcmVlTm9kZSBmcm9tICcuLi9UcmVlTm9kZSc7XG5leHBvcnQgZnVuY3Rpb24gY29udmVydENoaWxkcmVuVG9EYXRhKG5vZGVzKSB7XG4gIHJldHVybiB0b0FycmF5KG5vZGVzKS5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICBpZiAoISAvKiNfX1BVUkVfXyovUmVhY3QuaXNWYWxpZEVsZW1lbnQobm9kZSkgfHwgIW5vZGUudHlwZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdmFyIGtleSA9IG5vZGUua2V5LFxuICAgICAgICBfbm9kZSRwcm9wcyA9IG5vZGUucHJvcHMsXG4gICAgICAgIGNoaWxkcmVuID0gX25vZGUkcHJvcHMuY2hpbGRyZW4sXG4gICAgICAgIHZhbHVlID0gX25vZGUkcHJvcHMudmFsdWUsXG4gICAgICAgIHJlc3RQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfbm9kZSRwcm9wcywgW1wiY2hpbGRyZW5cIiwgXCJ2YWx1ZVwiXSk7XG5cbiAgICB2YXIgZGF0YSA9IF9vYmplY3RTcHJlYWQoe1xuICAgICAga2V5OiBrZXksXG4gICAgICB2YWx1ZTogdmFsdWVcbiAgICB9LCByZXN0UHJvcHMpO1xuXG4gICAgdmFyIGNoaWxkRGF0YSA9IGNvbnZlcnRDaGlsZHJlblRvRGF0YShjaGlsZHJlbik7XG5cbiAgICBpZiAoY2hpbGREYXRhLmxlbmd0aCkge1xuICAgICAgZGF0YS5jaGlsZHJlbiA9IGNoaWxkRGF0YTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfSkuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxMZWdhY3lQcm9wcyhkYXRhTm9kZSkge1xuICAvLyBTa2lwIGlmIG5vdCBkYXRhTm9kZSBleGlzdFxuICBpZiAoIWRhdGFOb2RlKSB7XG4gICAgcmV0dXJuIGRhdGFOb2RlO1xuICB9XG5cbiAgdmFyIGNsb25lTm9kZSA9IF9vYmplY3RTcHJlYWQoe30sIGRhdGFOb2RlKTtcblxuICBpZiAoISgncHJvcHMnIGluIGNsb25lTm9kZSkpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xvbmVOb2RlLCAncHJvcHMnLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgd2FybmluZyhmYWxzZSwgJ05ldyBgcmMtdHJlZS1zZWxlY3RgIG5vdCBzdXBwb3J0IHJldHVybiBub2RlIGluc3RhbmNlIGFzIGFyZ3VtZW50IGFueW1vcmUuIFBsZWFzZSBjb25zaWRlciB0byByZW1vdmUgYHByb3BzYCBhY2Nlc3MuJyk7XG4gICAgICAgIHJldHVybiBjbG9uZU5vZGU7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gY2xvbmVOb2RlO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxBZGRpdGlvbmFsSW5mbyhleHRyYSwgdHJpZ2dlclZhbHVlLCBjaGVja2VkVmFsdWVzLCB0cmVlRGF0YSwgc2hvd1Bvc2l0aW9uKSB7XG4gIHZhciB0cmlnZ2VyTm9kZSA9IG51bGw7XG4gIHZhciBub2RlTGlzdCA9IG51bGw7XG5cbiAgZnVuY3Rpb24gZ2VuZXJhdGVNYXAoKSB7XG4gICAgZnVuY3Rpb24gZGlnKGxpc3QpIHtcbiAgICAgIHZhciBsZXZlbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJzAnO1xuICAgICAgdmFyIHBhcmVudEluY2x1ZGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTtcbiAgICAgIHJldHVybiBsaXN0Lm1hcChmdW5jdGlvbiAoZGF0YU5vZGUsIGluZGV4KSB7XG4gICAgICAgIHZhciBwb3MgPSBcIlwiLmNvbmNhdChsZXZlbCwgXCItXCIpLmNvbmNhdChpbmRleCk7XG4gICAgICAgIHZhciBpbmNsdWRlZCA9IGNoZWNrZWRWYWx1ZXMuaW5jbHVkZXMoZGF0YU5vZGUudmFsdWUpO1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBkaWcoZGF0YU5vZGUuY2hpbGRyZW4gfHwgW10sIHBvcywgaW5jbHVkZWQpO1xuICAgICAgICB2YXIgbm9kZSA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyZWVOb2RlLCBkYXRhTm9kZSwgY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgIHJldHVybiBjaGlsZC5ub2RlO1xuICAgICAgICB9KSk7IC8vIExpbmsgd2l0aCB0cmlnZ2VyIG5vZGVcblxuICAgICAgICBpZiAodHJpZ2dlclZhbHVlID09PSBkYXRhTm9kZS52YWx1ZSkge1xuICAgICAgICAgIHRyaWdnZXJOb2RlID0gbm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmNsdWRlZCkge1xuICAgICAgICAgIHZhciBjaGVja2VkTm9kZSA9IHtcbiAgICAgICAgICAgIHBvczogcG9zLFxuICAgICAgICAgICAgbm9kZTogbm9kZSxcbiAgICAgICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlblxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoIXBhcmVudEluY2x1ZGVkKSB7XG4gICAgICAgICAgICBub2RlTGlzdC5wdXNoKGNoZWNrZWROb2RlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY2hlY2tlZE5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghbm9kZUxpc3QpIHtcbiAgICAgIG5vZGVMaXN0ID0gW107XG4gICAgICBkaWcodHJlZURhdGEpOyAvLyBTb3J0IHRvIGtlZXAgdGhlIGNoZWNrZWQgbm9kZSBsZW5ndGhcblxuICAgICAgbm9kZUxpc3Quc29ydChmdW5jdGlvbiAoX3JlZiwgX3JlZjIpIHtcbiAgICAgICAgdmFyIHZhbDEgPSBfcmVmLm5vZGUucHJvcHMudmFsdWU7XG4gICAgICAgIHZhciB2YWwyID0gX3JlZjIubm9kZS5wcm9wcy52YWx1ZTtcbiAgICAgICAgdmFyIGluZGV4MSA9IGNoZWNrZWRWYWx1ZXMuaW5kZXhPZih2YWwxKTtcbiAgICAgICAgdmFyIGluZGV4MiA9IGNoZWNrZWRWYWx1ZXMuaW5kZXhPZih2YWwyKTtcbiAgICAgICAgcmV0dXJuIGluZGV4MSAtIGluZGV4MjtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHRyYSwgJ3RyaWdnZXJOb2RlJywge1xuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgd2FybmluZyhmYWxzZSwgJ2B0cmlnZ2VyTm9kZWAgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIGNvbnNpZGVyIGRlY291cGxpbmcgZGF0YSB3aXRoIG5vZGUuJyk7XG4gICAgICBnZW5lcmF0ZU1hcCgpO1xuICAgICAgcmV0dXJuIHRyaWdnZXJOb2RlO1xuICAgIH1cbiAgfSk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHRyYSwgJ2FsbENoZWNrZWROb2RlcycsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHdhcm5pbmcoZmFsc2UsICdgYWxsQ2hlY2tlZE5vZGVzYCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgY29uc2lkZXIgZGVjb3VwbGluZyBkYXRhIHdpdGggbm9kZS4nKTtcbiAgICAgIGdlbmVyYXRlTWFwKCk7XG5cbiAgICAgIGlmIChzaG93UG9zaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIG5vZGVMaXN0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbm9kZUxpc3QubWFwKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgICB2YXIgbm9kZSA9IF9yZWYzLm5vZGU7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn0iLCJpbXBvcnQgeyBpc0NoZWNrRGlzYWJsZWQgfSBmcm9tICcuL3ZhbHVlVXRpbCc7XG5leHBvcnQgdmFyIFNIT1dfQUxMID0gJ1NIT1dfQUxMJztcbmV4cG9ydCB2YXIgU0hPV19QQVJFTlQgPSAnU0hPV19QQVJFTlQnO1xuZXhwb3J0IHZhciBTSE9XX0NISUxEID0gJ1NIT1dfQ0hJTEQnO1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFN0cmF0ZWd5S2V5cyhrZXlzLCBzdHJhdGVneSwga2V5RW50aXRpZXMpIHtcbiAgdmFyIGtleVNldCA9IG5ldyBTZXQoa2V5cyk7XG5cbiAgaWYgKHN0cmF0ZWd5ID09PSBTSE9XX0NISUxEKSB7XG4gICAgcmV0dXJuIGtleXMuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHZhciBlbnRpdHkgPSBrZXlFbnRpdGllc1trZXldO1xuXG4gICAgICBpZiAoZW50aXR5ICYmIGVudGl0eS5jaGlsZHJlbiAmJiBlbnRpdHkuY2hpbGRyZW4uZXZlcnkoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBfcmVmLm5vZGU7XG4gICAgICAgIHJldHVybiBpc0NoZWNrRGlzYWJsZWQobm9kZSkgfHwga2V5U2V0Lmhhcyhub2RlLmtleSk7XG4gICAgICB9KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHN0cmF0ZWd5ID09PSBTSE9XX1BBUkVOVCkge1xuICAgIHJldHVybiBrZXlzLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgZW50aXR5ID0ga2V5RW50aXRpZXNba2V5XTtcbiAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkgPyBlbnRpdHkucGFyZW50IDogbnVsbDtcblxuICAgICAgaWYgKHBhcmVudCAmJiAhaXNDaGVja0Rpc2FibGVkKHBhcmVudC5ub2RlKSAmJiBrZXlTZXQuaGFzKHBhcmVudC5ub2RlLmtleSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBrZXlzO1xufSIsImltcG9ydCBfdHlwZW9mIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2ZcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgeyBmbGF0dGVuVHJlZURhdGEgfSBmcm9tIFwicmMtdHJlZS9lcy91dGlscy90cmVlVXRpbFwiO1xuaW1wb3J0IHsgZmlsbExlZ2FjeVByb3BzIH0gZnJvbSAnLi9sZWdhY3lVdGlsJztcbmV4cG9ydCBmdW5jdGlvbiB0b0FycmF5KHZhbHVlKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gW3ZhbHVlXSA6IFtdO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRWYWx1ZU9wdGlvbih2YWx1ZXMsIG9wdGlvbnMpIHtcbiAgdmFyIG9wdGlvbk1hcCA9IG5ldyBNYXAoKTtcbiAgb3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChmbGF0dGVuSXRlbSkge1xuICAgIHZhciBkYXRhID0gZmxhdHRlbkl0ZW0uZGF0YTtcbiAgICBvcHRpb25NYXAuc2V0KGRhdGEudmFsdWUsIGRhdGEpO1xuICB9KTtcbiAgcmV0dXJuIHZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgIHJldHVybiBmaWxsTGVnYWN5UHJvcHMob3B0aW9uTWFwLmdldCh2YWwpKTtcbiAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNWYWx1ZURpc2FibGVkKHZhbHVlLCBvcHRpb25zKSB7XG4gIHZhciBvcHRpb24gPSBmaW5kVmFsdWVPcHRpb24oW3ZhbHVlXSwgb3B0aW9ucylbMF07XG5cbiAgaWYgKG9wdGlvbikge1xuICAgIHJldHVybiBvcHRpb24uZGlzYWJsZWQ7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNDaGVja0Rpc2FibGVkKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuZGlzYWJsZWQgfHwgbm9kZS5kaXNhYmxlQ2hlY2tib3ggfHwgbm9kZS5jaGVja2FibGUgPT09IGZhbHNlO1xufVxuXG5mdW5jdGlvbiBnZXRMZXZlbChfcmVmKSB7XG4gIHZhciBwYXJlbnQgPSBfcmVmLnBhcmVudDtcbiAgdmFyIGxldmVsID0gMDtcbiAgdmFyIGN1cnJlbnQgPSBwYXJlbnQ7XG5cbiAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XG4gICAgbGV2ZWwgKz0gMTtcbiAgfVxuXG4gIHJldHVybiBsZXZlbDtcbn1cbi8qKlxuICogQmVmb3JlIHJldXNlIGByYy10cmVlYCBsb2dpYywgd2UgbmVlZCB0byBhZGQga2V5IHNpbmNlIFRyZWVTZWxlY3QgdXNlIGB2YWx1ZWAgaW5zdGVhZCBvZiBga2V5YC5cbiAqL1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBmbGF0dGVuT3B0aW9ucyhvcHRpb25zKSB7XG4gIC8vIEFkZCBtaXNzaW5nIGtleVxuICBmdW5jdGlvbiBmaWxsS2V5KGxpc3QpIHtcbiAgICByZXR1cm4gKGxpc3QgfHwgW10pLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgdmFyIHZhbHVlID0gbm9kZS52YWx1ZSxcbiAgICAgICAgICBrZXkgPSBub2RlLmtleSxcbiAgICAgICAgICBjaGlsZHJlbiA9IG5vZGUuY2hpbGRyZW47XG5cbiAgICAgIHZhciBjbG9uZSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbm9kZSksIHt9LCB7XG4gICAgICAgIGtleTogJ2tleScgaW4gbm9kZSA/IGtleSA6IHZhbHVlXG4gICAgICB9KTtcblxuICAgICAgaWYgKGNoaWxkcmVuKSB7XG4gICAgICAgIGNsb25lLmNoaWxkcmVuID0gZmlsbEtleShjaGlsZHJlbik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBmbGF0dGVuTGlzdCA9IGZsYXR0ZW5UcmVlRGF0YShmaWxsS2V5KG9wdGlvbnMpLCB0cnVlKTtcbiAgcmV0dXJuIGZsYXR0ZW5MaXN0Lm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgIHJldHVybiB7XG4gICAgICBrZXk6IG5vZGUuZGF0YS5rZXksXG4gICAgICBkYXRhOiBub2RlLmRhdGEsXG4gICAgICBsZXZlbDogZ2V0TGV2ZWwobm9kZSlcbiAgICB9O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdEZpbHRlck9wdGlvbihvcHRpb25GaWx0ZXJQcm9wKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoc2VhcmNoVmFsdWUsIGRhdGFOb2RlKSB7XG4gICAgdmFyIHZhbHVlID0gZGF0YU5vZGVbb3B0aW9uRmlsdGVyUHJvcF07XG4gICAgcmV0dXJuIFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhTdHJpbmcoc2VhcmNoVmFsdWUpLnRvTG93ZXJDYXNlKCkpO1xuICB9O1xufVxuLyoqIEZpbHRlciBvcHRpb25zIGFuZCByZXR1cm4gYSBuZXcgb3B0aW9ucyBieSB0aGUgc2VhcmNoIHRleHQgKi9cblxuXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyT3B0aW9ucyhzZWFyY2hWYWx1ZSwgb3B0aW9ucywgX3JlZjIpIHtcbiAgdmFyIG9wdGlvbkZpbHRlclByb3AgPSBfcmVmMi5vcHRpb25GaWx0ZXJQcm9wLFxuICAgICAgZmlsdGVyT3B0aW9uID0gX3JlZjIuZmlsdGVyT3B0aW9uO1xuXG4gIGlmIChmaWx0ZXJPcHRpb24gPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cblxuICB2YXIgZmlsdGVyT3B0aW9uRnVuYztcblxuICBpZiAodHlwZW9mIGZpbHRlck9wdGlvbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGZpbHRlck9wdGlvbkZ1bmMgPSBmaWx0ZXJPcHRpb247XG4gIH0gZWxzZSB7XG4gICAgZmlsdGVyT3B0aW9uRnVuYyA9IGdldERlZmF1bHRGaWx0ZXJPcHRpb24ob3B0aW9uRmlsdGVyUHJvcCk7XG4gIH1cblxuICBmdW5jdGlvbiBkaWcobGlzdCkge1xuICAgIHZhciBrZWVwQWxsID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTtcbiAgICByZXR1cm4gbGlzdC5tYXAoZnVuY3Rpb24gKGRhdGFOb2RlKSB7XG4gICAgICB2YXIgY2hpbGRyZW4gPSBkYXRhTm9kZS5jaGlsZHJlbjtcbiAgICAgIHZhciBtYXRjaCA9IGtlZXBBbGwgfHwgZmlsdGVyT3B0aW9uRnVuYyhzZWFyY2hWYWx1ZSwgZmlsbExlZ2FjeVByb3BzKGRhdGFOb2RlKSk7XG4gICAgICB2YXIgY2hpbGRMaXN0ID0gZGlnKGNoaWxkcmVuIHx8IFtdLCBtYXRjaCk7XG5cbiAgICAgIGlmIChtYXRjaCB8fCBjaGlsZExpc3QubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGRhdGFOb2RlKSwge30sIHtcbiAgICAgICAgICBjaGlsZHJlbjogY2hpbGRMaXN0XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIGRpZyhvcHRpb25zKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRSYXdWYWx1ZUxhYmVsZWQodmFsdWVzLCBwcmV2VmFsdWUsIGdldEVudGl0eUJ5VmFsdWUsIGdldExhYmVsUHJvcCkge1xuICB2YXIgdmFsdWVNYXAgPSBuZXcgTWFwKCk7XG4gIHRvQXJyYXkocHJldlZhbHVlKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKGl0ZW0gJiYgX3R5cGVvZihpdGVtKSA9PT0gJ29iamVjdCcgJiYgJ3ZhbHVlJyBpbiBpdGVtKSB7XG4gICAgICB2YWx1ZU1hcC5zZXQoaXRlbS52YWx1ZSwgaXRlbSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCkge1xuICAgIHZhciBpdGVtID0ge1xuICAgICAgdmFsdWU6IHZhbFxuICAgIH07XG4gICAgdmFyIGVudGl0eSA9IGdldEVudGl0eUJ5VmFsdWUodmFsLCAnc2VsZWN0JywgdHJ1ZSk7XG4gICAgdmFyIGxhYmVsID0gZW50aXR5ID8gZ2V0TGFiZWxQcm9wKGVudGl0eS5kYXRhKSA6IHZhbDtcblxuICAgIGlmICh2YWx1ZU1hcC5oYXModmFsKSkge1xuICAgICAgdmFyIGxhYmVsZWRWYWx1ZSA9IHZhbHVlTWFwLmdldCh2YWwpO1xuICAgICAgaXRlbS5sYWJlbCA9ICdsYWJlbCcgaW4gbGFiZWxlZFZhbHVlID8gbGFiZWxlZFZhbHVlLmxhYmVsIDogbGFiZWw7XG5cbiAgICAgIGlmICgnaGFsZkNoZWNrZWQnIGluIGxhYmVsZWRWYWx1ZSkge1xuICAgICAgICBpdGVtLmhhbGZDaGVja2VkID0gbGFiZWxlZFZhbHVlLmhhbGZDaGVja2VkO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpdGVtLmxhYmVsID0gbGFiZWw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGl0ZW07XG4gIH0pO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFkZFZhbHVlKHJhd1ZhbHVlcywgdmFsdWUpIHtcbiAgdmFyIHZhbHVlcyA9IG5ldyBTZXQocmF3VmFsdWVzKTtcbiAgdmFsdWVzLmFkZCh2YWx1ZSk7XG4gIHJldHVybiBBcnJheS5mcm9tKHZhbHVlcyk7XG59XG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVmFsdWUocmF3VmFsdWVzLCB2YWx1ZSkge1xuICB2YXIgdmFsdWVzID0gbmV3IFNldChyYXdWYWx1ZXMpO1xuICB2YWx1ZXMuZGVsZXRlKHZhbHVlKTtcbiAgcmV0dXJuIEFycmF5LmZyb20odmFsdWVzKTtcbn0iLCJpbXBvcnQgX3R5cGVvZiBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mXCI7XG5pbXBvcnQgd2FybmluZyBmcm9tIFwicmMtdXRpbC9lcy93YXJuaW5nXCI7XG5pbXBvcnQgeyB0b0FycmF5IH0gZnJvbSAnLi92YWx1ZVV0aWwnO1xuXG5mdW5jdGlvbiB3YXJuaW5nUHJvcHMocHJvcHMpIHtcbiAgdmFyIHNlYXJjaFBsYWNlaG9sZGVyID0gcHJvcHMuc2VhcmNoUGxhY2Vob2xkZXIsXG4gICAgICB0cmVlQ2hlY2tTdHJpY3RseSA9IHByb3BzLnRyZWVDaGVja1N0cmljdGx5LFxuICAgICAgdHJlZUNoZWNrYWJsZSA9IHByb3BzLnRyZWVDaGVja2FibGUsXG4gICAgICBsYWJlbEluVmFsdWUgPSBwcm9wcy5sYWJlbEluVmFsdWUsXG4gICAgICB2YWx1ZSA9IHByb3BzLnZhbHVlLFxuICAgICAgbXVsdGlwbGUgPSBwcm9wcy5tdWx0aXBsZTtcbiAgd2FybmluZyghc2VhcmNoUGxhY2Vob2xkZXIsICdgc2VhcmNoUGxhY2Vob2xkZXJgIGhhcyBiZWVuIHJlbW92ZWQuJyk7XG5cbiAgaWYgKHRyZWVDaGVja1N0cmljdGx5ICYmIGxhYmVsSW5WYWx1ZSA9PT0gZmFsc2UpIHtcbiAgICB3YXJuaW5nKGZhbHNlLCAnYHRyZWVDaGVja1N0cmljdGx5YCB3aWxsIGZvcmNlIHNldCBgbGFiZWxJblZhbHVlYCB0byBgdHJ1ZWAuJyk7XG4gIH1cblxuICBpZiAobGFiZWxJblZhbHVlIHx8IHRyZWVDaGVja1N0cmljdGx5KSB7XG4gICAgd2FybmluZyh0b0FycmF5KHZhbHVlKS5ldmVyeShmdW5jdGlvbiAodmFsKSB7XG4gICAgICByZXR1cm4gdmFsICYmIF90eXBlb2YodmFsKSA9PT0gJ29iamVjdCcgJiYgJ3ZhbHVlJyBpbiB2YWw7XG4gICAgfSksICdJbnZhbGlkIHByb3AgYHZhbHVlYCBzdXBwbGllZCB0byBgVHJlZVNlbGVjdGAuIFlvdSBzaG91bGQgdXNlIHsgbGFiZWw6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IG51bWJlciB9IG9yIFt7IGxhYmVsOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIgfV0gaW5zdGVhZC4nKTtcbiAgfVxuXG4gIGlmICh0cmVlQ2hlY2tTdHJpY3RseSB8fCBtdWx0aXBsZSB8fCB0cmVlQ2hlY2thYmxlKSB7XG4gICAgd2FybmluZyghdmFsdWUgfHwgQXJyYXkuaXNBcnJheSh2YWx1ZSksICdgdmFsdWVgIHNob3VsZCBiZSBhbiBhcnJheSB3aGVuIGBUcmVlU2VsZWN0YCBpcyBjaGVja2FibGUgb3IgbXVsdGlwbGUuJyk7XG4gIH0gZWxzZSB7XG4gICAgd2FybmluZyghQXJyYXkuaXNBcnJheSh2YWx1ZSksICdgdmFsdWVgIHNob3VsZCBub3QgYmUgYXJyYXkgd2hlbiBgVHJlZVNlbGVjdGAgaXMgc2luZ2xlIG1vZGUuJyk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgd2FybmluZ1Byb3BzOyIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIERyb3BJbmRpY2F0b3IoX3JlZikge1xuICB2YXIgZHJvcFBvc2l0aW9uID0gX3JlZi5kcm9wUG9zaXRpb24sXG4gICAgICBkcm9wTGV2ZWxPZmZzZXQgPSBfcmVmLmRyb3BMZXZlbE9mZnNldCxcbiAgICAgIGluZGVudCA9IF9yZWYuaW5kZW50O1xuICB2YXIgc3R5bGUgPSB7XG4gICAgcG9pbnRlckV2ZW50czogJ25vbmUnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHJpZ2h0OiAwLFxuICAgIGJhY2tncm91bmRDb2xvcjogJ3JlZCcsXG4gICAgaGVpZ2h0OiAyXG4gIH07XG5cbiAgc3dpdGNoIChkcm9wUG9zaXRpb24pIHtcbiAgICBjYXNlIC0xOlxuICAgICAgc3R5bGUudG9wID0gMDtcbiAgICAgIHN0eWxlLmxlZnQgPSAtZHJvcExldmVsT2Zmc2V0ICogaW5kZW50O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIDE6XG4gICAgICBzdHlsZS5ib3R0b20gPSAwO1xuICAgICAgc3R5bGUubGVmdCA9IC1kcm9wTGV2ZWxPZmZzZXQgKiBpbmRlbnQ7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgMDpcbiAgICAgIHN0eWxlLmJvdHRvbSA9IDA7XG4gICAgICBzdHlsZS5sZWZ0ID0gaW5kZW50O1xuICAgICAgYnJlYWs7XG4gIH1cblxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIHN0eWxlOiBzdHlsZVxuICB9KTtcbn0iLCJpbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eVwiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5cbnZhciBJbmRlbnQgPSBmdW5jdGlvbiBJbmRlbnQoX3JlZikge1xuICB2YXIgcHJlZml4Q2xzID0gX3JlZi5wcmVmaXhDbHMsXG4gICAgICBsZXZlbCA9IF9yZWYubGV2ZWwsXG4gICAgICBpc1N0YXJ0ID0gX3JlZi5pc1N0YXJ0LFxuICAgICAgaXNFbmQgPSBfcmVmLmlzRW5kO1xuICB2YXIgYmFzZUNsYXNzTmFtZSA9IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItaW5kZW50LXVuaXRcIik7XG4gIHZhciBsaXN0ID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZXZlbDsgaSArPSAxKSB7XG4gICAgdmFyIF9jbGFzc05hbWVzO1xuXG4gICAgbGlzdC5wdXNoKCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAga2V5OiBpLFxuICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVzKGJhc2VDbGFzc05hbWUsIChfY2xhc3NOYW1lcyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzTmFtZXMsIFwiXCIuY29uY2F0KGJhc2VDbGFzc05hbWUsIFwiLXN0YXJ0XCIpLCBpc1N0YXJ0W2ldKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChiYXNlQ2xhc3NOYW1lLCBcIi1lbmRcIiksIGlzRW5kW2ldKSwgX2NsYXNzTmFtZXMpKVxuICAgIH0pKTtcbiAgfVxuXG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgIFwiYXJpYS1oaWRkZW5cIjogXCJ0cnVlXCIsXG4gICAgY2xhc3NOYW1lOiBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWluZGVudFwiKVxuICB9LCBsaXN0KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEluZGVudDsiLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheVwiO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IENTU01vdGlvbiBmcm9tICdyYy1tb3Rpb24nO1xuaW1wb3J0IFRyZWVOb2RlIGZyb20gJy4vVHJlZU5vZGUnO1xuaW1wb3J0IHsgZ2V0VHJlZU5vZGVQcm9wcyB9IGZyb20gJy4vdXRpbHMvdHJlZVV0aWwnO1xuaW1wb3J0IHsgVHJlZUNvbnRleHQgfSBmcm9tICcuL2NvbnRleHRUeXBlcyc7XG5cbnZhciBNb3Rpb25UcmVlTm9kZSA9IGZ1bmN0aW9uIE1vdGlvblRyZWVOb2RlKF9yZWYsIHJlZikge1xuICB2YXIgY2xhc3NOYW1lID0gX3JlZi5jbGFzc05hbWUsXG4gICAgICBzdHlsZSA9IF9yZWYuc3R5bGUsXG4gICAgICBtb3Rpb24gPSBfcmVmLm1vdGlvbixcbiAgICAgIG1vdGlvbk5vZGVzID0gX3JlZi5tb3Rpb25Ob2RlcyxcbiAgICAgIG1vdGlvblR5cGUgPSBfcmVmLm1vdGlvblR5cGUsXG4gICAgICBvbk9yaWdpbk1vdGlvblN0YXJ0ID0gX3JlZi5vbk1vdGlvblN0YXJ0LFxuICAgICAgb25PcmlnaW5Nb3Rpb25FbmQgPSBfcmVmLm9uTW90aW9uRW5kLFxuICAgICAgYWN0aXZlID0gX3JlZi5hY3RpdmUsXG4gICAgICB0cmVlTm9kZVJlcXVpcmVkUHJvcHMgPSBfcmVmLnRyZWVOb2RlUmVxdWlyZWRQcm9wcyxcbiAgICAgIHByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF9yZWYsIFtcImNsYXNzTmFtZVwiLCBcInN0eWxlXCIsIFwibW90aW9uXCIsIFwibW90aW9uTm9kZXNcIiwgXCJtb3Rpb25UeXBlXCIsIFwib25Nb3Rpb25TdGFydFwiLCBcIm9uTW90aW9uRW5kXCIsIFwiYWN0aXZlXCIsIFwidHJlZU5vZGVSZXF1aXJlZFByb3BzXCJdKTtcblxuICB2YXIgX1JlYWN0JHVzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUodHJ1ZSksXG4gICAgICBfUmVhY3QkdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlLCAyKSxcbiAgICAgIHZpc2libGUgPSBfUmVhY3QkdXNlU3RhdGUyWzBdLFxuICAgICAgc2V0VmlzaWJsZSA9IF9SZWFjdCR1c2VTdGF0ZTJbMV07XG5cbiAgdmFyIF9SZWFjdCR1c2VDb250ZXh0ID0gUmVhY3QudXNlQ29udGV4dChUcmVlQ29udGV4dCksXG4gICAgICBwcmVmaXhDbHMgPSBfUmVhY3QkdXNlQ29udGV4dC5wcmVmaXhDbHM7XG5cbiAgdmFyIG1vdGlvbmVkUmVmID0gUmVhY3QudXNlUmVmKGZhbHNlKTtcblxuICB2YXIgb25Nb3Rpb25FbmQgPSBmdW5jdGlvbiBvbk1vdGlvbkVuZCgpIHtcbiAgICBpZiAoIW1vdGlvbmVkUmVmLmN1cnJlbnQpIHtcbiAgICAgIG9uT3JpZ2luTW90aW9uRW5kKCk7XG4gICAgfVxuXG4gICAgbW90aW9uZWRSZWYuY3VycmVudCA9IHRydWU7XG4gIH07XG5cbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobW90aW9uTm9kZXMgJiYgbW90aW9uVHlwZSA9PT0gJ2hpZGUnICYmIHZpc2libGUpIHtcbiAgICAgIHNldFZpc2libGUoZmFsc2UpO1xuICAgIH1cbiAgfSwgW21vdGlvbk5vZGVzXSk7XG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgLy8gVHJpZ2dlciBtb3Rpb24gb25seSB3aGVuIHBhdGNoZWRcbiAgICBpZiAobW90aW9uTm9kZXMpIHtcbiAgICAgIG9uT3JpZ2luTW90aW9uU3RhcnQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKG1vdGlvbk5vZGVzKSB7XG4gICAgICAgIG9uTW90aW9uRW5kKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIGlmIChtb3Rpb25Ob2Rlcykge1xuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDU1NNb3Rpb24sIF9leHRlbmRzKHtcbiAgICAgIHJlZjogcmVmLFxuICAgICAgdmlzaWJsZTogdmlzaWJsZVxuICAgIH0sIG1vdGlvbiwge1xuICAgICAgbW90aW9uQXBwZWFyOiBtb3Rpb25UeXBlID09PSAnc2hvdycsXG4gICAgICBvbkFwcGVhckVuZDogb25Nb3Rpb25FbmQsXG4gICAgICBvbkxlYXZlRW5kOiBvbk1vdGlvbkVuZFxuICAgIH0pLCBmdW5jdGlvbiAoX3JlZjIsIG1vdGlvblJlZikge1xuICAgICAgdmFyIG1vdGlvbkNsYXNzTmFtZSA9IF9yZWYyLmNsYXNzTmFtZSxcbiAgICAgICAgICBtb3Rpb25TdHlsZSA9IF9yZWYyLnN0eWxlO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgcmVmOiBtb3Rpb25SZWYsXG4gICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLW1vdGlvblwiKSwgbW90aW9uQ2xhc3NOYW1lKSxcbiAgICAgICAgc3R5bGU6IG1vdGlvblN0eWxlXG4gICAgICB9LCBtb3Rpb25Ob2Rlcy5tYXAoZnVuY3Rpb24gKHRyZWVOb2RlKSB7XG4gICAgICAgIHZhciBfdHJlZU5vZGUkZGF0YSA9IHRyZWVOb2RlLmRhdGEsXG4gICAgICAgICAgICBrZXkgPSBfdHJlZU5vZGUkZGF0YS5rZXksXG4gICAgICAgICAgICByZXN0UHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3RyZWVOb2RlJGRhdGEsIFtcImtleVwiXSksXG4gICAgICAgICAgICBpc1N0YXJ0ID0gdHJlZU5vZGUuaXNTdGFydCxcbiAgICAgICAgICAgIGlzRW5kID0gdHJlZU5vZGUuaXNFbmQ7XG5cbiAgICAgICAgZGVsZXRlIHJlc3RQcm9wcy5jaGlsZHJlbjtcbiAgICAgICAgdmFyIHRyZWVOb2RlUHJvcHMgPSBnZXRUcmVlTm9kZVByb3BzKGtleSwgdHJlZU5vZGVSZXF1aXJlZFByb3BzKTtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyZWVOb2RlLCBfZXh0ZW5kcyh7fSwgcmVzdFByb3BzLCB0cmVlTm9kZVByb3BzLCB7XG4gICAgICAgICAgYWN0aXZlOiBhY3RpdmUsXG4gICAgICAgICAgZGF0YTogdHJlZU5vZGUuZGF0YSxcbiAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICBpc1N0YXJ0OiBpc1N0YXJ0LFxuICAgICAgICAgIGlzRW5kOiBpc0VuZFxuICAgICAgICB9KSk7XG4gICAgICB9KSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJlZU5vZGUsIF9leHRlbmRzKHtcbiAgICBkb21SZWY6IHJlZixcbiAgICBjbGFzc05hbWU6IGNsYXNzTmFtZSxcbiAgICBzdHlsZTogc3R5bGVcbiAgfSwgcHJvcHMsIHtcbiAgICBhY3RpdmU6IGFjdGl2ZVxuICB9KSk7XG59O1xuXG5Nb3Rpb25UcmVlTm9kZS5kaXNwbGF5TmFtZSA9ICdNb3Rpb25UcmVlTm9kZSc7XG52YXIgUmVmTW90aW9uVHJlZU5vZGUgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihNb3Rpb25UcmVlTm9kZSk7XG5leHBvcnQgZGVmYXVsdCBSZWZNb3Rpb25UcmVlTm9kZTsiLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheVwiO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNcIjtcblxuLyoqXG4gKiBIYW5kbGUgdmlydHVhbCBsaXN0IG9mIHRoZSBUcmVlTm9kZXMuXG4gKi9cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBWaXJ0dWFsTGlzdCBmcm9tICdyYy12aXJ0dWFsLWxpc3QnO1xuaW1wb3J0IE1vdGlvblRyZWVOb2RlIGZyb20gJy4vTW90aW9uVHJlZU5vZGUnO1xuaW1wb3J0IHsgZmluZEV4cGFuZGVkS2V5cywgZ2V0RXhwYW5kUmFuZ2UgfSBmcm9tICcuL3V0aWxzL2RpZmZVdGlsJztcbmltcG9ydCB7IGdldFRyZWVOb2RlUHJvcHMsIGdldEtleSB9IGZyb20gJy4vdXRpbHMvdHJlZVV0aWwnO1xudmFyIEhJRERFTl9TVFlMRSA9IHtcbiAgd2lkdGg6IDAsXG4gIGhlaWdodDogMCxcbiAgZGlzcGxheTogJ2ZsZXgnLFxuICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gIG9wYWNpdHk6IDAsXG4gIGJvcmRlcjogMCxcbiAgcGFkZGluZzogMCxcbiAgbWFyZ2luOiAwXG59O1xuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxuZXhwb3J0IHZhciBNT1RJT05fS0VZID0gXCJSQ19UUkVFX01PVElPTl9cIi5jb25jYXQoTWF0aC5yYW5kb20oKSk7XG52YXIgTW90aW9uTm9kZSA9IHtcbiAga2V5OiBNT1RJT05fS0VZXG59O1xuZXhwb3J0IHZhciBNb3Rpb25FbnRpdHkgPSB7XG4gIGtleTogTU9USU9OX0tFWSxcbiAgbGV2ZWw6IDAsXG4gIGluZGV4OiAwLFxuICBwb3M6ICcwJyxcbiAgbm9kZTogTW90aW9uTm9kZVxufTtcbnZhciBNb3Rpb25GbGF0dGVuRGF0YSA9IHtcbiAgcGFyZW50OiBudWxsLFxuICBjaGlsZHJlbjogW10sXG4gIHBvczogTW90aW9uRW50aXR5LnBvcyxcbiAgZGF0YTogTW90aW9uTm9kZSxcblxuICAvKiogSG9sZCBlbXB0eSBsaXN0IGhlcmUgc2luY2Ugd2UgZG8gbm90IHVzZSBpdCAqL1xuICBpc1N0YXJ0OiBbXSxcbiAgaXNFbmQ6IFtdXG59O1xuLyoqXG4gKiBXZSBvbmx5IG5lZWQgZ2V0IHZpc2libGUgY29udGVudCBpdGVtcyB0byBwbGF5IHRoZSBhbmltYXRpb24uXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1pbmltdW1SYW5nZVRyYW5zaXRpb25SYW5nZShsaXN0LCB2aXJ0dWFsLCBoZWlnaHQsIGl0ZW1IZWlnaHQpIHtcbiAgaWYgKHZpcnR1YWwgPT09IGZhbHNlIHx8ICFoZWlnaHQpIHtcbiAgICByZXR1cm4gbGlzdDtcbiAgfVxuXG4gIHJldHVybiBsaXN0LnNsaWNlKDAsIE1hdGguY2VpbChoZWlnaHQgLyBpdGVtSGVpZ2h0KSArIDEpO1xufVxuXG5mdW5jdGlvbiBpdGVtS2V5KGl0ZW0pIHtcbiAgdmFyIGtleSA9IGl0ZW0uZGF0YS5rZXksXG4gICAgICBwb3MgPSBpdGVtLnBvcztcbiAgcmV0dXJuIGdldEtleShrZXksIHBvcyk7XG59XG5cbmZ1bmN0aW9uIGdldEFjY2Vzc2liaWxpdHlQYXRoKGl0ZW0pIHtcbiAgdmFyIHBhdGggPSBTdHJpbmcoaXRlbS5kYXRhLmtleSk7XG4gIHZhciBjdXJyZW50ID0gaXRlbTtcblxuICB3aGlsZSAoY3VycmVudC5wYXJlbnQpIHtcbiAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XG4gICAgcGF0aCA9IFwiXCIuY29uY2F0KGN1cnJlbnQuZGF0YS5rZXksIFwiID4gXCIpLmNvbmNhdChwYXRoKTtcbiAgfVxuXG4gIHJldHVybiBwYXRoO1xufVxuXG52YXIgUmVmTm9kZUxpc3QgPSBmdW5jdGlvbiBSZWZOb2RlTGlzdChwcm9wcywgcmVmKSB7XG4gIHZhciBwcmVmaXhDbHMgPSBwcm9wcy5wcmVmaXhDbHMsXG4gICAgICBkYXRhID0gcHJvcHMuZGF0YSxcbiAgICAgIHNlbGVjdGFibGUgPSBwcm9wcy5zZWxlY3RhYmxlLFxuICAgICAgY2hlY2thYmxlID0gcHJvcHMuY2hlY2thYmxlLFxuICAgICAgZXhwYW5kZWRLZXlzID0gcHJvcHMuZXhwYW5kZWRLZXlzLFxuICAgICAgc2VsZWN0ZWRLZXlzID0gcHJvcHMuc2VsZWN0ZWRLZXlzLFxuICAgICAgY2hlY2tlZEtleXMgPSBwcm9wcy5jaGVja2VkS2V5cyxcbiAgICAgIGxvYWRlZEtleXMgPSBwcm9wcy5sb2FkZWRLZXlzLFxuICAgICAgbG9hZGluZ0tleXMgPSBwcm9wcy5sb2FkaW5nS2V5cyxcbiAgICAgIGhhbGZDaGVja2VkS2V5cyA9IHByb3BzLmhhbGZDaGVja2VkS2V5cyxcbiAgICAgIGtleUVudGl0aWVzID0gcHJvcHMua2V5RW50aXRpZXMsXG4gICAgICBkaXNhYmxlZCA9IHByb3BzLmRpc2FibGVkLFxuICAgICAgZHJhZ2dpbmcgPSBwcm9wcy5kcmFnZ2luZyxcbiAgICAgIGRyYWdPdmVyTm9kZUtleSA9IHByb3BzLmRyYWdPdmVyTm9kZUtleSxcbiAgICAgIGRyb3BQb3NpdGlvbiA9IHByb3BzLmRyb3BQb3NpdGlvbixcbiAgICAgIG1vdGlvbiA9IHByb3BzLm1vdGlvbixcbiAgICAgIGhlaWdodCA9IHByb3BzLmhlaWdodCxcbiAgICAgIGl0ZW1IZWlnaHQgPSBwcm9wcy5pdGVtSGVpZ2h0LFxuICAgICAgdmlydHVhbCA9IHByb3BzLnZpcnR1YWwsXG4gICAgICBmb2N1c2FibGUgPSBwcm9wcy5mb2N1c2FibGUsXG4gICAgICBhY3RpdmVJdGVtID0gcHJvcHMuYWN0aXZlSXRlbSxcbiAgICAgIGZvY3VzZWQgPSBwcm9wcy5mb2N1c2VkLFxuICAgICAgdGFiSW5kZXggPSBwcm9wcy50YWJJbmRleCxcbiAgICAgIG9uS2V5RG93biA9IHByb3BzLm9uS2V5RG93bixcbiAgICAgIG9uRm9jdXMgPSBwcm9wcy5vbkZvY3VzLFxuICAgICAgb25CbHVyID0gcHJvcHMub25CbHVyLFxuICAgICAgb25BY3RpdmVDaGFuZ2UgPSBwcm9wcy5vbkFjdGl2ZUNoYW5nZSxcbiAgICAgIG9uTGlzdENoYW5nZVN0YXJ0ID0gcHJvcHMub25MaXN0Q2hhbmdlU3RhcnQsXG4gICAgICBvbkxpc3RDaGFuZ2VFbmQgPSBwcm9wcy5vbkxpc3RDaGFuZ2VFbmQsXG4gICAgICBkb21Qcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhwcm9wcywgW1wicHJlZml4Q2xzXCIsIFwiZGF0YVwiLCBcInNlbGVjdGFibGVcIiwgXCJjaGVja2FibGVcIiwgXCJleHBhbmRlZEtleXNcIiwgXCJzZWxlY3RlZEtleXNcIiwgXCJjaGVja2VkS2V5c1wiLCBcImxvYWRlZEtleXNcIiwgXCJsb2FkaW5nS2V5c1wiLCBcImhhbGZDaGVja2VkS2V5c1wiLCBcImtleUVudGl0aWVzXCIsIFwiZGlzYWJsZWRcIiwgXCJkcmFnZ2luZ1wiLCBcImRyYWdPdmVyTm9kZUtleVwiLCBcImRyb3BQb3NpdGlvblwiLCBcIm1vdGlvblwiLCBcImhlaWdodFwiLCBcIml0ZW1IZWlnaHRcIiwgXCJ2aXJ0dWFsXCIsIFwiZm9jdXNhYmxlXCIsIFwiYWN0aXZlSXRlbVwiLCBcImZvY3VzZWRcIiwgXCJ0YWJJbmRleFwiLCBcIm9uS2V5RG93blwiLCBcIm9uRm9jdXNcIiwgXCJvbkJsdXJcIiwgXCJvbkFjdGl2ZUNoYW5nZVwiLCBcIm9uTGlzdENoYW5nZVN0YXJ0XCIsIFwib25MaXN0Q2hhbmdlRW5kXCJdKTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBSZWYgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4gIHZhciBsaXN0UmVmID0gUmVhY3QudXNlUmVmKG51bGwpO1xuICB2YXIgaW5kZW50TWVhc3VyZXJSZWYgPSBSZWFjdC51c2VSZWYobnVsbCk7XG4gIFJlYWN0LnVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjcm9sbFRvOiBmdW5jdGlvbiBzY3JvbGxUbyhzY3JvbGwpIHtcbiAgICAgICAgbGlzdFJlZi5jdXJyZW50LnNjcm9sbFRvKHNjcm9sbCk7XG4gICAgICB9LFxuICAgICAgZ2V0SW5kZW50V2lkdGg6IGZ1bmN0aW9uIGdldEluZGVudFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gaW5kZW50TWVhc3VyZXJSZWYuY3VycmVudC5vZmZzZXRXaWR0aDtcbiAgICAgIH1cbiAgICB9O1xuICB9KTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IE1vdGlvbiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICB2YXIgX1JlYWN0JHVzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUoZXhwYW5kZWRLZXlzKSxcbiAgICAgIF9SZWFjdCR1c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGUsIDIpLFxuICAgICAgcHJldkV4cGFuZGVkS2V5cyA9IF9SZWFjdCR1c2VTdGF0ZTJbMF0sXG4gICAgICBzZXRQcmV2RXhwYW5kZWRLZXlzID0gX1JlYWN0JHVzZVN0YXRlMlsxXTtcblxuICB2YXIgX1JlYWN0JHVzZVN0YXRlMyA9IFJlYWN0LnVzZVN0YXRlKGRhdGEpLFxuICAgICAgX1JlYWN0JHVzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF9SZWFjdCR1c2VTdGF0ZTMsIDIpLFxuICAgICAgcHJldkRhdGEgPSBfUmVhY3QkdXNlU3RhdGU0WzBdLFxuICAgICAgc2V0UHJldkRhdGEgPSBfUmVhY3QkdXNlU3RhdGU0WzFdO1xuXG4gIHZhciBfUmVhY3QkdXNlU3RhdGU1ID0gUmVhY3QudXNlU3RhdGUoZGF0YSksXG4gICAgICBfUmVhY3QkdXNlU3RhdGU2ID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlNSwgMiksXG4gICAgICB0cmFuc2l0aW9uRGF0YSA9IF9SZWFjdCR1c2VTdGF0ZTZbMF0sXG4gICAgICBzZXRUcmFuc2l0aW9uRGF0YSA9IF9SZWFjdCR1c2VTdGF0ZTZbMV07XG5cbiAgdmFyIF9SZWFjdCR1c2VTdGF0ZTcgPSBSZWFjdC51c2VTdGF0ZShbXSksXG4gICAgICBfUmVhY3QkdXNlU3RhdGU4ID0gX3NsaWNlZFRvQXJyYXkoX1JlYWN0JHVzZVN0YXRlNywgMiksXG4gICAgICB0cmFuc2l0aW9uUmFuZ2UgPSBfUmVhY3QkdXNlU3RhdGU4WzBdLFxuICAgICAgc2V0VHJhbnNpdGlvblJhbmdlID0gX1JlYWN0JHVzZVN0YXRlOFsxXTtcblxuICB2YXIgX1JlYWN0JHVzZVN0YXRlOSA9IFJlYWN0LnVzZVN0YXRlKG51bGwpLFxuICAgICAgX1JlYWN0JHVzZVN0YXRlMTAgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGU5LCAyKSxcbiAgICAgIG1vdGlvblR5cGUgPSBfUmVhY3QkdXNlU3RhdGUxMFswXSxcbiAgICAgIHNldE1vdGlvblR5cGUgPSBfUmVhY3QkdXNlU3RhdGUxMFsxXTtcblxuICBmdW5jdGlvbiBvbk1vdGlvbkVuZCgpIHtcbiAgICBzZXRQcmV2RGF0YShkYXRhKTtcbiAgICBzZXRUcmFuc2l0aW9uRGF0YShkYXRhKTtcbiAgICBzZXRUcmFuc2l0aW9uUmFuZ2UoW10pO1xuICAgIHNldE1vdGlvblR5cGUobnVsbCk7XG4gICAgb25MaXN0Q2hhbmdlRW5kKCk7XG4gIH0gLy8gRG8gYW5pbWF0aW9uIGlmIGV4cGFuZGVkIGtleXMgY2hhbmdlZFxuXG5cbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBzZXRQcmV2RXhwYW5kZWRLZXlzKGV4cGFuZGVkS2V5cyk7XG4gICAgdmFyIGRpZmZFeHBhbmRlZCA9IGZpbmRFeHBhbmRlZEtleXMocHJldkV4cGFuZGVkS2V5cywgZXhwYW5kZWRLZXlzKTtcblxuICAgIGlmIChkaWZmRXhwYW5kZWQua2V5ICE9PSBudWxsKSB7XG4gICAgICBpZiAoZGlmZkV4cGFuZGVkLmFkZCkge1xuICAgICAgICB2YXIga2V5SW5kZXggPSBwcmV2RGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgICB2YXIga2V5ID0gX3JlZi5kYXRhLmtleTtcbiAgICAgICAgICByZXR1cm4ga2V5ID09PSBkaWZmRXhwYW5kZWQua2V5O1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHJhbmdlTm9kZXMgPSBnZXRNaW5pbXVtUmFuZ2VUcmFuc2l0aW9uUmFuZ2UoZ2V0RXhwYW5kUmFuZ2UocHJldkRhdGEsIGRhdGEsIGRpZmZFeHBhbmRlZC5rZXkpLCB2aXJ0dWFsLCBoZWlnaHQsIGl0ZW1IZWlnaHQpO1xuICAgICAgICB2YXIgbmV3VHJhbnNpdGlvbkRhdGEgPSBwcmV2RGF0YS5zbGljZSgpO1xuICAgICAgICBuZXdUcmFuc2l0aW9uRGF0YS5zcGxpY2Uoa2V5SW5kZXggKyAxLCAwLCBNb3Rpb25GbGF0dGVuRGF0YSk7XG4gICAgICAgIHNldFRyYW5zaXRpb25EYXRhKG5ld1RyYW5zaXRpb25EYXRhKTtcbiAgICAgICAgc2V0VHJhbnNpdGlvblJhbmdlKHJhbmdlTm9kZXMpO1xuICAgICAgICBzZXRNb3Rpb25UeXBlKCdzaG93Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgX2tleUluZGV4ID0gZGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICAgICAgdmFyIGtleSA9IF9yZWYyLmRhdGEua2V5O1xuICAgICAgICAgIHJldHVybiBrZXkgPT09IGRpZmZFeHBhbmRlZC5rZXk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBfcmFuZ2VOb2RlcyA9IGdldE1pbmltdW1SYW5nZVRyYW5zaXRpb25SYW5nZShnZXRFeHBhbmRSYW5nZShkYXRhLCBwcmV2RGF0YSwgZGlmZkV4cGFuZGVkLmtleSksIHZpcnR1YWwsIGhlaWdodCwgaXRlbUhlaWdodCk7XG5cbiAgICAgICAgdmFyIF9uZXdUcmFuc2l0aW9uRGF0YSA9IGRhdGEuc2xpY2UoKTtcblxuICAgICAgICBfbmV3VHJhbnNpdGlvbkRhdGEuc3BsaWNlKF9rZXlJbmRleCArIDEsIDAsIE1vdGlvbkZsYXR0ZW5EYXRhKTtcblxuICAgICAgICBzZXRUcmFuc2l0aW9uRGF0YShfbmV3VHJhbnNpdGlvbkRhdGEpO1xuICAgICAgICBzZXRUcmFuc2l0aW9uUmFuZ2UoX3JhbmdlTm9kZXMpO1xuICAgICAgICBzZXRNb3Rpb25UeXBlKCdoaWRlJyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChwcmV2RGF0YSAhPT0gZGF0YSkge1xuICAgICAgLy8gSWYgd2hvbGUgZGF0YSBjaGFuZ2VkLCB3ZSBqdXN0IHJlZnJlc2ggdGhlIGxpc3RcbiAgICAgIHNldFByZXZEYXRhKGRhdGEpO1xuICAgICAgc2V0VHJhbnNpdGlvbkRhdGEoZGF0YSk7XG4gICAgfVxuICB9LCBbZXhwYW5kZWRLZXlzLCBkYXRhXSk7IC8vIFdlIHNob3VsZCBjbGVhbiB1cCBtb3Rpb24gaWYgaXMgY2hhbmdlZCBieSBkcmFnZ2luZ1xuXG4gIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFkcmFnZ2luZykge1xuICAgICAgb25Nb3Rpb25FbmQoKTtcbiAgICB9XG4gIH0sIFtkcmFnZ2luZ10pO1xuICB2YXIgbWVyZ2VkRGF0YSA9IG1vdGlvbiA/IHRyYW5zaXRpb25EYXRhIDogZGF0YTtcbiAgdmFyIHRyZWVOb2RlUmVxdWlyZWRQcm9wcyA9IHtcbiAgICBleHBhbmRlZEtleXM6IGV4cGFuZGVkS2V5cyxcbiAgICBzZWxlY3RlZEtleXM6IHNlbGVjdGVkS2V5cyxcbiAgICBsb2FkZWRLZXlzOiBsb2FkZWRLZXlzLFxuICAgIGxvYWRpbmdLZXlzOiBsb2FkaW5nS2V5cyxcbiAgICBjaGVja2VkS2V5czogY2hlY2tlZEtleXMsXG4gICAgaGFsZkNoZWNrZWRLZXlzOiBoYWxmQ2hlY2tlZEtleXMsXG4gICAgZHJhZ092ZXJOb2RlS2V5OiBkcmFnT3Zlck5vZGVLZXksXG4gICAgZHJvcFBvc2l0aW9uOiBkcm9wUG9zaXRpb24sXG4gICAga2V5RW50aXRpZXM6IGtleUVudGl0aWVzXG4gIH07XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChSZWFjdC5GcmFnbWVudCwgbnVsbCwgZm9jdXNlZCAmJiBhY3RpdmVJdGVtICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7XG4gICAgc3R5bGU6IEhJRERFTl9TVFlMRSxcbiAgICBcImFyaWEtbGl2ZVwiOiBcImFzc2VydGl2ZVwiXG4gIH0sIGdldEFjY2Vzc2liaWxpdHlQYXRoKGFjdGl2ZUl0ZW0pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge1xuICAgIHJvbGU6IFwidHJlZVwiXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwge1xuICAgIHN0eWxlOiBISURERU5fU1RZTEUsXG4gICAgZGlzYWJsZWQ6IGZvY3VzYWJsZSA9PT0gZmFsc2UgfHwgZGlzYWJsZWQsXG4gICAgdGFiSW5kZXg6IGZvY3VzYWJsZSAhPT0gZmFsc2UgPyB0YWJJbmRleCA6IG51bGwsXG4gICAgb25LZXlEb3duOiBvbktleURvd24sXG4gICAgb25Gb2N1czogb25Gb2N1cyxcbiAgICBvbkJsdXI6IG9uQmx1cixcbiAgICB2YWx1ZTogXCJcIixcbiAgICBvbkNoYW5nZTogbm9vcFxuICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItdHJlZW5vZGVcIiksXG4gICAgXCJhcmlhLWhpZGRlblwiOiB0cnVlLFxuICAgIHN0eWxlOiB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJyxcbiAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nLFxuICAgICAgaGVpZ2h0OiAwLFxuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXG4gICAgfVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgY2xhc3NOYW1lOiBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWluZGVudFwiKVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgcmVmOiBpbmRlbnRNZWFzdXJlclJlZixcbiAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItaW5kZW50LXVuaXRcIilcbiAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVmlydHVhbExpc3QsIF9leHRlbmRzKHt9LCBkb21Qcm9wcywge1xuICAgIGRhdGE6IG1lcmdlZERhdGEsXG4gICAgaXRlbUtleTogaXRlbUtleSxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICBmdWxsSGVpZ2h0OiBmYWxzZSxcbiAgICB2aXJ0dWFsOiB2aXJ0dWFsLFxuICAgIGl0ZW1IZWlnaHQ6IGl0ZW1IZWlnaHQsXG4gICAgcHJlZml4Q2xzOiBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWxpc3RcIiksXG4gICAgcmVmOiBsaXN0UmVmXG4gIH0pLCBmdW5jdGlvbiAodHJlZU5vZGUpIHtcbiAgICB2YXIgcG9zID0gdHJlZU5vZGUucG9zLFxuICAgICAgICBfdHJlZU5vZGUkZGF0YSA9IHRyZWVOb2RlLmRhdGEsXG4gICAgICAgIGtleSA9IF90cmVlTm9kZSRkYXRhLmtleSxcbiAgICAgICAgcmVzdFByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF90cmVlTm9kZSRkYXRhLCBbXCJrZXlcIl0pLFxuICAgICAgICBpc1N0YXJ0ID0gdHJlZU5vZGUuaXNTdGFydCxcbiAgICAgICAgaXNFbmQgPSB0cmVlTm9kZS5pc0VuZDtcblxuICAgIHZhciBtZXJnZWRLZXkgPSBnZXRLZXkoa2V5LCBwb3MpO1xuICAgIGRlbGV0ZSByZXN0UHJvcHMuY2hpbGRyZW47XG4gICAgdmFyIHRyZWVOb2RlUHJvcHMgPSBnZXRUcmVlTm9kZVByb3BzKG1lcmdlZEtleSwgdHJlZU5vZGVSZXF1aXJlZFByb3BzKTtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoTW90aW9uVHJlZU5vZGUsIF9leHRlbmRzKHt9LCByZXN0UHJvcHMsIHRyZWVOb2RlUHJvcHMsIHtcbiAgICAgIGFjdGl2ZTogISFhY3RpdmVJdGVtICYmIGtleSA9PT0gYWN0aXZlSXRlbS5kYXRhLmtleSxcbiAgICAgIHBvczogcG9zLFxuICAgICAgZGF0YTogdHJlZU5vZGUuZGF0YSxcbiAgICAgIGlzU3RhcnQ6IGlzU3RhcnQsXG4gICAgICBpc0VuZDogaXNFbmQsXG4gICAgICBtb3Rpb246IG1vdGlvbixcbiAgICAgIG1vdGlvbk5vZGVzOiBrZXkgPT09IE1PVElPTl9LRVkgPyB0cmFuc2l0aW9uUmFuZ2UgOiBudWxsLFxuICAgICAgbW90aW9uVHlwZTogbW90aW9uVHlwZSxcbiAgICAgIG9uTW90aW9uU3RhcnQ6IG9uTGlzdENoYW5nZVN0YXJ0LFxuICAgICAgb25Nb3Rpb25FbmQ6IG9uTW90aW9uRW5kLFxuICAgICAgdHJlZU5vZGVSZXF1aXJlZFByb3BzOiB0cmVlTm9kZVJlcXVpcmVkUHJvcHMsXG4gICAgICBvbk1vdXNlTW92ZTogZnVuY3Rpb24gb25Nb3VzZU1vdmUoKSB7XG4gICAgICAgIG9uQWN0aXZlQ2hhbmdlKG51bGwpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgfSkpO1xufTtcblxudmFyIE5vZGVMaXN0ID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoUmVmTm9kZUxpc3QpO1xuTm9kZUxpc3QuZGlzcGxheU5hbWUgPSAnTm9kZUxpc3QnO1xuZXhwb3J0IGRlZmF1bHQgTm9kZUxpc3Q7IiwiaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eVwiO1xuaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDJcIjtcbmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5XCI7XG5pbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVja1wiO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3NcIjtcbmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIjtcbmltcG9ydCBfaW5oZXJpdHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzXCI7XG5pbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlclwiO1xuLy8gVE9ETzogaHR0cHM6Ly93d3cudzMub3JnL1RSLzIwMTcvTk9URS13YWktYXJpYS1wcmFjdGljZXMtMS4xLTIwMTcxMjE0L2V4YW1wbGVzL3RyZWV2aWV3L3RyZWV2aWV3LTIvdHJlZXZpZXctMmEuaHRtbFxuLy8gRnVsbHkgYWNjZXNzaWJpbGl0eSBzdXBwb3J0XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgS2V5Q29kZSBmcm9tIFwicmMtdXRpbC9lcy9LZXlDb2RlXCI7XG5pbXBvcnQgd2FybmluZyBmcm9tIFwicmMtdXRpbC9lcy93YXJuaW5nXCI7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCB7IFRyZWVDb250ZXh0IH0gZnJvbSAnLi9jb250ZXh0VHlwZXMnO1xuaW1wb3J0IHsgZ2V0RGF0YUFuZEFyaWEsIGdldERyYWdDaGlsZHJlbktleXMsIHBhcnNlQ2hlY2tlZEtleXMsIGNvbmR1Y3RFeHBhbmRQYXJlbnQsIGNhbGNTZWxlY3RlZEtleXMsIGNhbGNEcm9wUG9zaXRpb24sIGFyckFkZCwgYXJyRGVsLCBwb3NUb0FyciB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgeyBmbGF0dGVuVHJlZURhdGEsIGNvbnZlcnRUcmVlVG9EYXRhLCBjb252ZXJ0RGF0YVRvRW50aXRpZXMsIHdhcm5pbmdXaXRob3V0S2V5LCBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEsIGdldFRyZWVOb2RlUHJvcHMgfSBmcm9tICcuL3V0aWxzL3RyZWVVdGlsJztcbmltcG9ydCBOb2RlTGlzdCwgeyBNT1RJT05fS0VZLCBNb3Rpb25FbnRpdHkgfSBmcm9tICcuL05vZGVMaXN0JztcbmltcG9ydCBUcmVlTm9kZSBmcm9tICcuL1RyZWVOb2RlJztcbmltcG9ydCB7IGNvbmR1Y3RDaGVjayB9IGZyb20gJy4vdXRpbHMvY29uZHVjdFV0aWwnO1xuaW1wb3J0IERyb3BJbmRpY2F0b3IgZnJvbSAnLi9Ecm9wSW5kaWNhdG9yJztcblxudmFyIFRyZWUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKFRyZWUsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVHJlZSk7XG5cbiAgZnVuY3Rpb24gVHJlZSgpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJlZSk7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIF90aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAga2V5RW50aXRpZXM6IHt9LFxuICAgICAgaW5kZW50OiBudWxsLFxuICAgICAgc2VsZWN0ZWRLZXlzOiBbXSxcbiAgICAgIGNoZWNrZWRLZXlzOiBbXSxcbiAgICAgIGhhbGZDaGVja2VkS2V5czogW10sXG4gICAgICBsb2FkZWRLZXlzOiBbXSxcbiAgICAgIGxvYWRpbmdLZXlzOiBbXSxcbiAgICAgIGV4cGFuZGVkS2V5czogW10sXG4gICAgICBkcmFnZ2luZzogZmFsc2UsXG4gICAgICBkcmFnQ2hpbGRyZW5LZXlzOiBbXSxcbiAgICAgIC8vIGRyb3BUYXJnZXRLZXkgaXMgdGhlIGtleSBvZiBhYnN0cmFjdC1kcm9wLW5vZGVcbiAgICAgIC8vIHRoZSBhYnN0cmFjdC1kcm9wLW5vZGUgaXMgdGhlIHJlYWwgZHJvcCBub2RlIHdoZW4gZHJhZyBhbmQgZHJvcFxuICAgICAgLy8gbm90IHRoZSBET00gZHJhZyBvdmVyIG5vZGVcbiAgICAgIGRyb3BUYXJnZXRLZXk6IG51bGwsXG4gICAgICBkcm9wUG9zaXRpb246IG51bGwsXG4gICAgICBkcm9wQ29udGFpbmVyS2V5OiBudWxsLFxuICAgICAgZHJvcExldmVsT2Zmc2V0OiBudWxsLFxuICAgICAgZHJvcFRhcmdldFBvczogbnVsbCxcbiAgICAgIGRyb3BBbGxvd2VkOiB0cnVlLFxuICAgICAgLy8gdGhlIGFic3RyYWN0LWRyYWctb3Zlci1ub2RlXG4gICAgICAvLyBpZiBtb3VzZSBpcyBvbiB0aGUgYm90dG9tIG9mIHRvcCBkb20gbm9kZSBvciBubyB0aGUgdG9wIG9mIHRoZSBib3R0b20gZG9tIG5vZGVcbiAgICAgIC8vIGFic3RyYWN0LWRyYWctb3Zlci1ub2RlIGlzIHRoZSB0b3Agbm9kZVxuICAgICAgZHJhZ092ZXJOb2RlS2V5OiBudWxsLFxuICAgICAgdHJlZURhdGE6IFtdLFxuICAgICAgZmxhdHRlbk5vZGVzOiBbXSxcbiAgICAgIGZvY3VzZWQ6IGZhbHNlLFxuICAgICAgYWN0aXZlS2V5OiBudWxsLFxuICAgICAgbGlzdENoYW5naW5nOiBmYWxzZSxcbiAgICAgIHByZXZQcm9wczogbnVsbFxuICAgIH07XG4gICAgX3RoaXMuZHJhZ1N0YXJ0TW91c2VQb3NpdGlvbiA9IG51bGw7XG4gICAgX3RoaXMubGlzdFJlZiA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVSZWYoKTtcblxuICAgIF90aGlzLm9uTm9kZURyYWdTdGFydCA9IGZ1bmN0aW9uIChldmVudCwgbm9kZSkge1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsXG4gICAgICAgICAgZXhwYW5kZWRLZXlzID0gX3RoaXMkc3RhdGUuZXhwYW5kZWRLZXlzLFxuICAgICAgICAgIGtleUVudGl0aWVzID0gX3RoaXMkc3RhdGUua2V5RW50aXRpZXM7XG4gICAgICB2YXIgb25EcmFnU3RhcnQgPSBfdGhpcy5wcm9wcy5vbkRyYWdTdGFydDtcbiAgICAgIHZhciBldmVudEtleSA9IG5vZGUucHJvcHMuZXZlbnRLZXk7XG4gICAgICBfdGhpcy5kcmFnTm9kZSA9IG5vZGU7XG4gICAgICBfdGhpcy5kcmFnU3RhcnRNb3VzZVBvc2l0aW9uID0ge1xuICAgICAgICB4OiBldmVudC5jbGllbnRYLFxuICAgICAgICB5OiBldmVudC5jbGllbnRZXG4gICAgICB9O1xuICAgICAgdmFyIG5ld0V4cGFuZGVkS2V5cyA9IGFyckRlbChleHBhbmRlZEtleXMsIGV2ZW50S2V5KTtcblxuICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICBkcmFnZ2luZzogdHJ1ZSxcbiAgICAgICAgZHJhZ0NoaWxkcmVuS2V5czogZ2V0RHJhZ0NoaWxkcmVuS2V5cyhldmVudEtleSwga2V5RW50aXRpZXMpLFxuICAgICAgICBpbmRlbnQ6IF90aGlzLmxpc3RSZWYuY3VycmVudC5nZXRJbmRlbnRXaWR0aCgpXG4gICAgICB9KTtcblxuICAgICAgX3RoaXMuc2V0RXhwYW5kZWRLZXlzKG5ld0V4cGFuZGVkS2V5cyk7XG5cbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgX3RoaXMub25XaW5kb3dEcmFnRW5kKTtcblxuICAgICAgaWYgKG9uRHJhZ1N0YXJ0KSB7XG4gICAgICAgIG9uRHJhZ1N0YXJ0KHtcbiAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgbm9kZTogY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKG5vZGUucHJvcHMpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogW0xlZ2FjeV0gU2VsZWN0IGhhbmRsZXIgaXMgc21hbGxlciB0aGFuIG5vZGUsXG4gICAgICogc28gdGhhdCB0aGlzIHdpbGwgdHJpZ2dlciB3aGVuIGRyYWcgZW50ZXIgbm9kZSBvciBzZWxlY3QgaGFuZGxlci5cbiAgICAgKiBUaGlzIGlzIGEgbGl0dGxlIHRyaWNreSBpZiBjdXN0b21pemUgY3NzIHdpdGhvdXQgcGFkZGluZy5cbiAgICAgKiBCZXR0ZXIgZm9yIHVzZSBtb3VzZSBtb3ZlIGV2ZW50IHRvIHJlZnJlc2ggZHJhZyBzdGF0ZS5cbiAgICAgKiBCdXQgbGV0J3MganVzdCBrZWVwIGl0IHRvIGF2b2lkIGV2ZW50IHRyaWdnZXIgbG9naWMgY2hhbmdlLlxuICAgICAqL1xuXG5cbiAgICBfdGhpcy5vbk5vZGVEcmFnRW50ZXIgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZTIgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICBleHBhbmRlZEtleXMgPSBfdGhpcyRzdGF0ZTIuZXhwYW5kZWRLZXlzLFxuICAgICAgICAgIGtleUVudGl0aWVzID0gX3RoaXMkc3RhdGUyLmtleUVudGl0aWVzLFxuICAgICAgICAgIGRyYWdDaGlsZHJlbktleXMgPSBfdGhpcyRzdGF0ZTIuZHJhZ0NoaWxkcmVuS2V5cyxcbiAgICAgICAgICBmbGF0dGVuTm9kZXMgPSBfdGhpcyRzdGF0ZTIuZmxhdHRlbk5vZGVzLFxuICAgICAgICAgIGluZGVudCA9IF90aGlzJHN0YXRlMi5pbmRlbnQ7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBvbkRyYWdFbnRlciA9IF90aGlzJHByb3BzLm9uRHJhZ0VudGVyLFxuICAgICAgICAgIG9uRXhwYW5kID0gX3RoaXMkcHJvcHMub25FeHBhbmQsXG4gICAgICAgICAgYWxsb3dEcm9wID0gX3RoaXMkcHJvcHMuYWxsb3dEcm9wLFxuICAgICAgICAgIGRpcmVjdGlvbiA9IF90aGlzJHByb3BzLmRpcmVjdGlvbjtcbiAgICAgIHZhciBwb3MgPSBub2RlLnByb3BzLnBvcztcblxuICAgICAgdmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZSA9IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLFxuICAgICAgICAgIGRyYWdOb2RlID0gX2Fzc2VydFRoaXNJbml0aWFsaXplLmRyYWdOb2RlO1xuXG4gICAgICB2YXIgX2NhbGNEcm9wUG9zaXRpb24gPSBjYWxjRHJvcFBvc2l0aW9uKGV2ZW50LCBkcmFnTm9kZSwgbm9kZSwgaW5kZW50LCBfdGhpcy5kcmFnU3RhcnRNb3VzZVBvc2l0aW9uLCBhbGxvd0Ryb3AsIGZsYXR0ZW5Ob2Rlcywga2V5RW50aXRpZXMsIGV4cGFuZGVkS2V5cywgZGlyZWN0aW9uKSxcbiAgICAgICAgICBkcm9wUG9zaXRpb24gPSBfY2FsY0Ryb3BQb3NpdGlvbi5kcm9wUG9zaXRpb24sXG4gICAgICAgICAgZHJvcExldmVsT2Zmc2V0ID0gX2NhbGNEcm9wUG9zaXRpb24uZHJvcExldmVsT2Zmc2V0LFxuICAgICAgICAgIGRyb3BUYXJnZXRLZXkgPSBfY2FsY0Ryb3BQb3NpdGlvbi5kcm9wVGFyZ2V0S2V5LFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXkgPSBfY2FsY0Ryb3BQb3NpdGlvbi5kcm9wQ29udGFpbmVyS2V5LFxuICAgICAgICAgIGRyb3BUYXJnZXRQb3MgPSBfY2FsY0Ryb3BQb3NpdGlvbi5kcm9wVGFyZ2V0UG9zLFxuICAgICAgICAgIGRyb3BBbGxvd2VkID0gX2NhbGNEcm9wUG9zaXRpb24uZHJvcEFsbG93ZWQsXG4gICAgICAgICAgZHJhZ092ZXJOb2RlS2V5ID0gX2NhbGNEcm9wUG9zaXRpb24uZHJhZ092ZXJOb2RlS2V5O1xuXG4gICAgICBpZiAoIWRyYWdOb2RlIHx8IC8vIGRvbid0IGFsbG93IGRyb3AgaW5zaWRlIGl0cyBjaGlsZHJlblxuICAgICAgZHJhZ0NoaWxkcmVuS2V5cy5pbmRleE9mKGRyb3BUYXJnZXRLZXkpICE9PSAtMSB8fCAvLyBkb24ndCBhbGxvdyBkcm9wIHdoZW4gZHJvcCBpcyBub3QgYWxsb3dlZCBjYWN1bGF0ZWQgYnkgY2FsY0Ryb3BQb3NpdGlvblxuICAgICAgIWRyb3BBbGxvd2VkKSB7XG4gICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXk6IG51bGwsXG4gICAgICAgICAgZHJvcFBvc2l0aW9uOiBudWxsLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldDogbnVsbCxcbiAgICAgICAgICBkcm9wVGFyZ2V0S2V5OiBudWxsLFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXk6IG51bGwsXG4gICAgICAgICAgZHJvcFRhcmdldFBvczogbnVsbCxcbiAgICAgICAgICBkcm9wQWxsb3dlZDogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTaWRlIGVmZmVjdCBmb3IgZGVsYXkgZHJhZ1xuXG5cbiAgICAgIGlmICghX3RoaXMuZGVsYXllZERyYWdFbnRlckxvZ2ljKSB7XG4gICAgICAgIF90aGlzLmRlbGF5ZWREcmFnRW50ZXJMb2dpYyA9IHt9O1xuICAgICAgfVxuXG4gICAgICBPYmplY3Qua2V5cyhfdGhpcy5kZWxheWVkRHJhZ0VudGVyTG9naWMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMuZGVsYXllZERyYWdFbnRlckxvZ2ljW2tleV0pO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChkcmFnTm9kZS5wcm9wcy5ldmVudEtleSAhPT0gbm9kZS5wcm9wcy5ldmVudEtleSkge1xuICAgICAgICAvLyBob2lzdCBleHBhbmQgbG9naWMgaGVyZVxuICAgICAgICAvLyBzaW5jZSBpZiBsb2dpYyBpcyBvbiB0aGUgYm90dG9tXG4gICAgICAgIC8vIGl0IHdpbGwgYmUgYmxvY2tlZCBieSBhYnN0cmFjdCBkcmFnb3ZlciBub2RlIGNoZWNrXG4gICAgICAgIC8vICAgPT4gaWYgeW91IGRyYWdlbnRlciBmcm9tIHRvcCwgeW91IG1vdXNlIHdpbGwgc3RpbGwgYmUgY29uc2lkZXIgYXMgaW4gdGhlIHRvcCBub2RlXG4gICAgICAgIGV2ZW50LnBlcnNpc3QoKTtcbiAgICAgICAgX3RoaXMuZGVsYXllZERyYWdFbnRlckxvZ2ljW3Bvc10gPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKCFfdGhpcy5zdGF0ZS5kcmFnZ2luZykgcmV0dXJuO1xuXG4gICAgICAgICAgdmFyIG5ld0V4cGFuZGVkS2V5cyA9IF90b0NvbnN1bWFibGVBcnJheShleHBhbmRlZEtleXMpO1xuXG4gICAgICAgICAgdmFyIGVudGl0eSA9IGtleUVudGl0aWVzW25vZGUucHJvcHMuZXZlbnRLZXldO1xuXG4gICAgICAgICAgaWYgKGVudGl0eSAmJiAoZW50aXR5LmNoaWxkcmVuIHx8IFtdKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5ld0V4cGFuZGVkS2V5cyA9IGFyckFkZChleHBhbmRlZEtleXMsIG5vZGUucHJvcHMuZXZlbnRLZXkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghKCdleHBhbmRlZEtleXMnIGluIF90aGlzLnByb3BzKSkge1xuICAgICAgICAgICAgX3RoaXMuc2V0RXhwYW5kZWRLZXlzKG5ld0V4cGFuZGVkS2V5cyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG9uRXhwYW5kKSB7XG4gICAgICAgICAgICBvbkV4cGFuZChuZXdFeHBhbmRlZEtleXMsIHtcbiAgICAgICAgICAgICAgbm9kZTogY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKG5vZGUucHJvcHMpLFxuICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmF0aXZlRXZlbnQ6IGV2ZW50Lm5hdGl2ZUV2ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDgwMCk7XG4gICAgICB9IC8vIFNraXAgaWYgZHJhZyBub2RlIGlzIHNlbGZcblxuXG4gICAgICBpZiAoZHJhZ05vZGUucHJvcHMuZXZlbnRLZXkgPT09IGRyb3BUYXJnZXRLZXkgJiYgZHJvcExldmVsT2Zmc2V0ID09PSAwKSB7XG4gICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXk6IG51bGwsXG4gICAgICAgICAgZHJvcFBvc2l0aW9uOiBudWxsLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldDogbnVsbCxcbiAgICAgICAgICBkcm9wVGFyZ2V0S2V5OiBudWxsLFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXk6IG51bGwsXG4gICAgICAgICAgZHJvcFRhcmdldFBvczogbnVsbCxcbiAgICAgICAgICBkcm9wQWxsb3dlZDogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgZHJhZyBvdmVyIG5vZGUgYW5kIGRyYWcgc3RhdGVcblxuXG4gICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGRyYWdPdmVyTm9kZUtleTogZHJhZ092ZXJOb2RlS2V5LFxuICAgICAgICBkcm9wUG9zaXRpb246IGRyb3BQb3NpdGlvbixcbiAgICAgICAgZHJvcExldmVsT2Zmc2V0OiBkcm9wTGV2ZWxPZmZzZXQsXG4gICAgICAgIGRyb3BUYXJnZXRLZXk6IGRyb3BUYXJnZXRLZXksXG4gICAgICAgIGRyb3BDb250YWluZXJLZXk6IGRyb3BDb250YWluZXJLZXksXG4gICAgICAgIGRyb3BUYXJnZXRQb3M6IGRyb3BUYXJnZXRQb3MsXG4gICAgICAgIGRyb3BBbGxvd2VkOiBkcm9wQWxsb3dlZFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChvbkRyYWdFbnRlcikge1xuICAgICAgICBvbkRyYWdFbnRlcih7XG4gICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgIG5vZGU6IGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YShub2RlLnByb3BzKSxcbiAgICAgICAgICBleHBhbmRlZEtleXM6IGV4cGFuZGVkS2V5c1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25Ob2RlRHJhZ092ZXIgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZTMgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICBkcmFnQ2hpbGRyZW5LZXlzID0gX3RoaXMkc3RhdGUzLmRyYWdDaGlsZHJlbktleXMsXG4gICAgICAgICAgZmxhdHRlbk5vZGVzID0gX3RoaXMkc3RhdGUzLmZsYXR0ZW5Ob2RlcyxcbiAgICAgICAgICBrZXlFbnRpdGllcyA9IF90aGlzJHN0YXRlMy5rZXlFbnRpdGllcyxcbiAgICAgICAgICBleHBhbmRlZEtleXMgPSBfdGhpcyRzdGF0ZTMuZXhwYW5kZWRLZXlzLFxuICAgICAgICAgIGluZGVudCA9IF90aGlzJHN0YXRlMy5pbmRlbnQ7XG4gICAgICB2YXIgX3RoaXMkcHJvcHMyID0gX3RoaXMucHJvcHMsXG4gICAgICAgICAgb25EcmFnT3ZlciA9IF90aGlzJHByb3BzMi5vbkRyYWdPdmVyLFxuICAgICAgICAgIGFsbG93RHJvcCA9IF90aGlzJHByb3BzMi5hbGxvd0Ryb3AsXG4gICAgICAgICAgZGlyZWN0aW9uID0gX3RoaXMkcHJvcHMyLmRpcmVjdGlvbjtcblxuICAgICAgdmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZTIgPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSxcbiAgICAgICAgICBkcmFnTm9kZSA9IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZTIuZHJhZ05vZGU7XG5cbiAgICAgIHZhciBfY2FsY0Ryb3BQb3NpdGlvbjIgPSBjYWxjRHJvcFBvc2l0aW9uKGV2ZW50LCBkcmFnTm9kZSwgbm9kZSwgaW5kZW50LCBfdGhpcy5kcmFnU3RhcnRNb3VzZVBvc2l0aW9uLCBhbGxvd0Ryb3AsIGZsYXR0ZW5Ob2Rlcywga2V5RW50aXRpZXMsIGV4cGFuZGVkS2V5cywgZGlyZWN0aW9uKSxcbiAgICAgICAgICBkcm9wUG9zaXRpb24gPSBfY2FsY0Ryb3BQb3NpdGlvbjIuZHJvcFBvc2l0aW9uLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldCA9IF9jYWxjRHJvcFBvc2l0aW9uMi5kcm9wTGV2ZWxPZmZzZXQsXG4gICAgICAgICAgZHJvcFRhcmdldEtleSA9IF9jYWxjRHJvcFBvc2l0aW9uMi5kcm9wVGFyZ2V0S2V5LFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXkgPSBfY2FsY0Ryb3BQb3NpdGlvbjIuZHJvcENvbnRhaW5lcktleSxcbiAgICAgICAgICBkcm9wQWxsb3dlZCA9IF9jYWxjRHJvcFBvc2l0aW9uMi5kcm9wQWxsb3dlZCxcbiAgICAgICAgICBkcm9wVGFyZ2V0UG9zID0gX2NhbGNEcm9wUG9zaXRpb24yLmRyb3BUYXJnZXRQb3MsXG4gICAgICAgICAgZHJhZ092ZXJOb2RlS2V5ID0gX2NhbGNEcm9wUG9zaXRpb24yLmRyYWdPdmVyTm9kZUtleTtcblxuICAgICAgaWYgKCFkcmFnTm9kZSB8fCBkcmFnQ2hpbGRyZW5LZXlzLmluZGV4T2YoZHJvcFRhcmdldEtleSkgIT09IC0xIHx8ICFkcm9wQWxsb3dlZCkge1xuICAgICAgICAvLyBkb24ndCBhbGxvdyBkcm9wIGluc2lkZSBpdHMgY2hpbGRyZW5cbiAgICAgICAgLy8gZG9uJ3QgYWxsb3cgZHJvcCB3aGVuIGRyb3AgaXMgbm90IGFsbG93ZWQgY2FjdWxhdGVkIGJ5IGNhbGNEcm9wUG9zaXRpb25cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgZHJhZyBwb3NpdGlvblxuXG5cbiAgICAgIGlmIChkcmFnTm9kZS5wcm9wcy5ldmVudEtleSA9PT0gZHJvcFRhcmdldEtleSAmJiBkcm9wTGV2ZWxPZmZzZXQgPT09IDApIHtcbiAgICAgICAgaWYgKCEoX3RoaXMuc3RhdGUuZHJvcFBvc2l0aW9uID09PSBudWxsICYmIF90aGlzLnN0YXRlLmRyb3BMZXZlbE9mZnNldCA9PT0gbnVsbCAmJiBfdGhpcy5zdGF0ZS5kcm9wVGFyZ2V0S2V5ID09PSBudWxsICYmIF90aGlzLnN0YXRlLmRyb3BDb250YWluZXJLZXkgPT09IG51bGwgJiYgX3RoaXMuc3RhdGUuZHJvcFRhcmdldFBvcyA9PT0gbnVsbCAmJiBfdGhpcy5zdGF0ZS5kcm9wQWxsb3dlZCA9PT0gZmFsc2UgJiYgX3RoaXMuc3RhdGUuZHJhZ092ZXJOb2RlS2V5ID09PSBudWxsKSkge1xuICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGRyb3BQb3NpdGlvbjogbnVsbCxcbiAgICAgICAgICAgIGRyb3BMZXZlbE9mZnNldDogbnVsbCxcbiAgICAgICAgICAgIGRyb3BUYXJnZXRLZXk6IG51bGwsXG4gICAgICAgICAgICBkcm9wQ29udGFpbmVyS2V5OiBudWxsLFxuICAgICAgICAgICAgZHJvcFRhcmdldFBvczogbnVsbCxcbiAgICAgICAgICAgIGRyb3BBbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGRyYWdPdmVyTm9kZUtleTogbnVsbFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCEoZHJvcFBvc2l0aW9uID09PSBfdGhpcy5zdGF0ZS5kcm9wUG9zaXRpb24gJiYgZHJvcExldmVsT2Zmc2V0ID09PSBfdGhpcy5zdGF0ZS5kcm9wTGV2ZWxPZmZzZXQgJiYgZHJvcFRhcmdldEtleSA9PT0gX3RoaXMuc3RhdGUuZHJvcFRhcmdldEtleSAmJiBkcm9wQ29udGFpbmVyS2V5ID09PSBfdGhpcy5zdGF0ZS5kcm9wQ29udGFpbmVyS2V5ICYmIGRyb3BUYXJnZXRQb3MgPT09IF90aGlzLnN0YXRlLmRyb3BUYXJnZXRQb3MgJiYgZHJvcEFsbG93ZWQgPT09IF90aGlzLnN0YXRlLmRyb3BBbGxvd2VkICYmIGRyYWdPdmVyTm9kZUtleSA9PT0gX3RoaXMuc3RhdGUuZHJhZ092ZXJOb2RlS2V5KSkge1xuICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgZHJvcFBvc2l0aW9uOiBkcm9wUG9zaXRpb24sXG4gICAgICAgICAgZHJvcExldmVsT2Zmc2V0OiBkcm9wTGV2ZWxPZmZzZXQsXG4gICAgICAgICAgZHJvcFRhcmdldEtleTogZHJvcFRhcmdldEtleSxcbiAgICAgICAgICBkcm9wQ29udGFpbmVyS2V5OiBkcm9wQ29udGFpbmVyS2V5LFxuICAgICAgICAgIGRyb3BUYXJnZXRQb3M6IGRyb3BUYXJnZXRQb3MsXG4gICAgICAgICAgZHJvcEFsbG93ZWQ6IGRyb3BBbGxvd2VkLFxuICAgICAgICAgIGRyYWdPdmVyTm9kZUtleTogZHJhZ092ZXJOb2RlS2V5XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAob25EcmFnT3Zlcikge1xuICAgICAgICBvbkRyYWdPdmVyKHtcbiAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgbm9kZTogY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKG5vZGUucHJvcHMpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5vbk5vZGVEcmFnTGVhdmUgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBvbkRyYWdMZWF2ZSA9IF90aGlzLnByb3BzLm9uRHJhZ0xlYXZlO1xuXG4gICAgICBpZiAob25EcmFnTGVhdmUpIHtcbiAgICAgICAgb25EcmFnTGVhdmUoe1xuICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICBub2RlOiBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEobm9kZS5wcm9wcylcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTsgLy8gc2luY2Ugc3RvcFByb3BhZ2F0aW9uKCkgaXMgY2FsbGVkIGluIHRyZWVOb2RlXG4gICAgLy8gaWYgb25XaW5kb3dEcmFnIGlzIGNhbGxlZCwgd2hpY2UgbWVhbnMgc3RhdGUgaXMga2VlcGVkLCBkcmFnIHN0YXRlIHNob3VsZCBiZSBjbGVhcmVkXG5cblxuICAgIF90aGlzLm9uV2luZG93RHJhZ0VuZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgX3RoaXMub25Ob2RlRHJhZ0VuZChldmVudCwgbnVsbCwgdHJ1ZSk7XG5cbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgX3RoaXMub25XaW5kb3dEcmFnRW5kKTtcbiAgICB9OyAvLyBpZiBvbk5vZGVEcmFnRW5kIGlzIGNhbGxlZCwgb25XaW5kb3dEcmFnRW5kIHdvbid0IGJlIGNhbGxlZCBzaW5jZSBzdG9wUHJvcGFnYXRpb24oKSBpcyBjYWxsZWRcblxuXG4gICAgX3RoaXMub25Ob2RlRHJhZ0VuZCA9IGZ1bmN0aW9uIChldmVudCwgbm9kZSkge1xuICAgICAgdmFyIG91dHNpZGVUcmVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTtcbiAgICAgIHZhciBvbkRyYWdFbmQgPSBfdGhpcy5wcm9wcy5vbkRyYWdFbmQ7XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZHJhZ092ZXJOb2RlS2V5OiBudWxsXG4gICAgICB9KTtcblxuICAgICAgX3RoaXMuY2xlYW5EcmFnU3RhdGUoKTtcblxuICAgICAgaWYgKG9uRHJhZ0VuZCAmJiAhb3V0c2lkZVRyZWUpIHtcbiAgICAgICAgb25EcmFnRW5kKHtcbiAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgbm9kZTogY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKG5vZGUucHJvcHMpXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5kcmFnTm9kZSA9IG51bGw7XG4gICAgfTtcblxuICAgIF90aGlzLm9uTm9kZURyb3AgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBfdGhpcyRnZXRBY3RpdmVJdGVtO1xuXG4gICAgICB2YXIgb3V0c2lkZVRyZWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlO1xuICAgICAgdmFyIF90aGlzJHN0YXRlNCA9IF90aGlzLnN0YXRlLFxuICAgICAgICAgIGRyYWdDaGlsZHJlbktleXMgPSBfdGhpcyRzdGF0ZTQuZHJhZ0NoaWxkcmVuS2V5cyxcbiAgICAgICAgICBkcm9wUG9zaXRpb24gPSBfdGhpcyRzdGF0ZTQuZHJvcFBvc2l0aW9uLFxuICAgICAgICAgIGRyb3BUYXJnZXRLZXkgPSBfdGhpcyRzdGF0ZTQuZHJvcFRhcmdldEtleSxcbiAgICAgICAgICBkcm9wVGFyZ2V0UG9zID0gX3RoaXMkc3RhdGU0LmRyb3BUYXJnZXRQb3MsXG4gICAgICAgICAgZHJvcEFsbG93ZWQgPSBfdGhpcyRzdGF0ZTQuZHJvcEFsbG93ZWQ7XG4gICAgICBpZiAoIWRyb3BBbGxvd2VkKSByZXR1cm47XG4gICAgICB2YXIgb25Ecm9wID0gX3RoaXMucHJvcHMub25Ecm9wO1xuXG4gICAgICBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGRyYWdPdmVyTm9kZUtleTogbnVsbFxuICAgICAgfSk7XG5cbiAgICAgIF90aGlzLmNsZWFuRHJhZ1N0YXRlKCk7XG5cbiAgICAgIGlmIChkcm9wVGFyZ2V0S2V5ID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgIHZhciBhYnN0cmFjdERyb3BOb2RlUHJvcHMgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGdldFRyZWVOb2RlUHJvcHMoZHJvcFRhcmdldEtleSwgX3RoaXMuZ2V0VHJlZU5vZGVSZXF1aXJlZFByb3BzKCkpKSwge30sIHtcbiAgICAgICAgYWN0aXZlOiAoKF90aGlzJGdldEFjdGl2ZUl0ZW0gPSBfdGhpcy5nZXRBY3RpdmVJdGVtKCkpID09PSBudWxsIHx8IF90aGlzJGdldEFjdGl2ZUl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGdldEFjdGl2ZUl0ZW0uZGF0YS5rZXkpID09PSBkcm9wVGFyZ2V0S2V5LFxuICAgICAgICBkYXRhOiBfdGhpcy5zdGF0ZS5rZXlFbnRpdGllc1tkcm9wVGFyZ2V0S2V5XS5ub2RlXG4gICAgICB9KTtcblxuICAgICAgdmFyIGRyb3BUb0NoaWxkID0gZHJhZ0NoaWxkcmVuS2V5cy5pbmRleE9mKGRyb3BUYXJnZXRLZXkpICE9PSAtMTtcbiAgICAgIHdhcm5pbmcoIWRyb3BUb0NoaWxkLCBcIkNhbiBub3QgZHJvcCB0byBkcmFnTm9kZSdzIGNoaWxkcmVuIG5vZGUuIFRoaXMgaXMgYSBidWcgb2YgcmMtdHJlZS4gUGxlYXNlIHJlcG9ydCBhbiBpc3N1ZS5cIik7XG4gICAgICB2YXIgcG9zQXJyID0gcG9zVG9BcnIoZHJvcFRhcmdldFBvcyk7XG4gICAgICB2YXIgZHJvcFJlc3VsdCA9IHtcbiAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICBub2RlOiBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEoYWJzdHJhY3REcm9wTm9kZVByb3BzKSxcbiAgICAgICAgZHJhZ05vZGU6IF90aGlzLmRyYWdOb2RlID8gY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKF90aGlzLmRyYWdOb2RlLnByb3BzKSA6IG51bGwsXG4gICAgICAgIGRyYWdOb2Rlc0tleXM6IFtfdGhpcy5kcmFnTm9kZS5wcm9wcy5ldmVudEtleV0uY29uY2F0KGRyYWdDaGlsZHJlbktleXMpLFxuICAgICAgICBkcm9wVG9HYXA6IGRyb3BQb3NpdGlvbiAhPT0gMCxcbiAgICAgICAgZHJvcFBvc2l0aW9uOiBkcm9wUG9zaXRpb24gKyBOdW1iZXIocG9zQXJyW3Bvc0Fyci5sZW5ndGggLSAxXSlcbiAgICAgIH07XG5cbiAgICAgIGlmIChvbkRyb3AgJiYgIW91dHNpZGVUcmVlKSB7XG4gICAgICAgIG9uRHJvcChkcm9wUmVzdWx0KTtcbiAgICAgIH1cblxuICAgICAgX3RoaXMuZHJhZ05vZGUgPSBudWxsO1xuICAgIH07XG5cbiAgICBfdGhpcy5jbGVhbkRyYWdTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkcmFnZ2luZyA9IF90aGlzLnN0YXRlLmRyYWdnaW5nO1xuXG4gICAgICBpZiAoZHJhZ2dpbmcpIHtcbiAgICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGRyYWdnaW5nOiBmYWxzZSxcbiAgICAgICAgICBkcm9wUG9zaXRpb246IG51bGwsXG4gICAgICAgICAgZHJvcENvbnRhaW5lcktleTogbnVsbCxcbiAgICAgICAgICBkcm9wVGFyZ2V0S2V5OiBudWxsLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldDogbnVsbCxcbiAgICAgICAgICBkcm9wQWxsb3dlZDogdHJ1ZSxcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXk6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzLmRyYWdTdGFydE1vdXNlUG9zaXRpb24gPSBudWxsO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbk5vZGVDbGljayA9IGZ1bmN0aW9uIChlLCB0cmVlTm9kZSkge1xuICAgICAgdmFyIG9uQ2xpY2sgPSBfdGhpcy5wcm9wcy5vbkNsaWNrO1xuXG4gICAgICBpZiAob25DbGljaykge1xuICAgICAgICBvbkNsaWNrKGUsIHRyZWVOb2RlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25Ob2RlRG91YmxlQ2xpY2sgPSBmdW5jdGlvbiAoZSwgdHJlZU5vZGUpIHtcbiAgICAgIHZhciBvbkRvdWJsZUNsaWNrID0gX3RoaXMucHJvcHMub25Eb3VibGVDbGljaztcblxuICAgICAgaWYgKG9uRG91YmxlQ2xpY2spIHtcbiAgICAgICAgb25Eb3VibGVDbGljayhlLCB0cmVlTm9kZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLm9uTm9kZVNlbGVjdCA9IGZ1bmN0aW9uIChlLCB0cmVlTm9kZSkge1xuICAgICAgdmFyIHNlbGVjdGVkS2V5cyA9IF90aGlzLnN0YXRlLnNlbGVjdGVkS2V5cztcbiAgICAgIHZhciBrZXlFbnRpdGllcyA9IF90aGlzLnN0YXRlLmtleUVudGl0aWVzO1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIG9uU2VsZWN0ID0gX3RoaXMkcHJvcHMzLm9uU2VsZWN0LFxuICAgICAgICAgIG11bHRpcGxlID0gX3RoaXMkcHJvcHMzLm11bHRpcGxlO1xuICAgICAgdmFyIHNlbGVjdGVkID0gdHJlZU5vZGUuc2VsZWN0ZWQsXG4gICAgICAgICAga2V5ID0gdHJlZU5vZGUua2V5O1xuICAgICAgdmFyIHRhcmdldFNlbGVjdGVkID0gIXNlbGVjdGVkOyAvLyBVcGRhdGUgc2VsZWN0ZWQga2V5c1xuXG4gICAgICBpZiAoIXRhcmdldFNlbGVjdGVkKSB7XG4gICAgICAgIHNlbGVjdGVkS2V5cyA9IGFyckRlbChzZWxlY3RlZEtleXMsIGtleSk7XG4gICAgICB9IGVsc2UgaWYgKCFtdWx0aXBsZSkge1xuICAgICAgICBzZWxlY3RlZEtleXMgPSBba2V5XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGVjdGVkS2V5cyA9IGFyckFkZChzZWxlY3RlZEtleXMsIGtleSk7XG4gICAgICB9IC8vIFtMZWdhY3ldIE5vdCBmb3VuZCByZWxhdGVkIHVzYWdlIGluIGRvYyBvciB1cHBlciBsaWJzXG5cblxuICAgICAgdmFyIHNlbGVjdGVkTm9kZXMgPSBzZWxlY3RlZEtleXMubWFwKGZ1bmN0aW9uIChzZWxlY3RlZEtleSkge1xuICAgICAgICB2YXIgZW50aXR5ID0ga2V5RW50aXRpZXNbc2VsZWN0ZWRLZXldO1xuICAgICAgICBpZiAoIWVudGl0eSkgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBlbnRpdHkubm9kZTtcbiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgIH0pO1xuXG4gICAgICBfdGhpcy5zZXRVbmNvbnRyb2xsZWRTdGF0ZSh7XG4gICAgICAgIHNlbGVjdGVkS2V5czogc2VsZWN0ZWRLZXlzXG4gICAgICB9KTtcblxuICAgICAgaWYgKG9uU2VsZWN0KSB7XG4gICAgICAgIG9uU2VsZWN0KHNlbGVjdGVkS2V5cywge1xuICAgICAgICAgIGV2ZW50OiAnc2VsZWN0JyxcbiAgICAgICAgICBzZWxlY3RlZDogdGFyZ2V0U2VsZWN0ZWQsXG4gICAgICAgICAgbm9kZTogdHJlZU5vZGUsXG4gICAgICAgICAgc2VsZWN0ZWROb2Rlczogc2VsZWN0ZWROb2RlcyxcbiAgICAgICAgICBuYXRpdmVFdmVudDogZS5uYXRpdmVFdmVudFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25Ob2RlQ2hlY2sgPSBmdW5jdGlvbiAoZSwgdHJlZU5vZGUsIGNoZWNrZWQpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZTUgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICBrZXlFbnRpdGllcyA9IF90aGlzJHN0YXRlNS5rZXlFbnRpdGllcyxcbiAgICAgICAgICBvcmlDaGVja2VkS2V5cyA9IF90aGlzJHN0YXRlNS5jaGVja2VkS2V5cyxcbiAgICAgICAgICBvcmlIYWxmQ2hlY2tlZEtleXMgPSBfdGhpcyRzdGF0ZTUuaGFsZkNoZWNrZWRLZXlzO1xuICAgICAgdmFyIF90aGlzJHByb3BzNCA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIGNoZWNrU3RyaWN0bHkgPSBfdGhpcyRwcm9wczQuY2hlY2tTdHJpY3RseSxcbiAgICAgICAgICBvbkNoZWNrID0gX3RoaXMkcHJvcHM0Lm9uQ2hlY2s7XG4gICAgICB2YXIga2V5ID0gdHJlZU5vZGUua2V5OyAvLyBQcmVwYXJlIHRyaWdnZXIgYXJndW1lbnRzXG5cbiAgICAgIHZhciBjaGVja2VkT2JqO1xuICAgICAgdmFyIGV2ZW50T2JqID0ge1xuICAgICAgICBldmVudDogJ2NoZWNrJyxcbiAgICAgICAgbm9kZTogdHJlZU5vZGUsXG4gICAgICAgIGNoZWNrZWQ6IGNoZWNrZWQsXG4gICAgICAgIG5hdGl2ZUV2ZW50OiBlLm5hdGl2ZUV2ZW50XG4gICAgICB9O1xuXG4gICAgICBpZiAoY2hlY2tTdHJpY3RseSkge1xuICAgICAgICB2YXIgY2hlY2tlZEtleXMgPSBjaGVja2VkID8gYXJyQWRkKG9yaUNoZWNrZWRLZXlzLCBrZXkpIDogYXJyRGVsKG9yaUNoZWNrZWRLZXlzLCBrZXkpO1xuICAgICAgICB2YXIgaGFsZkNoZWNrZWRLZXlzID0gYXJyRGVsKG9yaUhhbGZDaGVja2VkS2V5cywga2V5KTtcbiAgICAgICAgY2hlY2tlZE9iaiA9IHtcbiAgICAgICAgICBjaGVja2VkOiBjaGVja2VkS2V5cyxcbiAgICAgICAgICBoYWxmQ2hlY2tlZDogaGFsZkNoZWNrZWRLZXlzXG4gICAgICAgIH07XG4gICAgICAgIGV2ZW50T2JqLmNoZWNrZWROb2RlcyA9IGNoZWNrZWRLZXlzLm1hcChmdW5jdGlvbiAoY2hlY2tlZEtleSkge1xuICAgICAgICAgIHJldHVybiBrZXlFbnRpdGllc1tjaGVja2VkS2V5XTtcbiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlbnRpdHkpIHtcbiAgICAgICAgICByZXR1cm4gZW50aXR5O1xuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgICAgIHJldHVybiBlbnRpdHkubm9kZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgX3RoaXMuc2V0VW5jb250cm9sbGVkU3RhdGUoe1xuICAgICAgICAgIGNoZWNrZWRLZXlzOiBjaGVja2VkS2V5c1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEFsd2F5cyBmaWxsIGZpcnN0XG4gICAgICAgIHZhciBfY29uZHVjdENoZWNrID0gY29uZHVjdENoZWNrKFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkob3JpQ2hlY2tlZEtleXMpLCBba2V5XSksIHRydWUsIGtleUVudGl0aWVzKSxcbiAgICAgICAgICAgIF9jaGVja2VkS2V5cyA9IF9jb25kdWN0Q2hlY2suY2hlY2tlZEtleXMsXG4gICAgICAgICAgICBfaGFsZkNoZWNrZWRLZXlzID0gX2NvbmR1Y3RDaGVjay5oYWxmQ2hlY2tlZEtleXM7IC8vIElmIHJlbW92ZSwgd2UgZG8gaXQgYWdhaW4gdG8gY29ycmVjdGlvblxuXG5cbiAgICAgICAgaWYgKCFjaGVja2VkKSB7XG4gICAgICAgICAgdmFyIGtleVNldCA9IG5ldyBTZXQoX2NoZWNrZWRLZXlzKTtcbiAgICAgICAgICBrZXlTZXQuZGVsZXRlKGtleSk7XG5cbiAgICAgICAgICB2YXIgX2NvbmR1Y3RDaGVjazIgPSBjb25kdWN0Q2hlY2soQXJyYXkuZnJvbShrZXlTZXQpLCB7XG4gICAgICAgICAgICBjaGVja2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGhhbGZDaGVja2VkS2V5czogX2hhbGZDaGVja2VkS2V5c1xuICAgICAgICAgIH0sIGtleUVudGl0aWVzKTtcblxuICAgICAgICAgIF9jaGVja2VkS2V5cyA9IF9jb25kdWN0Q2hlY2syLmNoZWNrZWRLZXlzO1xuICAgICAgICAgIF9oYWxmQ2hlY2tlZEtleXMgPSBfY29uZHVjdENoZWNrMi5oYWxmQ2hlY2tlZEtleXM7XG4gICAgICAgIH1cblxuICAgICAgICBjaGVja2VkT2JqID0gX2NoZWNrZWRLZXlzOyAvLyBbTGVnYWN5XSBUaGlzIGlzIHVzZWQgZm9yIGByYy10cmVlLXNlbGVjdGBcblxuICAgICAgICBldmVudE9iai5jaGVja2VkTm9kZXMgPSBbXTtcbiAgICAgICAgZXZlbnRPYmouY2hlY2tlZE5vZGVzUG9zaXRpb25zID0gW107XG4gICAgICAgIGV2ZW50T2JqLmhhbGZDaGVja2VkS2V5cyA9IF9oYWxmQ2hlY2tlZEtleXM7XG5cbiAgICAgICAgX2NoZWNrZWRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGNoZWNrZWRLZXkpIHtcbiAgICAgICAgICB2YXIgZW50aXR5ID0ga2V5RW50aXRpZXNbY2hlY2tlZEtleV07XG4gICAgICAgICAgaWYgKCFlbnRpdHkpIHJldHVybjtcbiAgICAgICAgICB2YXIgbm9kZSA9IGVudGl0eS5ub2RlLFxuICAgICAgICAgICAgICBwb3MgPSBlbnRpdHkucG9zO1xuICAgICAgICAgIGV2ZW50T2JqLmNoZWNrZWROb2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgIGV2ZW50T2JqLmNoZWNrZWROb2Rlc1Bvc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIG5vZGU6IG5vZGUsXG4gICAgICAgICAgICBwb3M6IHBvc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBfdGhpcy5zZXRVbmNvbnRyb2xsZWRTdGF0ZSh7XG4gICAgICAgICAgY2hlY2tlZEtleXM6IF9jaGVja2VkS2V5c1xuICAgICAgICB9LCBmYWxzZSwge1xuICAgICAgICAgIGhhbGZDaGVja2VkS2V5czogX2hhbGZDaGVja2VkS2V5c1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9uQ2hlY2spIHtcbiAgICAgICAgb25DaGVjayhjaGVja2VkT2JqLCBldmVudE9iaik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLm9uTm9kZUxvYWQgPSBmdW5jdGlvbiAodHJlZU5vZGUpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAvLyBXZSBuZWVkIHRvIGdldCB0aGUgbGF0ZXN0IHN0YXRlIG9mIGxvYWRpbmcvbG9hZGVkIGtleXNcbiAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgICB2YXIgX3JlZiRsb2FkZWRLZXlzID0gX3JlZi5sb2FkZWRLZXlzLFxuICAgICAgICAgICAgICBsb2FkZWRLZXlzID0gX3JlZiRsb2FkZWRLZXlzID09PSB2b2lkIDAgPyBbXSA6IF9yZWYkbG9hZGVkS2V5cyxcbiAgICAgICAgICAgICAgX3JlZiRsb2FkaW5nS2V5cyA9IF9yZWYubG9hZGluZ0tleXMsXG4gICAgICAgICAgICAgIGxvYWRpbmdLZXlzID0gX3JlZiRsb2FkaW5nS2V5cyA9PT0gdm9pZCAwID8gW10gOiBfcmVmJGxvYWRpbmdLZXlzO1xuICAgICAgICAgIHZhciBfdGhpcyRwcm9wczUgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICAgICAgbG9hZERhdGEgPSBfdGhpcyRwcm9wczUubG9hZERhdGEsXG4gICAgICAgICAgICAgIG9uTG9hZCA9IF90aGlzJHByb3BzNS5vbkxvYWQ7XG4gICAgICAgICAgdmFyIGtleSA9IHRyZWVOb2RlLmtleTtcblxuICAgICAgICAgIGlmICghbG9hZERhdGEgfHwgbG9hZGVkS2V5cy5pbmRleE9mKGtleSkgIT09IC0xIHx8IGxvYWRpbmdLZXlzLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICAgICAgICAgIC8vIHJlYWN0IDE1IHdpbGwgd2FybiBpZiByZXR1cm4gbnVsbFxuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgIH0gLy8gUHJvY2VzcyBsb2FkIGRhdGFcblxuXG4gICAgICAgICAgdmFyIHByb21pc2UgPSBsb2FkRGF0YSh0cmVlTm9kZSk7XG4gICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyRzdGF0ZTYgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgICAgICBjdXJyZW50TG9hZGVkS2V5cyA9IF90aGlzJHN0YXRlNi5sb2FkZWRLZXlzLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRMb2FkaW5nS2V5cyA9IF90aGlzJHN0YXRlNi5sb2FkaW5nS2V5cztcbiAgICAgICAgICAgIHZhciBuZXdMb2FkZWRLZXlzID0gYXJyQWRkKGN1cnJlbnRMb2FkZWRLZXlzLCBrZXkpO1xuICAgICAgICAgICAgdmFyIG5ld0xvYWRpbmdLZXlzID0gYXJyRGVsKGN1cnJlbnRMb2FkaW5nS2V5cywga2V5KTsgLy8gb25Mb2FkIHNob3VsZCB0cmlnZ2VyIGJlZm9yZSBpbnRlcm5hbCBzZXRTdGF0ZSB0byBhdm9pZCBgbG9hZERhdGFgIHRyaWdnZXIgdHdpY2UuXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy8xMjQ2NFxuXG4gICAgICAgICAgICBpZiAob25Mb2FkKSB7XG4gICAgICAgICAgICAgIG9uTG9hZChuZXdMb2FkZWRLZXlzLCB7XG4gICAgICAgICAgICAgICAgZXZlbnQ6ICdsb2FkJyxcbiAgICAgICAgICAgICAgICBub2RlOiB0cmVlTm9kZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX3RoaXMuc2V0VW5jb250cm9sbGVkU3RhdGUoe1xuICAgICAgICAgICAgICBsb2FkZWRLZXlzOiBuZXdMb2FkZWRLZXlzXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICBsb2FkaW5nS2V5czogbmV3TG9hZGluZ0tleXNcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvYWRpbmdLZXlzOiBhcnJBZGQobG9hZGluZ0tleXMsIGtleSlcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbk5vZGVNb3VzZUVudGVyID0gZnVuY3Rpb24gKGV2ZW50LCBub2RlKSB7XG4gICAgICB2YXIgb25Nb3VzZUVudGVyID0gX3RoaXMucHJvcHMub25Nb3VzZUVudGVyO1xuXG4gICAgICBpZiAob25Nb3VzZUVudGVyKSB7XG4gICAgICAgIG9uTW91c2VFbnRlcih7XG4gICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgIG5vZGU6IG5vZGVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLm9uTm9kZU1vdXNlTGVhdmUgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBvbk1vdXNlTGVhdmUgPSBfdGhpcy5wcm9wcy5vbk1vdXNlTGVhdmU7XG5cbiAgICAgIGlmIChvbk1vdXNlTGVhdmUpIHtcbiAgICAgICAgb25Nb3VzZUxlYXZlKHtcbiAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgbm9kZTogbm9kZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25Ob2RlQ29udGV4dE1lbnUgPSBmdW5jdGlvbiAoZXZlbnQsIG5vZGUpIHtcbiAgICAgIHZhciBvblJpZ2h0Q2xpY2sgPSBfdGhpcy5wcm9wcy5vblJpZ2h0Q2xpY2s7XG5cbiAgICAgIGlmIChvblJpZ2h0Q2xpY2spIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgb25SaWdodENsaWNrKHtcbiAgICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgICAgbm9kZTogbm9kZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25Gb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBvbkZvY3VzID0gX3RoaXMucHJvcHMub25Gb2N1cztcblxuICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICBmb2N1c2VkOiB0cnVlXG4gICAgICB9KTtcblxuICAgICAgaWYgKG9uRm9jdXMpIHtcbiAgICAgICAgb25Gb2N1cy5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLm9uQmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBvbkJsdXIgPSBfdGhpcy5wcm9wcy5vbkJsdXI7XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZm9jdXNlZDogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICBfdGhpcy5vbkFjdGl2ZUNoYW5nZShudWxsKTtcblxuICAgICAgaWYgKG9uQmx1cikge1xuICAgICAgICBvbkJsdXIuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5nZXRUcmVlTm9kZVJlcXVpcmVkUHJvcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3RoaXMkc3RhdGU3ID0gX3RoaXMuc3RhdGUsXG4gICAgICAgICAgZXhwYW5kZWRLZXlzID0gX3RoaXMkc3RhdGU3LmV4cGFuZGVkS2V5cyxcbiAgICAgICAgICBzZWxlY3RlZEtleXMgPSBfdGhpcyRzdGF0ZTcuc2VsZWN0ZWRLZXlzLFxuICAgICAgICAgIGxvYWRlZEtleXMgPSBfdGhpcyRzdGF0ZTcubG9hZGVkS2V5cyxcbiAgICAgICAgICBsb2FkaW5nS2V5cyA9IF90aGlzJHN0YXRlNy5sb2FkaW5nS2V5cyxcbiAgICAgICAgICBjaGVja2VkS2V5cyA9IF90aGlzJHN0YXRlNy5jaGVja2VkS2V5cyxcbiAgICAgICAgICBoYWxmQ2hlY2tlZEtleXMgPSBfdGhpcyRzdGF0ZTcuaGFsZkNoZWNrZWRLZXlzLFxuICAgICAgICAgIGRyYWdPdmVyTm9kZUtleSA9IF90aGlzJHN0YXRlNy5kcmFnT3Zlck5vZGVLZXksXG4gICAgICAgICAgZHJvcFBvc2l0aW9uID0gX3RoaXMkc3RhdGU3LmRyb3BQb3NpdGlvbixcbiAgICAgICAgICBrZXlFbnRpdGllcyA9IF90aGlzJHN0YXRlNy5rZXlFbnRpdGllcztcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGV4cGFuZGVkS2V5czogZXhwYW5kZWRLZXlzIHx8IFtdLFxuICAgICAgICBzZWxlY3RlZEtleXM6IHNlbGVjdGVkS2V5cyB8fCBbXSxcbiAgICAgICAgbG9hZGVkS2V5czogbG9hZGVkS2V5cyB8fCBbXSxcbiAgICAgICAgbG9hZGluZ0tleXM6IGxvYWRpbmdLZXlzIHx8IFtdLFxuICAgICAgICBjaGVja2VkS2V5czogY2hlY2tlZEtleXMgfHwgW10sXG4gICAgICAgIGhhbGZDaGVja2VkS2V5czogaGFsZkNoZWNrZWRLZXlzIHx8IFtdLFxuICAgICAgICBkcmFnT3Zlck5vZGVLZXk6IGRyYWdPdmVyTm9kZUtleSxcbiAgICAgICAgZHJvcFBvc2l0aW9uOiBkcm9wUG9zaXRpb24sXG4gICAgICAgIGtleUVudGl0aWVzOiBrZXlFbnRpdGllc1xuICAgICAgfTtcbiAgICB9OyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT0gRXhwYW5kZWQgPT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvKiogU2V0IHVuY29udHJvbGxlZCBgZXhwYW5kZWRLZXlzYC4gVGhpcyB3aWxsIGFsc28gYXV0byB1cGRhdGUgYGZsYXR0ZW5Ob2Rlc2AuICovXG5cblxuICAgIF90aGlzLnNldEV4cGFuZGVkS2V5cyA9IGZ1bmN0aW9uIChleHBhbmRlZEtleXMpIHtcbiAgICAgIHZhciB0cmVlRGF0YSA9IF90aGlzLnN0YXRlLnRyZWVEYXRhO1xuICAgICAgdmFyIGZsYXR0ZW5Ob2RlcyA9IGZsYXR0ZW5UcmVlRGF0YSh0cmVlRGF0YSwgZXhwYW5kZWRLZXlzKTtcblxuICAgICAgX3RoaXMuc2V0VW5jb250cm9sbGVkU3RhdGUoe1xuICAgICAgICBleHBhbmRlZEtleXM6IGV4cGFuZGVkS2V5cyxcbiAgICAgICAgZmxhdHRlbk5vZGVzOiBmbGF0dGVuTm9kZXNcbiAgICAgIH0sIHRydWUpO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbk5vZGVFeHBhbmQgPSBmdW5jdGlvbiAoZSwgdHJlZU5vZGUpIHtcbiAgICAgIHZhciBleHBhbmRlZEtleXMgPSBfdGhpcy5zdGF0ZS5leHBhbmRlZEtleXM7XG4gICAgICB2YXIgbGlzdENoYW5naW5nID0gX3RoaXMuc3RhdGUubGlzdENoYW5naW5nO1xuICAgICAgdmFyIF90aGlzJHByb3BzNiA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIG9uRXhwYW5kID0gX3RoaXMkcHJvcHM2Lm9uRXhwYW5kLFxuICAgICAgICAgIGxvYWREYXRhID0gX3RoaXMkcHJvcHM2LmxvYWREYXRhO1xuICAgICAgdmFyIGtleSA9IHRyZWVOb2RlLmtleSxcbiAgICAgICAgICBleHBhbmRlZCA9IHRyZWVOb2RlLmV4cGFuZGVkOyAvLyBEbyBub3RoaW5nIHdoZW4gbW90aW9uIGlzIGluIHByb2dyZXNzXG5cbiAgICAgIGlmIChsaXN0Q2hhbmdpbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgc2VsZWN0ZWQga2V5c1xuXG5cbiAgICAgIHZhciBpbmRleCA9IGV4cGFuZGVkS2V5cy5pbmRleE9mKGtleSk7XG4gICAgICB2YXIgdGFyZ2V0RXhwYW5kZWQgPSAhZXhwYW5kZWQ7XG4gICAgICB3YXJuaW5nKGV4cGFuZGVkICYmIGluZGV4ICE9PSAtMSB8fCAhZXhwYW5kZWQgJiYgaW5kZXggPT09IC0xLCAnRXhwYW5kIHN0YXRlIG5vdCBzeW5jIHdpdGggaW5kZXggY2hlY2snKTtcblxuICAgICAgaWYgKHRhcmdldEV4cGFuZGVkKSB7XG4gICAgICAgIGV4cGFuZGVkS2V5cyA9IGFyckFkZChleHBhbmRlZEtleXMsIGtleSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHBhbmRlZEtleXMgPSBhcnJEZWwoZXhwYW5kZWRLZXlzLCBrZXkpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5zZXRFeHBhbmRlZEtleXMoZXhwYW5kZWRLZXlzKTtcblxuICAgICAgaWYgKG9uRXhwYW5kKSB7XG4gICAgICAgIG9uRXhwYW5kKGV4cGFuZGVkS2V5cywge1xuICAgICAgICAgIG5vZGU6IHRyZWVOb2RlLFxuICAgICAgICAgIGV4cGFuZGVkOiB0YXJnZXRFeHBhbmRlZCxcbiAgICAgICAgICBuYXRpdmVFdmVudDogZS5uYXRpdmVFdmVudFxuICAgICAgICB9KTtcbiAgICAgIH0gLy8gQXN5bmMgTG9hZCBkYXRhXG5cblxuICAgICAgaWYgKHRhcmdldEV4cGFuZGVkICYmIGxvYWREYXRhKSB7XG4gICAgICAgIHZhciBsb2FkUHJvbWlzZSA9IF90aGlzLm9uTm9kZUxvYWQodHJlZU5vZGUpO1xuXG4gICAgICAgIGlmIChsb2FkUHJvbWlzZSkge1xuICAgICAgICAgIGxvYWRQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gW0xlZ2FjeV0gUmVmcmVzaCBsb2dpY1xuICAgICAgICAgICAgdmFyIG5ld0ZsYXR0ZW5UcmVlRGF0YSA9IGZsYXR0ZW5UcmVlRGF0YShfdGhpcy5zdGF0ZS50cmVlRGF0YSwgZXhwYW5kZWRLZXlzKTtcblxuICAgICAgICAgICAgX3RoaXMuc2V0VW5jb250cm9sbGVkU3RhdGUoe1xuICAgICAgICAgICAgICBmbGF0dGVuTm9kZXM6IG5ld0ZsYXR0ZW5UcmVlRGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25MaXN0Q2hhbmdlU3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5zZXRVbmNvbnRyb2xsZWRTdGF0ZSh7XG4gICAgICAgIGxpc3RDaGFuZ2luZzogdHJ1ZVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIF90aGlzLm9uTGlzdENoYW5nZUVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5zZXRVbmNvbnRyb2xsZWRTdGF0ZSh7XG4gICAgICAgICAgbGlzdENoYW5naW5nOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PSBLZXlib2FyZCA9PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4gICAgX3RoaXMub25BY3RpdmVDaGFuZ2UgPSBmdW5jdGlvbiAobmV3QWN0aXZlS2V5KSB7XG4gICAgICB2YXIgYWN0aXZlS2V5ID0gX3RoaXMuc3RhdGUuYWN0aXZlS2V5O1xuICAgICAgdmFyIG9uQWN0aXZlQ2hhbmdlID0gX3RoaXMucHJvcHMub25BY3RpdmVDaGFuZ2U7XG5cbiAgICAgIGlmIChhY3RpdmVLZXkgPT09IG5ld0FjdGl2ZUtleSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgYWN0aXZlS2V5OiBuZXdBY3RpdmVLZXlcbiAgICAgIH0pO1xuXG4gICAgICBpZiAobmV3QWN0aXZlS2V5ICE9PSBudWxsKSB7XG4gICAgICAgIF90aGlzLnNjcm9sbFRvKHtcbiAgICAgICAgICBrZXk6IG5ld0FjdGl2ZUtleVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9uQWN0aXZlQ2hhbmdlKSB7XG4gICAgICAgIG9uQWN0aXZlQ2hhbmdlKG5ld0FjdGl2ZUtleSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLmdldEFjdGl2ZUl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3RoaXMkc3RhdGU4ID0gX3RoaXMuc3RhdGUsXG4gICAgICAgICAgYWN0aXZlS2V5ID0gX3RoaXMkc3RhdGU4LmFjdGl2ZUtleSxcbiAgICAgICAgICBmbGF0dGVuTm9kZXMgPSBfdGhpcyRzdGF0ZTguZmxhdHRlbk5vZGVzO1xuXG4gICAgICBpZiAoYWN0aXZlS2V5ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmxhdHRlbk5vZGVzLmZpbmQoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICAgIHZhciBrZXkgPSBfcmVmMi5kYXRhLmtleTtcbiAgICAgICAgcmV0dXJuIGtleSA9PT0gYWN0aXZlS2V5O1xuICAgICAgfSkgfHwgbnVsbDtcbiAgICB9O1xuXG4gICAgX3RoaXMub2Zmc2V0QWN0aXZlS2V5ID0gZnVuY3Rpb24gKG9mZnNldCkge1xuICAgICAgdmFyIF90aGlzJHN0YXRlOSA9IF90aGlzLnN0YXRlLFxuICAgICAgICAgIGZsYXR0ZW5Ob2RlcyA9IF90aGlzJHN0YXRlOS5mbGF0dGVuTm9kZXMsXG4gICAgICAgICAgYWN0aXZlS2V5ID0gX3RoaXMkc3RhdGU5LmFjdGl2ZUtleTtcbiAgICAgIHZhciBpbmRleCA9IGZsYXR0ZW5Ob2Rlcy5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICAgIHZhciBrZXkgPSBfcmVmMy5kYXRhLmtleTtcbiAgICAgICAgcmV0dXJuIGtleSA9PT0gYWN0aXZlS2V5O1xuICAgICAgfSk7IC8vIEFsaWduIHdpdGggaW5kZXhcblxuICAgICAgaWYgKGluZGV4ID09PSAtMSAmJiBvZmZzZXQgPCAwKSB7XG4gICAgICAgIGluZGV4ID0gZmxhdHRlbk5vZGVzLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgaW5kZXggPSAoaW5kZXggKyBvZmZzZXQgKyBmbGF0dGVuTm9kZXMubGVuZ3RoKSAlIGZsYXR0ZW5Ob2Rlcy5sZW5ndGg7XG4gICAgICB2YXIgaXRlbSA9IGZsYXR0ZW5Ob2Rlc1tpbmRleF07XG5cbiAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgIHZhciBrZXkgPSBpdGVtLmRhdGEua2V5O1xuXG4gICAgICAgIF90aGlzLm9uQWN0aXZlQ2hhbmdlKGtleSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5vbkFjdGl2ZUNoYW5nZShudWxsKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25LZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXMkc3RhdGUxMCA9IF90aGlzLnN0YXRlLFxuICAgICAgICAgIGFjdGl2ZUtleSA9IF90aGlzJHN0YXRlMTAuYWN0aXZlS2V5LFxuICAgICAgICAgIGV4cGFuZGVkS2V5cyA9IF90aGlzJHN0YXRlMTAuZXhwYW5kZWRLZXlzLFxuICAgICAgICAgIGNoZWNrZWRLZXlzID0gX3RoaXMkc3RhdGUxMC5jaGVja2VkS2V5cztcbiAgICAgIHZhciBfdGhpcyRwcm9wczcgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBvbktleURvd24gPSBfdGhpcyRwcm9wczcub25LZXlEb3duLFxuICAgICAgICAgIGNoZWNrYWJsZSA9IF90aGlzJHByb3BzNy5jaGVja2FibGUsXG4gICAgICAgICAgc2VsZWN0YWJsZSA9IF90aGlzJHByb3BzNy5zZWxlY3RhYmxlOyAvLyA+Pj4+Pj4+Pj4+IERpcmVjdGlvblxuXG4gICAgICBzd2l0Y2ggKGV2ZW50LndoaWNoKSB7XG4gICAgICAgIGNhc2UgS2V5Q29kZS5VUDpcbiAgICAgICAgICB7XG4gICAgICAgICAgICBfdGhpcy5vZmZzZXRBY3RpdmVLZXkoLTEpO1xuXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgS2V5Q29kZS5ET1dOOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIF90aGlzLm9mZnNldEFjdGl2ZUtleSgxKTtcblxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgIH0gLy8gPj4+Pj4+Pj4+PiBFeHBhbmQgJiBTZWxlY3Rpb25cblxuXG4gICAgICB2YXIgYWN0aXZlSXRlbSA9IF90aGlzLmdldEFjdGl2ZUl0ZW0oKTtcblxuICAgICAgaWYgKGFjdGl2ZUl0ZW0gJiYgYWN0aXZlSXRlbS5kYXRhKSB7XG4gICAgICAgIHZhciB0cmVlTm9kZVJlcXVpcmVkUHJvcHMgPSBfdGhpcy5nZXRUcmVlTm9kZVJlcXVpcmVkUHJvcHMoKTtcblxuICAgICAgICB2YXIgZXhwYW5kYWJsZSA9IGFjdGl2ZUl0ZW0uZGF0YS5pc0xlYWYgPT09IGZhbHNlIHx8ICEhKGFjdGl2ZUl0ZW0uZGF0YS5jaGlsZHJlbiB8fCBbXSkubGVuZ3RoO1xuICAgICAgICB2YXIgZXZlbnROb2RlID0gY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZ2V0VHJlZU5vZGVQcm9wcyhhY3RpdmVLZXksIHRyZWVOb2RlUmVxdWlyZWRQcm9wcykpLCB7fSwge1xuICAgICAgICAgIGRhdGE6IGFjdGl2ZUl0ZW0uZGF0YSxcbiAgICAgICAgICBhY3RpdmU6IHRydWVcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHN3aXRjaCAoZXZlbnQud2hpY2gpIHtcbiAgICAgICAgICAvLyA+Pj4gRXhwYW5kXG4gICAgICAgICAgY2FzZSBLZXlDb2RlLkxFRlQ6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIC8vIENvbGxhcHNlIGlmIHBvc3NpYmxlXG4gICAgICAgICAgICAgIGlmIChleHBhbmRhYmxlICYmIGV4cGFuZGVkS2V5cy5pbmNsdWRlcyhhY3RpdmVLZXkpKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25Ob2RlRXhwYW5kKHt9LCBldmVudE5vZGUpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGl2ZUl0ZW0ucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25BY3RpdmVDaGFuZ2UoYWN0aXZlSXRlbS5wYXJlbnQuZGF0YS5rZXkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXNlIEtleUNvZGUuUklHSFQ6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIC8vIEV4cGFuZCBpZiBwb3NzaWJsZVxuICAgICAgICAgICAgICBpZiAoZXhwYW5kYWJsZSAmJiAhZXhwYW5kZWRLZXlzLmluY2x1ZGVzKGFjdGl2ZUtleSkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5vbk5vZGVFeHBhbmQoe30sIGV2ZW50Tm9kZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aXZlSXRlbS5jaGlsZHJlbiAmJiBhY3RpdmVJdGVtLmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIF90aGlzLm9uQWN0aXZlQ2hhbmdlKGFjdGl2ZUl0ZW0uY2hpbGRyZW5bMF0uZGF0YS5rZXkpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgLy8gU2VsZWN0aW9uXG5cbiAgICAgICAgICBjYXNlIEtleUNvZGUuRU5URVI6XG4gICAgICAgICAgY2FzZSBLZXlDb2RlLlNQQUNFOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZiAoY2hlY2thYmxlICYmICFldmVudE5vZGUuZGlzYWJsZWQgJiYgZXZlbnROb2RlLmNoZWNrYWJsZSAhPT0gZmFsc2UgJiYgIWV2ZW50Tm9kZS5kaXNhYmxlQ2hlY2tib3gpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5vbk5vZGVDaGVjayh7fSwgZXZlbnROb2RlLCAhY2hlY2tlZEtleXMuaW5jbHVkZXMoYWN0aXZlS2V5KSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWNoZWNrYWJsZSAmJiBzZWxlY3RhYmxlICYmICFldmVudE5vZGUuZGlzYWJsZWQgJiYgZXZlbnROb2RlLnNlbGVjdGFibGUgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMub25Ob2RlU2VsZWN0KHt9LCBldmVudE5vZGUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG9uS2V5RG93bikge1xuICAgICAgICBvbktleURvd24oZXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogT25seSB1cGRhdGUgdGhlIHZhbHVlIHdoaWNoIGlzIG5vdCBpbiBwcm9wc1xuICAgICAqL1xuXG5cbiAgICBfdGhpcy5zZXRVbmNvbnRyb2xsZWRTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgdmFyIGF0b21pYyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG4gICAgICB2YXIgZm9yY2VTdGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDtcblxuICAgICAgaWYgKF90aGlzLmRlc3Ryb3llZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBuZWVkU3luYyA9IGZhbHNlO1xuICAgICAgdmFyIGFsbFBhc3NlZCA9IHRydWU7XG4gICAgICB2YXIgbmV3U3RhdGUgPSB7fTtcbiAgICAgIE9iamVjdC5rZXlzKHN0YXRlKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGlmIChuYW1lIGluIF90aGlzLnByb3BzKSB7XG4gICAgICAgICAgYWxsUGFzc2VkID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbmVlZFN5bmMgPSB0cnVlO1xuICAgICAgICBuZXdTdGF0ZVtuYW1lXSA9IHN0YXRlW25hbWVdO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChuZWVkU3luYyAmJiAoIWF0b21pYyB8fCBhbGxQYXNzZWQpKSB7XG4gICAgICAgIF90aGlzLnNldFN0YXRlKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbmV3U3RhdGUpLCBmb3JjZVN0YXRlKSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLnNjcm9sbFRvID0gZnVuY3Rpb24gKHNjcm9sbCkge1xuICAgICAgX3RoaXMubGlzdFJlZi5jdXJyZW50LnNjcm9sbFRvKHNjcm9sbCk7XG4gICAgfTtcblxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhUcmVlLCBbe1xuICAgIGtleTogXCJjb21wb25lbnRXaWxsVW5tb3VudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5vbldpbmRvd0RyYWdFbmQpO1xuICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW5kZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIF9jbGFzc05hbWVzO1xuXG4gICAgICB2YXIgX3RoaXMkc3RhdGUxMSA9IHRoaXMuc3RhdGUsXG4gICAgICAgICAgZm9jdXNlZCA9IF90aGlzJHN0YXRlMTEuZm9jdXNlZCxcbiAgICAgICAgICBmbGF0dGVuTm9kZXMgPSBfdGhpcyRzdGF0ZTExLmZsYXR0ZW5Ob2RlcyxcbiAgICAgICAgICBrZXlFbnRpdGllcyA9IF90aGlzJHN0YXRlMTEua2V5RW50aXRpZXMsXG4gICAgICAgICAgZHJhZ2dpbmcgPSBfdGhpcyRzdGF0ZTExLmRyYWdnaW5nLFxuICAgICAgICAgIGFjdGl2ZUtleSA9IF90aGlzJHN0YXRlMTEuYWN0aXZlS2V5LFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldCA9IF90aGlzJHN0YXRlMTEuZHJvcExldmVsT2Zmc2V0LFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXkgPSBfdGhpcyRzdGF0ZTExLmRyb3BDb250YWluZXJLZXksXG4gICAgICAgICAgZHJvcFRhcmdldEtleSA9IF90aGlzJHN0YXRlMTEuZHJvcFRhcmdldEtleSxcbiAgICAgICAgICBkcm9wUG9zaXRpb24gPSBfdGhpcyRzdGF0ZTExLmRyb3BQb3NpdGlvbixcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXkgPSBfdGhpcyRzdGF0ZTExLmRyYWdPdmVyTm9kZUtleSxcbiAgICAgICAgICBpbmRlbnQgPSBfdGhpcyRzdGF0ZTExLmluZGVudDtcbiAgICAgIHZhciBfdGhpcyRwcm9wczggPSB0aGlzLnByb3BzLFxuICAgICAgICAgIHByZWZpeENscyA9IF90aGlzJHByb3BzOC5wcmVmaXhDbHMsXG4gICAgICAgICAgY2xhc3NOYW1lID0gX3RoaXMkcHJvcHM4LmNsYXNzTmFtZSxcbiAgICAgICAgICBzdHlsZSA9IF90aGlzJHByb3BzOC5zdHlsZSxcbiAgICAgICAgICBzaG93TGluZSA9IF90aGlzJHByb3BzOC5zaG93TGluZSxcbiAgICAgICAgICBmb2N1c2FibGUgPSBfdGhpcyRwcm9wczguZm9jdXNhYmxlLFxuICAgICAgICAgIF90aGlzJHByb3BzOCR0YWJJbmRleCA9IF90aGlzJHByb3BzOC50YWJJbmRleCxcbiAgICAgICAgICB0YWJJbmRleCA9IF90aGlzJHByb3BzOCR0YWJJbmRleCA9PT0gdm9pZCAwID8gMCA6IF90aGlzJHByb3BzOCR0YWJJbmRleCxcbiAgICAgICAgICBzZWxlY3RhYmxlID0gX3RoaXMkcHJvcHM4LnNlbGVjdGFibGUsXG4gICAgICAgICAgc2hvd0ljb24gPSBfdGhpcyRwcm9wczguc2hvd0ljb24sXG4gICAgICAgICAgaWNvbiA9IF90aGlzJHByb3BzOC5pY29uLFxuICAgICAgICAgIHN3aXRjaGVySWNvbiA9IF90aGlzJHByb3BzOC5zd2l0Y2hlckljb24sXG4gICAgICAgICAgZHJhZ2dhYmxlID0gX3RoaXMkcHJvcHM4LmRyYWdnYWJsZSxcbiAgICAgICAgICBjaGVja2FibGUgPSBfdGhpcyRwcm9wczguY2hlY2thYmxlLFxuICAgICAgICAgIGNoZWNrU3RyaWN0bHkgPSBfdGhpcyRwcm9wczguY2hlY2tTdHJpY3RseSxcbiAgICAgICAgICBkaXNhYmxlZCA9IF90aGlzJHByb3BzOC5kaXNhYmxlZCxcbiAgICAgICAgICBtb3Rpb24gPSBfdGhpcyRwcm9wczgubW90aW9uLFxuICAgICAgICAgIGxvYWREYXRhID0gX3RoaXMkcHJvcHM4LmxvYWREYXRhLFxuICAgICAgICAgIGZpbHRlclRyZWVOb2RlID0gX3RoaXMkcHJvcHM4LmZpbHRlclRyZWVOb2RlLFxuICAgICAgICAgIGhlaWdodCA9IF90aGlzJHByb3BzOC5oZWlnaHQsXG4gICAgICAgICAgaXRlbUhlaWdodCA9IF90aGlzJHByb3BzOC5pdGVtSGVpZ2h0LFxuICAgICAgICAgIHZpcnR1YWwgPSBfdGhpcyRwcm9wczgudmlydHVhbCxcbiAgICAgICAgICB0aXRsZVJlbmRlciA9IF90aGlzJHByb3BzOC50aXRsZVJlbmRlcixcbiAgICAgICAgICBkcm9wSW5kaWNhdG9yUmVuZGVyID0gX3RoaXMkcHJvcHM4LmRyb3BJbmRpY2F0b3JSZW5kZXIsXG4gICAgICAgICAgb25Db250ZXh0TWVudSA9IF90aGlzJHByb3BzOC5vbkNvbnRleHRNZW51LFxuICAgICAgICAgIGRpcmVjdGlvbiA9IF90aGlzJHByb3BzOC5kaXJlY3Rpb247XG4gICAgICB2YXIgZG9tUHJvcHMgPSBnZXREYXRhQW5kQXJpYSh0aGlzLnByb3BzKTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUcmVlQ29udGV4dC5Qcm92aWRlciwge1xuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIHByZWZpeENsczogcHJlZml4Q2xzLFxuICAgICAgICAgIHNlbGVjdGFibGU6IHNlbGVjdGFibGUsXG4gICAgICAgICAgc2hvd0ljb246IHNob3dJY29uLFxuICAgICAgICAgIGljb246IGljb24sXG4gICAgICAgICAgc3dpdGNoZXJJY29uOiBzd2l0Y2hlckljb24sXG4gICAgICAgICAgZHJhZ2dhYmxlOiBkcmFnZ2FibGUsXG4gICAgICAgICAgY2hlY2thYmxlOiBjaGVja2FibGUsXG4gICAgICAgICAgY2hlY2tTdHJpY3RseTogY2hlY2tTdHJpY3RseSxcbiAgICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWQsXG4gICAgICAgICAga2V5RW50aXRpZXM6IGtleUVudGl0aWVzLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldDogZHJvcExldmVsT2Zmc2V0LFxuICAgICAgICAgIGRyb3BDb250YWluZXJLZXk6IGRyb3BDb250YWluZXJLZXksXG4gICAgICAgICAgZHJvcFRhcmdldEtleTogZHJvcFRhcmdldEtleSxcbiAgICAgICAgICBkcm9wUG9zaXRpb246IGRyb3BQb3NpdGlvbixcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXk6IGRyYWdPdmVyTm9kZUtleSxcbiAgICAgICAgICBpbmRlbnQ6IGluZGVudCxcbiAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvbixcbiAgICAgICAgICBkcm9wSW5kaWNhdG9yUmVuZGVyOiBkcm9wSW5kaWNhdG9yUmVuZGVyLFxuICAgICAgICAgIGxvYWREYXRhOiBsb2FkRGF0YSxcbiAgICAgICAgICBmaWx0ZXJUcmVlTm9kZTogZmlsdGVyVHJlZU5vZGUsXG4gICAgICAgICAgdGl0bGVSZW5kZXI6IHRpdGxlUmVuZGVyLFxuICAgICAgICAgIG9uTm9kZUNsaWNrOiB0aGlzLm9uTm9kZUNsaWNrLFxuICAgICAgICAgIG9uTm9kZURvdWJsZUNsaWNrOiB0aGlzLm9uTm9kZURvdWJsZUNsaWNrLFxuICAgICAgICAgIG9uTm9kZUV4cGFuZDogdGhpcy5vbk5vZGVFeHBhbmQsXG4gICAgICAgICAgb25Ob2RlU2VsZWN0OiB0aGlzLm9uTm9kZVNlbGVjdCxcbiAgICAgICAgICBvbk5vZGVDaGVjazogdGhpcy5vbk5vZGVDaGVjayxcbiAgICAgICAgICBvbk5vZGVMb2FkOiB0aGlzLm9uTm9kZUxvYWQsXG4gICAgICAgICAgb25Ob2RlTW91c2VFbnRlcjogdGhpcy5vbk5vZGVNb3VzZUVudGVyLFxuICAgICAgICAgIG9uTm9kZU1vdXNlTGVhdmU6IHRoaXMub25Ob2RlTW91c2VMZWF2ZSxcbiAgICAgICAgICBvbk5vZGVDb250ZXh0TWVudTogdGhpcy5vbk5vZGVDb250ZXh0TWVudSxcbiAgICAgICAgICBvbk5vZGVEcmFnU3RhcnQ6IHRoaXMub25Ob2RlRHJhZ1N0YXJ0LFxuICAgICAgICAgIG9uTm9kZURyYWdFbnRlcjogdGhpcy5vbk5vZGVEcmFnRW50ZXIsXG4gICAgICAgICAgb25Ob2RlRHJhZ092ZXI6IHRoaXMub25Ob2RlRHJhZ092ZXIsXG4gICAgICAgICAgb25Ob2RlRHJhZ0xlYXZlOiB0aGlzLm9uTm9kZURyYWdMZWF2ZSxcbiAgICAgICAgICBvbk5vZGVEcmFnRW5kOiB0aGlzLm9uTm9kZURyYWdFbmQsXG4gICAgICAgICAgb25Ob2RlRHJvcDogdGhpcy5vbk5vZGVEcm9wXG4gICAgICAgIH1cbiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVzKHByZWZpeENscywgY2xhc3NOYW1lLCAoX2NsYXNzTmFtZXMgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXNob3ctbGluZVwiKSwgc2hvd0xpbmUpLCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzTmFtZXMsIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItZm9jdXNlZFwiKSwgZm9jdXNlZCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1hY3RpdmUtZm9jdXNlZFwiKSwgYWN0aXZlS2V5ICE9PSBudWxsKSwgX2NsYXNzTmFtZXMpKVxuICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoTm9kZUxpc3QsIF9leHRlbmRzKHtcbiAgICAgICAgcmVmOiB0aGlzLmxpc3RSZWYsXG4gICAgICAgIHByZWZpeENsczogcHJlZml4Q2xzLFxuICAgICAgICBzdHlsZTogc3R5bGUsXG4gICAgICAgIGRhdGE6IGZsYXR0ZW5Ob2RlcyxcbiAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkLFxuICAgICAgICBzZWxlY3RhYmxlOiBzZWxlY3RhYmxlLFxuICAgICAgICBjaGVja2FibGU6ICEhY2hlY2thYmxlLFxuICAgICAgICBtb3Rpb246IG1vdGlvbixcbiAgICAgICAgZHJhZ2dpbmc6IGRyYWdnaW5nLFxuICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgaXRlbUhlaWdodDogaXRlbUhlaWdodCxcbiAgICAgICAgdmlydHVhbDogdmlydHVhbCxcbiAgICAgICAgZm9jdXNhYmxlOiBmb2N1c2FibGUsXG4gICAgICAgIGZvY3VzZWQ6IGZvY3VzZWQsXG4gICAgICAgIHRhYkluZGV4OiB0YWJJbmRleCxcbiAgICAgICAgYWN0aXZlSXRlbTogdGhpcy5nZXRBY3RpdmVJdGVtKCksXG4gICAgICAgIG9uRm9jdXM6IHRoaXMub25Gb2N1cyxcbiAgICAgICAgb25CbHVyOiB0aGlzLm9uQmx1cixcbiAgICAgICAgb25LZXlEb3duOiB0aGlzLm9uS2V5RG93bixcbiAgICAgICAgb25BY3RpdmVDaGFuZ2U6IHRoaXMub25BY3RpdmVDaGFuZ2UsXG4gICAgICAgIG9uTGlzdENoYW5nZVN0YXJ0OiB0aGlzLm9uTGlzdENoYW5nZVN0YXJ0LFxuICAgICAgICBvbkxpc3RDaGFuZ2VFbmQ6IHRoaXMub25MaXN0Q2hhbmdlRW5kLFxuICAgICAgICBvbkNvbnRleHRNZW51OiBvbkNvbnRleHRNZW51XG4gICAgICB9LCB0aGlzLmdldFRyZWVOb2RlUmVxdWlyZWRQcm9wcygpLCBkb21Qcm9wcykpKSk7XG4gICAgfVxuICB9XSwgW3tcbiAgICBrZXk6IFwiZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhwcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICB2YXIgcHJldlByb3BzID0gcHJldlN0YXRlLnByZXZQcm9wcztcbiAgICAgIHZhciBuZXdTdGF0ZSA9IHtcbiAgICAgICAgcHJldlByb3BzOiBwcm9wc1xuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gbmVlZFN5bmMobmFtZSkge1xuICAgICAgICByZXR1cm4gIXByZXZQcm9wcyAmJiBuYW1lIGluIHByb3BzIHx8IHByZXZQcm9wcyAmJiBwcmV2UHJvcHNbbmFtZV0gIT09IHByb3BzW25hbWVdO1xuICAgICAgfSAvLyA9PT09PT09PT09PT09PT09PT0gVHJlZSBOb2RlID09PT09PT09PT09PT09PT09PVxuXG5cbiAgICAgIHZhciB0cmVlRGF0YTsgLy8gQ2hlY2sgaWYgYHRyZWVEYXRhYCBvciBgY2hpbGRyZW5gIGNoYW5nZWQgYW5kIHNhdmUgaW50byB0aGUgc3RhdGUuXG5cbiAgICAgIGlmIChuZWVkU3luYygndHJlZURhdGEnKSkge1xuICAgICAgICB0cmVlRGF0YSA9IHByb3BzLnRyZWVEYXRhO1xuICAgICAgfSBlbHNlIGlmIChuZWVkU3luYygnY2hpbGRyZW4nKSkge1xuICAgICAgICB3YXJuaW5nKGZhbHNlLCAnYGNoaWxkcmVuYCBvZiBUcmVlIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgYHRyZWVEYXRhYCBpbnN0ZWFkLicpO1xuICAgICAgICB0cmVlRGF0YSA9IGNvbnZlcnRUcmVlVG9EYXRhKHByb3BzLmNoaWxkcmVuKTtcbiAgICAgIH0gLy8gU2F2ZSBmbGF0dGVuIG5vZGVzIGluZm8gYW5kIGNvbnZlcnQgYHRyZWVEYXRhYCBpbnRvIGtleUVudGl0aWVzXG5cblxuICAgICAgaWYgKHRyZWVEYXRhKSB7XG4gICAgICAgIG5ld1N0YXRlLnRyZWVEYXRhID0gdHJlZURhdGE7XG4gICAgICAgIHZhciBlbnRpdGllc01hcCA9IGNvbnZlcnREYXRhVG9FbnRpdGllcyh0cmVlRGF0YSk7XG4gICAgICAgIG5ld1N0YXRlLmtleUVudGl0aWVzID0gX29iamVjdFNwcmVhZChfZGVmaW5lUHJvcGVydHkoe30sIE1PVElPTl9LRVksIE1vdGlvbkVudGl0eSksIGVudGl0aWVzTWFwLmtleUVudGl0aWVzKTsgLy8gV2FybmluZyBpZiB0cmVlTm9kZSBub3QgcHJvdmlkZSBrZXlcblxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIHdhcm5pbmdXaXRob3V0S2V5KHRyZWVEYXRhKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIga2V5RW50aXRpZXMgPSBuZXdTdGF0ZS5rZXlFbnRpdGllcyB8fCBwcmV2U3RhdGUua2V5RW50aXRpZXM7IC8vID09PT09PT09PT09PT09PT0gZXhwYW5kZWRLZXlzID09PT09PT09PT09PT09PT09XG5cbiAgICAgIGlmIChuZWVkU3luYygnZXhwYW5kZWRLZXlzJykgfHwgcHJldlByb3BzICYmIG5lZWRTeW5jKCdhdXRvRXhwYW5kUGFyZW50JykpIHtcbiAgICAgICAgbmV3U3RhdGUuZXhwYW5kZWRLZXlzID0gcHJvcHMuYXV0b0V4cGFuZFBhcmVudCB8fCAhcHJldlByb3BzICYmIHByb3BzLmRlZmF1bHRFeHBhbmRQYXJlbnQgPyBjb25kdWN0RXhwYW5kUGFyZW50KHByb3BzLmV4cGFuZGVkS2V5cywga2V5RW50aXRpZXMpIDogcHJvcHMuZXhwYW5kZWRLZXlzO1xuICAgICAgfSBlbHNlIGlmICghcHJldlByb3BzICYmIHByb3BzLmRlZmF1bHRFeHBhbmRBbGwpIHtcbiAgICAgICAgdmFyIGNsb25lS2V5RW50aXRpZXMgPSBfb2JqZWN0U3ByZWFkKHt9LCBrZXlFbnRpdGllcyk7XG5cbiAgICAgICAgZGVsZXRlIGNsb25lS2V5RW50aXRpZXNbTU9USU9OX0tFWV07XG4gICAgICAgIG5ld1N0YXRlLmV4cGFuZGVkS2V5cyA9IE9iamVjdC5rZXlzKGNsb25lS2V5RW50aXRpZXMpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgcmV0dXJuIGNsb25lS2V5RW50aXRpZXNba2V5XS5rZXk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICghcHJldlByb3BzICYmIHByb3BzLmRlZmF1bHRFeHBhbmRlZEtleXMpIHtcbiAgICAgICAgbmV3U3RhdGUuZXhwYW5kZWRLZXlzID0gcHJvcHMuYXV0b0V4cGFuZFBhcmVudCB8fCBwcm9wcy5kZWZhdWx0RXhwYW5kUGFyZW50ID8gY29uZHVjdEV4cGFuZFBhcmVudChwcm9wcy5kZWZhdWx0RXhwYW5kZWRLZXlzLCBrZXlFbnRpdGllcykgOiBwcm9wcy5kZWZhdWx0RXhwYW5kZWRLZXlzO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW5ld1N0YXRlLmV4cGFuZGVkS2V5cykge1xuICAgICAgICBkZWxldGUgbmV3U3RhdGUuZXhwYW5kZWRLZXlzO1xuICAgICAgfSAvLyA9PT09PT09PT09PT09PT09IGZsYXR0ZW5Ob2RlcyA9PT09PT09PT09PT09PT09PVxuXG5cbiAgICAgIGlmICh0cmVlRGF0YSB8fCBuZXdTdGF0ZS5leHBhbmRlZEtleXMpIHtcbiAgICAgICAgdmFyIGZsYXR0ZW5Ob2RlcyA9IGZsYXR0ZW5UcmVlRGF0YSh0cmVlRGF0YSB8fCBwcmV2U3RhdGUudHJlZURhdGEsIG5ld1N0YXRlLmV4cGFuZGVkS2V5cyB8fCBwcmV2U3RhdGUuZXhwYW5kZWRLZXlzKTtcbiAgICAgICAgbmV3U3RhdGUuZmxhdHRlbk5vZGVzID0gZmxhdHRlbk5vZGVzO1xuICAgICAgfSAvLyA9PT09PT09PT09PT09PT09IHNlbGVjdGVkS2V5cyA9PT09PT09PT09PT09PT09PVxuXG5cbiAgICAgIGlmIChwcm9wcy5zZWxlY3RhYmxlKSB7XG4gICAgICAgIGlmIChuZWVkU3luYygnc2VsZWN0ZWRLZXlzJykpIHtcbiAgICAgICAgICBuZXdTdGF0ZS5zZWxlY3RlZEtleXMgPSBjYWxjU2VsZWN0ZWRLZXlzKHByb3BzLnNlbGVjdGVkS2V5cywgcHJvcHMpO1xuICAgICAgICB9IGVsc2UgaWYgKCFwcmV2UHJvcHMgJiYgcHJvcHMuZGVmYXVsdFNlbGVjdGVkS2V5cykge1xuICAgICAgICAgIG5ld1N0YXRlLnNlbGVjdGVkS2V5cyA9IGNhbGNTZWxlY3RlZEtleXMocHJvcHMuZGVmYXVsdFNlbGVjdGVkS2V5cywgcHJvcHMpO1xuICAgICAgICB9XG4gICAgICB9IC8vID09PT09PT09PT09PT09PT09IGNoZWNrZWRLZXlzID09PT09PT09PT09PT09PT09XG5cblxuICAgICAgaWYgKHByb3BzLmNoZWNrYWJsZSkge1xuICAgICAgICB2YXIgY2hlY2tlZEtleUVudGl0eTtcblxuICAgICAgICBpZiAobmVlZFN5bmMoJ2NoZWNrZWRLZXlzJykpIHtcbiAgICAgICAgICBjaGVja2VkS2V5RW50aXR5ID0gcGFyc2VDaGVja2VkS2V5cyhwcm9wcy5jaGVja2VkS2V5cykgfHwge307XG4gICAgICAgIH0gZWxzZSBpZiAoIXByZXZQcm9wcyAmJiBwcm9wcy5kZWZhdWx0Q2hlY2tlZEtleXMpIHtcbiAgICAgICAgICBjaGVja2VkS2V5RW50aXR5ID0gcGFyc2VDaGVja2VkS2V5cyhwcm9wcy5kZWZhdWx0Q2hlY2tlZEtleXMpIHx8IHt9O1xuICAgICAgICB9IGVsc2UgaWYgKHRyZWVEYXRhKSB7XG4gICAgICAgICAgLy8gSWYgYHRyZWVEYXRhYCBjaGFuZ2VkLCB3ZSBhbHNvIG5lZWQgY2hlY2sgaXRcbiAgICAgICAgICBjaGVja2VkS2V5RW50aXR5ID0gcGFyc2VDaGVja2VkS2V5cyhwcm9wcy5jaGVja2VkS2V5cykgfHwge1xuICAgICAgICAgICAgY2hlY2tlZEtleXM6IHByZXZTdGF0ZS5jaGVja2VkS2V5cyxcbiAgICAgICAgICAgIGhhbGZDaGVja2VkS2V5czogcHJldlN0YXRlLmhhbGZDaGVja2VkS2V5c1xuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hlY2tlZEtleUVudGl0eSkge1xuICAgICAgICAgIHZhciBfY2hlY2tlZEtleUVudGl0eSA9IGNoZWNrZWRLZXlFbnRpdHksXG4gICAgICAgICAgICAgIF9jaGVja2VkS2V5RW50aXR5JGNoZSA9IF9jaGVja2VkS2V5RW50aXR5LmNoZWNrZWRLZXlzLFxuICAgICAgICAgICAgICBjaGVja2VkS2V5cyA9IF9jaGVja2VkS2V5RW50aXR5JGNoZSA9PT0gdm9pZCAwID8gW10gOiBfY2hlY2tlZEtleUVudGl0eSRjaGUsXG4gICAgICAgICAgICAgIF9jaGVja2VkS2V5RW50aXR5JGhhbCA9IF9jaGVja2VkS2V5RW50aXR5LmhhbGZDaGVja2VkS2V5cyxcbiAgICAgICAgICAgICAgaGFsZkNoZWNrZWRLZXlzID0gX2NoZWNrZWRLZXlFbnRpdHkkaGFsID09PSB2b2lkIDAgPyBbXSA6IF9jaGVja2VkS2V5RW50aXR5JGhhbDtcblxuICAgICAgICAgIGlmICghcHJvcHMuY2hlY2tTdHJpY3RseSkge1xuICAgICAgICAgICAgdmFyIGNvbmR1Y3RLZXlzID0gY29uZHVjdENoZWNrKGNoZWNrZWRLZXlzLCB0cnVlLCBrZXlFbnRpdGllcyk7XG4gICAgICAgICAgICBjaGVja2VkS2V5cyA9IGNvbmR1Y3RLZXlzLmNoZWNrZWRLZXlzO1xuICAgICAgICAgICAgaGFsZkNoZWNrZWRLZXlzID0gY29uZHVjdEtleXMuaGFsZkNoZWNrZWRLZXlzO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG5ld1N0YXRlLmNoZWNrZWRLZXlzID0gY2hlY2tlZEtleXM7XG4gICAgICAgICAgbmV3U3RhdGUuaGFsZkNoZWNrZWRLZXlzID0gaGFsZkNoZWNrZWRLZXlzO1xuICAgICAgICB9XG4gICAgICB9IC8vID09PT09PT09PT09PT09PT09IGxvYWRlZEtleXMgPT09PT09PT09PT09PT09PT09XG5cblxuICAgICAgaWYgKG5lZWRTeW5jKCdsb2FkZWRLZXlzJykpIHtcbiAgICAgICAgbmV3U3RhdGUubG9hZGVkS2V5cyA9IHByb3BzLmxvYWRlZEtleXM7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVHJlZTtcbn0oUmVhY3QuQ29tcG9uZW50KTtcblxuVHJlZS5kZWZhdWx0UHJvcHMgPSB7XG4gIHByZWZpeENsczogJ3JjLXRyZWUnLFxuICBzaG93TGluZTogZmFsc2UsXG4gIHNob3dJY29uOiB0cnVlLFxuICBzZWxlY3RhYmxlOiB0cnVlLFxuICBtdWx0aXBsZTogZmFsc2UsXG4gIGNoZWNrYWJsZTogZmFsc2UsXG4gIGRpc2FibGVkOiBmYWxzZSxcbiAgY2hlY2tTdHJpY3RseTogZmFsc2UsXG4gIGRyYWdnYWJsZTogZmFsc2UsXG4gIGRlZmF1bHRFeHBhbmRQYXJlbnQ6IHRydWUsXG4gIGF1dG9FeHBhbmRQYXJlbnQ6IGZhbHNlLFxuICBkZWZhdWx0RXhwYW5kQWxsOiBmYWxzZSxcbiAgZGVmYXVsdEV4cGFuZGVkS2V5czogW10sXG4gIGRlZmF1bHRDaGVja2VkS2V5czogW10sXG4gIGRlZmF1bHRTZWxlY3RlZEtleXM6IFtdLFxuICBkcm9wSW5kaWNhdG9yUmVuZGVyOiBEcm9wSW5kaWNhdG9yLFxuICBhbGxvd0Ryb3A6IGZ1bmN0aW9uIGFsbG93RHJvcCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcblRyZWUuVHJlZU5vZGUgPSBUcmVlTm9kZTtcbmV4cG9ydCBkZWZhdWx0IFRyZWU7IiwiaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eVwiO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVja1wiO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3NcIjtcbmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIjtcbmltcG9ydCBfaW5oZXJpdHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzXCI7XG5pbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlclwiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7IC8vIEB0cy1pZ25vcmVcblxuaW1wb3J0IHsgVHJlZUNvbnRleHQgfSBmcm9tICcuL2NvbnRleHRUeXBlcyc7XG5pbXBvcnQgeyBnZXREYXRhQW5kQXJpYSB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgSW5kZW50IGZyb20gJy4vSW5kZW50JztcbmltcG9ydCB7IGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YSB9IGZyb20gJy4vdXRpbHMvdHJlZVV0aWwnO1xudmFyIElDT05fT1BFTiA9ICdvcGVuJztcbnZhciBJQ09OX0NMT1NFID0gJ2Nsb3NlJztcbnZhciBkZWZhdWx0VGl0bGUgPSAnLS0tJztcblxudmFyIEludGVybmFsVHJlZU5vZGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKEludGVybmFsVHJlZU5vZGUsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoSW50ZXJuYWxUcmVlTm9kZSk7XG5cbiAgZnVuY3Rpb24gSW50ZXJuYWxUcmVlTm9kZSgpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW50ZXJuYWxUcmVlTm9kZSk7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgZHJhZ05vZGVIaWdobGlnaHQ6IGZhbHNlXG4gICAgfTtcblxuICAgIF90aGlzLm9uU2VsZWN0b3JDbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAvLyBDbGljayB0cmlnZ2VyIGJlZm9yZSBzZWxlY3QvY2hlY2sgb3BlcmF0aW9uXG4gICAgICB2YXIgb25Ob2RlQ2xpY2sgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZUNsaWNrO1xuICAgICAgb25Ob2RlQ2xpY2soZSwgY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKF90aGlzLnByb3BzKSk7XG5cbiAgICAgIGlmIChfdGhpcy5pc1NlbGVjdGFibGUoKSkge1xuICAgICAgICBfdGhpcy5vblNlbGVjdChlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLm9uQ2hlY2soZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLm9uU2VsZWN0b3JEb3VibGVDbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgb25Ob2RlRG91YmxlQ2xpY2sgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZURvdWJsZUNsaWNrO1xuICAgICAgb25Ob2RlRG91YmxlQ2xpY2soZSwgY29udmVydE5vZGVQcm9wc1RvRXZlbnREYXRhKF90aGlzLnByb3BzKSk7XG4gICAgfTtcblxuICAgIF90aGlzLm9uU2VsZWN0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmIChfdGhpcy5pc0Rpc2FibGVkKCkpIHJldHVybjtcbiAgICAgIHZhciBvbk5vZGVTZWxlY3QgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZVNlbGVjdDtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIG9uTm9kZVNlbGVjdChlLCBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEoX3RoaXMucHJvcHMpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMub25DaGVjayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoX3RoaXMuaXNEaXNhYmxlZCgpKSByZXR1cm47XG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBkaXNhYmxlQ2hlY2tib3ggPSBfdGhpcyRwcm9wcy5kaXNhYmxlQ2hlY2tib3gsXG4gICAgICAgICAgY2hlY2tlZCA9IF90aGlzJHByb3BzLmNoZWNrZWQ7XG4gICAgICB2YXIgb25Ob2RlQ2hlY2sgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZUNoZWNrO1xuICAgICAgaWYgKCFfdGhpcy5pc0NoZWNrYWJsZSgpIHx8IGRpc2FibGVDaGVja2JveCkgcmV0dXJuO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdmFyIHRhcmdldENoZWNrZWQgPSAhY2hlY2tlZDtcbiAgICAgIG9uTm9kZUNoZWNrKGUsIGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YShfdGhpcy5wcm9wcyksIHRhcmdldENoZWNrZWQpO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbk1vdXNlRW50ZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIG9uTm9kZU1vdXNlRW50ZXIgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZU1vdXNlRW50ZXI7XG4gICAgICBvbk5vZGVNb3VzZUVudGVyKGUsIGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YShfdGhpcy5wcm9wcykpO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbk1vdXNlTGVhdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIG9uTm9kZU1vdXNlTGVhdmUgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZU1vdXNlTGVhdmU7XG4gICAgICBvbk5vZGVNb3VzZUxlYXZlKGUsIGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YShfdGhpcy5wcm9wcykpO1xuICAgIH07XG5cbiAgICBfdGhpcy5vbkNvbnRleHRNZW51ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBvbk5vZGVDb250ZXh0TWVudSA9IF90aGlzLnByb3BzLmNvbnRleHQub25Ob2RlQ29udGV4dE1lbnU7XG4gICAgICBvbk5vZGVDb250ZXh0TWVudShlLCBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEoX3RoaXMucHJvcHMpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMub25EcmFnU3RhcnQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIG9uTm9kZURyYWdTdGFydCA9IF90aGlzLnByb3BzLmNvbnRleHQub25Ob2RlRHJhZ1N0YXJ0O1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICBkcmFnTm9kZUhpZ2hsaWdodDogdHJ1ZVxuICAgICAgfSk7XG5cbiAgICAgIG9uTm9kZURyYWdTdGFydChlLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIGllIHRocm93IGVycm9yXG4gICAgICAgIC8vIGZpcmVmb3gtbmVlZC1pdFxuICAgICAgICBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKCd0ZXh0L3BsYWluJywgJycpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHsvLyBlbXB0eVxuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5vbkRyYWdFbnRlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgb25Ob2RlRHJhZ0VudGVyID0gX3RoaXMucHJvcHMuY29udGV4dC5vbk5vZGVEcmFnRW50ZXI7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgb25Ob2RlRHJhZ0VudGVyKGUsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMub25EcmFnT3ZlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgb25Ob2RlRHJhZ092ZXIgPSBfdGhpcy5wcm9wcy5jb250ZXh0Lm9uTm9kZURyYWdPdmVyO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIG9uTm9kZURyYWdPdmVyKGUsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMub25EcmFnTGVhdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIG9uTm9kZURyYWdMZWF2ZSA9IF90aGlzLnByb3BzLmNvbnRleHQub25Ob2RlRHJhZ0xlYXZlO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIG9uTm9kZURyYWdMZWF2ZShlLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG4gICAgfTtcblxuICAgIF90aGlzLm9uRHJhZ0VuZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgb25Ob2RlRHJhZ0VuZCA9IF90aGlzLnByb3BzLmNvbnRleHQub25Ob2RlRHJhZ0VuZDtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZHJhZ05vZGVIaWdobGlnaHQ6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgb25Ob2RlRHJhZ0VuZChlLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG4gICAgfTtcblxuICAgIF90aGlzLm9uRHJvcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgb25Ob2RlRHJvcCA9IF90aGlzLnByb3BzLmNvbnRleHQub25Ob2RlRHJvcDtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZHJhZ05vZGVIaWdobGlnaHQ6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgb25Ob2RlRHJvcChlLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG4gICAgfTsgLy8gRGlzYWJsZWQgaXRlbSBzdGlsbCBjYW4gYmUgc3dpdGNoXG5cblxuICAgIF90aGlzLm9uRXhwYW5kID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBsb2FkaW5nID0gX3RoaXMkcHJvcHMyLmxvYWRpbmcsXG4gICAgICAgICAgb25Ob2RlRXhwYW5kID0gX3RoaXMkcHJvcHMyLmNvbnRleHQub25Ob2RlRXhwYW5kO1xuICAgICAgaWYgKGxvYWRpbmcpIHJldHVybjtcbiAgICAgIG9uTm9kZUV4cGFuZChlLCBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEoX3RoaXMucHJvcHMpKTtcbiAgICB9OyAvLyBEcmFnIHVzYWdlXG5cblxuICAgIF90aGlzLnNldFNlbGVjdEhhbmRsZSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICBfdGhpcy5zZWxlY3RIYW5kbGUgPSBub2RlO1xuICAgIH07XG5cbiAgICBfdGhpcy5nZXROb2RlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZXhwYW5kZWQgPSBfdGhpcy5wcm9wcy5leHBhbmRlZDtcblxuICAgICAgaWYgKF90aGlzLmlzTGVhZigpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZXhwYW5kZWQgPyBJQ09OX09QRU4gOiBJQ09OX0NMT1NFO1xuICAgIH07XG5cbiAgICBfdGhpcy5oYXNDaGlsZHJlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBldmVudEtleSA9IF90aGlzLnByb3BzLmV2ZW50S2V5O1xuICAgICAgdmFyIGtleUVudGl0aWVzID0gX3RoaXMucHJvcHMuY29udGV4dC5rZXlFbnRpdGllcztcblxuICAgICAgdmFyIF9yZWYgPSBrZXlFbnRpdGllc1tldmVudEtleV0gfHwge30sXG4gICAgICAgICAgY2hpbGRyZW4gPSBfcmVmLmNoaWxkcmVuO1xuXG4gICAgICByZXR1cm4gISEoY2hpbGRyZW4gfHwgW10pLmxlbmd0aDtcbiAgICB9O1xuXG4gICAgX3RoaXMuaXNMZWFmID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIGlzTGVhZiA9IF90aGlzJHByb3BzMy5pc0xlYWYsXG4gICAgICAgICAgbG9hZGVkID0gX3RoaXMkcHJvcHMzLmxvYWRlZDtcbiAgICAgIHZhciBsb2FkRGF0YSA9IF90aGlzLnByb3BzLmNvbnRleHQubG9hZERhdGE7XG5cbiAgICAgIHZhciBoYXNDaGlsZHJlbiA9IF90aGlzLmhhc0NoaWxkcmVuKCk7XG5cbiAgICAgIGlmIChpc0xlYWYgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGlzTGVhZiB8fCAhbG9hZERhdGEgJiYgIWhhc0NoaWxkcmVuIHx8IGxvYWREYXRhICYmIGxvYWRlZCAmJiAhaGFzQ2hpbGRyZW47XG4gICAgfTtcblxuICAgIF90aGlzLmlzRGlzYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGlzYWJsZWQgPSBfdGhpcy5wcm9wcy5kaXNhYmxlZDtcbiAgICAgIHZhciB0cmVlRGlzYWJsZWQgPSBfdGhpcy5wcm9wcy5jb250ZXh0LmRpc2FibGVkO1xuICAgICAgcmV0dXJuICEhKHRyZWVEaXNhYmxlZCB8fCBkaXNhYmxlZCk7XG4gICAgfTtcblxuICAgIF90aGlzLmlzQ2hlY2thYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGNoZWNrYWJsZSA9IF90aGlzLnByb3BzLmNoZWNrYWJsZTtcbiAgICAgIHZhciB0cmVlQ2hlY2thYmxlID0gX3RoaXMucHJvcHMuY29udGV4dC5jaGVja2FibGU7IC8vIFJldHVybiBmYWxzZSBpZiB0cmVlIG9yIHRyZWVOb2RlIGlzIG5vdCBjaGVja2FibGVcblxuICAgICAgaWYgKCF0cmVlQ2hlY2thYmxlIHx8IGNoZWNrYWJsZSA9PT0gZmFsc2UpIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiB0cmVlQ2hlY2thYmxlO1xuICAgIH07IC8vIExvYWQgZGF0YSB0byBhdm9pZCBkZWZhdWx0IGV4cGFuZGVkIHRyZWUgd2l0aG91dCBkYXRhXG5cblxuICAgIF90aGlzLnN5bmNMb2FkRGF0YSA9IGZ1bmN0aW9uIChwcm9wcykge1xuICAgICAgdmFyIGV4cGFuZGVkID0gcHJvcHMuZXhwYW5kZWQsXG4gICAgICAgICAgbG9hZGluZyA9IHByb3BzLmxvYWRpbmcsXG4gICAgICAgICAgbG9hZGVkID0gcHJvcHMubG9hZGVkO1xuICAgICAgdmFyIF90aGlzJHByb3BzJGNvbnRleHQgPSBfdGhpcy5wcm9wcy5jb250ZXh0LFxuICAgICAgICAgIGxvYWREYXRhID0gX3RoaXMkcHJvcHMkY29udGV4dC5sb2FkRGF0YSxcbiAgICAgICAgICBvbk5vZGVMb2FkID0gX3RoaXMkcHJvcHMkY29udGV4dC5vbk5vZGVMb2FkO1xuICAgICAgaWYgKGxvYWRpbmcpIHJldHVybjsgLy8gcmVhZCBmcm9tIHN0YXRlIHRvIGF2b2lkIGxvYWREYXRhIGF0IHNhbWUgdGltZVxuXG4gICAgICBpZiAobG9hZERhdGEgJiYgZXhwYW5kZWQgJiYgIV90aGlzLmlzTGVhZigpKSB7XG4gICAgICAgIC8vIFdlIG5lZWRuJ3QgcmVsb2FkIGRhdGEgd2hlbiBoYXMgY2hpbGRyZW4gaW4gc3luYyBsb2dpY1xuICAgICAgICAvLyBJdCdzIG9ubHkgbmVlZGVkIGluIG5vZGUgZXhwYW5kZWRcbiAgICAgICAgaWYgKCFfdGhpcy5oYXNDaGlsZHJlbigpICYmICFsb2FkZWQpIHtcbiAgICAgICAgICBvbk5vZGVMb2FkKGNvbnZlcnROb2RlUHJvcHNUb0V2ZW50RGF0YShfdGhpcy5wcm9wcykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLnJlbmRlclN3aXRjaGVySWNvbkRvbSA9IGZ1bmN0aW9uIChpc0xlYWYpIHtcbiAgICAgIHZhciBzd2l0Y2hlckljb25Gcm9tUHJvcHMgPSBfdGhpcy5wcm9wcy5zd2l0Y2hlckljb247XG4gICAgICB2YXIgc3dpdGNoZXJJY29uRnJvbUN0eCA9IF90aGlzLnByb3BzLmNvbnRleHQuc3dpdGNoZXJJY29uO1xuICAgICAgdmFyIHN3aXRjaGVySWNvbiA9IHN3aXRjaGVySWNvbkZyb21Qcm9wcyB8fCBzd2l0Y2hlckljb25Gcm9tQ3R4OyAvLyBpZiBzd2l0Y2hlckljb25Eb20gaXMgbnVsbCwgbm8gcmVuZGVyIHN3aXRjaGVyIHNwYW5cblxuICAgICAgaWYgKHR5cGVvZiBzd2l0Y2hlckljb24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHN3aXRjaGVySWNvbihfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIF90aGlzLnByb3BzKSwge30sIHtcbiAgICAgICAgICBpc0xlYWY6IGlzTGVhZlxuICAgICAgICB9KSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzd2l0Y2hlckljb247XG4gICAgfTsgLy8gU3dpdGNoZXJcblxuXG4gICAgX3RoaXMucmVuZGVyU3dpdGNoZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZXhwYW5kZWQgPSBfdGhpcy5wcm9wcy5leHBhbmRlZDtcbiAgICAgIHZhciBwcmVmaXhDbHMgPSBfdGhpcy5wcm9wcy5jb250ZXh0LnByZWZpeENscztcblxuICAgICAgaWYgKF90aGlzLmlzTGVhZigpKSB7XG4gICAgICAgIC8vIGlmIHN3aXRjaGVySWNvbkRvbSBpcyBudWxsLCBubyByZW5kZXIgc3dpdGNoZXIgc3BhblxuICAgICAgICB2YXIgX3N3aXRjaGVySWNvbkRvbSA9IF90aGlzLnJlbmRlclN3aXRjaGVySWNvbkRvbSh0cnVlKTtcblxuICAgICAgICByZXR1cm4gX3N3aXRjaGVySWNvbkRvbSAhPT0gZmFsc2UgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXN3aXRjaGVyXCIpLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXN3aXRjaGVyLW5vb3BcIikpXG4gICAgICAgIH0sIF9zd2l0Y2hlckljb25Eb20pIDogbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIHN3aXRjaGVyQ2xzID0gY2xhc3NOYW1lcyhcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXN3aXRjaGVyXCIpLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXN3aXRjaGVyX1wiKS5jb25jYXQoZXhwYW5kZWQgPyBJQ09OX09QRU4gOiBJQ09OX0NMT1NFKSk7XG5cbiAgICAgIHZhciBzd2l0Y2hlckljb25Eb20gPSBfdGhpcy5yZW5kZXJTd2l0Y2hlckljb25Eb20oZmFsc2UpO1xuXG4gICAgICByZXR1cm4gc3dpdGNoZXJJY29uRG9tICE9PSBmYWxzZSA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7XG4gICAgICAgIG9uQ2xpY2s6IF90aGlzLm9uRXhwYW5kLFxuICAgICAgICBjbGFzc05hbWU6IHN3aXRjaGVyQ2xzXG4gICAgICB9LCBzd2l0Y2hlckljb25Eb20pIDogbnVsbDtcbiAgICB9OyAvLyBDaGVja2JveFxuXG5cbiAgICBfdGhpcy5yZW5kZXJDaGVja2JveCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczQgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBjaGVja2VkID0gX3RoaXMkcHJvcHM0LmNoZWNrZWQsXG4gICAgICAgICAgaGFsZkNoZWNrZWQgPSBfdGhpcyRwcm9wczQuaGFsZkNoZWNrZWQsXG4gICAgICAgICAgZGlzYWJsZUNoZWNrYm94ID0gX3RoaXMkcHJvcHM0LmRpc2FibGVDaGVja2JveDtcbiAgICAgIHZhciBwcmVmaXhDbHMgPSBfdGhpcy5wcm9wcy5jb250ZXh0LnByZWZpeENscztcblxuICAgICAgdmFyIGRpc2FibGVkID0gX3RoaXMuaXNEaXNhYmxlZCgpO1xuXG4gICAgICB2YXIgY2hlY2thYmxlID0gX3RoaXMuaXNDaGVja2FibGUoKTtcblxuICAgICAgaWYgKCFjaGVja2FibGUpIHJldHVybiBudWxsOyAvLyBbTGVnYWN5XSBDdXN0b20gZWxlbWVudCBzaG91bGQgYmUgc2VwYXJhdGUgd2l0aCBgY2hlY2thYmxlYCBpbiBmdXR1cmVcblxuICAgICAgdmFyICRjdXN0b20gPSB0eXBlb2YgY2hlY2thYmxlICE9PSAnYm9vbGVhbicgPyBjaGVja2FibGUgOiBudWxsO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWNoZWNrYm94XCIpLCBjaGVja2VkICYmIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItY2hlY2tib3gtY2hlY2tlZFwiKSwgIWNoZWNrZWQgJiYgaGFsZkNoZWNrZWQgJiYgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1jaGVja2JveC1pbmRldGVybWluYXRlXCIpLCAoZGlzYWJsZWQgfHwgZGlzYWJsZUNoZWNrYm94KSAmJiBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWNoZWNrYm94LWRpc2FibGVkXCIpKSxcbiAgICAgICAgb25DbGljazogX3RoaXMub25DaGVja1xuICAgICAgfSwgJGN1c3RvbSk7XG4gICAgfTtcblxuICAgIF90aGlzLnJlbmRlckljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbG9hZGluZyA9IF90aGlzLnByb3BzLmxvYWRpbmc7XG4gICAgICB2YXIgcHJlZml4Q2xzID0gX3RoaXMucHJvcHMuY29udGV4dC5wcmVmaXhDbHM7XG4gICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVzKFwiXCIuY29uY2F0KHByZWZpeENscywgXCItaWNvbkVsZVwiKSwgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1pY29uX19cIikuY29uY2F0KF90aGlzLmdldE5vZGVTdGF0ZSgpIHx8ICdkb2N1JyksIGxvYWRpbmcgJiYgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1pY29uX2xvYWRpbmdcIikpXG4gICAgICB9KTtcbiAgICB9OyAvLyBJY29uICsgVGl0bGVcblxuXG4gICAgX3RoaXMucmVuZGVyU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZHJhZ05vZGVIaWdobGlnaHQgPSBfdGhpcy5zdGF0ZS5kcmFnTm9kZUhpZ2hsaWdodDtcbiAgICAgIHZhciBfdGhpcyRwcm9wczUgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICB0aXRsZSA9IF90aGlzJHByb3BzNS50aXRsZSxcbiAgICAgICAgICBzZWxlY3RlZCA9IF90aGlzJHByb3BzNS5zZWxlY3RlZCxcbiAgICAgICAgICBpY29uID0gX3RoaXMkcHJvcHM1Lmljb24sXG4gICAgICAgICAgbG9hZGluZyA9IF90aGlzJHByb3BzNS5sb2FkaW5nLFxuICAgICAgICAgIGRhdGEgPSBfdGhpcyRwcm9wczUuZGF0YTtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyRjb250ZXh0MiA9IF90aGlzLnByb3BzLmNvbnRleHQsXG4gICAgICAgICAgcHJlZml4Q2xzID0gX3RoaXMkcHJvcHMkY29udGV4dDIucHJlZml4Q2xzLFxuICAgICAgICAgIHNob3dJY29uID0gX3RoaXMkcHJvcHMkY29udGV4dDIuc2hvd0ljb24sXG4gICAgICAgICAgdHJlZUljb24gPSBfdGhpcyRwcm9wcyRjb250ZXh0Mi5pY29uLFxuICAgICAgICAgIGRyYWdnYWJsZSA9IF90aGlzJHByb3BzJGNvbnRleHQyLmRyYWdnYWJsZSxcbiAgICAgICAgICBsb2FkRGF0YSA9IF90aGlzJHByb3BzJGNvbnRleHQyLmxvYWREYXRhLFxuICAgICAgICAgIHRpdGxlUmVuZGVyID0gX3RoaXMkcHJvcHMkY29udGV4dDIudGl0bGVSZW5kZXI7XG5cbiAgICAgIHZhciBkaXNhYmxlZCA9IF90aGlzLmlzRGlzYWJsZWQoKTtcblxuICAgICAgdmFyIG1lcmdlZERyYWdnYWJsZSA9IHR5cGVvZiBkcmFnZ2FibGUgPT09ICdmdW5jdGlvbicgPyBkcmFnZ2FibGUoZGF0YSkgOiBkcmFnZ2FibGU7XG4gICAgICB2YXIgd3JhcENsYXNzID0gXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1ub2RlLWNvbnRlbnQtd3JhcHBlclwiKTsgLy8gSWNvbiAtIFN0aWxsIHNob3cgbG9hZGluZyBpY29uIHdoZW4gbG9hZGluZyB3aXRob3V0IHNob3dJY29uXG5cbiAgICAgIHZhciAkaWNvbjtcblxuICAgICAgaWYgKHNob3dJY29uKSB7XG4gICAgICAgIHZhciBjdXJyZW50SWNvbiA9IGljb24gfHwgdHJlZUljb247XG4gICAgICAgICRpY29uID0gY3VycmVudEljb24gPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWljb25FbGVcIiksIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItaWNvbl9fY3VzdG9taXplXCIpKVxuICAgICAgICB9LCB0eXBlb2YgY3VycmVudEljb24gPT09ICdmdW5jdGlvbicgPyBjdXJyZW50SWNvbihfdGhpcy5wcm9wcykgOiBjdXJyZW50SWNvbikgOiBfdGhpcy5yZW5kZXJJY29uKCk7XG4gICAgICB9IGVsc2UgaWYgKGxvYWREYXRhICYmIGxvYWRpbmcpIHtcbiAgICAgICAgJGljb24gPSBfdGhpcy5yZW5kZXJJY29uKCk7XG4gICAgICB9IC8vIFRpdGxlXG5cblxuICAgICAgdmFyIHRpdGxlTm9kZTtcblxuICAgICAgaWYgKHR5cGVvZiB0aXRsZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aXRsZU5vZGUgPSB0aXRsZShkYXRhKTtcbiAgICAgIH0gZWxzZSBpZiAodGl0bGVSZW5kZXIpIHtcbiAgICAgICAgdGl0bGVOb2RlID0gdGl0bGVSZW5kZXIoZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aXRsZU5vZGUgPSB0aXRsZTtcbiAgICAgIH1cblxuICAgICAgdmFyICR0aXRsZSA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7XG4gICAgICAgIGNsYXNzTmFtZTogXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi10aXRsZVwiKVxuICAgICAgfSwgdGl0bGVOb2RlKTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge1xuICAgICAgICByZWY6IF90aGlzLnNldFNlbGVjdEhhbmRsZSxcbiAgICAgICAgdGl0bGU6IHR5cGVvZiB0aXRsZSA9PT0gJ3N0cmluZycgPyB0aXRsZSA6ICcnLFxuICAgICAgICBjbGFzc05hbWU6IGNsYXNzTmFtZXMoXCJcIi5jb25jYXQod3JhcENsYXNzKSwgXCJcIi5jb25jYXQod3JhcENsYXNzLCBcIi1cIikuY29uY2F0KF90aGlzLmdldE5vZGVTdGF0ZSgpIHx8ICdub3JtYWwnKSwgIWRpc2FibGVkICYmIChzZWxlY3RlZCB8fCBkcmFnTm9kZUhpZ2hsaWdodCkgJiYgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1ub2RlLXNlbGVjdGVkXCIpLCAhZGlzYWJsZWQgJiYgbWVyZ2VkRHJhZ2dhYmxlICYmICdkcmFnZ2FibGUnKSxcbiAgICAgICAgZHJhZ2dhYmxlOiAhZGlzYWJsZWQgJiYgbWVyZ2VkRHJhZ2dhYmxlIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgXCJhcmlhLWdyYWJiZWRcIjogIWRpc2FibGVkICYmIG1lcmdlZERyYWdnYWJsZSB8fCB1bmRlZmluZWQsXG4gICAgICAgIG9uTW91c2VFbnRlcjogX3RoaXMub25Nb3VzZUVudGVyLFxuICAgICAgICBvbk1vdXNlTGVhdmU6IF90aGlzLm9uTW91c2VMZWF2ZSxcbiAgICAgICAgb25Db250ZXh0TWVudTogX3RoaXMub25Db250ZXh0TWVudSxcbiAgICAgICAgb25DbGljazogX3RoaXMub25TZWxlY3RvckNsaWNrLFxuICAgICAgICBvbkRvdWJsZUNsaWNrOiBfdGhpcy5vblNlbGVjdG9yRG91YmxlQ2xpY2ssXG4gICAgICAgIG9uRHJhZ1N0YXJ0OiBtZXJnZWREcmFnZ2FibGUgPyBfdGhpcy5vbkRyYWdTdGFydCA6IHVuZGVmaW5lZFxuICAgICAgfSwgJGljb24sICR0aXRsZSwgX3RoaXMucmVuZGVyRHJvcEluZGljYXRvcigpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMucmVuZGVyRHJvcEluZGljYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wczYgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBkaXNhYmxlZCA9IF90aGlzJHByb3BzNi5kaXNhYmxlZCxcbiAgICAgICAgICBldmVudEtleSA9IF90aGlzJHByb3BzNi5ldmVudEtleTtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyRjb250ZXh0MyA9IF90aGlzLnByb3BzLmNvbnRleHQsXG4gICAgICAgICAgZHJhZ2dhYmxlID0gX3RoaXMkcHJvcHMkY29udGV4dDMuZHJhZ2dhYmxlLFxuICAgICAgICAgIGRyb3BMZXZlbE9mZnNldCA9IF90aGlzJHByb3BzJGNvbnRleHQzLmRyb3BMZXZlbE9mZnNldCxcbiAgICAgICAgICBkcm9wUG9zaXRpb24gPSBfdGhpcyRwcm9wcyRjb250ZXh0My5kcm9wUG9zaXRpb24sXG4gICAgICAgICAgcHJlZml4Q2xzID0gX3RoaXMkcHJvcHMkY29udGV4dDMucHJlZml4Q2xzLFxuICAgICAgICAgIGluZGVudCA9IF90aGlzJHByb3BzJGNvbnRleHQzLmluZGVudCxcbiAgICAgICAgICBkcm9wSW5kaWNhdG9yUmVuZGVyID0gX3RoaXMkcHJvcHMkY29udGV4dDMuZHJvcEluZGljYXRvclJlbmRlcixcbiAgICAgICAgICBkcmFnT3Zlck5vZGVLZXkgPSBfdGhpcyRwcm9wcyRjb250ZXh0My5kcmFnT3Zlck5vZGVLZXksXG4gICAgICAgICAgZGlyZWN0aW9uID0gX3RoaXMkcHJvcHMkY29udGV4dDMuZGlyZWN0aW9uO1xuICAgICAgdmFyIG1lcmdlZERyYWdnYWJsZSA9IGRyYWdnYWJsZSAhPT0gZmFsc2U7IC8vIGFsbG93RHJvcCBpcyBjYWxjdWxhdGVkIGluIFRyZWUudHN4LCB0aGVyZSBpcyBubyBuZWVkIGZvciBjYWxjIGl0IGhlcmVcblxuICAgICAgdmFyIHNob3dJbmRpY2F0b3IgPSAhZGlzYWJsZWQgJiYgbWVyZ2VkRHJhZ2dhYmxlICYmIGRyYWdPdmVyTm9kZUtleSA9PT0gZXZlbnRLZXk7XG4gICAgICByZXR1cm4gc2hvd0luZGljYXRvciA/IGRyb3BJbmRpY2F0b3JSZW5kZXIoe1xuICAgICAgICBkcm9wUG9zaXRpb246IGRyb3BQb3NpdGlvbixcbiAgICAgICAgZHJvcExldmVsT2Zmc2V0OiBkcm9wTGV2ZWxPZmZzZXQsXG4gICAgICAgIGluZGVudDogaW5kZW50LFxuICAgICAgICBwcmVmaXhDbHM6IHByZWZpeENscyxcbiAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb25cbiAgICAgIH0pIDogbnVsbDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9IC8vIElzb21vcnBoaWMgbmVlZG4ndCBsb2FkIGRhdGEgaW4gc2VydmVyIHNpZGVcblxuXG4gIF9jcmVhdGVDbGFzcyhJbnRlcm5hbFRyZWVOb2RlLCBbe1xuICAgIGtleTogXCJjb21wb25lbnREaWRNb3VudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgIHRoaXMuc3luY0xvYWREYXRhKHRoaXMucHJvcHMpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjb21wb25lbnREaWRVcGRhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgdGhpcy5zeW5jTG9hZERhdGEodGhpcy5wcm9wcyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImlzU2VsZWN0YWJsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc1NlbGVjdGFibGUoKSB7XG4gICAgICB2YXIgc2VsZWN0YWJsZSA9IHRoaXMucHJvcHMuc2VsZWN0YWJsZTtcbiAgICAgIHZhciB0cmVlU2VsZWN0YWJsZSA9IHRoaXMucHJvcHMuY29udGV4dC5zZWxlY3RhYmxlOyAvLyBJZ25vcmUgd2hlbiBzZWxlY3RhYmxlIGlzIHVuZGVmaW5lZCBvciBudWxsXG5cbiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0YWJsZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHJldHVybiBzZWxlY3RhYmxlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJlZVNlbGVjdGFibGU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX2NsYXNzTmFtZXM7XG5cbiAgICAgIHZhciBfdGhpcyRwcm9wczcgPSB0aGlzLnByb3BzLFxuICAgICAgICAgIGV2ZW50S2V5ID0gX3RoaXMkcHJvcHM3LmV2ZW50S2V5LFxuICAgICAgICAgIGNsYXNzTmFtZSA9IF90aGlzJHByb3BzNy5jbGFzc05hbWUsXG4gICAgICAgICAgc3R5bGUgPSBfdGhpcyRwcm9wczcuc3R5bGUsXG4gICAgICAgICAgZHJhZ092ZXIgPSBfdGhpcyRwcm9wczcuZHJhZ092ZXIsXG4gICAgICAgICAgZHJhZ092ZXJHYXBUb3AgPSBfdGhpcyRwcm9wczcuZHJhZ092ZXJHYXBUb3AsXG4gICAgICAgICAgZHJhZ092ZXJHYXBCb3R0b20gPSBfdGhpcyRwcm9wczcuZHJhZ092ZXJHYXBCb3R0b20sXG4gICAgICAgICAgaXNMZWFmID0gX3RoaXMkcHJvcHM3LmlzTGVhZixcbiAgICAgICAgICBpc1N0YXJ0ID0gX3RoaXMkcHJvcHM3LmlzU3RhcnQsXG4gICAgICAgICAgaXNFbmQgPSBfdGhpcyRwcm9wczcuaXNFbmQsXG4gICAgICAgICAgZXhwYW5kZWQgPSBfdGhpcyRwcm9wczcuZXhwYW5kZWQsXG4gICAgICAgICAgc2VsZWN0ZWQgPSBfdGhpcyRwcm9wczcuc2VsZWN0ZWQsXG4gICAgICAgICAgY2hlY2tlZCA9IF90aGlzJHByb3BzNy5jaGVja2VkLFxuICAgICAgICAgIGhhbGZDaGVja2VkID0gX3RoaXMkcHJvcHM3LmhhbGZDaGVja2VkLFxuICAgICAgICAgIGxvYWRpbmcgPSBfdGhpcyRwcm9wczcubG9hZGluZyxcbiAgICAgICAgICBkb21SZWYgPSBfdGhpcyRwcm9wczcuZG9tUmVmLFxuICAgICAgICAgIGFjdGl2ZSA9IF90aGlzJHByb3BzNy5hY3RpdmUsXG4gICAgICAgICAgZGF0YSA9IF90aGlzJHByb3BzNy5kYXRhLFxuICAgICAgICAgIG9uTW91c2VNb3ZlID0gX3RoaXMkcHJvcHM3Lm9uTW91c2VNb3ZlLFxuICAgICAgICAgIG90aGVyUHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3RoaXMkcHJvcHM3LCBbXCJldmVudEtleVwiLCBcImNsYXNzTmFtZVwiLCBcInN0eWxlXCIsIFwiZHJhZ092ZXJcIiwgXCJkcmFnT3ZlckdhcFRvcFwiLCBcImRyYWdPdmVyR2FwQm90dG9tXCIsIFwiaXNMZWFmXCIsIFwiaXNTdGFydFwiLCBcImlzRW5kXCIsIFwiZXhwYW5kZWRcIiwgXCJzZWxlY3RlZFwiLCBcImNoZWNrZWRcIiwgXCJoYWxmQ2hlY2tlZFwiLCBcImxvYWRpbmdcIiwgXCJkb21SZWZcIiwgXCJhY3RpdmVcIiwgXCJkYXRhXCIsIFwib25Nb3VzZU1vdmVcIl0pO1xuXG4gICAgICB2YXIgX3RoaXMkcHJvcHMkY29udGV4dDQgPSB0aGlzLnByb3BzLmNvbnRleHQsXG4gICAgICAgICAgcHJlZml4Q2xzID0gX3RoaXMkcHJvcHMkY29udGV4dDQucHJlZml4Q2xzLFxuICAgICAgICAgIGZpbHRlclRyZWVOb2RlID0gX3RoaXMkcHJvcHMkY29udGV4dDQuZmlsdGVyVHJlZU5vZGUsXG4gICAgICAgICAgZHJhZ2dhYmxlID0gX3RoaXMkcHJvcHMkY29udGV4dDQuZHJhZ2dhYmxlLFxuICAgICAgICAgIGtleUVudGl0aWVzID0gX3RoaXMkcHJvcHMkY29udGV4dDQua2V5RW50aXRpZXMsXG4gICAgICAgICAgZHJvcENvbnRhaW5lcktleSA9IF90aGlzJHByb3BzJGNvbnRleHQ0LmRyb3BDb250YWluZXJLZXksXG4gICAgICAgICAgZHJvcFRhcmdldEtleSA9IF90aGlzJHByb3BzJGNvbnRleHQ0LmRyb3BUYXJnZXRLZXk7XG4gICAgICB2YXIgZGlzYWJsZWQgPSB0aGlzLmlzRGlzYWJsZWQoKTtcbiAgICAgIHZhciBkYXRhT3JBcmlhQXR0cmlidXRlUHJvcHMgPSBnZXREYXRhQW5kQXJpYShvdGhlclByb3BzKTtcblxuICAgICAgdmFyIF9yZWYyID0ga2V5RW50aXRpZXNbZXZlbnRLZXldIHx8IHt9LFxuICAgICAgICAgIGxldmVsID0gX3JlZjIubGV2ZWw7XG5cbiAgICAgIHZhciBpc0VuZE5vZGUgPSBpc0VuZFtpc0VuZC5sZW5ndGggLSAxXTtcbiAgICAgIHZhciBtZXJnZWREcmFnZ2FibGUgPSB0eXBlb2YgZHJhZ2dhYmxlID09PSAnZnVuY3Rpb24nID8gZHJhZ2dhYmxlKGRhdGEpIDogZHJhZ2dhYmxlO1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIF9leHRlbmRzKHtcbiAgICAgICAgcmVmOiBkb21SZWYsXG4gICAgICAgIGNsYXNzTmFtZTogY2xhc3NOYW1lcyhjbGFzc05hbWUsIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItdHJlZW5vZGVcIiksIChfY2xhc3NOYW1lcyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzTmFtZXMsIFwiXCIuY29uY2F0KHByZWZpeENscywgXCItdHJlZW5vZGUtZGlzYWJsZWRcIiksIGRpc2FibGVkKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLXN3aXRjaGVyLVwiKS5jb25jYXQoZXhwYW5kZWQgPyAnb3BlbicgOiAnY2xvc2UnKSwgIWlzTGVhZiksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi10cmVlbm9kZS1jaGVja2JveC1jaGVja2VkXCIpLCBjaGVja2VkKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLWNoZWNrYm94LWluZGV0ZXJtaW5hdGVcIiksIGhhbGZDaGVja2VkKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLXNlbGVjdGVkXCIpLCBzZWxlY3RlZCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi10cmVlbm9kZS1sb2FkaW5nXCIpLCBsb2FkaW5nKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLWFjdGl2ZVwiKSwgYWN0aXZlKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLXRyZWVub2RlLWxlYWYtbGFzdFwiKSwgaXNFbmROb2RlKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCAnZHJvcC10YXJnZXQnLCBkcm9wVGFyZ2V0S2V5ID09PSBldmVudEtleSksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgJ2Ryb3AtY29udGFpbmVyJywgZHJvcENvbnRhaW5lcktleSA9PT0gZXZlbnRLZXkpLCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzTmFtZXMsICdkcmFnLW92ZXInLCAhZGlzYWJsZWQgJiYgZHJhZ092ZXIpLCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzTmFtZXMsICdkcmFnLW92ZXItZ2FwLXRvcCcsICFkaXNhYmxlZCAmJiBkcmFnT3ZlckdhcFRvcCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgJ2RyYWctb3Zlci1nYXAtYm90dG9tJywgIWRpc2FibGVkICYmIGRyYWdPdmVyR2FwQm90dG9tKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCAnZmlsdGVyLW5vZGUnLCBmaWx0ZXJUcmVlTm9kZSAmJiBmaWx0ZXJUcmVlTm9kZShjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEodGhpcy5wcm9wcykpKSwgX2NsYXNzTmFtZXMpKSxcbiAgICAgICAgc3R5bGU6IHN0eWxlLFxuICAgICAgICBvbkRyYWdFbnRlcjogbWVyZ2VkRHJhZ2dhYmxlID8gdGhpcy5vbkRyYWdFbnRlciA6IHVuZGVmaW5lZCxcbiAgICAgICAgb25EcmFnT3ZlcjogbWVyZ2VkRHJhZ2dhYmxlID8gdGhpcy5vbkRyYWdPdmVyIDogdW5kZWZpbmVkLFxuICAgICAgICBvbkRyYWdMZWF2ZTogbWVyZ2VkRHJhZ2dhYmxlID8gdGhpcy5vbkRyYWdMZWF2ZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgb25Ecm9wOiBtZXJnZWREcmFnZ2FibGUgPyB0aGlzLm9uRHJvcCA6IHVuZGVmaW5lZCxcbiAgICAgICAgb25EcmFnRW5kOiBtZXJnZWREcmFnZ2FibGUgPyB0aGlzLm9uRHJhZ0VuZCA6IHVuZGVmaW5lZCxcbiAgICAgICAgb25Nb3VzZU1vdmU6IG9uTW91c2VNb3ZlXG4gICAgICB9LCBkYXRhT3JBcmlhQXR0cmlidXRlUHJvcHMpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChJbmRlbnQsIHtcbiAgICAgICAgcHJlZml4Q2xzOiBwcmVmaXhDbHMsXG4gICAgICAgIGxldmVsOiBsZXZlbCxcbiAgICAgICAgaXNTdGFydDogaXNTdGFydCxcbiAgICAgICAgaXNFbmQ6IGlzRW5kXG4gICAgICB9KSwgdGhpcy5yZW5kZXJTd2l0Y2hlcigpLCB0aGlzLnJlbmRlckNoZWNrYm94KCksIHRoaXMucmVuZGVyU2VsZWN0b3IoKSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEludGVybmFsVHJlZU5vZGU7XG59KFJlYWN0LkNvbXBvbmVudCk7XG5cbnZhciBDb250ZXh0VHJlZU5vZGUgPSBmdW5jdGlvbiBDb250ZXh0VHJlZU5vZGUocHJvcHMpIHtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyZWVDb250ZXh0LkNvbnN1bWVyLCBudWxsLCBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChJbnRlcm5hbFRyZWVOb2RlLCBfZXh0ZW5kcyh7fSwgcHJvcHMsIHtcbiAgICAgIGNvbnRleHQ6IGNvbnRleHRcbiAgICB9KSk7XG4gIH0pO1xufTtcblxuQ29udGV4dFRyZWVOb2RlLmRpc3BsYXlOYW1lID0gJ1RyZWVOb2RlJztcbkNvbnRleHRUcmVlTm9kZS5kZWZhdWx0UHJvcHMgPSB7XG4gIHRpdGxlOiBkZWZhdWx0VGl0bGVcbn07XG5Db250ZXh0VHJlZU5vZGUuaXNUcmVlTm9kZSA9IDE7XG5leHBvcnQgeyBJbnRlcm5hbFRyZWVOb2RlIH07XG5leHBvcnQgZGVmYXVsdCBDb250ZXh0VHJlZU5vZGU7IiwiLyoqXG4gKiBXZWJwYWNrIGhhcyBidWcgZm9yIGltcG9ydCBsb29wLCB3aGljaCBpcyBub3QgdGhlIHNhbWUgYmVoYXZpb3IgYXMgRVMgbW9kdWxlLlxuICogV2hlbiB1dGlsLmpzIGltcG9ydHMgdGhlIFRyZWVOb2RlIGZvciB0cmVlIGdlbmVyYXRlIHdpbGwgY2F1c2UgdHJlZUNvbnRleHRUeXBlcyBiZSBlbXB0eS5cbiAqL1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuZXhwb3J0IHZhciBUcmVlQ29udGV4dCA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVDb250ZXh0KG51bGwpOyIsImltcG9ydCBUcmVlIGZyb20gJy4vVHJlZSc7XG5pbXBvcnQgVHJlZU5vZGUgZnJvbSAnLi9UcmVlTm9kZSc7XG5leHBvcnQgeyBUcmVlTm9kZSB9O1xuZXhwb3J0IGRlZmF1bHQgVHJlZTsiLCJpbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheVwiO1xuaW1wb3J0IF90eXBlb2YgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZlwiO1xuaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0V2l0aG91dFByb3BlcnRpZXNcIjtcblxuLyogZXNsaW50LWRpc2FibGUgbm8tbG9uZWx5LWlmICovXG5cbi8qKlxuICogTGVnYWN5IGNvZGUuIFNob3VsZCBhdm9pZCB0byB1c2UgaWYgeW91IGFyZSBuZXcgdG8gaW1wb3J0IHRoZXNlIGNvZGUuXG4gKi9cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgd2FybmluZyBmcm9tIFwicmMtdXRpbC9lcy93YXJuaW5nXCI7XG5pbXBvcnQgVHJlZU5vZGUgZnJvbSAnLi9UcmVlTm9kZSc7XG5leHBvcnQgZnVuY3Rpb24gYXJyRGVsKGxpc3QsIHZhbHVlKSB7XG4gIHZhciBjbG9uZSA9IGxpc3Quc2xpY2UoKTtcbiAgdmFyIGluZGV4ID0gY2xvbmUuaW5kZXhPZih2YWx1ZSk7XG5cbiAgaWYgKGluZGV4ID49IDApIHtcbiAgICBjbG9uZS5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG5cbiAgcmV0dXJuIGNsb25lO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFyckFkZChsaXN0LCB2YWx1ZSkge1xuICB2YXIgY2xvbmUgPSBsaXN0LnNsaWNlKCk7XG5cbiAgaWYgKGNsb25lLmluZGV4T2YodmFsdWUpID09PSAtMSkge1xuICAgIGNsb25lLnB1c2godmFsdWUpO1xuICB9XG5cbiAgcmV0dXJuIGNsb25lO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHBvc1RvQXJyKHBvcykge1xuICByZXR1cm4gcG9zLnNwbGl0KCctJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9zaXRpb24obGV2ZWwsIGluZGV4KSB7XG4gIHJldHVybiBcIlwiLmNvbmNhdChsZXZlbCwgXCItXCIpLmNvbmNhdChpbmRleCk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNUcmVlTm9kZShub2RlKSB7XG4gIHJldHVybiBub2RlICYmIG5vZGUudHlwZSAmJiBub2RlLnR5cGUuaXNUcmVlTm9kZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXREcmFnQ2hpbGRyZW5LZXlzKGRyYWdOb2RlS2V5LCBrZXlFbnRpdGllcykge1xuICAvLyBub3QgY29udGFpbnMgc2VsZlxuICAvLyBzZWxmIGZvciBsZWZ0IG9yIHJpZ2h0IGRyYWdcbiAgdmFyIGRyYWdDaGlsZHJlbktleXMgPSBbXTtcbiAgdmFyIGVudGl0eSA9IGtleUVudGl0aWVzW2RyYWdOb2RlS2V5XTtcblxuICBmdW5jdGlvbiBkaWcoKSB7XG4gICAgdmFyIGxpc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdO1xuICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAoX3JlZikge1xuICAgICAgdmFyIGtleSA9IF9yZWYua2V5LFxuICAgICAgICAgIGNoaWxkcmVuID0gX3JlZi5jaGlsZHJlbjtcbiAgICAgIGRyYWdDaGlsZHJlbktleXMucHVzaChrZXkpO1xuICAgICAgZGlnKGNoaWxkcmVuKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpZyhlbnRpdHkuY2hpbGRyZW4pO1xuICByZXR1cm4gZHJhZ0NoaWxkcmVuS2V5cztcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc0xhc3RDaGlsZCh0cmVlTm9kZUVudGl0eSkge1xuICBpZiAodHJlZU5vZGVFbnRpdHkucGFyZW50KSB7XG4gICAgdmFyIHBvc0FyciA9IHBvc1RvQXJyKHRyZWVOb2RlRW50aXR5LnBvcyk7XG4gICAgcmV0dXJuIE51bWJlcihwb3NBcnJbcG9zQXJyLmxlbmd0aCAtIDFdKSA9PT0gdHJlZU5vZGVFbnRpdHkucGFyZW50LmNoaWxkcmVuLmxlbmd0aCAtIDE7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNGaXJzdENoaWxkKHRyZWVOb2RlRW50aXR5KSB7XG4gIHZhciBwb3NBcnIgPSBwb3NUb0Fycih0cmVlTm9kZUVudGl0eS5wb3MpO1xuICByZXR1cm4gTnVtYmVyKHBvc0Fycltwb3NBcnIubGVuZ3RoIC0gMV0pID09PSAwO1xufSAvLyBPbmx5IHVzZWQgd2hlbiBkcmFnLCBub3QgYWZmZWN0IFNTUi5cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNEcm9wUG9zaXRpb24oZXZlbnQsIGRyYWdOb2RlLCB0YXJnZXROb2RlLCBpbmRlbnQsIHN0YXJ0TW91c2VQb3NpdGlvbiwgYWxsb3dEcm9wLCBmbGF0dGVuZWROb2Rlcywga2V5RW50aXRpZXMsIGV4cGFuZEtleXMsIGRpcmVjdGlvbikge1xuICB2YXIgX2Fic3RyYWN0RHJvcE5vZGVFbnRpO1xuXG4gIHZhciBjbGllbnRYID0gZXZlbnQuY2xpZW50WCxcbiAgICAgIGNsaWVudFkgPSBldmVudC5jbGllbnRZO1xuXG4gIHZhciBfZXZlbnQkdGFyZ2V0JGdldEJvdW4gPSBldmVudC50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICB0b3AgPSBfZXZlbnQkdGFyZ2V0JGdldEJvdW4udG9wLFxuICAgICAgaGVpZ2h0ID0gX2V2ZW50JHRhcmdldCRnZXRCb3VuLmhlaWdodDsgLy8gb3B0aW9uYWwgY2hhaW4gZm9yIHRlc3RpbmdcblxuXG4gIHZhciBob3Jpem9udGFsTW91c2VPZmZzZXQgPSAoZGlyZWN0aW9uID09PSAncnRsJyA/IC0xIDogMSkgKiAoKChzdGFydE1vdXNlUG9zaXRpb24gPT09IG51bGwgfHwgc3RhcnRNb3VzZVBvc2l0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdGFydE1vdXNlUG9zaXRpb24ueCkgfHwgMCkgLSBjbGllbnRYKTtcbiAgdmFyIHJhd0Ryb3BMZXZlbE9mZnNldCA9IChob3Jpem9udGFsTW91c2VPZmZzZXQgLSAxMikgLyBpbmRlbnQ7IC8vIGZpbmQgYWJzdHJhY3QgZHJvcCBub2RlIGJ5IGhvcml6b250YWwgb2Zmc2V0XG5cbiAgdmFyIGFic3RyYWN0RHJvcE5vZGVFbnRpdHkgPSBrZXlFbnRpdGllc1t0YXJnZXROb2RlLnByb3BzLmV2ZW50S2V5XTtcblxuICBpZiAoY2xpZW50WSA8IHRvcCArIGhlaWdodCAvIDIpIHtcbiAgICAvLyBmaXJzdCBoYWxmLCBzZXQgYWJzdHJhY3QgZHJvcCBub2RlIHRvIHByZXZpb3VzIG5vZGVcbiAgICB2YXIgbm9kZUluZGV4ID0gZmxhdHRlbmVkTm9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChmbGF0dGVuZWROb2RlKSB7XG4gICAgICByZXR1cm4gZmxhdHRlbmVkTm9kZS5kYXRhLmtleSA9PT0gYWJzdHJhY3REcm9wTm9kZUVudGl0eS5rZXk7XG4gICAgfSk7XG4gICAgdmFyIHByZXZOb2RlSW5kZXggPSBub2RlSW5kZXggPD0gMCA/IDAgOiBub2RlSW5kZXggLSAxO1xuICAgIHZhciBwcmV2Tm9kZUtleSA9IGZsYXR0ZW5lZE5vZGVzW3ByZXZOb2RlSW5kZXhdLmRhdGEua2V5O1xuICAgIGFic3RyYWN0RHJvcE5vZGVFbnRpdHkgPSBrZXlFbnRpdGllc1twcmV2Tm9kZUtleV07XG4gIH1cblxuICB2YXIgaW5pdGlhbEFic3RyYWN0RHJvcE5vZGVLZXkgPSBhYnN0cmFjdERyb3BOb2RlRW50aXR5LmtleTtcbiAgdmFyIGFic3RyYWN0RHJhZ092ZXJFbnRpdHkgPSBhYnN0cmFjdERyb3BOb2RlRW50aXR5O1xuICB2YXIgZHJhZ092ZXJOb2RlS2V5ID0gYWJzdHJhY3REcm9wTm9kZUVudGl0eS5rZXk7XG4gIHZhciBkcm9wUG9zaXRpb24gPSAwO1xuICB2YXIgZHJvcExldmVsT2Zmc2V0ID0gMDsgLy8gT25seSBhbGxvdyBjcm9zcyBsZXZlbCBkcm9wIHdoZW4gZHJhZ2dpbmcgb24gYSBub24tZXhwYW5kZWQgbm9kZVxuXG4gIGlmICghZXhwYW5kS2V5cy5pbmNsdWRlcyhpbml0aWFsQWJzdHJhY3REcm9wTm9kZUtleSkpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhd0Ryb3BMZXZlbE9mZnNldDsgaSArPSAxKSB7XG4gICAgICBpZiAoaXNMYXN0Q2hpbGQoYWJzdHJhY3REcm9wTm9kZUVudGl0eSkpIHtcbiAgICAgICAgYWJzdHJhY3REcm9wTm9kZUVudGl0eSA9IGFic3RyYWN0RHJvcE5vZGVFbnRpdHkucGFyZW50O1xuICAgICAgICBkcm9wTGV2ZWxPZmZzZXQgKz0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBhYnN0cmFjdERyb3BEYXRhTm9kZSA9IGFic3RyYWN0RHJvcE5vZGVFbnRpdHkubm9kZTtcbiAgdmFyIGRyb3BBbGxvd2VkID0gdHJ1ZTtcblxuICBpZiAoaXNGaXJzdENoaWxkKGFic3RyYWN0RHJvcE5vZGVFbnRpdHkpICYmIGFic3RyYWN0RHJvcE5vZGVFbnRpdHkubGV2ZWwgPT09IDAgJiYgY2xpZW50WSA8IHRvcCArIGhlaWdodCAvIDIgJiYgYWxsb3dEcm9wKHtcbiAgICBkcm9wTm9kZTogYWJzdHJhY3REcm9wRGF0YU5vZGUsXG4gICAgZHJvcFBvc2l0aW9uOiAtMVxuICB9KSAmJiBhYnN0cmFjdERyb3BOb2RlRW50aXR5LmtleSA9PT0gdGFyZ2V0Tm9kZS5wcm9wcy5ldmVudEtleSkge1xuICAgIC8vIGZpcnN0IGhhbGYgb2YgZmlyc3Qgbm9kZSBpbiBmaXJzdCBsZXZlbFxuICAgIGRyb3BQb3NpdGlvbiA9IC0xO1xuICB9IGVsc2UgaWYgKChhYnN0cmFjdERyYWdPdmVyRW50aXR5LmNoaWxkcmVuIHx8IFtdKS5sZW5ndGggJiYgZXhwYW5kS2V5cy5pbmNsdWRlcyhkcmFnT3Zlck5vZGVLZXkpKSB7XG4gICAgLy8gZHJvcCBvbiBleHBhbmRlZCBub2RlXG4gICAgLy8gb25seSBhbGxvdyBkcm9wIGluc2lkZVxuICAgIGlmIChhbGxvd0Ryb3Aoe1xuICAgICAgZHJvcE5vZGU6IGFic3RyYWN0RHJvcERhdGFOb2RlLFxuICAgICAgZHJvcFBvc2l0aW9uOiAwXG4gICAgfSkpIHtcbiAgICAgIGRyb3BQb3NpdGlvbiA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRyb3BBbGxvd2VkID0gZmFsc2U7XG4gICAgfVxuICB9IGVsc2UgaWYgKGRyb3BMZXZlbE9mZnNldCA9PT0gMCkge1xuICAgIGlmIChyYXdEcm9wTGV2ZWxPZmZzZXQgPiAtMS41KSB7XG4gICAgICAvLyB8IE5vZGUgICAgIHwgPC0gYWJzdHJhY3REcm9wTm9kZVxuICAgICAgLy8gfCAtXi09PT09PSB8IDwtIG1vdXNlUG9zaXRpb25cbiAgICAgIC8vIDEuIHRyeSBkcm9wIGFmdGVyXG4gICAgICAvLyAyLiBkbyBub3QgYWxsb3cgZHJvcFxuICAgICAgaWYgKGFsbG93RHJvcCh7XG4gICAgICAgIGRyb3BOb2RlOiBhYnN0cmFjdERyb3BEYXRhTm9kZSxcbiAgICAgICAgZHJvcFBvc2l0aW9uOiAxXG4gICAgICB9KSkge1xuICAgICAgICBkcm9wUG9zaXRpb24gPSAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZHJvcEFsbG93ZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gfCBOb2RlICAgICB8IDwtIGFic3RyYWN0RHJvcE5vZGVcbiAgICAgIC8vIHwgLS0tPT1ePT0gfCA8LSBtb3VzZVBvc2l0aW9uXG4gICAgICAvLyB3aGV0aGVyIGl0IGhhcyBjaGlsZHJlbiBvciBkb2Vzbid0IGhhcyBjaGlsZHJlblxuICAgICAgLy8gYWx3YXlzXG4gICAgICAvLyAxLiB0cnkgZHJvcCBpbnNpZGVcbiAgICAgIC8vIDIuIHRyeSBkcm9wIGFmdGVyXG4gICAgICAvLyAzLiBkbyBub3QgYWxsb3cgZHJvcFxuICAgICAgaWYgKGFsbG93RHJvcCh7XG4gICAgICAgIGRyb3BOb2RlOiBhYnN0cmFjdERyb3BEYXRhTm9kZSxcbiAgICAgICAgZHJvcFBvc2l0aW9uOiAwXG4gICAgICB9KSkge1xuICAgICAgICBkcm9wUG9zaXRpb24gPSAwO1xuICAgICAgfSBlbHNlIGlmIChhbGxvd0Ryb3Aoe1xuICAgICAgICBkcm9wTm9kZTogYWJzdHJhY3REcm9wRGF0YU5vZGUsXG4gICAgICAgIGRyb3BQb3NpdGlvbjogMVxuICAgICAgfSkpIHtcbiAgICAgICAgZHJvcFBvc2l0aW9uID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRyb3BBbGxvd2VkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIHwgTm9kZTEgfCA8LSBhYnN0cmFjdERyb3BOb2RlXG4gICAgLy8gICAgICB8ICBOb2RlMiAgfFxuICAgIC8vIC0tXi0tfC0tLS09PT09PXwgPC0gbW91c2VQb3NpdGlvblxuICAgIC8vIDEuIHRyeSBpbnNlcnQgYWZ0ZXIgTm9kZTFcbiAgICAvLyAyLiBkbyBub3QgYWxsb3cgZHJvcFxuICAgIGlmIChhbGxvd0Ryb3Aoe1xuICAgICAgZHJvcE5vZGU6IGFic3RyYWN0RHJvcERhdGFOb2RlLFxuICAgICAgZHJvcFBvc2l0aW9uOiAxXG4gICAgfSkpIHtcbiAgICAgIGRyb3BQb3NpdGlvbiA9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRyb3BBbGxvd2VkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBkcm9wUG9zaXRpb246IGRyb3BQb3NpdGlvbixcbiAgICBkcm9wTGV2ZWxPZmZzZXQ6IGRyb3BMZXZlbE9mZnNldCxcbiAgICBkcm9wVGFyZ2V0S2V5OiBhYnN0cmFjdERyb3BOb2RlRW50aXR5LmtleSxcbiAgICBkcm9wVGFyZ2V0UG9zOiBhYnN0cmFjdERyb3BOb2RlRW50aXR5LnBvcyxcbiAgICBkcmFnT3Zlck5vZGVLZXk6IGRyYWdPdmVyTm9kZUtleSxcbiAgICBkcm9wQ29udGFpbmVyS2V5OiBkcm9wUG9zaXRpb24gPT09IDAgPyBudWxsIDogKChfYWJzdHJhY3REcm9wTm9kZUVudGkgPSBhYnN0cmFjdERyb3BOb2RlRW50aXR5LnBhcmVudCkgPT09IG51bGwgfHwgX2Fic3RyYWN0RHJvcE5vZGVFbnRpID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYWJzdHJhY3REcm9wTm9kZUVudGkua2V5KSB8fCBudWxsLFxuICAgIGRyb3BBbGxvd2VkOiBkcm9wQWxsb3dlZFxuICB9O1xufVxuLyoqXG4gKiBSZXR1cm4gc2VsZWN0ZWRLZXlzIGFjY29yZGluZyB3aXRoIG11bHRpcGxlIHByb3BcbiAqIEBwYXJhbSBzZWxlY3RlZEtleXNcbiAqIEBwYXJhbSBwcm9wc1xuICogQHJldHVybnMgW3N0cmluZ11cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY1NlbGVjdGVkS2V5cyhzZWxlY3RlZEtleXMsIHByb3BzKSB7XG4gIGlmICghc2VsZWN0ZWRLZXlzKSByZXR1cm4gdW5kZWZpbmVkO1xuICB2YXIgbXVsdGlwbGUgPSBwcm9wcy5tdWx0aXBsZTtcblxuICBpZiAobXVsdGlwbGUpIHtcbiAgICByZXR1cm4gc2VsZWN0ZWRLZXlzLnNsaWNlKCk7XG4gIH1cblxuICBpZiAoc2VsZWN0ZWRLZXlzLmxlbmd0aCkge1xuICAgIHJldHVybiBbc2VsZWN0ZWRLZXlzWzBdXTtcbiAgfVxuXG4gIHJldHVybiBzZWxlY3RlZEtleXM7XG59XG5cbnZhciBpbnRlcm5hbFByb2Nlc3NQcm9wcyA9IGZ1bmN0aW9uIGludGVybmFsUHJvY2Vzc1Byb3BzKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcztcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0RGF0YVRvVHJlZSh0cmVlRGF0YSwgcHJvY2Vzc29yKSB7XG4gIGlmICghdHJlZURhdGEpIHJldHVybiBbXTtcblxuICB2YXIgX3JlZjIgPSBwcm9jZXNzb3IgfHwge30sXG4gICAgICBfcmVmMiRwcm9jZXNzUHJvcHMgPSBfcmVmMi5wcm9jZXNzUHJvcHMsXG4gICAgICBwcm9jZXNzUHJvcHMgPSBfcmVmMiRwcm9jZXNzUHJvcHMgPT09IHZvaWQgMCA/IGludGVybmFsUHJvY2Vzc1Byb3BzIDogX3JlZjIkcHJvY2Vzc1Byb3BzO1xuXG4gIHZhciBsaXN0ID0gQXJyYXkuaXNBcnJheSh0cmVlRGF0YSkgPyB0cmVlRGF0YSA6IFt0cmVlRGF0YV07XG4gIHJldHVybiBsaXN0Lm1hcChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSBfcmVmMy5jaGlsZHJlbixcbiAgICAgICAgcHJvcHMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZjMsIFtcImNoaWxkcmVuXCJdKTtcblxuICAgIHZhciBjaGlsZHJlbk5vZGVzID0gY29udmVydERhdGFUb1RyZWUoY2hpbGRyZW4sIHByb2Nlc3Nvcik7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRyZWVOb2RlLCBwcm9jZXNzUHJvcHMocHJvcHMpLCBjaGlsZHJlbk5vZGVzKTtcbiAgfSk7XG59XG4vKipcbiAqIFBhcnNlIGBjaGVja2VkS2V5c2AgdG8geyBjaGVja2VkS2V5cywgaGFsZkNoZWNrZWRLZXlzIH0gc3R5bGVcbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDaGVja2VkS2V5cyhrZXlzKSB7XG4gIGlmICgha2V5cykge1xuICAgIHJldHVybiBudWxsO1xuICB9IC8vIENvbnZlcnQga2V5cyB0byBvYmplY3QgZm9ybWF0XG5cblxuICB2YXIga2V5UHJvcHM7XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkoa2V5cykpIHtcbiAgICAvLyBbTGVnYWN5XSBGb2xsb3cgdGhlIGFwaSBkb2NcbiAgICBrZXlQcm9wcyA9IHtcbiAgICAgIGNoZWNrZWRLZXlzOiBrZXlzLFxuICAgICAgaGFsZkNoZWNrZWRLZXlzOiB1bmRlZmluZWRcbiAgICB9O1xuICB9IGVsc2UgaWYgKF90eXBlb2Yoa2V5cykgPT09ICdvYmplY3QnKSB7XG4gICAga2V5UHJvcHMgPSB7XG4gICAgICBjaGVja2VkS2V5czoga2V5cy5jaGVja2VkIHx8IHVuZGVmaW5lZCxcbiAgICAgIGhhbGZDaGVja2VkS2V5czoga2V5cy5oYWxmQ2hlY2tlZCB8fCB1bmRlZmluZWRcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHdhcm5pbmcoZmFsc2UsICdgY2hlY2tlZEtleXNgIGlzIG5vdCBhbiBhcnJheSBvciBhbiBvYmplY3QnKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBrZXlQcm9wcztcbn1cbi8qKlxuICogSWYgdXNlciB1c2UgYGF1dG9FeHBhbmRQYXJlbnRgIHdlIHNob3VsZCBnZXQgdGhlIGxpc3Qgb2YgcGFyZW50IG5vZGVcbiAqIEBwYXJhbSBrZXlMaXN0XG4gKiBAcGFyYW0ga2V5RW50aXRpZXNcbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY29uZHVjdEV4cGFuZFBhcmVudChrZXlMaXN0LCBrZXlFbnRpdGllcykge1xuICB2YXIgZXhwYW5kZWRLZXlzID0gbmV3IFNldCgpO1xuXG4gIGZ1bmN0aW9uIGNvbmR1Y3RVcChrZXkpIHtcbiAgICBpZiAoZXhwYW5kZWRLZXlzLmhhcyhrZXkpKSByZXR1cm47XG4gICAgdmFyIGVudGl0eSA9IGtleUVudGl0aWVzW2tleV07XG4gICAgaWYgKCFlbnRpdHkpIHJldHVybjtcbiAgICBleHBhbmRlZEtleXMuYWRkKGtleSk7XG4gICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnQsXG4gICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZTtcbiAgICBpZiAobm9kZS5kaXNhYmxlZCkgcmV0dXJuO1xuXG4gICAgaWYgKHBhcmVudCkge1xuICAgICAgY29uZHVjdFVwKHBhcmVudC5rZXkpO1xuICAgIH1cbiAgfVxuXG4gIChrZXlMaXN0IHx8IFtdKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBjb25kdWN0VXAoa2V5KTtcbiAgfSk7XG4gIHJldHVybiBfdG9Db25zdW1hYmxlQXJyYXkoZXhwYW5kZWRLZXlzKTtcbn1cbi8qKlxuICogUmV0dXJucyBvbmx5IHRoZSBkYXRhLSBhbmQgYXJpYS0ga2V5L3ZhbHVlIHBhaXJzXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGFBbmRBcmlhKHByb3BzKSB7XG4gIHZhciBvbWl0UHJvcHMgPSB7fTtcbiAgT2JqZWN0LmtleXMocHJvcHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGlmIChrZXkuc3RhcnRzV2l0aCgnZGF0YS0nKSB8fCBrZXkuc3RhcnRzV2l0aCgnYXJpYS0nKSkge1xuICAgICAgb21pdFByb3BzW2tleV0gPSBwcm9wc1trZXldO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBvbWl0UHJvcHM7XG59IiwiaW1wb3J0IHdhcm5pbmcgZnJvbSBcInJjLXV0aWwvZXMvd2FybmluZ1wiO1xuXG5mdW5jdGlvbiByZW1vdmVGcm9tQ2hlY2tlZEtleXMoaGFsZkNoZWNrZWRLZXlzLCBjaGVja2VkS2V5cykge1xuICB2YXIgZmlsdGVyZWRLZXlzID0gbmV3IFNldCgpO1xuICBoYWxmQ2hlY2tlZEtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgaWYgKCFjaGVja2VkS2V5cy5oYXMoa2V5KSkge1xuICAgICAgZmlsdGVyZWRLZXlzLmFkZChrZXkpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBmaWx0ZXJlZEtleXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NoZWNrRGlzYWJsZWQobm9kZSkge1xuICB2YXIgX3JlZiA9IG5vZGUgfHwge30sXG4gICAgICBkaXNhYmxlZCA9IF9yZWYuZGlzYWJsZWQsXG4gICAgICBkaXNhYmxlQ2hlY2tib3ggPSBfcmVmLmRpc2FibGVDaGVja2JveCxcbiAgICAgIGNoZWNrYWJsZSA9IF9yZWYuY2hlY2thYmxlO1xuXG4gIHJldHVybiAhIShkaXNhYmxlZCB8fCBkaXNhYmxlQ2hlY2tib3gpIHx8IGNoZWNrYWJsZSA9PT0gZmFsc2U7XG59IC8vIEZpbGwgbWlzcyBrZXlzXG5cbmZ1bmN0aW9uIGZpbGxDb25kdWN0Q2hlY2soa2V5cywgbGV2ZWxFbnRpdGllcywgbWF4TGV2ZWwsIHN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQpIHtcbiAgdmFyIGNoZWNrZWRLZXlzID0gbmV3IFNldChrZXlzKTtcbiAgdmFyIGhhbGZDaGVja2VkS2V5cyA9IG5ldyBTZXQoKTsgLy8gQWRkIGNoZWNrZWQga2V5cyB0b3AgdG8gYm90dG9tXG5cbiAgZm9yICh2YXIgbGV2ZWwgPSAwOyBsZXZlbCA8PSBtYXhMZXZlbDsgbGV2ZWwgKz0gMSkge1xuICAgIHZhciBlbnRpdGllcyA9IGxldmVsRW50aXRpZXMuZ2V0KGxldmVsKSB8fCBuZXcgU2V0KCk7XG4gICAgZW50aXRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZW50aXR5KSB7XG4gICAgICB2YXIga2V5ID0gZW50aXR5LmtleSxcbiAgICAgICAgICBub2RlID0gZW50aXR5Lm5vZGUsXG4gICAgICAgICAgX2VudGl0eSRjaGlsZHJlbiA9IGVudGl0eS5jaGlsZHJlbixcbiAgICAgICAgICBjaGlsZHJlbiA9IF9lbnRpdHkkY2hpbGRyZW4gPT09IHZvaWQgMCA/IFtdIDogX2VudGl0eSRjaGlsZHJlbjtcblxuICAgICAgaWYgKGNoZWNrZWRLZXlzLmhhcyhrZXkpICYmICFzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKG5vZGUpKSB7XG4gICAgICAgIGNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgICByZXR1cm4gIXN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQoY2hpbGRFbnRpdHkubm9kZSk7XG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkRW50aXR5KSB7XG4gICAgICAgICAgY2hlY2tlZEtleXMuYWRkKGNoaWxkRW50aXR5LmtleSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9IC8vIEFkZCBjaGVja2VkIGtleXMgZnJvbSBib3R0b20gdG8gdG9wXG5cblxuICB2YXIgdmlzaXRlZEtleXMgPSBuZXcgU2V0KCk7XG5cbiAgZm9yICh2YXIgX2xldmVsID0gbWF4TGV2ZWw7IF9sZXZlbCA+PSAwOyBfbGV2ZWwgLT0gMSkge1xuICAgIHZhciBfZW50aXRpZXMgPSBsZXZlbEVudGl0aWVzLmdldChfbGV2ZWwpIHx8IG5ldyBTZXQoKTtcblxuICAgIF9lbnRpdGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRpdHkpIHtcbiAgICAgIHZhciBwYXJlbnQgPSBlbnRpdHkucGFyZW50LFxuICAgICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZTsgLy8gU2tpcCBpZiBubyBuZWVkIHRvIGNoZWNrXG5cbiAgICAgIGlmIChzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKG5vZGUpIHx8ICFlbnRpdHkucGFyZW50IHx8IHZpc2l0ZWRLZXlzLmhhcyhlbnRpdHkucGFyZW50LmtleSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTa2lwIGlmIHBhcmVudCBpcyBkaXNhYmxlZFxuXG5cbiAgICAgIGlmIChzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGVudGl0eS5wYXJlbnQubm9kZSkpIHtcbiAgICAgICAgdmlzaXRlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBhbGxDaGVja2VkID0gdHJ1ZTtcbiAgICAgIHZhciBwYXJ0aWFsQ2hlY2tlZCA9IGZhbHNlO1xuICAgICAgKHBhcmVudC5jaGlsZHJlbiB8fCBbXSkuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZEVudGl0eSkge1xuICAgICAgICByZXR1cm4gIXN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQoY2hpbGRFbnRpdHkubm9kZSk7XG4gICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgICB2YXIga2V5ID0gX3JlZjIua2V5O1xuICAgICAgICB2YXIgY2hlY2tlZCA9IGNoZWNrZWRLZXlzLmhhcyhrZXkpO1xuXG4gICAgICAgIGlmIChhbGxDaGVja2VkICYmICFjaGVja2VkKSB7XG4gICAgICAgICAgYWxsQ2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwYXJ0aWFsQ2hlY2tlZCAmJiAoY2hlY2tlZCB8fCBoYWxmQ2hlY2tlZEtleXMuaGFzKGtleSkpKSB7XG4gICAgICAgICAgcGFydGlhbENoZWNrZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGFsbENoZWNrZWQpIHtcbiAgICAgICAgY2hlY2tlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgfVxuXG4gICAgICBpZiAocGFydGlhbENoZWNrZWQpIHtcbiAgICAgICAgaGFsZkNoZWNrZWRLZXlzLmFkZChwYXJlbnQua2V5KTtcbiAgICAgIH1cblxuICAgICAgdmlzaXRlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjaGVja2VkS2V5czogQXJyYXkuZnJvbShjaGVja2VkS2V5cyksXG4gICAgaGFsZkNoZWNrZWRLZXlzOiBBcnJheS5mcm9tKHJlbW92ZUZyb21DaGVja2VkS2V5cyhoYWxmQ2hlY2tlZEtleXMsIGNoZWNrZWRLZXlzKSlcbiAgfTtcbn0gLy8gUmVtb3ZlIHVzZWxlc3Mga2V5XG5cblxuZnVuY3Rpb24gY2xlYW5Db25kdWN0Q2hlY2soa2V5cywgaGFsZktleXMsIGxldmVsRW50aXRpZXMsIG1heExldmVsLCBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKSB7XG4gIHZhciBjaGVja2VkS2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gIHZhciBoYWxmQ2hlY2tlZEtleXMgPSBuZXcgU2V0KGhhbGZLZXlzKTsgLy8gUmVtb3ZlIGNoZWNrZWQga2V5cyBmcm9tIHRvcCB0byBib3R0b21cblxuICBmb3IgKHZhciBsZXZlbCA9IDA7IGxldmVsIDw9IG1heExldmVsOyBsZXZlbCArPSAxKSB7XG4gICAgdmFyIGVudGl0aWVzID0gbGV2ZWxFbnRpdGllcy5nZXQobGV2ZWwpIHx8IG5ldyBTZXQoKTtcbiAgICBlbnRpdGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRpdHkpIHtcbiAgICAgIHZhciBrZXkgPSBlbnRpdHkua2V5LFxuICAgICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZSxcbiAgICAgICAgICBfZW50aXR5JGNoaWxkcmVuMiA9IGVudGl0eS5jaGlsZHJlbixcbiAgICAgICAgICBjaGlsZHJlbiA9IF9lbnRpdHkkY2hpbGRyZW4yID09PSB2b2lkIDAgPyBbXSA6IF9lbnRpdHkkY2hpbGRyZW4yO1xuXG4gICAgICBpZiAoIWNoZWNrZWRLZXlzLmhhcyhrZXkpICYmICFoYWxmQ2hlY2tlZEtleXMuaGFzKGtleSkgJiYgIXN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQobm9kZSkpIHtcbiAgICAgICAgY2hpbGRyZW4uZmlsdGVyKGZ1bmN0aW9uIChjaGlsZEVudGl0eSkge1xuICAgICAgICAgIHJldHVybiAhc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChjaGlsZEVudGl0eS5ub2RlKTtcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgICBjaGVja2VkS2V5cy5kZWxldGUoY2hpbGRFbnRpdHkua2V5KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gLy8gUmVtb3ZlIGNoZWNrZWQga2V5cyBmb3JtIGJvdHRvbSB0byB0b3BcblxuXG4gIGhhbGZDaGVja2VkS2V5cyA9IG5ldyBTZXQoKTtcbiAgdmFyIHZpc2l0ZWRLZXlzID0gbmV3IFNldCgpO1xuXG4gIGZvciAodmFyIF9sZXZlbDIgPSBtYXhMZXZlbDsgX2xldmVsMiA+PSAwOyBfbGV2ZWwyIC09IDEpIHtcbiAgICB2YXIgX2VudGl0aWVzMiA9IGxldmVsRW50aXRpZXMuZ2V0KF9sZXZlbDIpIHx8IG5ldyBTZXQoKTtcblxuICAgIF9lbnRpdGllczIuZm9yRWFjaChmdW5jdGlvbiAoZW50aXR5KSB7XG4gICAgICB2YXIgcGFyZW50ID0gZW50aXR5LnBhcmVudCxcbiAgICAgICAgICBub2RlID0gZW50aXR5Lm5vZGU7IC8vIFNraXAgaWYgbm8gbmVlZCB0byBjaGVja1xuXG4gICAgICBpZiAoc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChub2RlKSB8fCAhZW50aXR5LnBhcmVudCB8fCB2aXNpdGVkS2V5cy5oYXMoZW50aXR5LnBhcmVudC5rZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gU2tpcCBpZiBwYXJlbnQgaXMgZGlzYWJsZWRcblxuXG4gICAgICBpZiAoc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChlbnRpdHkucGFyZW50Lm5vZGUpKSB7XG4gICAgICAgIHZpc2l0ZWRLZXlzLmFkZChwYXJlbnQua2V5KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWxsQ2hlY2tlZCA9IHRydWU7XG4gICAgICB2YXIgcGFydGlhbENoZWNrZWQgPSBmYWxzZTtcbiAgICAgIChwYXJlbnQuY2hpbGRyZW4gfHwgW10pLmZpbHRlcihmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuICFzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGNoaWxkRW50aXR5Lm5vZGUpO1xuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgICAgdmFyIGtleSA9IF9yZWYzLmtleTtcbiAgICAgICAgdmFyIGNoZWNrZWQgPSBjaGVja2VkS2V5cy5oYXMoa2V5KTtcblxuICAgICAgICBpZiAoYWxsQ2hlY2tlZCAmJiAhY2hlY2tlZCkge1xuICAgICAgICAgIGFsbENoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcGFydGlhbENoZWNrZWQgJiYgKGNoZWNrZWQgfHwgaGFsZkNoZWNrZWRLZXlzLmhhcyhrZXkpKSkge1xuICAgICAgICAgIHBhcnRpYWxDaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghYWxsQ2hlY2tlZCkge1xuICAgICAgICBjaGVja2VkS2V5cy5kZWxldGUocGFyZW50LmtleSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJ0aWFsQ2hlY2tlZCkge1xuICAgICAgICBoYWxmQ2hlY2tlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgfVxuXG4gICAgICB2aXNpdGVkS2V5cy5hZGQocGFyZW50LmtleSk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNoZWNrZWRLZXlzOiBBcnJheS5mcm9tKGNoZWNrZWRLZXlzKSxcbiAgICBoYWxmQ2hlY2tlZEtleXM6IEFycmF5LmZyb20ocmVtb3ZlRnJvbUNoZWNrZWRLZXlzKGhhbGZDaGVja2VkS2V5cywgY2hlY2tlZEtleXMpKVxuICB9O1xufVxuLyoqXG4gKiBDb25kdWN0IHdpdGgga2V5cy5cbiAqIEBwYXJhbSBrZXlMaXN0IGN1cnJlbnQga2V5IGxpc3RcbiAqIEBwYXJhbSBrZXlFbnRpdGllcyBrZXkgLSBkYXRhRW50aXR5IG1hcFxuICogQHBhcmFtIG1vZGUgYGZpbGxgIHRvIGZpbGwgbWlzc2luZyBrZXksIGBjbGVhbmAgdG8gcmVtb3ZlIHVzZWxlc3Mga2V5XG4gKi9cblxuXG5leHBvcnQgZnVuY3Rpb24gY29uZHVjdENoZWNrKGtleUxpc3QsIGNoZWNrZWQsIGtleUVudGl0aWVzLCBnZXRDaGVja0Rpc2FibGVkKSB7XG4gIHZhciB3YXJuaW5nTWlzc0tleXMgPSBbXTtcbiAgdmFyIHN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQ7XG5cbiAgaWYgKGdldENoZWNrRGlzYWJsZWQpIHtcbiAgICBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkID0gZ2V0Q2hlY2tEaXNhYmxlZDtcbiAgfSBlbHNlIHtcbiAgICBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkID0gaXNDaGVja0Rpc2FibGVkO1xuICB9IC8vIFdlIG9ubHkgaGFuZGxlIGV4aXN0IGtleXNcblxuXG4gIHZhciBrZXlzID0gbmV3IFNldChrZXlMaXN0LmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgdmFyIGhhc0VudGl0eSA9ICEha2V5RW50aXRpZXNba2V5XTtcblxuICAgIGlmICghaGFzRW50aXR5KSB7XG4gICAgICB3YXJuaW5nTWlzc0tleXMucHVzaChrZXkpO1xuICAgIH1cblxuICAgIHJldHVybiBoYXNFbnRpdHk7XG4gIH0pKTtcbiAgdmFyIGxldmVsRW50aXRpZXMgPSBuZXcgTWFwKCk7XG4gIHZhciBtYXhMZXZlbCA9IDA7IC8vIENvbnZlcnQgZW50aXRpZXMgYnkgbGV2ZWwgZm9yIGNhbGN1bGF0aW9uXG5cbiAgT2JqZWN0LmtleXMoa2V5RW50aXRpZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHZhciBlbnRpdHkgPSBrZXlFbnRpdGllc1trZXldO1xuICAgIHZhciBsZXZlbCA9IGVudGl0eS5sZXZlbDtcbiAgICB2YXIgbGV2ZWxTZXQgPSBsZXZlbEVudGl0aWVzLmdldChsZXZlbCk7XG5cbiAgICBpZiAoIWxldmVsU2V0KSB7XG4gICAgICBsZXZlbFNldCA9IG5ldyBTZXQoKTtcbiAgICAgIGxldmVsRW50aXRpZXMuc2V0KGxldmVsLCBsZXZlbFNldCk7XG4gICAgfVxuXG4gICAgbGV2ZWxTZXQuYWRkKGVudGl0eSk7XG4gICAgbWF4TGV2ZWwgPSBNYXRoLm1heChtYXhMZXZlbCwgbGV2ZWwpO1xuICB9KTtcbiAgd2FybmluZyghd2FybmluZ01pc3NLZXlzLmxlbmd0aCwgXCJUcmVlIG1pc3NpbmcgZm9sbG93IGtleXM6IFwiLmNvbmNhdCh3YXJuaW5nTWlzc0tleXMuc2xpY2UoMCwgMTAwKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBcIidcIi5jb25jYXQoa2V5LCBcIidcIik7XG4gIH0pLmpvaW4oJywgJykpKTtcbiAgdmFyIHJlc3VsdDtcblxuICBpZiAoY2hlY2tlZCA9PT0gdHJ1ZSkge1xuICAgIHJlc3VsdCA9IGZpbGxDb25kdWN0Q2hlY2soa2V5cywgbGV2ZWxFbnRpdGllcywgbWF4TGV2ZWwsIHN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQpO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdCA9IGNsZWFuQ29uZHVjdENoZWNrKGtleXMsIGNoZWNrZWQuaGFsZkNoZWNrZWRLZXlzLCBsZXZlbEVudGl0aWVzLCBtYXhMZXZlbCwgc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufSIsImV4cG9ydCBmdW5jdGlvbiBmaW5kRXhwYW5kZWRLZXlzKCkge1xuICB2YXIgcHJldiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107XG4gIHZhciBuZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTtcbiAgdmFyIHByZXZMZW4gPSBwcmV2Lmxlbmd0aDtcbiAgdmFyIG5leHRMZW4gPSBuZXh0Lmxlbmd0aDtcblxuICBpZiAoTWF0aC5hYnMocHJldkxlbiAtIG5leHRMZW4pICE9PSAxKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFkZDogZmFsc2UsXG4gICAgICBrZXk6IG51bGxcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gZmluZChzaG9ydGVyLCBsb25nZXIpIHtcbiAgICB2YXIgY2FjaGUgPSBuZXcgTWFwKCk7XG4gICAgc2hvcnRlci5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGNhY2hlLnNldChrZXksIHRydWUpO1xuICAgIH0pO1xuICAgIHZhciBrZXlzID0gbG9uZ2VyLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgICByZXR1cm4gIWNhY2hlLmhhcyhrZXkpO1xuICAgIH0pO1xuICAgIHJldHVybiBrZXlzLmxlbmd0aCA9PT0gMSA/IGtleXNbMF0gOiBudWxsO1xuICB9XG5cbiAgaWYgKHByZXZMZW4gPCBuZXh0TGVuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFkZDogdHJ1ZSxcbiAgICAgIGtleTogZmluZChwcmV2LCBuZXh0KVxuICAgIH07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZDogZmFsc2UsXG4gICAga2V5OiBmaW5kKG5leHQsIHByZXYpXG4gIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RXhwYW5kUmFuZ2Uoc2hvcnRlciwgbG9uZ2VyLCBrZXkpIHtcbiAgdmFyIHNob3J0ZXJTdGFydEluZGV4ID0gc2hvcnRlci5maW5kSW5kZXgoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICB2YXIgZGF0YSA9IF9yZWYuZGF0YTtcbiAgICByZXR1cm4gZGF0YS5rZXkgPT09IGtleTtcbiAgfSk7XG4gIHZhciBzaG9ydGVyRW5kTm9kZSA9IHNob3J0ZXJbc2hvcnRlclN0YXJ0SW5kZXggKyAxXTtcbiAgdmFyIGxvbmdlclN0YXJ0SW5kZXggPSBsb25nZXIuZmluZEluZGV4KGZ1bmN0aW9uIChfcmVmMikge1xuICAgIHZhciBkYXRhID0gX3JlZjIuZGF0YTtcbiAgICByZXR1cm4gZGF0YS5rZXkgPT09IGtleTtcbiAgfSk7XG5cbiAgaWYgKHNob3J0ZXJFbmROb2RlKSB7XG4gICAgdmFyIGxvbmdlckVuZEluZGV4ID0gbG9uZ2VyLmZpbmRJbmRleChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBkYXRhID0gX3JlZjMuZGF0YTtcbiAgICAgIHJldHVybiBkYXRhLmtleSA9PT0gc2hvcnRlckVuZE5vZGUuZGF0YS5rZXk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGxvbmdlci5zbGljZShsb25nZXJTdGFydEluZGV4ICsgMSwgbG9uZ2VyRW5kSW5kZXgpO1xuICB9XG5cbiAgcmV0dXJuIGxvbmdlci5zbGljZShsb25nZXJTdGFydEluZGV4ICsgMSk7XG59IiwiaW1wb3J0IF90eXBlb2YgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZlwiO1xuaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXlcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RXaXRob3V0UHJvcGVydGllc1wiO1xuaW1wb3J0IHRvQXJyYXkgZnJvbSBcInJjLXV0aWwvZXMvQ2hpbGRyZW4vdG9BcnJheVwiO1xuaW1wb3J0IHdhcm5pbmcgZnJvbSBcInJjLXV0aWwvZXMvd2FybmluZ1wiO1xuaW1wb3J0IHsgZ2V0UG9zaXRpb24sIGlzVHJlZU5vZGUgfSBmcm9tICcuLi91dGlsJztcbmV4cG9ydCBmdW5jdGlvbiBnZXRLZXkoa2V5LCBwb3MpIHtcbiAgaWYgKGtleSAhPT0gbnVsbCAmJiBrZXkgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBrZXk7XG4gIH1cblxuICByZXR1cm4gcG9zO1xufVxuLyoqXG4gKiBXYXJuaW5nIGlmIFRyZWVOb2RlIGRvIG5vdCBwcm92aWRlcyBrZXlcbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gd2FybmluZ1dpdGhvdXRLZXkoKSB7XG4gIHZhciB0cmVlRGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107XG4gIHZhciBrZXlzID0gbmV3IE1hcCgpO1xuXG4gIGZ1bmN0aW9uIGRpZyhsaXN0KSB7XG4gICAgdmFyIHBhdGggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcnO1xuICAgIChsaXN0IHx8IFtdKS5mb3JFYWNoKGZ1bmN0aW9uICh0cmVlTm9kZSkge1xuICAgICAgdmFyIGtleSA9IHRyZWVOb2RlLmtleSxcbiAgICAgICAgICBjaGlsZHJlbiA9IHRyZWVOb2RlLmNoaWxkcmVuO1xuICAgICAgd2FybmluZyhrZXkgIT09IG51bGwgJiYga2V5ICE9PSB1bmRlZmluZWQsIFwiVHJlZSBub2RlIG11c3QgaGF2ZSBhIGNlcnRhaW4ga2V5OiBbXCIuY29uY2F0KHBhdGgpLmNvbmNhdChrZXksIFwiXVwiKSk7XG4gICAgICB2YXIgcmVjb3JkS2V5ID0gU3RyaW5nKGtleSk7XG4gICAgICB3YXJuaW5nKCFrZXlzLmhhcyhyZWNvcmRLZXkpIHx8IGtleSA9PT0gbnVsbCB8fCBrZXkgPT09IHVuZGVmaW5lZCwgXCJTYW1lICdrZXknIGV4aXN0IGluIHRoZSBUcmVlOiBcIi5jb25jYXQocmVjb3JkS2V5KSk7XG4gICAgICBrZXlzLnNldChyZWNvcmRLZXksIHRydWUpO1xuICAgICAgZGlnKGNoaWxkcmVuLCBcIlwiLmNvbmNhdChwYXRoKS5jb25jYXQocmVjb3JkS2V5LCBcIiA+IFwiKSk7XG4gICAgfSk7XG4gIH1cblxuICBkaWcodHJlZURhdGEpO1xufVxuLyoqXG4gKiBDb252ZXJ0IGBjaGlsZHJlbmAgb2YgVHJlZSBpbnRvIGB0cmVlRGF0YWAgc3RydWN0dXJlLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VHJlZVRvRGF0YShyb290Tm9kZXMpIHtcbiAgZnVuY3Rpb24gZGlnKG5vZGUpIHtcbiAgICB2YXIgdHJlZU5vZGVzID0gdG9BcnJheShub2RlKTtcbiAgICByZXR1cm4gdHJlZU5vZGVzLm1hcChmdW5jdGlvbiAodHJlZU5vZGUpIHtcbiAgICAgIC8vIEZpbHRlciBpbnZhbGlkYXRlIG5vZGVcbiAgICAgIGlmICghaXNUcmVlTm9kZSh0cmVlTm9kZSkpIHtcbiAgICAgICAgd2FybmluZyghdHJlZU5vZGUsICdUcmVlL1RyZWVOb2RlIGNhbiBvbmx5IGFjY2VwdCBUcmVlTm9kZSBhcyBjaGlsZHJlbi4nKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXkgPSB0cmVlTm9kZS5rZXk7XG5cbiAgICAgIHZhciBfdHJlZU5vZGUkcHJvcHMgPSB0cmVlTm9kZS5wcm9wcyxcbiAgICAgICAgICBjaGlsZHJlbiA9IF90cmVlTm9kZSRwcm9wcy5jaGlsZHJlbixcbiAgICAgICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF90cmVlTm9kZSRwcm9wcywgW1wiY2hpbGRyZW5cIl0pO1xuXG4gICAgICB2YXIgZGF0YU5vZGUgPSBfb2JqZWN0U3ByZWFkKHtcbiAgICAgICAga2V5OiBrZXlcbiAgICAgIH0sIHJlc3QpO1xuXG4gICAgICB2YXIgcGFyc2VkQ2hpbGRyZW4gPSBkaWcoY2hpbGRyZW4pO1xuXG4gICAgICBpZiAocGFyc2VkQ2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIGRhdGFOb2RlLmNoaWxkcmVuID0gcGFyc2VkQ2hpbGRyZW47XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhTm9kZTtcbiAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKGRhdGFOb2RlKSB7XG4gICAgICByZXR1cm4gZGF0YU5vZGU7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gZGlnKHJvb3ROb2Rlcyk7XG59XG4vKipcbiAqIEZsYXQgbmVzdCB0cmVlIGRhdGEgaW50byBmbGF0dGVuIGxpc3QuIFRoaXMgaXMgdXNlZCBmb3IgdmlydHVhbCBsaXN0IHJlbmRlci5cbiAqIEBwYXJhbSB0cmVlTm9kZUxpc3QgT3JpZ2luIGRhdGEgbm9kZSBsaXN0XG4gKiBAcGFyYW0gZXhwYW5kZWRLZXlzXG4gKiBuZWVkIGV4cGFuZGVkIGtleXMsIHByb3ZpZGVzIGB0cnVlYCBtZWFucyBhbGwgZXhwYW5kZWQgKHVzZWQgaW4gYHJjLXRyZWUtc2VsZWN0YCkuXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGZsYXR0ZW5UcmVlRGF0YSgpIHtcbiAgdmFyIHRyZWVOb2RlTGlzdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107XG4gIHZhciBleHBhbmRlZEtleXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdO1xuICB2YXIgZXhwYW5kZWRLZXlTZXQgPSBuZXcgU2V0KGV4cGFuZGVkS2V5cyA9PT0gdHJ1ZSA/IFtdIDogZXhwYW5kZWRLZXlzKTtcbiAgdmFyIGZsYXR0ZW5MaXN0ID0gW107XG5cbiAgZnVuY3Rpb24gZGlnKGxpc3QpIHtcbiAgICB2YXIgcGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsO1xuICAgIHJldHVybiBsaXN0Lm1hcChmdW5jdGlvbiAodHJlZU5vZGUsIGluZGV4KSB7XG4gICAgICB2YXIgcG9zID0gZ2V0UG9zaXRpb24ocGFyZW50ID8gcGFyZW50LnBvcyA6ICcwJywgaW5kZXgpO1xuICAgICAgdmFyIG1lcmdlZEtleSA9IGdldEtleSh0cmVlTm9kZS5rZXksIHBvcyk7IC8vIEFkZCBGbGF0dGVuRGF0YU5vZGUgaW50byBsaXN0XG5cbiAgICAgIHZhciBmbGF0dGVuTm9kZSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdHJlZU5vZGUpLCB7fSwge1xuICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgcG9zOiBwb3MsXG4gICAgICAgIGNoaWxkcmVuOiBudWxsLFxuICAgICAgICBkYXRhOiB0cmVlTm9kZSxcbiAgICAgICAgaXNTdGFydDogW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShwYXJlbnQgPyBwYXJlbnQuaXNTdGFydCA6IFtdKSwgW2luZGV4ID09PSAwXSksXG4gICAgICAgIGlzRW5kOiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHBhcmVudCA/IHBhcmVudC5pc0VuZCA6IFtdKSwgW2luZGV4ID09PSBsaXN0Lmxlbmd0aCAtIDFdKVxuICAgICAgfSk7XG5cbiAgICAgIGZsYXR0ZW5MaXN0LnB1c2goZmxhdHRlbk5vZGUpOyAvLyBMb29wIHRyZWVOb2RlIGNoaWxkcmVuXG5cbiAgICAgIGlmIChleHBhbmRlZEtleXMgPT09IHRydWUgfHwgZXhwYW5kZWRLZXlTZXQuaGFzKG1lcmdlZEtleSkpIHtcbiAgICAgICAgZmxhdHRlbk5vZGUuY2hpbGRyZW4gPSBkaWcodHJlZU5vZGUuY2hpbGRyZW4gfHwgW10sIGZsYXR0ZW5Ob2RlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZsYXR0ZW5Ob2RlLmNoaWxkcmVuID0gW107XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmbGF0dGVuTm9kZTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpZyh0cmVlTm9kZUxpc3QpO1xuICByZXR1cm4gZmxhdHRlbkxpc3Q7XG59XG4vKipcbiAqIFRyYXZlcnNlIGFsbCB0aGUgZGF0YSBieSBgdHJlZURhdGFgLlxuICogUGxlYXNlIG5vdCB1c2UgaXQgb3V0IG9mIHRoZSBgcmMtdHJlZWAgc2luY2Ugd2UgbWF5IHJlZmFjdG9yIHRoaXMgY29kZS5cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gdHJhdmVyc2VEYXRhTm9kZXMoZGF0YU5vZGVzLCBjYWxsYmFjaywgLy8gVG8gYXZvaWQgdG9vIG1hbnkgcGFyYW1zLCBsZXQgdXNlIGNvbmZpZyBpbnN0ZWFkIG9mIG9yaWdpbiBwYXJhbVxuY29uZmlnKSB7XG4gIC8vIEluaXQgY29uZmlnXG4gIHZhciBleHRlcm5hbEdldEtleSA9IG51bGw7XG4gIHZhciBjaGlsZHJlblByb3BOYW1lO1xuXG4gIHZhciBjb25maWdUeXBlID0gX3R5cGVvZihjb25maWcpO1xuXG4gIGlmIChjb25maWdUeXBlID09PSAnZnVuY3Rpb24nIHx8IGNvbmZpZ1R5cGUgPT09ICdzdHJpbmcnKSB7XG4gICAgLy8gTGVnYWN5IGdldEtleSBwYXJhbVxuICAgIGV4dGVybmFsR2V0S2V5ID0gY29uZmlnO1xuICB9IGVsc2UgaWYgKGNvbmZpZyAmJiBjb25maWdUeXBlID09PSAnb2JqZWN0Jykge1xuICAgIGNoaWxkcmVuUHJvcE5hbWUgPSBjb25maWcuY2hpbGRyZW5Qcm9wTmFtZTtcbiAgICBleHRlcm5hbEdldEtleSA9IGNvbmZpZy5leHRlcm5hbEdldEtleTtcbiAgfVxuXG4gIGNoaWxkcmVuUHJvcE5hbWUgPSBjaGlsZHJlblByb3BOYW1lIHx8ICdjaGlsZHJlbic7IC8vIEdldCBrZXlzXG5cbiAgdmFyIHN5bnRoZXRpY0dldEtleTtcblxuICBpZiAoZXh0ZXJuYWxHZXRLZXkpIHtcbiAgICBpZiAodHlwZW9mIGV4dGVybmFsR2V0S2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgc3ludGhldGljR2V0S2V5ID0gZnVuY3Rpb24gc3ludGhldGljR2V0S2V5KG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGVbZXh0ZXJuYWxHZXRLZXldO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBleHRlcm5hbEdldEtleSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgc3ludGhldGljR2V0S2V5ID0gZnVuY3Rpb24gc3ludGhldGljR2V0S2V5KG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsR2V0S2V5KG5vZGUpO1xuICAgICAgfTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgc3ludGhldGljR2V0S2V5ID0gZnVuY3Rpb24gc3ludGhldGljR2V0S2V5KG5vZGUsIHBvcykge1xuICAgICAgcmV0dXJuIGdldEtleShub2RlLmtleSwgcG9zKTtcbiAgICB9O1xuICB9IC8vIFByb2Nlc3NcblxuXG4gIGZ1bmN0aW9uIHByb2Nlc3NOb2RlKG5vZGUsIGluZGV4LCBwYXJlbnQpIHtcbiAgICB2YXIgY2hpbGRyZW4gPSBub2RlID8gbm9kZVtjaGlsZHJlblByb3BOYW1lXSA6IGRhdGFOb2RlcztcbiAgICB2YXIgcG9zID0gbm9kZSA/IGdldFBvc2l0aW9uKHBhcmVudC5wb3MsIGluZGV4KSA6ICcwJzsgLy8gUHJvY2VzcyBub2RlIGlmIGlzIG5vdCByb290XG5cbiAgICBpZiAobm9kZSkge1xuICAgICAgdmFyIGtleSA9IHN5bnRoZXRpY0dldEtleShub2RlLCBwb3MpO1xuICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgIG5vZGU6IG5vZGUsXG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgcG9zOiBwb3MsXG4gICAgICAgIGtleToga2V5LFxuICAgICAgICBwYXJlbnRQb3M6IHBhcmVudC5ub2RlID8gcGFyZW50LnBvcyA6IG51bGwsXG4gICAgICAgIGxldmVsOiBwYXJlbnQubGV2ZWwgKyAxXG4gICAgICB9O1xuICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgfSAvLyBQcm9jZXNzIGNoaWxkcmVuIG5vZGVcblxuXG4gICAgaWYgKGNoaWxkcmVuKSB7XG4gICAgICBjaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChzdWJOb2RlLCBzdWJJbmRleCkge1xuICAgICAgICBwcm9jZXNzTm9kZShzdWJOb2RlLCBzdWJJbmRleCwge1xuICAgICAgICAgIG5vZGU6IG5vZGUsXG4gICAgICAgICAgcG9zOiBwb3MsXG4gICAgICAgICAgbGV2ZWw6IHBhcmVudCA/IHBhcmVudC5sZXZlbCArIDEgOiAtMVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByb2Nlc3NOb2RlKG51bGwpO1xufVxuLyoqXG4gKiBDb252ZXJ0IGB0cmVlRGF0YWAgaW50byBlbnRpdHkgcmVjb3Jkcy5cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY29udmVydERhdGFUb0VudGl0aWVzKGRhdGFOb2Rlcykge1xuICB2YXIgX3JlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge30sXG4gICAgICBpbml0V3JhcHBlciA9IF9yZWYuaW5pdFdyYXBwZXIsXG4gICAgICBwcm9jZXNzRW50aXR5ID0gX3JlZi5wcm9jZXNzRW50aXR5LFxuICAgICAgb25Qcm9jZXNzRmluaXNoZWQgPSBfcmVmLm9uUHJvY2Vzc0ZpbmlzaGVkLFxuICAgICAgZXh0ZXJuYWxHZXRLZXkgPSBfcmVmLmV4dGVybmFsR2V0S2V5LFxuICAgICAgY2hpbGRyZW5Qcm9wTmFtZSA9IF9yZWYuY2hpbGRyZW5Qcm9wTmFtZTtcblxuICB2YXJcbiAgLyoqIEBkZXByZWNhdGVkIFVzZSBgY29uZmlnLmV4dGVybmFsR2V0S2V5YCBpbnN0ZWFkICovXG4gIGxlZ2FjeUV4dGVybmFsR2V0S2V5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7XG4gIC8vIEluaXQgY29uZmlnXG4gIHZhciBtZXJnZWRFeHRlcm5hbEdldEtleSA9IGV4dGVybmFsR2V0S2V5IHx8IGxlZ2FjeUV4dGVybmFsR2V0S2V5O1xuICB2YXIgcG9zRW50aXRpZXMgPSB7fTtcbiAgdmFyIGtleUVudGl0aWVzID0ge307XG4gIHZhciB3cmFwcGVyID0ge1xuICAgIHBvc0VudGl0aWVzOiBwb3NFbnRpdGllcyxcbiAgICBrZXlFbnRpdGllczoga2V5RW50aXRpZXNcbiAgfTtcblxuICBpZiAoaW5pdFdyYXBwZXIpIHtcbiAgICB3cmFwcGVyID0gaW5pdFdyYXBwZXIod3JhcHBlcikgfHwgd3JhcHBlcjtcbiAgfVxuXG4gIHRyYXZlcnNlRGF0YU5vZGVzKGRhdGFOb2RlcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgbm9kZSA9IGl0ZW0ubm9kZSxcbiAgICAgICAgaW5kZXggPSBpdGVtLmluZGV4LFxuICAgICAgICBwb3MgPSBpdGVtLnBvcyxcbiAgICAgICAga2V5ID0gaXRlbS5rZXksXG4gICAgICAgIHBhcmVudFBvcyA9IGl0ZW0ucGFyZW50UG9zLFxuICAgICAgICBsZXZlbCA9IGl0ZW0ubGV2ZWw7XG4gICAgdmFyIGVudGl0eSA9IHtcbiAgICAgIG5vZGU6IG5vZGUsXG4gICAgICBpbmRleDogaW5kZXgsXG4gICAgICBrZXk6IGtleSxcbiAgICAgIHBvczogcG9zLFxuICAgICAgbGV2ZWw6IGxldmVsXG4gICAgfTtcbiAgICB2YXIgbWVyZ2VkS2V5ID0gZ2V0S2V5KGtleSwgcG9zKTtcbiAgICBwb3NFbnRpdGllc1twb3NdID0gZW50aXR5O1xuICAgIGtleUVudGl0aWVzW21lcmdlZEtleV0gPSBlbnRpdHk7IC8vIEZpbGwgY2hpbGRyZW5cblxuICAgIGVudGl0eS5wYXJlbnQgPSBwb3NFbnRpdGllc1twYXJlbnRQb3NdO1xuXG4gICAgaWYgKGVudGl0eS5wYXJlbnQpIHtcbiAgICAgIGVudGl0eS5wYXJlbnQuY2hpbGRyZW4gPSBlbnRpdHkucGFyZW50LmNoaWxkcmVuIHx8IFtdO1xuICAgICAgZW50aXR5LnBhcmVudC5jaGlsZHJlbi5wdXNoKGVudGl0eSk7XG4gICAgfVxuXG4gICAgaWYgKHByb2Nlc3NFbnRpdHkpIHtcbiAgICAgIHByb2Nlc3NFbnRpdHkoZW50aXR5LCB3cmFwcGVyKTtcbiAgICB9XG4gIH0sIHtcbiAgICBleHRlcm5hbEdldEtleTogbWVyZ2VkRXh0ZXJuYWxHZXRLZXksXG4gICAgY2hpbGRyZW5Qcm9wTmFtZTogY2hpbGRyZW5Qcm9wTmFtZVxuICB9KTtcblxuICBpZiAob25Qcm9jZXNzRmluaXNoZWQpIHtcbiAgICBvblByb2Nlc3NGaW5pc2hlZCh3cmFwcGVyKTtcbiAgfVxuXG4gIHJldHVybiB3cmFwcGVyO1xufVxuLyoqXG4gKiBHZXQgVHJlZU5vZGUgcHJvcHMgd2l0aCBUcmVlIHByb3BzLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUcmVlTm9kZVByb3BzKGtleSwgX3JlZjIpIHtcbiAgdmFyIGV4cGFuZGVkS2V5cyA9IF9yZWYyLmV4cGFuZGVkS2V5cyxcbiAgICAgIHNlbGVjdGVkS2V5cyA9IF9yZWYyLnNlbGVjdGVkS2V5cyxcbiAgICAgIGxvYWRlZEtleXMgPSBfcmVmMi5sb2FkZWRLZXlzLFxuICAgICAgbG9hZGluZ0tleXMgPSBfcmVmMi5sb2FkaW5nS2V5cyxcbiAgICAgIGNoZWNrZWRLZXlzID0gX3JlZjIuY2hlY2tlZEtleXMsXG4gICAgICBoYWxmQ2hlY2tlZEtleXMgPSBfcmVmMi5oYWxmQ2hlY2tlZEtleXMsXG4gICAgICBkcmFnT3Zlck5vZGVLZXkgPSBfcmVmMi5kcmFnT3Zlck5vZGVLZXksXG4gICAgICBkcm9wUG9zaXRpb24gPSBfcmVmMi5kcm9wUG9zaXRpb24sXG4gICAgICBrZXlFbnRpdGllcyA9IF9yZWYyLmtleUVudGl0aWVzO1xuICB2YXIgZW50aXR5ID0ga2V5RW50aXRpZXNba2V5XTtcbiAgdmFyIHRyZWVOb2RlUHJvcHMgPSB7XG4gICAgZXZlbnRLZXk6IGtleSxcbiAgICBleHBhbmRlZDogZXhwYW5kZWRLZXlzLmluZGV4T2Yoa2V5KSAhPT0gLTEsXG4gICAgc2VsZWN0ZWQ6IHNlbGVjdGVkS2V5cy5pbmRleE9mKGtleSkgIT09IC0xLFxuICAgIGxvYWRlZDogbG9hZGVkS2V5cy5pbmRleE9mKGtleSkgIT09IC0xLFxuICAgIGxvYWRpbmc6IGxvYWRpbmdLZXlzLmluZGV4T2Yoa2V5KSAhPT0gLTEsXG4gICAgY2hlY2tlZDogY2hlY2tlZEtleXMuaW5kZXhPZihrZXkpICE9PSAtMSxcbiAgICBoYWxmQ2hlY2tlZDogaGFsZkNoZWNrZWRLZXlzLmluZGV4T2Yoa2V5KSAhPT0gLTEsXG4gICAgcG9zOiBTdHJpbmcoZW50aXR5ID8gZW50aXR5LnBvcyA6ICcnKSxcbiAgICAvLyBbTGVnYWN5XSBEcmFnIHByb3BzXG4gICAgLy8gU2luY2UgdGhlIGludGVyYWN0aW9uIG9mIGRyYWcgaXMgY2hhbmdlZCwgdGhlIHNlbWFudGljIG9mIHRoZSBwcm9wcyBhcmVcbiAgICAvLyBub3QgYWNjdXJhY3ksIEkgdGhpbmsgaXQgc2hvdWxkIGJlIGZpbmFsbHkgcmVtb3ZlZFxuICAgIGRyYWdPdmVyOiBkcmFnT3Zlck5vZGVLZXkgPT09IGtleSAmJiBkcm9wUG9zaXRpb24gPT09IDAsXG4gICAgZHJhZ092ZXJHYXBUb3A6IGRyYWdPdmVyTm9kZUtleSA9PT0ga2V5ICYmIGRyb3BQb3NpdGlvbiA9PT0gLTEsXG4gICAgZHJhZ092ZXJHYXBCb3R0b206IGRyYWdPdmVyTm9kZUtleSA9PT0ga2V5ICYmIGRyb3BQb3NpdGlvbiA9PT0gMVxuICB9O1xuICByZXR1cm4gdHJlZU5vZGVQcm9wcztcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0Tm9kZVByb3BzVG9FdmVudERhdGEocHJvcHMpIHtcbiAgdmFyIGRhdGEgPSBwcm9wcy5kYXRhLFxuICAgICAgZXhwYW5kZWQgPSBwcm9wcy5leHBhbmRlZCxcbiAgICAgIHNlbGVjdGVkID0gcHJvcHMuc2VsZWN0ZWQsXG4gICAgICBjaGVja2VkID0gcHJvcHMuY2hlY2tlZCxcbiAgICAgIGxvYWRlZCA9IHByb3BzLmxvYWRlZCxcbiAgICAgIGxvYWRpbmcgPSBwcm9wcy5sb2FkaW5nLFxuICAgICAgaGFsZkNoZWNrZWQgPSBwcm9wcy5oYWxmQ2hlY2tlZCxcbiAgICAgIGRyYWdPdmVyID0gcHJvcHMuZHJhZ092ZXIsXG4gICAgICBkcmFnT3ZlckdhcFRvcCA9IHByb3BzLmRyYWdPdmVyR2FwVG9wLFxuICAgICAgZHJhZ092ZXJHYXBCb3R0b20gPSBwcm9wcy5kcmFnT3ZlckdhcEJvdHRvbSxcbiAgICAgIHBvcyA9IHByb3BzLnBvcyxcbiAgICAgIGFjdGl2ZSA9IHByb3BzLmFjdGl2ZTtcblxuICB2YXIgZXZlbnREYXRhID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkYXRhKSwge30sIHtcbiAgICBleHBhbmRlZDogZXhwYW5kZWQsXG4gICAgc2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgIGNoZWNrZWQ6IGNoZWNrZWQsXG4gICAgbG9hZGVkOiBsb2FkZWQsXG4gICAgbG9hZGluZzogbG9hZGluZyxcbiAgICBoYWxmQ2hlY2tlZDogaGFsZkNoZWNrZWQsXG4gICAgZHJhZ092ZXI6IGRyYWdPdmVyLFxuICAgIGRyYWdPdmVyR2FwVG9wOiBkcmFnT3ZlckdhcFRvcCxcbiAgICBkcmFnT3ZlckdhcEJvdHRvbTogZHJhZ092ZXJHYXBCb3R0b20sXG4gICAgcG9zOiBwb3MsXG4gICAgYWN0aXZlOiBhY3RpdmVcbiAgfSk7XG5cbiAgaWYgKCEoJ3Byb3BzJyBpbiBldmVudERhdGEpKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV2ZW50RGF0YSwgJ3Byb3BzJywge1xuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgIHdhcm5pbmcoZmFsc2UsICdTZWNvbmQgcGFyYW0gcmV0dXJuIGZyb20gZXZlbnQgaXMgbm9kZSBkYXRhIGluc3RlYWQgb2YgVHJlZU5vZGUgaW5zdGFuY2UuIFBsZWFzZSByZWFkIHZhbHVlIGRpcmVjdGx5IGluc3RlYWQgb2YgcmVhZGluZyBmcm9tIGBwcm9wc2AuJyk7XG4gICAgICAgIHJldHVybiBwcm9wcztcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBldmVudERhdGE7XG59IiwiaW1wb3J0IF9leHRlbmRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9leHRlbmRzXCI7XG5pbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMlwiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgQ1NTTW90aW9uIGZyb20gJ3JjLW1vdGlvbic7XG5pbXBvcnQgeyBnZXRNb3Rpb24gfSBmcm9tICcuLi91dGlscy9sZWdhY3lVdGlsJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1hc2socHJvcHMpIHtcbiAgdmFyIHByZWZpeENscyA9IHByb3BzLnByZWZpeENscyxcbiAgICAgIHZpc2libGUgPSBwcm9wcy52aXNpYmxlLFxuICAgICAgekluZGV4ID0gcHJvcHMuekluZGV4LFxuICAgICAgbWFzayA9IHByb3BzLm1hc2ssXG4gICAgICBtYXNrTW90aW9uID0gcHJvcHMubWFza01vdGlvbixcbiAgICAgIG1hc2tBbmltYXRpb24gPSBwcm9wcy5tYXNrQW5pbWF0aW9uLFxuICAgICAgbWFza1RyYW5zaXRpb25OYW1lID0gcHJvcHMubWFza1RyYW5zaXRpb25OYW1lO1xuXG4gIGlmICghbWFzaykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIG1vdGlvbiA9IHt9O1xuXG4gIGlmIChtYXNrTW90aW9uIHx8IG1hc2tUcmFuc2l0aW9uTmFtZSB8fCBtYXNrQW5pbWF0aW9uKSB7XG4gICAgbW90aW9uID0gX29iamVjdFNwcmVhZCh7XG4gICAgICBtb3Rpb25BcHBlYXI6IHRydWVcbiAgICB9LCBnZXRNb3Rpb24oe1xuICAgICAgbW90aW9uOiBtYXNrTW90aW9uLFxuICAgICAgcHJlZml4Q2xzOiBwcmVmaXhDbHMsXG4gICAgICB0cmFuc2l0aW9uTmFtZTogbWFza1RyYW5zaXRpb25OYW1lLFxuICAgICAgYW5pbWF0aW9uOiBtYXNrQW5pbWF0aW9uXG4gICAgfSkpO1xuICB9XG5cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENTU01vdGlvbiwgX2V4dGVuZHMoe30sIG1vdGlvbiwge1xuICAgIHZpc2libGU6IHZpc2libGUsXG4gICAgcmVtb3ZlT25MZWF2ZTogdHJ1ZVxuICB9KSwgZnVuY3Rpb24gKF9yZWYpIHtcbiAgICB2YXIgY2xhc3NOYW1lID0gX3JlZi5jbGFzc05hbWU7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIHpJbmRleDogekluZGV4XG4gICAgICB9LFxuICAgICAgY2xhc3NOYW1lOiBjbGFzc05hbWVzKFwiXCIuY29uY2F0KHByZWZpeENscywgXCItbWFza1wiKSwgY2xhc3NOYW1lKVxuICAgIH0pO1xuICB9KTtcbn0iLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQ1NTTW90aW9uIGZyb20gJ3JjLW1vdGlvbic7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbnZhciBNb2JpbGVQb3B1cElubmVyID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoZnVuY3Rpb24gKHByb3BzLCByZWYpIHtcbiAgdmFyIHByZWZpeENscyA9IHByb3BzLnByZWZpeENscyxcbiAgICAgIHZpc2libGUgPSBwcm9wcy52aXNpYmxlLFxuICAgICAgekluZGV4ID0gcHJvcHMuekluZGV4LFxuICAgICAgY2hpbGRyZW4gPSBwcm9wcy5jaGlsZHJlbixcbiAgICAgIF9wcm9wcyRtb2JpbGUgPSBwcm9wcy5tb2JpbGU7XG4gIF9wcm9wcyRtb2JpbGUgPSBfcHJvcHMkbW9iaWxlID09PSB2b2lkIDAgPyB7fSA6IF9wcm9wcyRtb2JpbGU7XG4gIHZhciBwb3B1cENsYXNzTmFtZSA9IF9wcm9wcyRtb2JpbGUucG9wdXBDbGFzc05hbWUsXG4gICAgICBwb3B1cFN0eWxlID0gX3Byb3BzJG1vYmlsZS5wb3B1cFN0eWxlLFxuICAgICAgX3Byb3BzJG1vYmlsZSRwb3B1cE1vID0gX3Byb3BzJG1vYmlsZS5wb3B1cE1vdGlvbixcbiAgICAgIHBvcHVwTW90aW9uID0gX3Byb3BzJG1vYmlsZSRwb3B1cE1vID09PSB2b2lkIDAgPyB7fSA6IF9wcm9wcyRtb2JpbGUkcG9wdXBNbyxcbiAgICAgIHBvcHVwUmVuZGVyID0gX3Byb3BzJG1vYmlsZS5wb3B1cFJlbmRlcjtcbiAgdmFyIGVsZW1lbnRSZWYgPSBSZWFjdC51c2VSZWYoKTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PSBSZWZzID09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBSZWFjdC51c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBmb3JjZUFsaWduOiBmdW5jdGlvbiBmb3JjZUFsaWduKCkge30sXG4gICAgICBnZXRFbGVtZW50OiBmdW5jdGlvbiBnZXRFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudFJlZi5jdXJyZW50O1xuICAgICAgfVxuICAgIH07XG4gIH0pOyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT0gUmVuZGVyID09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHZhciBtZXJnZWRTdHlsZSA9IF9vYmplY3RTcHJlYWQoe1xuICAgIHpJbmRleDogekluZGV4XG4gIH0sIHBvcHVwU3R5bGUpO1xuXG4gIHZhciBjaGlsZE5vZGUgPSBjaGlsZHJlbjsgLy8gV3JhcHBlciB3aGVuIG11bHRpcGxlIGNoaWxkcmVuXG5cbiAgaWYgKFJlYWN0LkNoaWxkcmVuLmNvdW50KGNoaWxkcmVuKSA+IDEpIHtcbiAgICBjaGlsZE5vZGUgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7XG4gICAgICBjbGFzc05hbWU6IFwiXCIuY29uY2F0KHByZWZpeENscywgXCItY29udGVudFwiKVxuICAgIH0sIGNoaWxkcmVuKTtcbiAgfSAvLyBNb2JpbGUgc3VwcG9ydCBhZGRpdGlvbmFsIHJlbmRlclxuXG5cbiAgaWYgKHBvcHVwUmVuZGVyKSB7XG4gICAgY2hpbGROb2RlID0gcG9wdXBSZW5kZXIoY2hpbGROb2RlKTtcbiAgfVxuXG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChDU1NNb3Rpb24sIF9leHRlbmRzKHtcbiAgICB2aXNpYmxlOiB2aXNpYmxlLFxuICAgIHJlZjogZWxlbWVudFJlZixcbiAgICByZW1vdmVPbkxlYXZlOiB0cnVlXG4gIH0sIHBvcHVwTW90aW9uKSwgZnVuY3Rpb24gKF9yZWYsIG1vdGlvblJlZikge1xuICAgIHZhciBtb3Rpb25DbGFzc05hbWUgPSBfcmVmLmNsYXNzTmFtZSxcbiAgICAgICAgbW90aW9uU3R5bGUgPSBfcmVmLnN0eWxlO1xuICAgIHZhciBtZXJnZWRDbGFzc05hbWUgPSBjbGFzc05hbWVzKHByZWZpeENscywgcG9wdXBDbGFzc05hbWUsIG1vdGlvbkNsYXNzTmFtZSk7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgIHJlZjogbW90aW9uUmVmLFxuICAgICAgY2xhc3NOYW1lOiBtZXJnZWRDbGFzc05hbWUsXG4gICAgICBzdHlsZTogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtb3Rpb25TdHlsZSksIG1lcmdlZFN0eWxlKVxuICAgIH0sIGNoaWxkTm9kZSk7XG4gIH0pO1xufSk7XG5Nb2JpbGVQb3B1cElubmVyLmRpc3BsYXlOYW1lID0gJ01vYmlsZVBvcHVwSW5uZXInO1xuZXhwb3J0IGRlZmF1bHQgTW9iaWxlUG9wdXBJbm5lcjsiLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXlcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVJlZiwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQWxpZ24gZnJvbSAncmMtYWxpZ24nO1xuaW1wb3J0IENTU01vdGlvbiBmcm9tICdyYy1tb3Rpb24nO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgdXNlVmlzaWJsZVN0YXR1cyBmcm9tICcuL3VzZVZpc2libGVTdGF0dXMnO1xuaW1wb3J0IHsgZ2V0TW90aW9uIH0gZnJvbSAnLi4vdXRpbHMvbGVnYWN5VXRpbCc7XG5pbXBvcnQgdXNlU3RyZXRjaFN0eWxlIGZyb20gJy4vdXNlU3RyZXRjaFN0eWxlJztcbnZhciBQb3B1cElubmVyID0gLyojX19QVVJFX18qL1JlYWN0LmZvcndhcmRSZWYoZnVuY3Rpb24gKHByb3BzLCByZWYpIHtcbiAgdmFyIHZpc2libGUgPSBwcm9wcy52aXNpYmxlLFxuICAgICAgcHJlZml4Q2xzID0gcHJvcHMucHJlZml4Q2xzLFxuICAgICAgY2xhc3NOYW1lID0gcHJvcHMuY2xhc3NOYW1lLFxuICAgICAgc3R5bGUgPSBwcm9wcy5zdHlsZSxcbiAgICAgIGNoaWxkcmVuID0gcHJvcHMuY2hpbGRyZW4sXG4gICAgICB6SW5kZXggPSBwcm9wcy56SW5kZXgsXG4gICAgICBzdHJldGNoID0gcHJvcHMuc3RyZXRjaCxcbiAgICAgIGRlc3Ryb3lQb3B1cE9uSGlkZSA9IHByb3BzLmRlc3Ryb3lQb3B1cE9uSGlkZSxcbiAgICAgIGZvcmNlUmVuZGVyID0gcHJvcHMuZm9yY2VSZW5kZXIsXG4gICAgICBhbGlnbiA9IHByb3BzLmFsaWduLFxuICAgICAgcG9pbnQgPSBwcm9wcy5wb2ludCxcbiAgICAgIGdldFJvb3REb21Ob2RlID0gcHJvcHMuZ2V0Um9vdERvbU5vZGUsXG4gICAgICBnZXRDbGFzc05hbWVGcm9tQWxpZ24gPSBwcm9wcy5nZXRDbGFzc05hbWVGcm9tQWxpZ24sXG4gICAgICBvbkFsaWduID0gcHJvcHMub25BbGlnbixcbiAgICAgIG9uTW91c2VFbnRlciA9IHByb3BzLm9uTW91c2VFbnRlcixcbiAgICAgIG9uTW91c2VMZWF2ZSA9IHByb3BzLm9uTW91c2VMZWF2ZSxcbiAgICAgIG9uTW91c2VEb3duID0gcHJvcHMub25Nb3VzZURvd24sXG4gICAgICBvblRvdWNoU3RhcnQgPSBwcm9wcy5vblRvdWNoU3RhcnQ7XG4gIHZhciBhbGlnblJlZiA9IHVzZVJlZigpO1xuICB2YXIgZWxlbWVudFJlZiA9IHVzZVJlZigpO1xuXG4gIHZhciBfdXNlU3RhdGUgPSB1c2VTdGF0ZSgpLFxuICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksXG4gICAgICBhbGlnbmVkQ2xhc3NOYW1lID0gX3VzZVN0YXRlMlswXSxcbiAgICAgIHNldEFsaWduZWRDbGFzc05hbWUgPSBfdXNlU3RhdGUyWzFdOyAvLyA9PT09PT09PT09PT09PT09PT09PT09PSBNZWFzdXJlID09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgdmFyIF91c2VTdHJldGNoU3R5bGUgPSB1c2VTdHJldGNoU3R5bGUoc3RyZXRjaCksXG4gICAgICBfdXNlU3RyZXRjaFN0eWxlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdHJldGNoU3R5bGUsIDIpLFxuICAgICAgc3RyZXRjaFN0eWxlID0gX3VzZVN0cmV0Y2hTdHlsZTJbMF0sXG4gICAgICBtZWFzdXJlU3RyZXRjaFN0eWxlID0gX3VzZVN0cmV0Y2hTdHlsZTJbMV07XG5cbiAgZnVuY3Rpb24gZG9NZWFzdXJlKCkge1xuICAgIGlmIChzdHJldGNoKSB7XG4gICAgICBtZWFzdXJlU3RyZXRjaFN0eWxlKGdldFJvb3REb21Ob2RlKCkpO1xuICAgIH1cbiAgfSAvLyA9PT09PT09PT09PT09PT09PT09PT09PT0gU3RhdHVzID09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgdmFyIF91c2VWaXNpYmxlU3RhdHVzID0gdXNlVmlzaWJsZVN0YXR1cyh2aXNpYmxlLCBkb01lYXN1cmUpLFxuICAgICAgX3VzZVZpc2libGVTdGF0dXMyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVZpc2libGVTdGF0dXMsIDIpLFxuICAgICAgc3RhdHVzID0gX3VzZVZpc2libGVTdGF0dXMyWzBdLFxuICAgICAgZ29OZXh0U3RhdHVzID0gX3VzZVZpc2libGVTdGF0dXMyWzFdOyAvLyA9PT09PT09PT09PT09PT09PT09PT09PT0gQWxpZ25zID09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgdmFyIHByZXBhcmVSZXNvbHZlUmVmID0gdXNlUmVmKCk7IC8vIGB0YXJnZXRgIG9uIGByYy1hbGlnbmAgY2FuIGFjY2VwdCBhcyBhIGZ1bmN0aW9uIHRvIGdldCB0aGUgYmluZCBlbGVtZW50IG9yIGEgcG9pbnQuXG4gIC8vIHJlZjogaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvcmMtYWxpZ25cblxuICBmdW5jdGlvbiBnZXRBbGlnblRhcmdldCgpIHtcbiAgICBpZiAocG9pbnQpIHtcbiAgICAgIHJldHVybiBwb2ludDtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0Um9vdERvbU5vZGU7XG4gIH1cblxuICBmdW5jdGlvbiBmb3JjZUFsaWduKCkge1xuICAgIHZhciBfYWxpZ25SZWYkY3VycmVudDtcblxuICAgIChfYWxpZ25SZWYkY3VycmVudCA9IGFsaWduUmVmLmN1cnJlbnQpID09PSBudWxsIHx8IF9hbGlnblJlZiRjdXJyZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYWxpZ25SZWYkY3VycmVudC5mb3JjZUFsaWduKCk7XG4gIH1cblxuICBmdW5jdGlvbiBvbkludGVybmFsQWxpZ24ocG9wdXBEb21Ob2RlLCBtYXRjaEFsaWduKSB7XG4gICAgaWYgKHN0YXR1cyA9PT0gJ2FsaWduJykge1xuICAgICAgdmFyIG5leHRBbGlnbmVkQ2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lRnJvbUFsaWduKG1hdGNoQWxpZ24pO1xuICAgICAgc2V0QWxpZ25lZENsYXNzTmFtZShuZXh0QWxpZ25lZENsYXNzTmFtZSk7IC8vIFJlcGVhdCB1bnRpbCBub3QgbW9yZSBhbGlnbiBuZWVkZWRcblxuICAgICAgaWYgKGFsaWduZWRDbGFzc05hbWUgIT09IG5leHRBbGlnbmVkQ2xhc3NOYW1lKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGZvcmNlQWxpZ24oKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBnb05leHRTdGF0dXMoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBfcHJlcGFyZVJlc29sdmVSZWYkY3U7XG5cbiAgICAgICAgICAoX3ByZXBhcmVSZXNvbHZlUmVmJGN1ID0gcHJlcGFyZVJlc29sdmVSZWYuY3VycmVudCkgPT09IG51bGwgfHwgX3ByZXBhcmVSZXNvbHZlUmVmJGN1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcHJlcGFyZVJlc29sdmVSZWYkY3UuY2FsbChwcmVwYXJlUmVzb2x2ZVJlZik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBvbkFsaWduID09PSBudWxsIHx8IG9uQWxpZ24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9uQWxpZ24ocG9wdXBEb21Ob2RlLCBtYXRjaEFsaWduKTtcbiAgICB9XG4gIH0gLy8gPT09PT09PT09PT09PT09PT09PT09PT09IE1vdGlvbiA9PT09PT09PT09PT09PT09PT09PT09PT1cblxuXG4gIHZhciBtb3Rpb24gPSBfb2JqZWN0U3ByZWFkKHt9LCBnZXRNb3Rpb24ocHJvcHMpKTtcblxuICBbJ29uQXBwZWFyRW5kJywgJ29uRW50ZXJFbmQnLCAnb25MZWF2ZUVuZCddLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgIHZhciBvcmlnaW5IYW5kbGVyID0gbW90aW9uW2V2ZW50TmFtZV07XG5cbiAgICBtb3Rpb25bZXZlbnROYW1lXSA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudCkge1xuICAgICAgZ29OZXh0U3RhdHVzKCk7XG4gICAgICByZXR1cm4gb3JpZ2luSGFuZGxlciA9PT0gbnVsbCB8fCBvcmlnaW5IYW5kbGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcmlnaW5IYW5kbGVyKGVsZW1lbnQsIGV2ZW50KTtcbiAgICB9O1xuICB9KTtcblxuICBmdW5jdGlvbiBvblNob3dQcmVwYXJlKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgcHJlcGFyZVJlc29sdmVSZWYuY3VycmVudCA9IHJlc29sdmU7XG4gICAgfSk7XG4gIH0gLy8gR28gdG8gc3RhYmxlIGRpcmVjdGx5IHdoZW4gbW90aW9uIG5vdCBwcm92aWRlZFxuXG5cbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIW1vdGlvbi5tb3Rpb25OYW1lICYmIHN0YXR1cyA9PT0gJ21vdGlvbicpIHtcbiAgICAgIGdvTmV4dFN0YXR1cygpO1xuICAgIH1cbiAgfSwgW21vdGlvbi5tb3Rpb25OYW1lLCBzdGF0dXNdKTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PSBSZWZzID09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBSZWFjdC51c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBmb3JjZUFsaWduOiBmb3JjZUFsaWduLFxuICAgICAgZ2V0RWxlbWVudDogZnVuY3Rpb24gZ2V0RWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRSZWYuY3VycmVudDtcbiAgICAgIH1cbiAgICB9O1xuICB9KTsgLy8gPT09PT09PT09PT09PT09PT09PT09PT09IFJlbmRlciA9PT09PT09PT09PT09PT09PT09PT09PT1cblxuICB2YXIgbWVyZ2VkU3R5bGUgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0cmV0Y2hTdHlsZSksIHt9LCB7XG4gICAgekluZGV4OiB6SW5kZXgsXG4gICAgb3BhY2l0eTogc3RhdHVzID09PSAnbW90aW9uJyB8fCBzdGF0dXMgPT09ICdzdGFibGUnIHx8ICF2aXNpYmxlID8gdW5kZWZpbmVkIDogMCxcbiAgICBwb2ludGVyRXZlbnRzOiBzdGF0dXMgPT09ICdzdGFibGUnID8gdW5kZWZpbmVkIDogJ25vbmUnXG4gIH0sIHN0eWxlKTsgLy8gQWxpZ24gc3RhdHVzXG5cblxuICB2YXIgYWxpZ25EaXNhYmxlZCA9IHRydWU7XG5cbiAgaWYgKChhbGlnbiA9PT0gbnVsbCB8fCBhbGlnbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxpZ24ucG9pbnRzKSAmJiAoc3RhdHVzID09PSAnYWxpZ24nIHx8IHN0YXR1cyA9PT0gJ3N0YWJsZScpKSB7XG4gICAgYWxpZ25EaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIGNoaWxkTm9kZSA9IGNoaWxkcmVuOyAvLyBXcmFwcGVyIHdoZW4gbXVsdGlwbGUgY2hpbGRyZW5cblxuICBpZiAoUmVhY3QuQ2hpbGRyZW4uY291bnQoY2hpbGRyZW4pID4gMSkge1xuICAgIGNoaWxkTm9kZSA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgIGNsYXNzTmFtZTogXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1jb250ZW50XCIpXG4gICAgfSwgY2hpbGRyZW4pO1xuICB9XG5cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KENTU01vdGlvbiwgX2V4dGVuZHMoe1xuICAgIHZpc2libGU6IHZpc2libGUsXG4gICAgcmVmOiBlbGVtZW50UmVmLFxuICAgIGxlYXZlZENsYXNzTmFtZTogXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1oaWRkZW5cIilcbiAgfSwgbW90aW9uLCB7XG4gICAgb25BcHBlYXJQcmVwYXJlOiBvblNob3dQcmVwYXJlLFxuICAgIG9uRW50ZXJQcmVwYXJlOiBvblNob3dQcmVwYXJlLFxuICAgIHJlbW92ZU9uTGVhdmU6IGRlc3Ryb3lQb3B1cE9uSGlkZSxcbiAgICBmb3JjZVJlbmRlcjogZm9yY2VSZW5kZXJcbiAgfSksIGZ1bmN0aW9uIChfcmVmLCBtb3Rpb25SZWYpIHtcbiAgICB2YXIgbW90aW9uQ2xhc3NOYW1lID0gX3JlZi5jbGFzc05hbWUsXG4gICAgICAgIG1vdGlvblN0eWxlID0gX3JlZi5zdHlsZTtcbiAgICB2YXIgbWVyZ2VkQ2xhc3NOYW1lID0gY2xhc3NOYW1lcyhwcmVmaXhDbHMsIGNsYXNzTmFtZSwgYWxpZ25lZENsYXNzTmFtZSwgbW90aW9uQ2xhc3NOYW1lKTtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQWxpZ24sIHtcbiAgICAgIHRhcmdldDogZ2V0QWxpZ25UYXJnZXQoKSxcbiAgICAgIGtleTogXCJwb3B1cFwiLFxuICAgICAgcmVmOiBhbGlnblJlZixcbiAgICAgIG1vbml0b3JXaW5kb3dSZXNpemU6IHRydWUsXG4gICAgICBkaXNhYmxlZDogYWxpZ25EaXNhYmxlZCxcbiAgICAgIGFsaWduOiBhbGlnbixcbiAgICAgIG9uQWxpZ246IG9uSW50ZXJuYWxBbGlnblxuICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICAgIHJlZjogbW90aW9uUmVmLFxuICAgICAgY2xhc3NOYW1lOiBtZXJnZWRDbGFzc05hbWUsXG4gICAgICBvbk1vdXNlRW50ZXI6IG9uTW91c2VFbnRlcixcbiAgICAgIG9uTW91c2VMZWF2ZTogb25Nb3VzZUxlYXZlLFxuICAgICAgb25Nb3VzZURvd25DYXB0dXJlOiBvbk1vdXNlRG93bixcbiAgICAgIG9uVG91Y2hTdGFydENhcHR1cmU6IG9uVG91Y2hTdGFydCxcbiAgICAgIHN0eWxlOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1vdGlvblN0eWxlKSwgbWVyZ2VkU3R5bGUpXG4gICAgfSwgY2hpbGROb2RlKSk7XG4gIH0pO1xufSk7XG5Qb3B1cElubmVyLmRpc3BsYXlOYW1lID0gJ1BvcHVwSW5uZXInO1xuZXhwb3J0IGRlZmF1bHQgUG9wdXBJbm5lcjsiLCJpbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXlcIjtcbmltcG9ydCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGlzTW9iaWxlIGZyb20gXCJyYy11dGlsL2VzL2lzTW9iaWxlXCI7XG5pbXBvcnQgTWFzayBmcm9tICcuL01hc2snO1xuaW1wb3J0IFBvcHVwSW5uZXIgZnJvbSAnLi9Qb3B1cElubmVyJztcbmltcG9ydCBNb2JpbGVQb3B1cElubmVyIGZyb20gJy4vTW9iaWxlUG9wdXBJbm5lcic7XG52YXIgUG9wdXAgPSAvKiNfX1BVUkVfXyovUmVhY3QuZm9yd2FyZFJlZihmdW5jdGlvbiAoX3JlZiwgcmVmKSB7XG4gIHZhciB2aXNpYmxlID0gX3JlZi52aXNpYmxlLFxuICAgICAgbW9iaWxlID0gX3JlZi5tb2JpbGUsXG4gICAgICBwcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfcmVmLCBbXCJ2aXNpYmxlXCIsIFwibW9iaWxlXCJdKTtcblxuICB2YXIgX3VzZVN0YXRlID0gdXNlU3RhdGUodmlzaWJsZSksXG4gICAgICBfdXNlU3RhdGUyID0gX3NsaWNlZFRvQXJyYXkoX3VzZVN0YXRlLCAyKSxcbiAgICAgIGlubmVyVmlzaWJsZSA9IF91c2VTdGF0ZTJbMF0sXG4gICAgICBzZXJJbm5lclZpc2libGUgPSBfdXNlU3RhdGUyWzFdO1xuXG4gIHZhciBfdXNlU3RhdGUzID0gdXNlU3RhdGUoZmFsc2UpLFxuICAgICAgX3VzZVN0YXRlNCA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZTMsIDIpLFxuICAgICAgaW5Nb2JpbGUgPSBfdXNlU3RhdGU0WzBdLFxuICAgICAgc2V0SW5Nb2JpbGUgPSBfdXNlU3RhdGU0WzFdO1xuXG4gIHZhciBjbG9uZVByb3BzID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBwcm9wcyksIHt9LCB7XG4gICAgdmlzaWJsZTogaW5uZXJWaXNpYmxlXG4gIH0pOyAvLyBXZSBjaGVjayBtb2JpbGUgaW4gdmlzaWJsZSBjaGFuZ2VkIGhlcmUuXG4gIC8vIEFuZCB0aGlzIGFsc28gZGVsYXkgc2V0IGBpbm5lclZpc2libGVgIHRvIGF2b2lkIHBvcHVwIGNvbXBvbmVudCByZW5kZXIgZmxhc2hcblxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgc2VySW5uZXJWaXNpYmxlKHZpc2libGUpO1xuXG4gICAgaWYgKHZpc2libGUgJiYgbW9iaWxlKSB7XG4gICAgICBzZXRJbk1vYmlsZShpc01vYmlsZSgpKTtcbiAgICB9XG4gIH0sIFt2aXNpYmxlLCBtb2JpbGVdKTtcbiAgdmFyIHBvcHVwTm9kZSA9IGluTW9iaWxlID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoTW9iaWxlUG9wdXBJbm5lciwgX2V4dGVuZHMoe30sIGNsb25lUHJvcHMsIHtcbiAgICBtb2JpbGU6IG1vYmlsZSxcbiAgICByZWY6IHJlZlxuICB9KSkgOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3B1cElubmVyLCBfZXh0ZW5kcyh7fSwgY2xvbmVQcm9wcywge1xuICAgIHJlZjogcmVmXG4gIH0pKTsgLy8gV2UgY2FuIHVzZSBmcmFnbWVudCBkaXJlY3RseSBidXQgdGhpcyBtYXkgZmFpbGVkIHNvbWUgc2VsZWN0b3IgdXNhZ2UuIEtlZXAgYXMgb3JpZ2luIGxvZ2ljXG5cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KE1hc2ssIGNsb25lUHJvcHMpLCBwb3B1cE5vZGUpO1xufSk7XG5Qb3B1cC5kaXNwbGF5TmFtZSA9ICdQb3B1cCc7XG5leHBvcnQgZGVmYXVsdCBQb3B1cDsiLCJpbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXlcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoc3RyZXRjaCkge1xuICB2YXIgX1JlYWN0JHVzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMFxuICB9KSxcbiAgICAgIF9SZWFjdCR1c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGUsIDIpLFxuICAgICAgdGFyZ2V0U2l6ZSA9IF9SZWFjdCR1c2VTdGF0ZTJbMF0sXG4gICAgICBzZXRUYXJnZXRTaXplID0gX1JlYWN0JHVzZVN0YXRlMlsxXTtcblxuICBmdW5jdGlvbiBtZWFzdXJlU3RyZXRjaChlbGVtZW50KSB7XG4gICAgc2V0VGFyZ2V0U2l6ZSh7XG4gICAgICB3aWR0aDogZWxlbWVudC5vZmZzZXRXaWR0aCxcbiAgICAgIGhlaWdodDogZWxlbWVudC5vZmZzZXRIZWlnaHRcbiAgICB9KTtcbiAgfSAvLyBNZXJnZSBzdHJldGNoIHN0eWxlXG5cblxuICB2YXIgc3R5bGUgPSBSZWFjdC51c2VNZW1vKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2l6ZVN0eWxlID0ge307XG5cbiAgICBpZiAoc3RyZXRjaCkge1xuICAgICAgdmFyIHdpZHRoID0gdGFyZ2V0U2l6ZS53aWR0aCxcbiAgICAgICAgICBoZWlnaHQgPSB0YXJnZXRTaXplLmhlaWdodDsgLy8gU3RyZXRjaCB3aXRoIHRhcmdldFxuXG4gICAgICBpZiAoc3RyZXRjaC5pbmRleE9mKCdoZWlnaHQnKSAhPT0gLTEgJiYgaGVpZ2h0KSB7XG4gICAgICAgIHNpemVTdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICB9IGVsc2UgaWYgKHN0cmV0Y2guaW5kZXhPZignbWluSGVpZ2h0JykgIT09IC0xICYmIGhlaWdodCkge1xuICAgICAgICBzaXplU3R5bGUubWluSGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RyZXRjaC5pbmRleE9mKCd3aWR0aCcpICE9PSAtMSAmJiB3aWR0aCkge1xuICAgICAgICBzaXplU3R5bGUud2lkdGggPSB3aWR0aDtcbiAgICAgIH0gZWxzZSBpZiAoc3RyZXRjaC5pbmRleE9mKCdtaW5XaWR0aCcpICE9PSAtMSAmJiB3aWR0aCkge1xuICAgICAgICBzaXplU3R5bGUubWluV2lkdGggPSB3aWR0aDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2l6ZVN0eWxlO1xuICB9LCBbc3RyZXRjaCwgdGFyZ2V0U2l6ZV0pO1xuICByZXR1cm4gW3N0eWxlLCBtZWFzdXJlU3RyZXRjaF07XG59KTsiLCJpbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIjtcbmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvclwiO1xuaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5XCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgcmFmIGZyb20gXCJyYy11dGlsL2VzL3JhZlwiO1xudmFyIFN0YXR1c1F1ZXVlID0gWydtZWFzdXJlJywgJ2FsaWduJywgbnVsbCwgJ21vdGlvbiddO1xuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICh2aXNpYmxlLCBkb01lYXN1cmUpIHtcbiAgdmFyIF91c2VTdGF0ZSA9IHVzZVN0YXRlKG51bGwpLFxuICAgICAgX3VzZVN0YXRlMiA9IF9zbGljZWRUb0FycmF5KF91c2VTdGF0ZSwgMiksXG4gICAgICBzdGF0dXMgPSBfdXNlU3RhdGUyWzBdLFxuICAgICAgc2V0SW50ZXJuYWxTdGF0dXMgPSBfdXNlU3RhdGUyWzFdO1xuXG4gIHZhciByYWZSZWYgPSB1c2VSZWYoKTtcbiAgdmFyIGRlc3Ryb3lSZWYgPSB1c2VSZWYoZmFsc2UpO1xuXG4gIGZ1bmN0aW9uIHNldFN0YXR1cyhuZXh0U3RhdHVzKSB7XG4gICAgaWYgKCFkZXN0cm95UmVmLmN1cnJlbnQpIHtcbiAgICAgIHNldEludGVybmFsU3RhdHVzKG5leHRTdGF0dXMpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbmNlbFJhZigpIHtcbiAgICByYWYuY2FuY2VsKHJhZlJlZi5jdXJyZW50KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdvTmV4dFN0YXR1cyhjYWxsYmFjaykge1xuICAgIGNhbmNlbFJhZigpO1xuICAgIHJhZlJlZi5jdXJyZW50ID0gcmFmKGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIE9ubHkgYWxpZ24gc2hvdWxkIGJlIG1hbnVhbGx5IHRyaWdnZXJcbiAgICAgIHNldFN0YXR1cyhmdW5jdGlvbiAocHJldikge1xuICAgICAgICBzd2l0Y2ggKHN0YXR1cykge1xuICAgICAgICAgIGNhc2UgJ2FsaWduJzpcbiAgICAgICAgICAgIHJldHVybiAnbW90aW9uJztcblxuICAgICAgICAgIGNhc2UgJ21vdGlvbic6XG4gICAgICAgICAgICByZXR1cm4gJ3N0YWJsZSc7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICB9KTtcbiAgICAgIGNhbGxiYWNrID09PSBudWxsIHx8IGNhbGxiYWNrID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjYWxsYmFjaygpO1xuICAgIH0pO1xuICB9IC8vIEluaXQgc3RhdHVzXG5cblxuICB1c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHNldFN0YXR1cygnbWVhc3VyZScpO1xuICB9LCBbdmlzaWJsZV0pOyAvLyBHbyBuZXh0IHN0YXR1c1xuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgIGNhc2UgJ21lYXN1cmUnOlxuICAgICAgICBkb01lYXN1cmUoKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cykge1xuICAgICAgcmFmUmVmLmN1cnJlbnQgPSByYWYoIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgICAgICB2YXIgaW5kZXgsIG5leHRTdGF0dXM7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgaW5kZXggPSBTdGF0dXNRdWV1ZS5pbmRleE9mKHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgbmV4dFN0YXR1cyA9IFN0YXR1c1F1ZXVlW2luZGV4ICsgMV07XG5cbiAgICAgICAgICAgICAgICBpZiAobmV4dFN0YXR1cyAmJiBpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgIHNldFN0YXR1cyhuZXh0U3RhdHVzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUpO1xuICAgICAgfSkpKTtcbiAgICB9XG4gIH0sIFtzdGF0dXNdKTtcbiAgdXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgZGVzdHJveVJlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgIGNhbmNlbFJhZigpO1xuICAgIH07XG4gIH0sIFtdKTtcbiAgcmV0dXJuIFtzdGF0dXMsIGdvTmV4dFN0YXR1c107XG59KTsiLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG52YXIgVHJpZ2dlckNvbnRleHQgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlQ29udGV4dChudWxsKTtcbmV4cG9ydCBkZWZhdWx0IFRyaWdnZXJDb250ZXh0OyIsImltcG9ydCBfb2JqZWN0U3ByZWFkIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyXCI7XG5pbXBvcnQgX2V4dGVuZHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2V4dGVuZHNcIjtcbmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrXCI7XG5pbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzc1wiO1xuaW1wb3J0IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiO1xuaW1wb3J0IF9pbmhlcml0cyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHNcIjtcbmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCByYWYgZnJvbSBcInJjLXV0aWwvZXMvcmFmXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcInJjLXV0aWwvZXMvRG9tL2NvbnRhaW5zXCI7XG5pbXBvcnQgZmluZERPTU5vZGUgZnJvbSBcInJjLXV0aWwvZXMvRG9tL2ZpbmRET01Ob2RlXCI7XG5pbXBvcnQgeyBjb21wb3NlUmVmLCBzdXBwb3J0UmVmIH0gZnJvbSBcInJjLXV0aWwvZXMvcmVmXCI7XG5pbXBvcnQgYWRkRXZlbnRMaXN0ZW5lciBmcm9tIFwicmMtdXRpbC9lcy9Eb20vYWRkRXZlbnRMaXN0ZW5lclwiO1xuaW1wb3J0IFBvcnRhbCBmcm9tIFwicmMtdXRpbC9lcy9Qb3J0YWxcIjtcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgZ2V0QWxpZ25Gcm9tUGxhY2VtZW50LCBnZXRBbGlnblBvcHVwQ2xhc3NOYW1lIH0gZnJvbSAnLi91dGlscy9hbGlnblV0aWwnO1xuaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAnO1xuaW1wb3J0IFRyaWdnZXJDb250ZXh0IGZyb20gJy4vY29udGV4dCc7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5mdW5jdGlvbiByZXR1cm5FbXB0eVN0cmluZygpIHtcbiAgcmV0dXJuICcnO1xufVxuXG5mdW5jdGlvbiByZXR1cm5Eb2N1bWVudChlbGVtZW50KSB7XG4gIGlmIChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQub3duZXJEb2N1bWVudDtcbiAgfVxuXG4gIHJldHVybiB3aW5kb3cuZG9jdW1lbnQ7XG59XG5cbnZhciBBTExfSEFORExFUlMgPSBbJ29uQ2xpY2snLCAnb25Nb3VzZURvd24nLCAnb25Ub3VjaFN0YXJ0JywgJ29uTW91c2VFbnRlcicsICdvbk1vdXNlTGVhdmUnLCAnb25Gb2N1cycsICdvbkJsdXInLCAnb25Db250ZXh0TWVudSddO1xuLyoqXG4gKiBJbnRlcm5hbCB1c2FnZS4gRG8gbm90IHVzZSBpbiB5b3VyIGNvZGUgc2luY2UgdGhpcyB3aWxsIGJlIHJlbW92ZWQuXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVHJpZ2dlcihQb3J0YWxDb21wb25lbnQpIHtcbiAgdmFyIFRyaWdnZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgICBfaW5oZXJpdHMoVHJpZ2dlciwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFRyaWdnZXIpO1xuXG4gICAgZnVuY3Rpb24gVHJpZ2dlcihwcm9wcykge1xuICAgICAgdmFyIF90aGlzO1xuXG4gICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJpZ2dlcik7XG5cbiAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpO1xuICAgICAgX3RoaXMucG9wdXBSZWYgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgICBfdGhpcy50cmlnZ2VyUmVmID0gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZVJlZigpO1xuXG4gICAgICBfdGhpcy5vbk1vdXNlRW50ZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgbW91c2VFbnRlckRlbGF5ID0gX3RoaXMucHJvcHMubW91c2VFbnRlckRlbGF5O1xuXG4gICAgICAgIF90aGlzLmZpcmVFdmVudHMoJ29uTW91c2VFbnRlcicsIGUpO1xuXG4gICAgICAgIF90aGlzLmRlbGF5U2V0UG9wdXBWaXNpYmxlKHRydWUsIG1vdXNlRW50ZXJEZWxheSwgbW91c2VFbnRlckRlbGF5ID8gbnVsbCA6IGUpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMub25Nb3VzZU1vdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBfdGhpcy5maXJlRXZlbnRzKCdvbk1vdXNlTW92ZScsIGUpO1xuXG4gICAgICAgIF90aGlzLnNldFBvaW50KGUpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMub25Nb3VzZUxlYXZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMuZmlyZUV2ZW50cygnb25Nb3VzZUxlYXZlJywgZSk7XG5cbiAgICAgICAgX3RoaXMuZGVsYXlTZXRQb3B1cFZpc2libGUoZmFsc2UsIF90aGlzLnByb3BzLm1vdXNlTGVhdmVEZWxheSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vblBvcHVwTW91c2VFbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuY2xlYXJEZWxheVRpbWVyKCk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vblBvcHVwTW91c2VMZWF2ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBfdGhpcyRwb3B1cFJlZiRjdXJyZW47XG5cbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0LWNvbXBvbmVudC90cmlnZ2VyL3B1bGwvMTNcbiAgICAgICAgLy8gcmVhY3QgYnVnP1xuICAgICAgICBpZiAoZS5yZWxhdGVkVGFyZ2V0ICYmICFlLnJlbGF0ZWRUYXJnZXQuc2V0VGltZW91dCAmJiBjb250YWlucygoX3RoaXMkcG9wdXBSZWYkY3VycmVuID0gX3RoaXMucG9wdXBSZWYuY3VycmVudCkgPT09IG51bGwgfHwgX3RoaXMkcG9wdXBSZWYkY3VycmVuID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRwb3B1cFJlZiRjdXJyZW4uZ2V0RWxlbWVudCgpLCBlLnJlbGF0ZWRUYXJnZXQpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMuZGVsYXlTZXRQb3B1cFZpc2libGUoZmFsc2UsIF90aGlzLnByb3BzLm1vdXNlTGVhdmVEZWxheSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vbkZvY3VzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMuZmlyZUV2ZW50cygnb25Gb2N1cycsIGUpOyAvLyBpbmNhc2UgZm9jdXNpbiBhbmQgZm9jdXNvdXRcblxuXG4gICAgICAgIF90aGlzLmNsZWFyRGVsYXlUaW1lcigpO1xuXG4gICAgICAgIGlmIChfdGhpcy5pc0ZvY3VzVG9TaG93KCkpIHtcbiAgICAgICAgICBfdGhpcy5mb2N1c1RpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgX3RoaXMuZGVsYXlTZXRQb3B1cFZpc2libGUodHJ1ZSwgX3RoaXMucHJvcHMuZm9jdXNEZWxheSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIF90aGlzLm9uTW91c2VEb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMuZmlyZUV2ZW50cygnb25Nb3VzZURvd24nLCBlKTtcblxuICAgICAgICBfdGhpcy5wcmVDbGlja1RpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMub25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgX3RoaXMuZmlyZUV2ZW50cygnb25Ub3VjaFN0YXJ0JywgZSk7XG5cbiAgICAgICAgX3RoaXMucHJlVG91Y2hUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLm9uQmx1ciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIF90aGlzLmZpcmVFdmVudHMoJ29uQmx1cicsIGUpO1xuXG4gICAgICAgIF90aGlzLmNsZWFyRGVsYXlUaW1lcigpO1xuXG4gICAgICAgIGlmIChfdGhpcy5pc0JsdXJUb0hpZGUoKSkge1xuICAgICAgICAgIF90aGlzLmRlbGF5U2V0UG9wdXBWaXNpYmxlKGZhbHNlLCBfdGhpcy5wcm9wcy5ibHVyRGVsYXkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vbkNvbnRleHRNZW51ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIF90aGlzLmZpcmVFdmVudHMoJ29uQ29udGV4dE1lbnUnLCBlKTtcblxuICAgICAgICBfdGhpcy5zZXRQb3B1cFZpc2libGUodHJ1ZSwgZSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vbkNvbnRleHRNZW51Q2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChfdGhpcy5pc0NvbnRleHRNZW51VG9TaG93KCkpIHtcbiAgICAgICAgICBfdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vbkNsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIF90aGlzLmZpcmVFdmVudHMoJ29uQ2xpY2snLCBldmVudCk7IC8vIGZvY3VzIHdpbGwgdHJpZ2dlciBjbGlja1xuXG5cbiAgICAgICAgaWYgKF90aGlzLmZvY3VzVGltZSkge1xuICAgICAgICAgIHZhciBwcmVUaW1lO1xuXG4gICAgICAgICAgaWYgKF90aGlzLnByZUNsaWNrVGltZSAmJiBfdGhpcy5wcmVUb3VjaFRpbWUpIHtcbiAgICAgICAgICAgIHByZVRpbWUgPSBNYXRoLm1pbihfdGhpcy5wcmVDbGlja1RpbWUsIF90aGlzLnByZVRvdWNoVGltZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChfdGhpcy5wcmVDbGlja1RpbWUpIHtcbiAgICAgICAgICAgIHByZVRpbWUgPSBfdGhpcy5wcmVDbGlja1RpbWU7XG4gICAgICAgICAgfSBlbHNlIGlmIChfdGhpcy5wcmVUb3VjaFRpbWUpIHtcbiAgICAgICAgICAgIHByZVRpbWUgPSBfdGhpcy5wcmVUb3VjaFRpbWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKE1hdGguYWJzKHByZVRpbWUgLSBfdGhpcy5mb2N1c1RpbWUpIDwgMjApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpcy5mb2N1c1RpbWUgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMucHJlQ2xpY2tUaW1lID0gMDtcbiAgICAgICAgX3RoaXMucHJlVG91Y2hUaW1lID0gMDsgLy8gT25seSBwcmV2ZW50IGRlZmF1bHQgd2hlbiBhbGwgdGhlIGFjdGlvbiBpcyBjbGljay5cbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvMTcwNDNcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvMTcyOTFcblxuICAgICAgICBpZiAoX3RoaXMuaXNDbGlja1RvU2hvdygpICYmIChfdGhpcy5pc0NsaWNrVG9IaWRlKCkgfHwgX3RoaXMuaXNCbHVyVG9IaWRlKCkpICYmIGV2ZW50ICYmIGV2ZW50LnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBuZXh0VmlzaWJsZSA9ICFfdGhpcy5zdGF0ZS5wb3B1cFZpc2libGU7XG5cbiAgICAgICAgaWYgKF90aGlzLmlzQ2xpY2tUb0hpZGUoKSAmJiAhbmV4dFZpc2libGUgfHwgbmV4dFZpc2libGUgJiYgX3RoaXMuaXNDbGlja1RvU2hvdygpKSB7XG4gICAgICAgICAgX3RoaXMuc2V0UG9wdXBWaXNpYmxlKCFfdGhpcy5zdGF0ZS5wb3B1cFZpc2libGUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgX3RoaXMub25Qb3B1cE1vdXNlRG93biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMuaGFzUG9wdXBNb3VzZURvd24gPSB0cnVlO1xuICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMubW91c2VEb3duVGltZW91dCk7XG4gICAgICAgIF90aGlzLm1vdXNlRG93blRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMuaGFzUG9wdXBNb3VzZURvd24gPSBmYWxzZTtcbiAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgaWYgKF90aGlzLmNvbnRleHQpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkY29udGV4dDtcblxuICAgICAgICAgIChfdGhpcyRjb250ZXh0ID0gX3RoaXMuY29udGV4dCkub25Qb3B1cE1vdXNlRG93bi5hcHBseShfdGhpcyRjb250ZXh0LCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5vbkRvY3VtZW50Q2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKF90aGlzLnByb3BzLm1hc2sgJiYgIV90aGlzLnByb3BzLm1hc2tDbG9zYWJsZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cbiAgICAgICAgdmFyIHJvb3QgPSBfdGhpcy5nZXRSb290RG9tTm9kZSgpO1xuXG4gICAgICAgIHZhciBwb3B1cE5vZGUgPSBfdGhpcy5nZXRQb3B1cERvbU5vZGUoKTtcblxuICAgICAgICBpZiAoIC8vIG1vdXNlZG93biBvbiB0aGUgdGFyZ2V0IHNob3VsZCBhbHNvIGNsb3NlIHBvcHVwIHdoZW4gYWN0aW9uIGlzIGNvbnRleHRNZW51LlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy8yOTg1M1xuICAgICAgICAoIWNvbnRhaW5zKHJvb3QsIHRhcmdldCkgfHwgX3RoaXMuaXNDb250ZXh0TWVudU9ubHkoKSkgJiYgIWNvbnRhaW5zKHBvcHVwTm9kZSwgdGFyZ2V0KSAmJiAhX3RoaXMuaGFzUG9wdXBNb3VzZURvd24pIHtcbiAgICAgICAgICBfdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5nZXRSb290RG9tTm9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdldFRyaWdnZXJET01Ob2RlID0gX3RoaXMucHJvcHMuZ2V0VHJpZ2dlckRPTU5vZGU7XG5cbiAgICAgICAgaWYgKGdldFRyaWdnZXJET01Ob2RlKSB7XG4gICAgICAgICAgcmV0dXJuIGdldFRyaWdnZXJET01Ob2RlKF90aGlzLnRyaWdnZXJSZWYuY3VycmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciBkb21Ob2RlID0gZmluZERPTU5vZGUoX3RoaXMudHJpZ2dlclJlZi5jdXJyZW50KTtcblxuICAgICAgICAgIGlmIChkb21Ob2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gZG9tTm9kZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycikgey8vIERvIG5vdGhpbmdcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBSZWFjdERPTS5maW5kRE9NTm9kZShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5nZXRQb3B1cENsYXNzTmFtZUZyb21BbGlnbiA9IGZ1bmN0aW9uIChhbGlnbikge1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gW107XG4gICAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLFxuICAgICAgICAgICAgcG9wdXBQbGFjZW1lbnQgPSBfdGhpcyRwcm9wcy5wb3B1cFBsYWNlbWVudCxcbiAgICAgICAgICAgIGJ1aWx0aW5QbGFjZW1lbnRzID0gX3RoaXMkcHJvcHMuYnVpbHRpblBsYWNlbWVudHMsXG4gICAgICAgICAgICBwcmVmaXhDbHMgPSBfdGhpcyRwcm9wcy5wcmVmaXhDbHMsXG4gICAgICAgICAgICBhbGlnblBvaW50ID0gX3RoaXMkcHJvcHMuYWxpZ25Qb2ludCxcbiAgICAgICAgICAgIGdldFBvcHVwQ2xhc3NOYW1lRnJvbUFsaWduID0gX3RoaXMkcHJvcHMuZ2V0UG9wdXBDbGFzc05hbWVGcm9tQWxpZ247XG5cbiAgICAgICAgaWYgKHBvcHVwUGxhY2VtZW50ICYmIGJ1aWx0aW5QbGFjZW1lbnRzKSB7XG4gICAgICAgICAgY2xhc3NOYW1lLnB1c2goZ2V0QWxpZ25Qb3B1cENsYXNzTmFtZShidWlsdGluUGxhY2VtZW50cywgcHJlZml4Q2xzLCBhbGlnbiwgYWxpZ25Qb2ludCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdldFBvcHVwQ2xhc3NOYW1lRnJvbUFsaWduKSB7XG4gICAgICAgICAgY2xhc3NOYW1lLnB1c2goZ2V0UG9wdXBDbGFzc05hbWVGcm9tQWxpZ24oYWxpZ24pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGFzc05hbWUuam9pbignICcpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMkcHJvcHMyID0gX3RoaXMucHJvcHMsXG4gICAgICAgICAgICBwcmVmaXhDbHMgPSBfdGhpcyRwcm9wczIucHJlZml4Q2xzLFxuICAgICAgICAgICAgZGVzdHJveVBvcHVwT25IaWRlID0gX3RoaXMkcHJvcHMyLmRlc3Ryb3lQb3B1cE9uSGlkZSxcbiAgICAgICAgICAgIHBvcHVwQ2xhc3NOYW1lID0gX3RoaXMkcHJvcHMyLnBvcHVwQ2xhc3NOYW1lLFxuICAgICAgICAgICAgb25Qb3B1cEFsaWduID0gX3RoaXMkcHJvcHMyLm9uUG9wdXBBbGlnbixcbiAgICAgICAgICAgIHBvcHVwTW90aW9uID0gX3RoaXMkcHJvcHMyLnBvcHVwTW90aW9uLFxuICAgICAgICAgICAgcG9wdXBBbmltYXRpb24gPSBfdGhpcyRwcm9wczIucG9wdXBBbmltYXRpb24sXG4gICAgICAgICAgICBwb3B1cFRyYW5zaXRpb25OYW1lID0gX3RoaXMkcHJvcHMyLnBvcHVwVHJhbnNpdGlvbk5hbWUsXG4gICAgICAgICAgICBwb3B1cFN0eWxlID0gX3RoaXMkcHJvcHMyLnBvcHVwU3R5bGUsXG4gICAgICAgICAgICBtYXNrID0gX3RoaXMkcHJvcHMyLm1hc2ssXG4gICAgICAgICAgICBtYXNrQW5pbWF0aW9uID0gX3RoaXMkcHJvcHMyLm1hc2tBbmltYXRpb24sXG4gICAgICAgICAgICBtYXNrVHJhbnNpdGlvbk5hbWUgPSBfdGhpcyRwcm9wczIubWFza1RyYW5zaXRpb25OYW1lLFxuICAgICAgICAgICAgbWFza01vdGlvbiA9IF90aGlzJHByb3BzMi5tYXNrTW90aW9uLFxuICAgICAgICAgICAgekluZGV4ID0gX3RoaXMkcHJvcHMyLnpJbmRleCxcbiAgICAgICAgICAgIHBvcHVwID0gX3RoaXMkcHJvcHMyLnBvcHVwLFxuICAgICAgICAgICAgc3RyZXRjaCA9IF90aGlzJHByb3BzMi5zdHJldGNoLFxuICAgICAgICAgICAgYWxpZ25Qb2ludCA9IF90aGlzJHByb3BzMi5hbGlnblBvaW50LFxuICAgICAgICAgICAgbW9iaWxlID0gX3RoaXMkcHJvcHMyLm1vYmlsZSxcbiAgICAgICAgICAgIGZvcmNlUmVuZGVyID0gX3RoaXMkcHJvcHMyLmZvcmNlUmVuZGVyO1xuICAgICAgICB2YXIgX3RoaXMkc3RhdGUgPSBfdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgIHBvcHVwVmlzaWJsZSA9IF90aGlzJHN0YXRlLnBvcHVwVmlzaWJsZSxcbiAgICAgICAgICAgIHBvaW50ID0gX3RoaXMkc3RhdGUucG9pbnQ7XG5cbiAgICAgICAgdmFyIGFsaWduID0gX3RoaXMuZ2V0UG9wdXBBbGlnbigpO1xuXG4gICAgICAgIHZhciBtb3VzZVByb3BzID0ge307XG5cbiAgICAgICAgaWYgKF90aGlzLmlzTW91c2VFbnRlclRvU2hvdygpKSB7XG4gICAgICAgICAgbW91c2VQcm9wcy5vbk1vdXNlRW50ZXIgPSBfdGhpcy5vblBvcHVwTW91c2VFbnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfdGhpcy5pc01vdXNlTGVhdmVUb0hpZGUoKSkge1xuICAgICAgICAgIG1vdXNlUHJvcHMub25Nb3VzZUxlYXZlID0gX3RoaXMub25Qb3B1cE1vdXNlTGVhdmU7XG4gICAgICAgIH1cblxuICAgICAgICBtb3VzZVByb3BzLm9uTW91c2VEb3duID0gX3RoaXMub25Qb3B1cE1vdXNlRG93bjtcbiAgICAgICAgbW91c2VQcm9wcy5vblRvdWNoU3RhcnQgPSBfdGhpcy5vblBvcHVwTW91c2VEb3duO1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoUG9wdXAsIF9leHRlbmRzKHtcbiAgICAgICAgICBwcmVmaXhDbHM6IHByZWZpeENscyxcbiAgICAgICAgICBkZXN0cm95UG9wdXBPbkhpZGU6IGRlc3Ryb3lQb3B1cE9uSGlkZSxcbiAgICAgICAgICB2aXNpYmxlOiBwb3B1cFZpc2libGUsXG4gICAgICAgICAgcG9pbnQ6IGFsaWduUG9pbnQgJiYgcG9pbnQsXG4gICAgICAgICAgY2xhc3NOYW1lOiBwb3B1cENsYXNzTmFtZSxcbiAgICAgICAgICBhbGlnbjogYWxpZ24sXG4gICAgICAgICAgb25BbGlnbjogb25Qb3B1cEFsaWduLFxuICAgICAgICAgIGFuaW1hdGlvbjogcG9wdXBBbmltYXRpb24sXG4gICAgICAgICAgZ2V0Q2xhc3NOYW1lRnJvbUFsaWduOiBfdGhpcy5nZXRQb3B1cENsYXNzTmFtZUZyb21BbGlnblxuICAgICAgICB9LCBtb3VzZVByb3BzLCB7XG4gICAgICAgICAgc3RyZXRjaDogc3RyZXRjaCxcbiAgICAgICAgICBnZXRSb290RG9tTm9kZTogX3RoaXMuZ2V0Um9vdERvbU5vZGUsXG4gICAgICAgICAgc3R5bGU6IHBvcHVwU3R5bGUsXG4gICAgICAgICAgbWFzazogbWFzayxcbiAgICAgICAgICB6SW5kZXg6IHpJbmRleCxcbiAgICAgICAgICB0cmFuc2l0aW9uTmFtZTogcG9wdXBUcmFuc2l0aW9uTmFtZSxcbiAgICAgICAgICBtYXNrQW5pbWF0aW9uOiBtYXNrQW5pbWF0aW9uLFxuICAgICAgICAgIG1hc2tUcmFuc2l0aW9uTmFtZTogbWFza1RyYW5zaXRpb25OYW1lLFxuICAgICAgICAgIG1hc2tNb3Rpb246IG1hc2tNb3Rpb24sXG4gICAgICAgICAgcmVmOiBfdGhpcy5wb3B1cFJlZixcbiAgICAgICAgICBtb3Rpb246IHBvcHVwTW90aW9uLFxuICAgICAgICAgIG1vYmlsZTogbW9iaWxlLFxuICAgICAgICAgIGZvcmNlUmVuZGVyOiBmb3JjZVJlbmRlclxuICAgICAgICB9KSwgdHlwZW9mIHBvcHVwID09PSAnZnVuY3Rpb24nID8gcG9wdXAoKSA6IHBvcHVwKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzLmF0dGFjaFBhcmVudCA9IGZ1bmN0aW9uIChwb3B1cENvbnRhaW5lcikge1xuICAgICAgICByYWYuY2FuY2VsKF90aGlzLmF0dGFjaElkKTtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzMyA9IF90aGlzLnByb3BzLFxuICAgICAgICAgICAgZ2V0UG9wdXBDb250YWluZXIgPSBfdGhpcyRwcm9wczMuZ2V0UG9wdXBDb250YWluZXIsXG4gICAgICAgICAgICBnZXREb2N1bWVudCA9IF90aGlzJHByb3BzMy5nZXREb2N1bWVudDtcblxuICAgICAgICB2YXIgZG9tTm9kZSA9IF90aGlzLmdldFJvb3REb21Ob2RlKCk7XG5cbiAgICAgICAgdmFyIG1vdW50Tm9kZTtcblxuICAgICAgICBpZiAoIWdldFBvcHVwQ29udGFpbmVyKSB7XG4gICAgICAgICAgbW91bnROb2RlID0gZ2V0RG9jdW1lbnQoX3RoaXMuZ2V0Um9vdERvbU5vZGUoKSkuYm9keTtcbiAgICAgICAgfSBlbHNlIGlmIChkb21Ob2RlIHx8IGdldFBvcHVwQ29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIC8vIENvbXBhdGlibGUgZm9yIGxlZ2FjeSBnZXRQb3B1cENvbnRhaW5lciB3aXRoIGRvbU5vZGUgYXJndW1lbnQuXG4gICAgICAgICAgLy8gSWYgbm8gbmVlZCBgZG9tTm9kZWAgYXJndW1lbnQsIHdpbGwgY2FsbCBkaXJlY3RseS5cbiAgICAgICAgICAvLyBodHRwczovL2NvZGVzYW5kYm94LmlvL3MvZWxvcXVlbnQtbWNsZWFuLXNzOTNtP2ZpbGU9L3NyYy9BcHAuanNcbiAgICAgICAgICBtb3VudE5vZGUgPSBnZXRQb3B1cENvbnRhaW5lcihkb21Ob2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtb3VudE5vZGUpIHtcbiAgICAgICAgICBtb3VudE5vZGUuYXBwZW5kQ2hpbGQocG9wdXBDb250YWluZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFJldHJ5IGFmdGVyIGZyYW1lIHJlbmRlciBpbiBjYXNlIHBhcmVudCBub3QgcmVhZHlcbiAgICAgICAgICBfdGhpcy5hdHRhY2hJZCA9IHJhZihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5hdHRhY2hQYXJlbnQocG9wdXBDb250YWluZXIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBfdGhpcy5nZXRDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnZXREb2N1bWVudCA9IF90aGlzLnByb3BzLmdldERvY3VtZW50O1xuICAgICAgICB2YXIgcG9wdXBDb250YWluZXIgPSBnZXREb2N1bWVudChfdGhpcy5nZXRSb290RG9tTm9kZSgpKS5jcmVhdGVFbGVtZW50KCdkaXYnKTsgLy8gTWFrZSBzdXJlIGRlZmF1bHQgcG9wdXAgY29udGFpbmVyIHdpbGwgbmV2ZXIgY2F1c2Ugc2Nyb2xsYmFyIGFwcGVhcmluZ1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtY29tcG9uZW50L3RyaWdnZXIvaXNzdWVzLzQxXG5cbiAgICAgICAgcG9wdXBDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBwb3B1cENvbnRhaW5lci5zdHlsZS50b3AgPSAnMCc7XG4gICAgICAgIHBvcHVwQ29udGFpbmVyLnN0eWxlLmxlZnQgPSAnMCc7XG4gICAgICAgIHBvcHVwQ29udGFpbmVyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuXG4gICAgICAgIF90aGlzLmF0dGFjaFBhcmVudChwb3B1cENvbnRhaW5lcik7XG5cbiAgICAgICAgcmV0dXJuIHBvcHVwQ29udGFpbmVyO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuc2V0UG9pbnQgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgdmFyIGFsaWduUG9pbnQgPSBfdGhpcy5wcm9wcy5hbGlnblBvaW50O1xuICAgICAgICBpZiAoIWFsaWduUG9pbnQgfHwgIXBvaW50KSByZXR1cm47XG5cbiAgICAgICAgX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIHBvaW50OiB7XG4gICAgICAgICAgICBwYWdlWDogcG9pbnQucGFnZVgsXG4gICAgICAgICAgICBwYWdlWTogcG9pbnQucGFnZVlcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgX3RoaXMuaGFuZGxlUG9ydGFsVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoX3RoaXMuc3RhdGUucHJldlBvcHVwVmlzaWJsZSAhPT0gX3RoaXMuc3RhdGUucG9wdXBWaXNpYmxlKSB7XG4gICAgICAgICAgX3RoaXMucHJvcHMuYWZ0ZXJQb3B1cFZpc2libGVDaGFuZ2UoX3RoaXMuc3RhdGUucG9wdXBWaXNpYmxlKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgX3RoaXMudHJpZ2dlckNvbnRleHRWYWx1ZSA9IHtcbiAgICAgICAgb25Qb3B1cE1vdXNlRG93bjogX3RoaXMub25Qb3B1cE1vdXNlRG93blxuICAgICAgfTtcbiAgICAgIHZhciBwb3B1cFZpc2libGU7XG5cbiAgICAgIGlmICgncG9wdXBWaXNpYmxlJyBpbiBwcm9wcykge1xuICAgICAgICBwb3B1cFZpc2libGUgPSAhIXByb3BzLnBvcHVwVmlzaWJsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvcHVwVmlzaWJsZSA9ICEhcHJvcHMuZGVmYXVsdFBvcHVwVmlzaWJsZTtcbiAgICAgIH1cblxuICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgIHByZXZQb3B1cFZpc2libGU6IHBvcHVwVmlzaWJsZSxcbiAgICAgICAgcG9wdXBWaXNpYmxlOiBwb3B1cFZpc2libGVcbiAgICAgIH07XG4gICAgICBBTExfSEFORExFUlMuZm9yRWFjaChmdW5jdGlvbiAoaCkge1xuICAgICAgICBfdGhpc1tcImZpcmVcIi5jb25jYXQoaCldID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBfdGhpcy5maXJlRXZlbnRzKGgsIGUpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFRyaWdnZXIsIFt7XG4gICAgICBrZXk6IFwiY29tcG9uZW50RGlkTW91bnRcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5jb21wb25lbnREaWRVcGRhdGUoKTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiY29tcG9uZW50RGlkVXBkYXRlXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnN0YXRlOyAvLyBXZSBtdXN0IGxpc3RlbiB0byBgbW91c2Vkb3duYCBvciBgdG91Y2hzdGFydGAsIGVkZ2UgY2FzZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvNTgwNFxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtY29tcG9uZW50L2NhbGVuZGFyL2lzc3Vlcy8yNTBcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3JlYWN0LWNvbXBvbmVudC90cmlnZ2VyL2lzc3Vlcy81MFxuXG4gICAgICAgIGlmIChzdGF0ZS5wb3B1cFZpc2libGUpIHtcbiAgICAgICAgICB2YXIgY3VycmVudERvY3VtZW50O1xuXG4gICAgICAgICAgaWYgKCF0aGlzLmNsaWNrT3V0c2lkZUhhbmRsZXIgJiYgKHRoaXMuaXNDbGlja1RvSGlkZSgpIHx8IHRoaXMuaXNDb250ZXh0TWVudVRvU2hvdygpKSkge1xuICAgICAgICAgICAgY3VycmVudERvY3VtZW50ID0gcHJvcHMuZ2V0RG9jdW1lbnQodGhpcy5nZXRSb290RG9tTm9kZSgpKTtcbiAgICAgICAgICAgIHRoaXMuY2xpY2tPdXRzaWRlSGFuZGxlciA9IGFkZEV2ZW50TGlzdGVuZXIoY3VycmVudERvY3VtZW50LCAnbW91c2Vkb3duJywgdGhpcy5vbkRvY3VtZW50Q2xpY2spO1xuICAgICAgICAgIH0gLy8gYWx3YXlzIGhpZGUgb24gbW9iaWxlXG5cblxuICAgICAgICAgIGlmICghdGhpcy50b3VjaE91dHNpZGVIYW5kbGVyKSB7XG4gICAgICAgICAgICBjdXJyZW50RG9jdW1lbnQgPSBjdXJyZW50RG9jdW1lbnQgfHwgcHJvcHMuZ2V0RG9jdW1lbnQodGhpcy5nZXRSb290RG9tTm9kZSgpKTtcbiAgICAgICAgICAgIHRoaXMudG91Y2hPdXRzaWRlSGFuZGxlciA9IGFkZEV2ZW50TGlzdGVuZXIoY3VycmVudERvY3VtZW50LCAndG91Y2hzdGFydCcsIHRoaXMub25Eb2N1bWVudENsaWNrKTtcbiAgICAgICAgICB9IC8vIGNsb3NlIHBvcHVwIHdoZW4gdHJpZ2dlciB0eXBlIGNvbnRhaW5zICdvbkNvbnRleHRNZW51JyBhbmQgZG9jdW1lbnQgaXMgc2Nyb2xsaW5nLlxuXG5cbiAgICAgICAgICBpZiAoIXRoaXMuY29udGV4dE1lbnVPdXRzaWRlSGFuZGxlcjEgJiYgdGhpcy5pc0NvbnRleHRNZW51VG9TaG93KCkpIHtcbiAgICAgICAgICAgIGN1cnJlbnREb2N1bWVudCA9IGN1cnJlbnREb2N1bWVudCB8fCBwcm9wcy5nZXREb2N1bWVudCh0aGlzLmdldFJvb3REb21Ob2RlKCkpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0TWVudU91dHNpZGVIYW5kbGVyMSA9IGFkZEV2ZW50TGlzdGVuZXIoY3VycmVudERvY3VtZW50LCAnc2Nyb2xsJywgdGhpcy5vbkNvbnRleHRNZW51Q2xvc2UpO1xuICAgICAgICAgIH0gLy8gY2xvc2UgcG9wdXAgd2hlbiB0cmlnZ2VyIHR5cGUgY29udGFpbnMgJ29uQ29udGV4dE1lbnUnIGFuZCB3aW5kb3cgaXMgYmx1ci5cblxuXG4gICAgICAgICAgaWYgKCF0aGlzLmNvbnRleHRNZW51T3V0c2lkZUhhbmRsZXIyICYmIHRoaXMuaXNDb250ZXh0TWVudVRvU2hvdygpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHRNZW51T3V0c2lkZUhhbmRsZXIyID0gYWRkRXZlbnRMaXN0ZW5lcih3aW5kb3csICdibHVyJywgdGhpcy5vbkNvbnRleHRNZW51Q2xvc2UpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xlYXJPdXRzaWRlSGFuZGxlcigpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJjb21wb25lbnRXaWxsVW5tb3VudFwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB0aGlzLmNsZWFyRGVsYXlUaW1lcigpO1xuICAgICAgICB0aGlzLmNsZWFyT3V0c2lkZUhhbmRsZXIoKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMubW91c2VEb3duVGltZW91dCk7XG4gICAgICAgIHJhZi5jYW5jZWwodGhpcy5hdHRhY2hJZCk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImdldFBvcHVwRG9tTm9kZVwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBvcHVwRG9tTm9kZSgpIHtcbiAgICAgICAgdmFyIF90aGlzJHBvcHVwUmVmJGN1cnJlbjI7XG5cbiAgICAgICAgLy8gZm9yIHRlc3RcbiAgICAgICAgcmV0dXJuICgoX3RoaXMkcG9wdXBSZWYkY3VycmVuMiA9IHRoaXMucG9wdXBSZWYuY3VycmVudCkgPT09IG51bGwgfHwgX3RoaXMkcG9wdXBSZWYkY3VycmVuMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkcG9wdXBSZWYkY3VycmVuMi5nZXRFbGVtZW50KCkpIHx8IG51bGw7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImdldFBvcHVwQWxpZ25cIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQb3B1cEFsaWduKCkge1xuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BzO1xuICAgICAgICB2YXIgcG9wdXBQbGFjZW1lbnQgPSBwcm9wcy5wb3B1cFBsYWNlbWVudCxcbiAgICAgICAgICAgIHBvcHVwQWxpZ24gPSBwcm9wcy5wb3B1cEFsaWduLFxuICAgICAgICAgICAgYnVpbHRpblBsYWNlbWVudHMgPSBwcm9wcy5idWlsdGluUGxhY2VtZW50cztcblxuICAgICAgICBpZiAocG9wdXBQbGFjZW1lbnQgJiYgYnVpbHRpblBsYWNlbWVudHMpIHtcbiAgICAgICAgICByZXR1cm4gZ2V0QWxpZ25Gcm9tUGxhY2VtZW50KGJ1aWx0aW5QbGFjZW1lbnRzLCBwb3B1cFBsYWNlbWVudCwgcG9wdXBBbGlnbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcG9wdXBBbGlnbjtcbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogQHBhcmFtIHBvcHVwVmlzaWJsZSAgICBTaG93IG9yIG5vdCB0aGUgcG9wdXAgZWxlbWVudFxuICAgICAgICogQHBhcmFtIGV2ZW50ICAgICAgICAgICBTeW50aGV0aWNFdmVudCwgdXNlZCBmb3IgYHBvaW50QWxpZ25gXG4gICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgIGtleTogXCJzZXRQb3B1cFZpc2libGVcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQb3B1cFZpc2libGUocG9wdXBWaXNpYmxlLCBldmVudCkge1xuICAgICAgICB2YXIgYWxpZ25Qb2ludCA9IHRoaXMucHJvcHMuYWxpZ25Qb2ludDtcbiAgICAgICAgdmFyIHByZXZQb3B1cFZpc2libGUgPSB0aGlzLnN0YXRlLnBvcHVwVmlzaWJsZTtcbiAgICAgICAgdGhpcy5jbGVhckRlbGF5VGltZXIoKTtcblxuICAgICAgICBpZiAocHJldlBvcHVwVmlzaWJsZSAhPT0gcG9wdXBWaXNpYmxlKSB7XG4gICAgICAgICAgaWYgKCEoJ3BvcHVwVmlzaWJsZScgaW4gdGhpcy5wcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICBwb3B1cFZpc2libGU6IHBvcHVwVmlzaWJsZSxcbiAgICAgICAgICAgICAgcHJldlBvcHVwVmlzaWJsZTogcHJldlBvcHVwVmlzaWJsZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5wcm9wcy5vblBvcHVwVmlzaWJsZUNoYW5nZShwb3B1cFZpc2libGUpO1xuICAgICAgICB9IC8vIEFsd2F5cyByZWNvcmQgdGhlIHBvaW50IHBvc2l0aW9uIHNpbmNlIG1vdXNlRW50ZXJEZWxheSB3aWxsIGRlbGF5IHRoZSBzaG93XG5cblxuICAgICAgICBpZiAoYWxpZ25Qb2ludCAmJiBldmVudCAmJiBwb3B1cFZpc2libGUpIHtcbiAgICAgICAgICB0aGlzLnNldFBvaW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJkZWxheVNldFBvcHVwVmlzaWJsZVwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGF5U2V0UG9wdXBWaXNpYmxlKHZpc2libGUsIGRlbGF5UywgZXZlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGRlbGF5ID0gZGVsYXlTICogMTAwMDtcbiAgICAgICAgdGhpcy5jbGVhckRlbGF5VGltZXIoKTtcblxuICAgICAgICBpZiAoZGVsYXkpIHtcbiAgICAgICAgICB2YXIgcG9pbnQgPSBldmVudCA/IHtcbiAgICAgICAgICAgIHBhZ2VYOiBldmVudC5wYWdlWCxcbiAgICAgICAgICAgIHBhZ2VZOiBldmVudC5wYWdlWVxuICAgICAgICAgIH0gOiBudWxsO1xuICAgICAgICAgIHRoaXMuZGVsYXlUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzMi5zZXRQb3B1cFZpc2libGUodmlzaWJsZSwgcG9pbnQpO1xuXG4gICAgICAgICAgICBfdGhpczIuY2xlYXJEZWxheVRpbWVyKCk7XG4gICAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0UG9wdXBWaXNpYmxlKHZpc2libGUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJjbGVhckRlbGF5VGltZXJcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckRlbGF5VGltZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGF5VGltZXIpIHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5kZWxheVRpbWVyKTtcbiAgICAgICAgICB0aGlzLmRlbGF5VGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImNsZWFyT3V0c2lkZUhhbmRsZXJcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhck91dHNpZGVIYW5kbGVyKCkge1xuICAgICAgICBpZiAodGhpcy5jbGlja091dHNpZGVIYW5kbGVyKSB7XG4gICAgICAgICAgdGhpcy5jbGlja091dHNpZGVIYW5kbGVyLnJlbW92ZSgpO1xuICAgICAgICAgIHRoaXMuY2xpY2tPdXRzaWRlSGFuZGxlciA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5jb250ZXh0TWVudU91dHNpZGVIYW5kbGVyMSkge1xuICAgICAgICAgIHRoaXMuY29udGV4dE1lbnVPdXRzaWRlSGFuZGxlcjEucmVtb3ZlKCk7XG4gICAgICAgICAgdGhpcy5jb250ZXh0TWVudU91dHNpZGVIYW5kbGVyMSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5jb250ZXh0TWVudU91dHNpZGVIYW5kbGVyMikge1xuICAgICAgICAgIHRoaXMuY29udGV4dE1lbnVPdXRzaWRlSGFuZGxlcjIucmVtb3ZlKCk7XG4gICAgICAgICAgdGhpcy5jb250ZXh0TWVudU91dHNpZGVIYW5kbGVyMiA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy50b3VjaE91dHNpZGVIYW5kbGVyKSB7XG4gICAgICAgICAgdGhpcy50b3VjaE91dHNpZGVIYW5kbGVyLnJlbW92ZSgpO1xuICAgICAgICAgIHRoaXMudG91Y2hPdXRzaWRlSGFuZGxlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiY3JlYXRlVHdvQ2hhaW5zXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlVHdvQ2hhaW5zKGV2ZW50KSB7XG4gICAgICAgIHZhciBjaGlsZFByb3MgPSB0aGlzLnByb3BzLmNoaWxkcmVuLnByb3BzO1xuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIGlmIChjaGlsZFByb3NbZXZlbnRdICYmIHByb3BzW2V2ZW50XSkge1xuICAgICAgICAgIHJldHVybiB0aGlzW1wiZmlyZVwiLmNvbmNhdChldmVudCldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkUHJvc1tldmVudF0gfHwgcHJvcHNbZXZlbnRdO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJpc0NsaWNrVG9TaG93XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaXNDbGlja1RvU2hvdygpIHtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgICBhY3Rpb24gPSBfdGhpcyRwcm9wczQuYWN0aW9uLFxuICAgICAgICAgICAgc2hvd0FjdGlvbiA9IF90aGlzJHByb3BzNC5zaG93QWN0aW9uO1xuICAgICAgICByZXR1cm4gYWN0aW9uLmluZGV4T2YoJ2NsaWNrJykgIT09IC0xIHx8IHNob3dBY3Rpb24uaW5kZXhPZignY2xpY2snKSAhPT0gLTE7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImlzQ29udGV4dE1lbnVPbmx5XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaXNDb250ZXh0TWVudU9ubHkoKSB7XG4gICAgICAgIHZhciBhY3Rpb24gPSB0aGlzLnByb3BzLmFjdGlvbjtcbiAgICAgICAgcmV0dXJuIGFjdGlvbiA9PT0gJ2NvbnRleHRNZW51JyB8fCBhY3Rpb24ubGVuZ3RoID09PSAxICYmIGFjdGlvblswXSA9PT0gJ2NvbnRleHRNZW51JztcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiaXNDb250ZXh0TWVudVRvU2hvd1wiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ29udGV4dE1lbnVUb1Nob3coKSB7XG4gICAgICAgIHZhciBfdGhpcyRwcm9wczUgPSB0aGlzLnByb3BzLFxuICAgICAgICAgICAgYWN0aW9uID0gX3RoaXMkcHJvcHM1LmFjdGlvbixcbiAgICAgICAgICAgIHNob3dBY3Rpb24gPSBfdGhpcyRwcm9wczUuc2hvd0FjdGlvbjtcbiAgICAgICAgcmV0dXJuIGFjdGlvbi5pbmRleE9mKCdjb250ZXh0TWVudScpICE9PSAtMSB8fCBzaG93QWN0aW9uLmluZGV4T2YoJ2NvbnRleHRNZW51JykgIT09IC0xO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJpc0NsaWNrVG9IaWRlXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaXNDbGlja1RvSGlkZSgpIHtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzNiA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgICBhY3Rpb24gPSBfdGhpcyRwcm9wczYuYWN0aW9uLFxuICAgICAgICAgICAgaGlkZUFjdGlvbiA9IF90aGlzJHByb3BzNi5oaWRlQWN0aW9uO1xuICAgICAgICByZXR1cm4gYWN0aW9uLmluZGV4T2YoJ2NsaWNrJykgIT09IC0xIHx8IGhpZGVBY3Rpb24uaW5kZXhPZignY2xpY2snKSAhPT0gLTE7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImlzTW91c2VFbnRlclRvU2hvd1wiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzTW91c2VFbnRlclRvU2hvdygpIHtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzNyA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgICBhY3Rpb24gPSBfdGhpcyRwcm9wczcuYWN0aW9uLFxuICAgICAgICAgICAgc2hvd0FjdGlvbiA9IF90aGlzJHByb3BzNy5zaG93QWN0aW9uO1xuICAgICAgICByZXR1cm4gYWN0aW9uLmluZGV4T2YoJ2hvdmVyJykgIT09IC0xIHx8IHNob3dBY3Rpb24uaW5kZXhPZignbW91c2VFbnRlcicpICE9PSAtMTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiaXNNb3VzZUxlYXZlVG9IaWRlXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaXNNb3VzZUxlYXZlVG9IaWRlKCkge1xuICAgICAgICB2YXIgX3RoaXMkcHJvcHM4ID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgIGFjdGlvbiA9IF90aGlzJHByb3BzOC5hY3Rpb24sXG4gICAgICAgICAgICBoaWRlQWN0aW9uID0gX3RoaXMkcHJvcHM4LmhpZGVBY3Rpb247XG4gICAgICAgIHJldHVybiBhY3Rpb24uaW5kZXhPZignaG92ZXInKSAhPT0gLTEgfHwgaGlkZUFjdGlvbi5pbmRleE9mKCdtb3VzZUxlYXZlJykgIT09IC0xO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJpc0ZvY3VzVG9TaG93XCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gaXNGb2N1c1RvU2hvdygpIHtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzOSA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgICBhY3Rpb24gPSBfdGhpcyRwcm9wczkuYWN0aW9uLFxuICAgICAgICAgICAgc2hvd0FjdGlvbiA9IF90aGlzJHByb3BzOS5zaG93QWN0aW9uO1xuICAgICAgICByZXR1cm4gYWN0aW9uLmluZGV4T2YoJ2ZvY3VzJykgIT09IC0xIHx8IHNob3dBY3Rpb24uaW5kZXhPZignZm9jdXMnKSAhPT0gLTE7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImlzQmx1clRvSGlkZVwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzQmx1clRvSGlkZSgpIHtcbiAgICAgICAgdmFyIF90aGlzJHByb3BzMTAgPSB0aGlzLnByb3BzLFxuICAgICAgICAgICAgYWN0aW9uID0gX3RoaXMkcHJvcHMxMC5hY3Rpb24sXG4gICAgICAgICAgICBoaWRlQWN0aW9uID0gX3RoaXMkcHJvcHMxMC5oaWRlQWN0aW9uO1xuICAgICAgICByZXR1cm4gYWN0aW9uLmluZGV4T2YoJ2ZvY3VzJykgIT09IC0xIHx8IGhpZGVBY3Rpb24uaW5kZXhPZignYmx1cicpICE9PSAtMTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiZm9yY2VQb3B1cEFsaWduXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZm9yY2VQb3B1cEFsaWduKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5wb3B1cFZpc2libGUpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkcG9wdXBSZWYkY3VycmVuMztcblxuICAgICAgICAgIChfdGhpcyRwb3B1cFJlZiRjdXJyZW4zID0gdGhpcy5wb3B1cFJlZi5jdXJyZW50KSA9PT0gbnVsbCB8fCBfdGhpcyRwb3B1cFJlZiRjdXJyZW4zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRwb3B1cFJlZiRjdXJyZW4zLmZvcmNlQWxpZ24oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogXCJmaXJlRXZlbnRzXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZmlyZUV2ZW50cyh0eXBlLCBlKSB7XG4gICAgICAgIHZhciBjaGlsZENhbGxiYWNrID0gdGhpcy5wcm9wcy5jaGlsZHJlbi5wcm9wc1t0eXBlXTtcblxuICAgICAgICBpZiAoY2hpbGRDYWxsYmFjaykge1xuICAgICAgICAgIGNoaWxkQ2FsbGJhY2soZSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLnByb3BzW3R5cGVdO1xuXG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgIGNhbGxiYWNrKGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImNsb3NlXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuc2V0UG9wdXBWaXNpYmxlKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgICB2YXIgcG9wdXBWaXNpYmxlID0gdGhpcy5zdGF0ZS5wb3B1cFZpc2libGU7XG4gICAgICAgIHZhciBfdGhpcyRwcm9wczExID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICAgIGNoaWxkcmVuID0gX3RoaXMkcHJvcHMxMS5jaGlsZHJlbixcbiAgICAgICAgICAgIGZvcmNlUmVuZGVyID0gX3RoaXMkcHJvcHMxMS5mb3JjZVJlbmRlcixcbiAgICAgICAgICAgIGFsaWduUG9pbnQgPSBfdGhpcyRwcm9wczExLmFsaWduUG9pbnQsXG4gICAgICAgICAgICBjbGFzc05hbWUgPSBfdGhpcyRwcm9wczExLmNsYXNzTmFtZSxcbiAgICAgICAgICAgIGF1dG9EZXN0cm95ID0gX3RoaXMkcHJvcHMxMS5hdXRvRGVzdHJveTtcbiAgICAgICAgdmFyIGNoaWxkID0gUmVhY3QuQ2hpbGRyZW4ub25seShjaGlsZHJlbik7XG4gICAgICAgIHZhciBuZXdDaGlsZFByb3BzID0ge1xuICAgICAgICAgIGtleTogJ3RyaWdnZXInXG4gICAgICAgIH07IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBWaXNpYmxlIEhhbmRsZXJzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyA+Pj4gQ29udGV4dE1lbnVcblxuICAgICAgICBpZiAodGhpcy5pc0NvbnRleHRNZW51VG9TaG93KCkpIHtcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uQ29udGV4dE1lbnUgPSB0aGlzLm9uQ29udGV4dE1lbnU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5vbkNvbnRleHRNZW51ID0gdGhpcy5jcmVhdGVUd29DaGFpbnMoJ29uQ29udGV4dE1lbnUnKTtcbiAgICAgICAgfSAvLyA+Pj4gQ2xpY2tcblxuXG4gICAgICAgIGlmICh0aGlzLmlzQ2xpY2tUb0hpZGUoKSB8fCB0aGlzLmlzQ2xpY2tUb1Nob3coKSkge1xuICAgICAgICAgIG5ld0NoaWxkUHJvcHMub25DbGljayA9IHRoaXMub25DbGljaztcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uTW91c2VEb3duID0gdGhpcy5vbk1vdXNlRG93bjtcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uVG91Y2hTdGFydCA9IHRoaXMub25Ub3VjaFN0YXJ0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld0NoaWxkUHJvcHMub25DbGljayA9IHRoaXMuY3JlYXRlVHdvQ2hhaW5zKCdvbkNsaWNrJyk7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5vbk1vdXNlRG93biA9IHRoaXMuY3JlYXRlVHdvQ2hhaW5zKCdvbk1vdXNlRG93bicpO1xuICAgICAgICAgIG5ld0NoaWxkUHJvcHMub25Ub3VjaFN0YXJ0ID0gdGhpcy5jcmVhdGVUd29DaGFpbnMoJ29uVG91Y2hTdGFydCcpO1xuICAgICAgICB9IC8vID4+PiBIb3ZlcihlbnRlcilcblxuXG4gICAgICAgIGlmICh0aGlzLmlzTW91c2VFbnRlclRvU2hvdygpKSB7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5vbk1vdXNlRW50ZXIgPSB0aGlzLm9uTW91c2VFbnRlcjsgLy8gUG9pbnQgYWxpZ25cblxuICAgICAgICAgIGlmIChhbGlnblBvaW50KSB7XG4gICAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uTW91c2VNb3ZlID0gdGhpcy5vbk1vdXNlTW92ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5vbk1vdXNlRW50ZXIgPSB0aGlzLmNyZWF0ZVR3b0NoYWlucygnb25Nb3VzZUVudGVyJyk7XG4gICAgICAgIH0gLy8gPj4+IEhvdmVyKGxlYXZlKVxuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNNb3VzZUxlYXZlVG9IaWRlKCkpIHtcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uTW91c2VMZWF2ZSA9IHRoaXMub25Nb3VzZUxlYXZlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld0NoaWxkUHJvcHMub25Nb3VzZUxlYXZlID0gdGhpcy5jcmVhdGVUd29DaGFpbnMoJ29uTW91c2VMZWF2ZScpO1xuICAgICAgICB9IC8vID4+PiBGb2N1c1xuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNGb2N1c1RvU2hvdygpIHx8IHRoaXMuaXNCbHVyVG9IaWRlKCkpIHtcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uRm9jdXMgPSB0aGlzLm9uRm9jdXM7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5vbkJsdXIgPSB0aGlzLm9uQmx1cjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdDaGlsZFByb3BzLm9uRm9jdXMgPSB0aGlzLmNyZWF0ZVR3b0NoYWlucygnb25Gb2N1cycpO1xuICAgICAgICAgIG5ld0NoaWxkUHJvcHMub25CbHVyID0gdGhpcy5jcmVhdGVUd29DaGFpbnMoJ29uQmx1cicpO1xuICAgICAgICB9IC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFJlbmRlciA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cbiAgICAgICAgdmFyIGNoaWxkcmVuQ2xhc3NOYW1lID0gY2xhc3NOYW1lcyhjaGlsZCAmJiBjaGlsZC5wcm9wcyAmJiBjaGlsZC5wcm9wcy5jbGFzc05hbWUsIGNsYXNzTmFtZSk7XG5cbiAgICAgICAgaWYgKGNoaWxkcmVuQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgbmV3Q2hpbGRQcm9wcy5jbGFzc05hbWUgPSBjaGlsZHJlbkNsYXNzTmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjbG9uZVByb3BzID0gX29iamVjdFNwcmVhZCh7fSwgbmV3Q2hpbGRQcm9wcyk7XG5cbiAgICAgICAgaWYgKHN1cHBvcnRSZWYoY2hpbGQpKSB7XG4gICAgICAgICAgY2xvbmVQcm9wcy5yZWYgPSBjb21wb3NlUmVmKHRoaXMudHJpZ2dlclJlZiwgY2hpbGQucmVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB0cmlnZ2VyID0gLyojX19QVVJFX18qL1JlYWN0LmNsb25lRWxlbWVudChjaGlsZCwgY2xvbmVQcm9wcyk7XG4gICAgICAgIHZhciBwb3J0YWw7IC8vIHByZXZlbnQgdW5tb3VudGluZyBhZnRlciBpdCdzIHJlbmRlcmVkXG5cbiAgICAgICAgaWYgKHBvcHVwVmlzaWJsZSB8fCB0aGlzLnBvcHVwUmVmLmN1cnJlbnQgfHwgZm9yY2VSZW5kZXIpIHtcbiAgICAgICAgICBwb3J0YWwgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3J0YWxDb21wb25lbnQsIHtcbiAgICAgICAgICAgIGtleTogXCJwb3J0YWxcIixcbiAgICAgICAgICAgIGdldENvbnRhaW5lcjogdGhpcy5nZXRDb250YWluZXIsXG4gICAgICAgICAgICBkaWRVcGRhdGU6IHRoaXMuaGFuZGxlUG9ydGFsVXBkYXRlXG4gICAgICAgICAgfSwgdGhpcy5nZXRDb21wb25lbnQoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXBvcHVwVmlzaWJsZSAmJiBhdXRvRGVzdHJveSkge1xuICAgICAgICAgIHBvcnRhbCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHJpZ2dlckNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICAgICAgICB2YWx1ZTogdGhpcy50cmlnZ2VyQ29udGV4dFZhbHVlXG4gICAgICAgIH0sIHRyaWdnZXIsIHBvcnRhbCk7XG4gICAgICB9XG4gICAgfV0sIFt7XG4gICAgICBrZXk6IFwiZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzKF9yZWYsIHByZXZTdGF0ZSkge1xuICAgICAgICB2YXIgcG9wdXBWaXNpYmxlID0gX3JlZi5wb3B1cFZpc2libGU7XG4gICAgICAgIHZhciBuZXdTdGF0ZSA9IHt9O1xuXG4gICAgICAgIGlmIChwb3B1cFZpc2libGUgIT09IHVuZGVmaW5lZCAmJiBwcmV2U3RhdGUucG9wdXBWaXNpYmxlICE9PSBwb3B1cFZpc2libGUpIHtcbiAgICAgICAgICBuZXdTdGF0ZS5wb3B1cFZpc2libGUgPSBwb3B1cFZpc2libGU7XG4gICAgICAgICAgbmV3U3RhdGUucHJldlBvcHVwVmlzaWJsZSA9IHByZXZTdGF0ZS5wb3B1cFZpc2libGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3U3RhdGU7XG4gICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFRyaWdnZXI7XG4gIH0oUmVhY3QuQ29tcG9uZW50KTtcblxuICBUcmlnZ2VyLmNvbnRleHRUeXBlID0gVHJpZ2dlckNvbnRleHQ7XG4gIFRyaWdnZXIuZGVmYXVsdFByb3BzID0ge1xuICAgIHByZWZpeENsczogJ3JjLXRyaWdnZXItcG9wdXAnLFxuICAgIGdldFBvcHVwQ2xhc3NOYW1lRnJvbUFsaWduOiByZXR1cm5FbXB0eVN0cmluZyxcbiAgICBnZXREb2N1bWVudDogcmV0dXJuRG9jdW1lbnQsXG4gICAgb25Qb3B1cFZpc2libGVDaGFuZ2U6IG5vb3AsXG4gICAgYWZ0ZXJQb3B1cFZpc2libGVDaGFuZ2U6IG5vb3AsXG4gICAgb25Qb3B1cEFsaWduOiBub29wLFxuICAgIHBvcHVwQ2xhc3NOYW1lOiAnJyxcbiAgICBtb3VzZUVudGVyRGVsYXk6IDAsXG4gICAgbW91c2VMZWF2ZURlbGF5OiAwLjEsXG4gICAgZm9jdXNEZWxheTogMCxcbiAgICBibHVyRGVsYXk6IDAuMTUsXG4gICAgcG9wdXBTdHlsZToge30sXG4gICAgZGVzdHJveVBvcHVwT25IaWRlOiBmYWxzZSxcbiAgICBwb3B1cEFsaWduOiB7fSxcbiAgICBkZWZhdWx0UG9wdXBWaXNpYmxlOiBmYWxzZSxcbiAgICBtYXNrOiBmYWxzZSxcbiAgICBtYXNrQ2xvc2FibGU6IHRydWUsXG4gICAgYWN0aW9uOiBbXSxcbiAgICBzaG93QWN0aW9uOiBbXSxcbiAgICBoaWRlQWN0aW9uOiBbXSxcbiAgICBhdXRvRGVzdHJveTogZmFsc2VcbiAgfTtcbiAgcmV0dXJuIFRyaWdnZXI7XG59XG5leHBvcnQgZGVmYXVsdCBnZW5lcmF0ZVRyaWdnZXIoUG9ydGFsKTsiLCJpbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMlwiO1xuXG5mdW5jdGlvbiBpc1BvaW50c0VxKGExLCBhMiwgaXNBbGlnblBvaW50KSB7XG4gIGlmIChpc0FsaWduUG9pbnQpIHtcbiAgICByZXR1cm4gYTFbMF0gPT09IGEyWzBdO1xuICB9XG5cbiAgcmV0dXJuIGExWzBdID09PSBhMlswXSAmJiBhMVsxXSA9PT0gYTJbMV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGlnbkZyb21QbGFjZW1lbnQoYnVpbHRpblBsYWNlbWVudHMsIHBsYWNlbWVudFN0ciwgYWxpZ24pIHtcbiAgdmFyIGJhc2VBbGlnbiA9IGJ1aWx0aW5QbGFjZW1lbnRzW3BsYWNlbWVudFN0cl0gfHwge307XG4gIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGJhc2VBbGlnbiksIGFsaWduKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGlnblBvcHVwQ2xhc3NOYW1lKGJ1aWx0aW5QbGFjZW1lbnRzLCBwcmVmaXhDbHMsIGFsaWduLCBpc0FsaWduUG9pbnQpIHtcbiAgdmFyIHBvaW50cyA9IGFsaWduLnBvaW50cztcbiAgdmFyIHBsYWNlbWVudHMgPSBPYmplY3Qua2V5cyhidWlsdGluUGxhY2VtZW50cyk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGFjZW1lbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgdmFyIHBsYWNlbWVudCA9IHBsYWNlbWVudHNbaV07XG5cbiAgICBpZiAoaXNQb2ludHNFcShidWlsdGluUGxhY2VtZW50c1twbGFjZW1lbnRdLnBvaW50cywgcG9pbnRzLCBpc0FsaWduUG9pbnQpKSB7XG4gICAgICByZXR1cm4gXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1wbGFjZW1lbnQtXCIpLmNvbmNhdChwbGFjZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiAnJztcbn0iLCJleHBvcnQgZnVuY3Rpb24gZ2V0TW90aW9uKF9yZWYpIHtcbiAgdmFyIHByZWZpeENscyA9IF9yZWYucHJlZml4Q2xzLFxuICAgICAgbW90aW9uID0gX3JlZi5tb3Rpb24sXG4gICAgICBhbmltYXRpb24gPSBfcmVmLmFuaW1hdGlvbixcbiAgICAgIHRyYW5zaXRpb25OYW1lID0gX3JlZi50cmFuc2l0aW9uTmFtZTtcblxuICBpZiAobW90aW9uKSB7XG4gICAgcmV0dXJuIG1vdGlvbjtcbiAgfVxuXG4gIGlmIChhbmltYXRpb24pIHtcbiAgICByZXR1cm4ge1xuICAgICAgbW90aW9uTmFtZTogXCJcIi5jb25jYXQocHJlZml4Q2xzLCBcIi1cIikuY29uY2F0KGFuaW1hdGlvbilcbiAgICB9O1xuICB9XG5cbiAgaWYgKHRyYW5zaXRpb25OYW1lKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1vdGlvbk5hbWU6IHRyYW5zaXRpb25OYW1lXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufSIsImltcG9ydCBfZXh0ZW5kcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kc1wiO1xuaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHlcIjtcbmltcG9ydCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzXCI7XG5pbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIjtcbmltcG9ydCBfdHlwZW9mIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2ZcIjtcbmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvclwiO1xuaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXlcIjtcbmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrXCI7XG5pbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzc1wiO1xuaW1wb3J0IF9pbmhlcml0cyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHNcIjtcbmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyXCI7XG5pbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgcGlja0F0dHJzIGZyb20gXCJyYy11dGlsL2VzL3BpY2tBdHRyc1wiO1xuaW1wb3J0IGRlZmF1bHRSZXF1ZXN0IGZyb20gJy4vcmVxdWVzdCc7XG5pbXBvcnQgZ2V0VWlkIGZyb20gJy4vdWlkJztcbmltcG9ydCBhdHRyQWNjZXB0IGZyb20gJy4vYXR0ci1hY2NlcHQnO1xuaW1wb3J0IHRyYXZlcnNlRmlsZVRyZWUgZnJvbSAnLi90cmF2ZXJzZUZpbGVUcmVlJztcblxudmFyIEFqYXhVcGxvYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuICBfaW5oZXJpdHMoQWpheFVwbG9hZGVyLCBfQ29tcG9uZW50KTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEFqYXhVcGxvYWRlcik7XG5cbiAgZnVuY3Rpb24gQWpheFVwbG9hZGVyKCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBamF4VXBsb2FkZXIpO1xuXG4gICAgX3RoaXMgPSBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHVpZDogZ2V0VWlkKClcbiAgICB9O1xuICAgIF90aGlzLnJlcXMgPSB7fTtcblxuICAgIF90aGlzLm9uQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBfdGhpcyRwcm9wcyA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIGFjY2VwdCA9IF90aGlzJHByb3BzLmFjY2VwdCxcbiAgICAgICAgICBkaXJlY3RvcnkgPSBfdGhpcyRwcm9wcy5kaXJlY3Rvcnk7XG4gICAgICB2YXIgZmlsZXMgPSBlLnRhcmdldC5maWxlcztcblxuICAgICAgdmFyIGFjY2VwdGVkRmlsZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoZmlsZXMpLmZpbHRlcihmdW5jdGlvbiAoZmlsZSkge1xuICAgICAgICByZXR1cm4gIWRpcmVjdG9yeSB8fCBhdHRyQWNjZXB0KGZpbGUsIGFjY2VwdCk7XG4gICAgICB9KTtcblxuICAgICAgX3RoaXMudXBsb2FkRmlsZXMoYWNjZXB0ZWRGaWxlcyk7XG5cbiAgICAgIF90aGlzLnJlc2V0KCk7XG4gICAgfTtcblxuICAgIF90aGlzLm9uQ2xpY2sgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGVsID0gX3RoaXMuZmlsZUlucHV0O1xuXG4gICAgICBpZiAoIWVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIF90aGlzJHByb3BzMiA9IF90aGlzLnByb3BzLFxuICAgICAgICAgIGNoaWxkcmVuID0gX3RoaXMkcHJvcHMyLmNoaWxkcmVuLFxuICAgICAgICAgIG9uQ2xpY2sgPSBfdGhpcyRwcm9wczIub25DbGljaztcblxuICAgICAgaWYgKGNoaWxkcmVuICYmIGNoaWxkcmVuLnR5cGUgPT09ICdidXR0b24nKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSBlbC5wYXJlbnROb2RlO1xuICAgICAgICBwYXJlbnQuZm9jdXMoKTtcbiAgICAgICAgcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpLmJsdXIoKTtcbiAgICAgIH1cblxuICAgICAgZWwuY2xpY2soKTtcblxuICAgICAgaWYgKG9uQ2xpY2spIHtcbiAgICAgICAgb25DbGljayhlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMub25LZXlEb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICBfdGhpcy5vbkNsaWNrKGUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5vbkZpbGVEcm9wID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBtdWx0aXBsZSA9IF90aGlzLnByb3BzLm11bHRpcGxlO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBpZiAoZS50eXBlID09PSAnZHJhZ292ZXInKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKF90aGlzLnByb3BzLmRpcmVjdG9yeSkge1xuICAgICAgICB0cmF2ZXJzZUZpbGVUcmVlKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGUuZGF0YVRyYW5zZmVyLml0ZW1zKSwgX3RoaXMudXBsb2FkRmlsZXMsIGZ1bmN0aW9uIChfZmlsZSkge1xuICAgICAgICAgIHJldHVybiBhdHRyQWNjZXB0KF9maWxlLCBfdGhpcy5wcm9wcy5hY2NlcHQpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBmaWxlcyA9IF90b0NvbnN1bWFibGVBcnJheShlLmRhdGFUcmFuc2Zlci5maWxlcykuZmlsdGVyKGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgICAgcmV0dXJuIGF0dHJBY2NlcHQoZmlsZSwgX3RoaXMucHJvcHMuYWNjZXB0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKG11bHRpcGxlID09PSBmYWxzZSkge1xuICAgICAgICAgIGZpbGVzID0gZmlsZXMuc2xpY2UoMCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpcy51cGxvYWRGaWxlcyhmaWxlcyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLnVwbG9hZEZpbGVzID0gZnVuY3Rpb24gKGZpbGVzKSB7XG4gICAgICB2YXIgb3JpZ2luRmlsZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoZmlsZXMpO1xuXG4gICAgICB2YXIgcG9zdEZpbGVzID0gb3JpZ2luRmlsZXMubWFwKGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgICBmaWxlLnVpZCA9IGdldFVpZCgpO1xuICAgICAgICByZXR1cm4gX3RoaXMucHJvY2Vzc0ZpbGUoZmlsZSwgb3JpZ2luRmlsZXMpO1xuICAgICAgfSk7IC8vIEJhdGNoIHVwbG9hZCBmaWxlc1xuXG4gICAgICBQcm9taXNlLmFsbChwb3N0RmlsZXMpLnRoZW4oZnVuY3Rpb24gKGZpbGVMaXN0KSB7XG4gICAgICAgIHZhciBvbkJhdGNoU3RhcnQgPSBfdGhpcy5wcm9wcy5vbkJhdGNoU3RhcnQ7XG4gICAgICAgIG9uQmF0Y2hTdGFydCA9PT0gbnVsbCB8fCBvbkJhdGNoU3RhcnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9uQmF0Y2hTdGFydChmaWxlTGlzdC5tYXAoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgICB2YXIgb3JpZ2luID0gX3JlZi5vcmlnaW4sXG4gICAgICAgICAgICAgIHBhcnNlZEZpbGUgPSBfcmVmLnBhcnNlZEZpbGU7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGU6IG9yaWdpbixcbiAgICAgICAgICAgIHBhcnNlZEZpbGU6IHBhcnNlZEZpbGVcbiAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgICAgIGZpbGVMaXN0LmZpbHRlcihmdW5jdGlvbiAoZmlsZSkge1xuICAgICAgICAgIHJldHVybiBmaWxlLnBhcnNlZEZpbGUgIT09IG51bGw7XG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgICAgICBfdGhpcy5wb3N0KGZpbGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBmaWxlIGJlZm9yZSB1cGxvYWQuIFdoZW4gYWxsIHRoZSBmaWxlIGlzIHJlYWR5LCB3ZSBzdGFydCB1cGxvYWQuXG4gICAgICovXG5cblxuICAgIF90aGlzLnByb2Nlc3NGaWxlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZmlsZSwgZmlsZUxpc3QpIHtcbiAgICAgICAgdmFyIGJlZm9yZVVwbG9hZCwgdHJhbnNmb3JtZWRGaWxlLCBhY3Rpb24sIG1lcmdlZEFjdGlvbiwgZGF0YSwgbWVyZ2VkRGF0YSwgcGFyc2VkRGF0YSwgcGFyc2VkRmlsZSwgbWVyZ2VkUGFyc2VkRmlsZTtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBiZWZvcmVVcGxvYWQgPSBfdGhpcy5wcm9wcy5iZWZvcmVVcGxvYWQ7XG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRGaWxlID0gZmlsZTtcblxuICAgICAgICAgICAgICAgIGlmICghYmVmb3JlVXBsb2FkKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMztcbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmVmb3JlVXBsb2FkKGZpbGUsIGZpbGVMaXN0KTtcblxuICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRGaWxlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA5O1xuICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbXCJjYXRjaFwiXSgzKTtcbiAgICAgICAgICAgICAgICAvLyBSZWplY3Rpb24gd2lsbCBhbHNvIHRyYWRlIGFzIGZhbHNlXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRGaWxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICBpZiAoISh0cmFuc2Zvcm1lZEZpbGUgPT09IGZhbHNlKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCB7XG4gICAgICAgICAgICAgICAgICBvcmlnaW46IGZpbGUsXG4gICAgICAgICAgICAgICAgICBwYXJzZWRGaWxlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgYWN0aW9uOiBudWxsLFxuICAgICAgICAgICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAgICAgLy8gR2V0IGxhdGVzdCBhY3Rpb25cbiAgICAgICAgICAgICAgICBhY3Rpb24gPSBfdGhpcy5wcm9wcy5hY3Rpb247XG5cbiAgICAgICAgICAgICAgICBpZiAoISh0eXBlb2YgYWN0aW9uID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb24oZmlsZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxODpcbiAgICAgICAgICAgICAgICBtZXJnZWRBY3Rpb24gPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMjtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgICAgIG1lcmdlZEFjdGlvbiA9IGFjdGlvbjtcblxuICAgICAgICAgICAgICBjYXNlIDIyOlxuICAgICAgICAgICAgICAgIC8vIEdldCBsYXRlc3QgZGF0YVxuICAgICAgICAgICAgICAgIGRhdGEgPSBfdGhpcy5wcm9wcy5kYXRhO1xuXG4gICAgICAgICAgICAgICAgaWYgKCEodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEoZmlsZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyNjpcbiAgICAgICAgICAgICAgICBtZXJnZWREYXRhID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOTpcbiAgICAgICAgICAgICAgICBtZXJnZWREYXRhID0gZGF0YTtcblxuICAgICAgICAgICAgICBjYXNlIDMwOlxuICAgICAgICAgICAgICAgIHBhcnNlZERhdGEgPSAvLyBzdHJpbmcgdHlwZSBpcyBmcm9tIGxlZ2FjeSBgdHJhbnNmb3JtRmlsZWAuXG4gICAgICAgICAgICAgICAgLy8gTm90IHN1cmUgaWYgdGhpcyB3aWxsIHdvcmsgc2luY2Ugbm8gcmVsYXRlZCB0ZXN0IGNhc2Ugd29ya3Mgd2l0aCBpdFxuICAgICAgICAgICAgICAgIChfdHlwZW9mKHRyYW5zZm9ybWVkRmlsZSkgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB0cmFuc2Zvcm1lZEZpbGUgPT09ICdzdHJpbmcnKSAmJiB0cmFuc2Zvcm1lZEZpbGUgPyB0cmFuc2Zvcm1lZEZpbGUgOiBmaWxlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZERhdGEgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgICAgICAgICBwYXJzZWRGaWxlID0gcGFyc2VkRGF0YTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcGFyc2VkRmlsZSA9IG5ldyBGaWxlKFtwYXJzZWREYXRhXSwgZmlsZS5uYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGZpbGUudHlwZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWVyZ2VkUGFyc2VkRmlsZSA9IHBhcnNlZEZpbGU7XG4gICAgICAgICAgICAgICAgbWVyZ2VkUGFyc2VkRmlsZS51aWQgPSBmaWxlLnVpZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHtcbiAgICAgICAgICAgICAgICAgIG9yaWdpbjogZmlsZSxcbiAgICAgICAgICAgICAgICAgIGRhdGE6IG1lcmdlZERhdGEsXG4gICAgICAgICAgICAgICAgICBwYXJzZWRGaWxlOiBtZXJnZWRQYXJzZWRGaWxlLFxuICAgICAgICAgICAgICAgICAgYWN0aW9uOiBtZXJnZWRBY3Rpb25cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDM1OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMywgOV1dKTtcbiAgICAgIH0pKTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyKSB7XG4gICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICBfdGhpcy5zYXZlRmlsZUlucHV0ID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIF90aGlzLmZpbGVJbnB1dCA9IG5vZGU7XG4gICAgfTtcblxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhBamF4VXBsb2FkZXIsIFt7XG4gICAga2V5OiBcImNvbXBvbmVudERpZE1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50V2lsbFVubW91bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicG9zdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwb3N0KF9yZWYzKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIGRhdGEgPSBfcmVmMy5kYXRhLFxuICAgICAgICAgIG9yaWdpbiA9IF9yZWYzLm9yaWdpbixcbiAgICAgICAgICBhY3Rpb24gPSBfcmVmMy5hY3Rpb24sXG4gICAgICAgICAgcGFyc2VkRmlsZSA9IF9yZWYzLnBhcnNlZEZpbGU7XG5cbiAgICAgIGlmICghdGhpcy5faXNNb3VudGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgb25TdGFydCA9IF90aGlzJHByb3BzMy5vblN0YXJ0LFxuICAgICAgICAgIGN1c3RvbVJlcXVlc3QgPSBfdGhpcyRwcm9wczMuY3VzdG9tUmVxdWVzdCxcbiAgICAgICAgICBuYW1lID0gX3RoaXMkcHJvcHMzLm5hbWUsXG4gICAgICAgICAgaGVhZGVycyA9IF90aGlzJHByb3BzMy5oZWFkZXJzLFxuICAgICAgICAgIHdpdGhDcmVkZW50aWFscyA9IF90aGlzJHByb3BzMy53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgbWV0aG9kID0gX3RoaXMkcHJvcHMzLm1ldGhvZDtcbiAgICAgIHZhciB1aWQgPSBvcmlnaW4udWlkO1xuICAgICAgdmFyIHJlcXVlc3QgPSBjdXN0b21SZXF1ZXN0IHx8IGRlZmF1bHRSZXF1ZXN0O1xuICAgICAgdmFyIHJlcXVlc3RPcHRpb24gPSB7XG4gICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICBmaWxlbmFtZTogbmFtZSxcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgZmlsZTogcGFyc2VkRmlsZSxcbiAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB3aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgIG1ldGhvZDogbWV0aG9kIHx8ICdwb3N0JyxcbiAgICAgICAgb25Qcm9ncmVzczogZnVuY3Rpb24gb25Qcm9ncmVzcyhlKSB7XG4gICAgICAgICAgdmFyIG9uUHJvZ3Jlc3MgPSBfdGhpczIucHJvcHMub25Qcm9ncmVzcztcbiAgICAgICAgICBvblByb2dyZXNzID09PSBudWxsIHx8IG9uUHJvZ3Jlc3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9uUHJvZ3Jlc3MoZSwgcGFyc2VkRmlsZSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24gb25TdWNjZXNzKHJldCwgeGhyKSB7XG4gICAgICAgICAgdmFyIG9uU3VjY2VzcyA9IF90aGlzMi5wcm9wcy5vblN1Y2Nlc3M7XG4gICAgICAgICAgb25TdWNjZXNzID09PSBudWxsIHx8IG9uU3VjY2VzcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb25TdWNjZXNzKHJldCwgcGFyc2VkRmlsZSwgeGhyKTtcbiAgICAgICAgICBkZWxldGUgX3RoaXMyLnJlcXNbdWlkXTtcbiAgICAgICAgfSxcbiAgICAgICAgb25FcnJvcjogZnVuY3Rpb24gb25FcnJvcihlcnIsIHJldCkge1xuICAgICAgICAgIHZhciBvbkVycm9yID0gX3RoaXMyLnByb3BzLm9uRXJyb3I7XG4gICAgICAgICAgb25FcnJvciA9PT0gbnVsbCB8fCBvbkVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvbkVycm9yKGVyciwgcmV0LCBwYXJzZWRGaWxlKTtcbiAgICAgICAgICBkZWxldGUgX3RoaXMyLnJlcXNbdWlkXTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIG9uU3RhcnQob3JpZ2luKTtcbiAgICAgIHRoaXMucmVxc1t1aWRdID0gcmVxdWVzdChyZXF1ZXN0T3B0aW9uKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVzZXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdWlkOiBnZXRVaWQoKVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFib3J0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KGZpbGUpIHtcbiAgICAgIHZhciByZXFzID0gdGhpcy5yZXFzO1xuXG4gICAgICBpZiAoZmlsZSkge1xuICAgICAgICB2YXIgdWlkID0gZmlsZS51aWQgPyBmaWxlLnVpZCA6IGZpbGU7XG5cbiAgICAgICAgaWYgKHJlcXNbdWlkXSAmJiByZXFzW3VpZF0uYWJvcnQpIHtcbiAgICAgICAgICByZXFzW3VpZF0uYWJvcnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlbGV0ZSByZXFzW3VpZF07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBPYmplY3Qua2V5cyhyZXFzKS5mb3JFYWNoKGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgICBpZiAocmVxc1t1aWRdICYmIHJlcXNbdWlkXS5hYm9ydCkge1xuICAgICAgICAgICAgcmVxc1t1aWRdLmFib3J0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGVsZXRlIHJlcXNbdWlkXTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbmRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgX2NsYXNzTmFtZXM7XG5cbiAgICAgIHZhciBfdGhpcyRwcm9wczQgPSB0aGlzLnByb3BzLFxuICAgICAgICAgIFRhZyA9IF90aGlzJHByb3BzNC5jb21wb25lbnQsXG4gICAgICAgICAgcHJlZml4Q2xzID0gX3RoaXMkcHJvcHM0LnByZWZpeENscyxcbiAgICAgICAgICBjbGFzc05hbWUgPSBfdGhpcyRwcm9wczQuY2xhc3NOYW1lLFxuICAgICAgICAgIGRpc2FibGVkID0gX3RoaXMkcHJvcHM0LmRpc2FibGVkLFxuICAgICAgICAgIGlkID0gX3RoaXMkcHJvcHM0LmlkLFxuICAgICAgICAgIHN0eWxlID0gX3RoaXMkcHJvcHM0LnN0eWxlLFxuICAgICAgICAgIG11bHRpcGxlID0gX3RoaXMkcHJvcHM0Lm11bHRpcGxlLFxuICAgICAgICAgIGFjY2VwdCA9IF90aGlzJHByb3BzNC5hY2NlcHQsXG4gICAgICAgICAgY2hpbGRyZW4gPSBfdGhpcyRwcm9wczQuY2hpbGRyZW4sXG4gICAgICAgICAgZGlyZWN0b3J5ID0gX3RoaXMkcHJvcHM0LmRpcmVjdG9yeSxcbiAgICAgICAgICBvcGVuRmlsZURpYWxvZ09uQ2xpY2sgPSBfdGhpcyRwcm9wczQub3BlbkZpbGVEaWFsb2dPbkNsaWNrLFxuICAgICAgICAgIG9uTW91c2VFbnRlciA9IF90aGlzJHByb3BzNC5vbk1vdXNlRW50ZXIsXG4gICAgICAgICAgb25Nb3VzZUxlYXZlID0gX3RoaXMkcHJvcHM0Lm9uTW91c2VMZWF2ZSxcbiAgICAgICAgICBjYXB0dXJlID0gX3RoaXMkcHJvcHM0LmNhcHR1cmUsXG4gICAgICAgICAgb3RoZXJQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhfdGhpcyRwcm9wczQsIFtcImNvbXBvbmVudFwiLCBcInByZWZpeENsc1wiLCBcImNsYXNzTmFtZVwiLCBcImRpc2FibGVkXCIsIFwiaWRcIiwgXCJzdHlsZVwiLCBcIm11bHRpcGxlXCIsIFwiYWNjZXB0XCIsIFwiY2hpbGRyZW5cIiwgXCJkaXJlY3RvcnlcIiwgXCJvcGVuRmlsZURpYWxvZ09uQ2xpY2tcIiwgXCJvbk1vdXNlRW50ZXJcIiwgXCJvbk1vdXNlTGVhdmVcIiwgXCJjYXB0dXJlXCJdKTtcblxuICAgICAgdmFyIGNscyA9IGNsYXNzTmFtZXMoKF9jbGFzc05hbWVzID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgcHJlZml4Q2xzLCB0cnVlKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzc05hbWVzLCBcIlwiLmNvbmNhdChwcmVmaXhDbHMsIFwiLWRpc2FibGVkXCIpLCBkaXNhYmxlZCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3NOYW1lcywgY2xhc3NOYW1lLCBjbGFzc05hbWUpLCBfY2xhc3NOYW1lcykpOyAvLyBiZWNhdXNlIGlucHV0IGRvbid0IGhhdmUgZGlyZWN0b3J5L3dlYmtpdGRpcmVjdG9yeSB0eXBlIGRlY2xhcmF0aW9uXG5cbiAgICAgIHZhciBkaXJQcm9wcyA9IGRpcmVjdG9yeSA/IHtcbiAgICAgICAgZGlyZWN0b3J5OiAnZGlyZWN0b3J5JyxcbiAgICAgICAgd2Via2l0ZGlyZWN0b3J5OiAnd2Via2l0ZGlyZWN0b3J5J1xuICAgICAgfSA6IHt9O1xuICAgICAgdmFyIGV2ZW50cyA9IGRpc2FibGVkID8ge30gOiB7XG4gICAgICAgIG9uQ2xpY2s6IG9wZW5GaWxlRGlhbG9nT25DbGljayA/IHRoaXMub25DbGljayA6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgICBvbktleURvd246IG9wZW5GaWxlRGlhbG9nT25DbGljayA/IHRoaXMub25LZXlEb3duIDogZnVuY3Rpb24gKCkge30sXG4gICAgICAgIG9uTW91c2VFbnRlcjogb25Nb3VzZUVudGVyLFxuICAgICAgICBvbk1vdXNlTGVhdmU6IG9uTW91c2VMZWF2ZSxcbiAgICAgICAgb25Ecm9wOiB0aGlzLm9uRmlsZURyb3AsXG4gICAgICAgIG9uRHJhZ092ZXI6IHRoaXMub25GaWxlRHJvcCxcbiAgICAgICAgdGFiSW5kZXg6ICcwJ1xuICAgICAgfTtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUYWcsIF9leHRlbmRzKHt9LCBldmVudHMsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBjbHMsXG4gICAgICAgIHJvbGU6IFwiYnV0dG9uXCIsXG4gICAgICAgIHN0eWxlOiBzdHlsZVxuICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgX2V4dGVuZHMoe30sIHBpY2tBdHRycyhvdGhlclByb3BzLCB7XG4gICAgICAgIGFyaWE6IHRydWUsXG4gICAgICAgIGRhdGE6IHRydWVcbiAgICAgIH0pLCB7XG4gICAgICAgIGlkOiBpZCxcbiAgICAgICAgdHlwZTogXCJmaWxlXCIsXG4gICAgICAgIHJlZjogdGhpcy5zYXZlRmlsZUlucHV0LFxuICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHtcbiAgICAgICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSAvLyBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy8xOTk0OFxuICAgICAgICAsXG4gICAgICAgIGtleTogdGhpcy5zdGF0ZS51aWQsXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2VwdDogYWNjZXB0XG4gICAgICB9LCBkaXJQcm9wcywge1xuICAgICAgICBtdWx0aXBsZTogbXVsdGlwbGUsXG4gICAgICAgIG9uQ2hhbmdlOiB0aGlzLm9uQ2hhbmdlXG4gICAgICB9LCBjYXB0dXJlICE9IG51bGwgPyB7XG4gICAgICAgIGNhcHR1cmU6IGNhcHR1cmVcbiAgICAgIH0gOiB7fSkpLCBjaGlsZHJlbik7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEFqYXhVcGxvYWRlcjtcbn0oQ29tcG9uZW50KTtcblxuZXhwb3J0IGRlZmF1bHQgQWpheFVwbG9hZGVyOyIsImltcG9ydCBfZXh0ZW5kcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZXh0ZW5kc1wiO1xuaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2tcIjtcbmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzXCI7XG5pbXBvcnQgX2luaGVyaXRzIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0c1wiO1xuaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXJcIjtcblxuLyogZXNsaW50IHJlYWN0L3Byb3AtdHlwZXM6MCAqL1xuaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBBamF4VXBsb2FkIGZyb20gJy4vQWpheFVwbG9hZGVyJztcblxuZnVuY3Rpb24gZW1wdHkoKSB7fVxuXG52YXIgVXBsb2FkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhVcGxvYWQsIF9Db21wb25lbnQpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVXBsb2FkKTtcblxuICBmdW5jdGlvbiBVcGxvYWQoKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFVwbG9hZCk7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG4gICAgX3RoaXMuc2F2ZVVwbG9hZGVyID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIF90aGlzLnVwbG9hZGVyID0gbm9kZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFVwbG9hZCwgW3tcbiAgICBrZXk6IFwiYWJvcnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoZmlsZSkge1xuICAgICAgdGhpcy51cGxvYWRlci5hYm9ydChmaWxlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicmVuZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChBamF4VXBsb2FkLCBfZXh0ZW5kcyh7fSwgdGhpcy5wcm9wcywge1xuICAgICAgICByZWY6IHRoaXMuc2F2ZVVwbG9hZGVyXG4gICAgICB9KSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFVwbG9hZDtcbn0oQ29tcG9uZW50KTtcblxuVXBsb2FkLmRlZmF1bHRQcm9wcyA9IHtcbiAgY29tcG9uZW50OiAnc3BhbicsXG4gIHByZWZpeENsczogJ3JjLXVwbG9hZCcsXG4gIGRhdGE6IHt9LFxuICBoZWFkZXJzOiB7fSxcbiAgbmFtZTogJ2ZpbGUnLFxuICBtdWx0aXBhcnQ6IGZhbHNlLFxuICBvblN0YXJ0OiBlbXB0eSxcbiAgb25FcnJvcjogZW1wdHksXG4gIG9uU3VjY2VzczogZW1wdHksXG4gIG11bHRpcGxlOiBmYWxzZSxcbiAgYmVmb3JlVXBsb2FkOiBudWxsLFxuICBjdXN0b21SZXF1ZXN0OiBudWxsLFxuICB3aXRoQ3JlZGVudGlhbHM6IGZhbHNlLFxuICBvcGVuRmlsZURpYWxvZ09uQ2xpY2s6IHRydWVcbn07XG5leHBvcnQgZGVmYXVsdCBVcGxvYWQ7IiwiaW1wb3J0IHdhcm5pbmcgZnJvbSBcInJjLXV0aWwvZXMvd2FybmluZ1wiO1xuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uIChmaWxlLCBhY2NlcHRlZEZpbGVzKSB7XG4gIGlmIChmaWxlICYmIGFjY2VwdGVkRmlsZXMpIHtcbiAgICB2YXIgYWNjZXB0ZWRGaWxlc0FycmF5ID0gQXJyYXkuaXNBcnJheShhY2NlcHRlZEZpbGVzKSA/IGFjY2VwdGVkRmlsZXMgOiBhY2NlcHRlZEZpbGVzLnNwbGl0KCcsJyk7XG4gICAgdmFyIGZpbGVOYW1lID0gZmlsZS5uYW1lIHx8ICcnO1xuICAgIHZhciBtaW1lVHlwZSA9IGZpbGUudHlwZSB8fCAnJztcbiAgICB2YXIgYmFzZU1pbWVUeXBlID0gbWltZVR5cGUucmVwbGFjZSgvXFwvLiokLywgJycpO1xuICAgIHJldHVybiBhY2NlcHRlZEZpbGVzQXJyYXkuc29tZShmdW5jdGlvbiAodHlwZSkge1xuICAgICAgdmFyIHZhbGlkVHlwZSA9IHR5cGUudHJpbSgpOyAvLyBUaGlzIGlzIHNvbWV0aGluZyBsaWtlICovKiwqICBhbGxvdyBhbGwgZmlsZXNcblxuICAgICAgaWYgKC9eXFwqKFxcL1xcKik/JC8udGVzdCh0eXBlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gLy8gbGlrZSAuanBnLCAucG5nXG5cblxuICAgICAgaWYgKHZhbGlkVHlwZS5jaGFyQXQoMCkgPT09ICcuJykge1xuICAgICAgICB2YXIgbG93ZXJGaWxlTmFtZSA9IGZpbGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBsb3dlclR5cGUgPSB2YWxpZFR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdmFyIGFmZml4TGlzdCA9IFtsb3dlclR5cGVdO1xuXG4gICAgICAgIGlmIChsb3dlclR5cGUgPT09ICcuanBnJyB8fCBsb3dlclR5cGUgPT09ICcuanBlZycpIHtcbiAgICAgICAgICBhZmZpeExpc3QgPSBbJy5qcGcnLCAnanBlZyddO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGFmZml4TGlzdC5zb21lKGZ1bmN0aW9uIChhZmZpeCkge1xuICAgICAgICAgIHJldHVybiBsb3dlckZpbGVOYW1lLmVuZHNXaXRoKGFmZml4KTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIFRoaXMgaXMgc29tZXRoaW5nIGxpa2UgYSBpbWFnZS8qIG1pbWUgdHlwZVxuXG5cbiAgICAgIGlmICgvXFwvXFwqJC8udGVzdCh2YWxpZFR5cGUpKSB7XG4gICAgICAgIHJldHVybiBiYXNlTWltZVR5cGUgPT09IHZhbGlkVHlwZS5yZXBsYWNlKC9cXC8uKiQvLCAnJyk7XG4gICAgICB9IC8vIEZ1bGwgbWF0Y2hcblxuXG4gICAgICBpZiAobWltZVR5cGUgPT09IHZhbGlkVHlwZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gLy8gSW52YWxpZGF0ZSB0eXBlIHNob3VsZCBza2lwXG5cblxuICAgICAgaWYgKC9eXFx3KyQvLnRlc3QodmFsaWRUeXBlKSkge1xuICAgICAgICB3YXJuaW5nKGZhbHNlLCBcIlVwbG9hZCB0YWtlcyBhbiBpbnZhbGlkYXRlICdhY2NlcHQnIHR5cGUgJ1wiLmNvbmNhdCh2YWxpZFR5cGUsIFwiJy5Ta2lwIGZvciBjaGVjay5cIikpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59KTsiLCJpbXBvcnQgVXBsb2FkIGZyb20gJy4vVXBsb2FkJztcbmV4cG9ydCBkZWZhdWx0IFVwbG9hZDsiLCJmdW5jdGlvbiBnZXRFcnJvcihvcHRpb24sIHhocikge1xuICB2YXIgbXNnID0gXCJjYW5ub3QgXCIuY29uY2F0KG9wdGlvbi5tZXRob2QsIFwiIFwiKS5jb25jYXQob3B0aW9uLmFjdGlvbiwgXCIgXCIpLmNvbmNhdCh4aHIuc3RhdHVzLCBcIidcIik7XG4gIHZhciBlcnIgPSBuZXcgRXJyb3IobXNnKTtcbiAgZXJyLnN0YXR1cyA9IHhoci5zdGF0dXM7XG4gIGVyci5tZXRob2QgPSBvcHRpb24ubWV0aG9kO1xuICBlcnIudXJsID0gb3B0aW9uLmFjdGlvbjtcbiAgcmV0dXJuIGVycjtcbn1cblxuZnVuY3Rpb24gZ2V0Qm9keSh4aHIpIHtcbiAgdmFyIHRleHQgPSB4aHIucmVzcG9uc2VUZXh0IHx8IHhoci5yZXNwb25zZTtcblxuICBpZiAoIXRleHQpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuXG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodGV4dCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1cGxvYWQob3B0aW9uKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgaWYgKG9wdGlvbi5vblByb2dyZXNzICYmIHhoci51cGxvYWQpIHtcbiAgICB4aHIudXBsb2FkLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiBwcm9ncmVzcyhlKSB7XG4gICAgICBpZiAoZS50b3RhbCA+IDApIHtcbiAgICAgICAgZS5wZXJjZW50ID0gZS5sb2FkZWQgLyBlLnRvdGFsICogMTAwO1xuICAgICAgfVxuXG4gICAgICBvcHRpb24ub25Qcm9ncmVzcyhlKTtcbiAgICB9O1xuICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuXG5cbiAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cbiAgaWYgKG9wdGlvbi5kYXRhKSB7XG4gICAgT2JqZWN0LmtleXMob3B0aW9uLmRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgdmFyIHZhbHVlID0gb3B0aW9uLmRhdGFba2V5XTsgLy8gc3VwcG9ydCBrZXktdmFsdWUgYXJyYXkgZGF0YVxuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIC8vIHsgbGlzdDogWyAxMSwgMjIgXSB9XG4gICAgICAgICAgLy8gZm9ybURhdGEuYXBwZW5kKCdsaXN0W10nLCAxMSk7XG4gICAgICAgICAgZm9ybURhdGEuYXBwZW5kKFwiXCIuY29uY2F0KGtleSwgXCJbXVwiKSwgaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIG9wdGlvbi5kYXRhW2tleV0pO1xuICAgIH0pO1xuICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuXG5cbiAgaWYgKG9wdGlvbi5maWxlIGluc3RhbmNlb2YgQmxvYikge1xuICAgIGZvcm1EYXRhLmFwcGVuZChvcHRpb24uZmlsZW5hbWUsIG9wdGlvbi5maWxlLCBvcHRpb24uZmlsZS5uYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBmb3JtRGF0YS5hcHBlbmQob3B0aW9uLmZpbGVuYW1lLCBvcHRpb24uZmlsZSk7XG4gIH1cblxuICB4aHIub25lcnJvciA9IGZ1bmN0aW9uIGVycm9yKGUpIHtcbiAgICBvcHRpb24ub25FcnJvcihlKTtcbiAgfTtcblxuICB4aHIub25sb2FkID0gZnVuY3Rpb24gb25sb2FkKCkge1xuICAgIC8vIGFsbG93IHN1Y2Nlc3Mgd2hlbiAyeHggc3RhdHVzXG4gICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdC1jb21wb25lbnQvdXBsb2FkL2lzc3Vlcy8zNFxuICAgIGlmICh4aHIuc3RhdHVzIDwgMjAwIHx8IHhoci5zdGF0dXMgPj0gMzAwKSB7XG4gICAgICByZXR1cm4gb3B0aW9uLm9uRXJyb3IoZ2V0RXJyb3Iob3B0aW9uLCB4aHIpLCBnZXRCb2R5KHhocikpO1xuICAgIH1cblxuICAgIHJldHVybiBvcHRpb24ub25TdWNjZXNzKGdldEJvZHkoeGhyKSwgeGhyKTtcbiAgfTtcblxuICB4aHIub3BlbihvcHRpb24ubWV0aG9kLCBvcHRpb24uYWN0aW9uLCB0cnVlKTsgLy8gSGFzIHRvIGJlIGFmdGVyIGAub3BlbigpYC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbnlvL2Ryb3B6b25lL2lzc3Vlcy8xNzlcblxuICBpZiAob3B0aW9uLndpdGhDcmVkZW50aWFscyAmJiAnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpIHtcbiAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgfVxuXG4gIHZhciBoZWFkZXJzID0gb3B0aW9uLmhlYWRlcnMgfHwge307IC8vIHdoZW4gc2V0IGhlYWRlcnNbJ1gtUmVxdWVzdGVkLVdpdGgnXSA9IG51bGwgLCBjYW4gY2xvc2UgZGVmYXVsdCBYSFIgaGVhZGVyXG4gIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtY29tcG9uZW50L3VwbG9hZC9pc3N1ZXMvMzNcblxuICBpZiAoaGVhZGVyc1snWC1SZXF1ZXN0ZWQtV2l0aCddICE9PSBudWxsKSB7XG4gICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTtcbiAgfVxuXG4gIE9iamVjdC5rZXlzKGhlYWRlcnMpLmZvckVhY2goZnVuY3Rpb24gKGgpIHtcbiAgICBpZiAoaGVhZGVyc1toXSAhPT0gbnVsbCkge1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoaCwgaGVhZGVyc1toXSk7XG4gICAgfVxuICB9KTtcbiAgeGhyLnNlbmQoZm9ybURhdGEpO1xuICByZXR1cm4ge1xuICAgIGFib3J0OiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgIHhoci5hYm9ydCgpO1xuICAgIH1cbiAgfTtcbn0iLCJmdW5jdGlvbiBsb29wRmlsZXMoaXRlbSwgY2FsbGJhY2spIHtcbiAgdmFyIGRpclJlYWRlciA9IGl0ZW0uY3JlYXRlUmVhZGVyKCk7XG4gIHZhciBmaWxlTGlzdCA9IFtdO1xuXG4gIGZ1bmN0aW9uIHNlcXVlbmNlKCkge1xuICAgIGRpclJlYWRlci5yZWFkRW50cmllcyhmdW5jdGlvbiAoZW50cmllcykge1xuICAgICAgdmFyIGVudHJ5TGlzdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShlbnRyaWVzKTtcbiAgICAgIGZpbGVMaXN0ID0gZmlsZUxpc3QuY29uY2F0KGVudHJ5TGlzdCk7IC8vIENoZWNrIGlmIGFsbCB0aGUgZmlsZSBoYXMgYmVlbiB2aWV3ZWRcblxuICAgICAgdmFyIGlzRmluaXNoZWQgPSAhZW50cnlMaXN0Lmxlbmd0aDtcblxuICAgICAgaWYgKGlzRmluaXNoZWQpIHtcbiAgICAgICAgY2FsbGJhY2soZmlsZUxpc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VxdWVuY2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHNlcXVlbmNlKCk7XG59XG5cbnZhciB0cmF2ZXJzZUZpbGVUcmVlID0gZnVuY3Rpb24gdHJhdmVyc2VGaWxlVHJlZShmaWxlcywgY2FsbGJhY2ssIGlzQWNjZXB0ZWQpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uYW1pbmctY29udmVudGlvblxuICB2YXIgX3RyYXZlcnNlRmlsZVRyZWUgPSBmdW5jdGlvbiBfdHJhdmVyc2VGaWxlVHJlZShpdGVtLCBwYXRoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgaXRlbS5wYXRoID0gcGF0aCB8fCAnJztcblxuICAgIGlmIChpdGVtLmlzRmlsZSkge1xuICAgICAgaXRlbS5maWxlKGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgIGlmIChpc0FjY2VwdGVkKGZpbGUpKSB7XG4gICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvMTY0MjZcbiAgICAgICAgICBpZiAoaXRlbS5mdWxsUGF0aCAmJiAhZmlsZS53ZWJraXRSZWxhdGl2ZVBhdGgpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGZpbGUsIHtcbiAgICAgICAgICAgICAgd2Via2l0UmVsYXRpdmVQYXRoOiB7XG4gICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgICAgICBmaWxlLndlYmtpdFJlbGF0aXZlUGF0aCA9IGl0ZW0uZnVsbFBhdGgucmVwbGFjZSgvXlxcLy8sICcnKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGZpbGUsIHtcbiAgICAgICAgICAgICAgd2Via2l0UmVsYXRpdmVQYXRoOiB7XG4gICAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhbGxiYWNrKFtmaWxlXSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoaXRlbS5pc0RpcmVjdG9yeSkge1xuICAgICAgbG9vcEZpbGVzKGl0ZW0sIGZ1bmN0aW9uIChlbnRyaWVzKSB7XG4gICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbiAoZW50cnlJdGVtKSB7XG4gICAgICAgICAgX3RyYXZlcnNlRmlsZVRyZWUoZW50cnlJdGVtLCBcIlwiLmNvbmNhdChwYXRoKS5jb25jYXQoaXRlbS5uYW1lLCBcIi9cIikpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBmaWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgX3RyYXZlcnNlRmlsZVRyZWUoZmlsZS53ZWJraXRHZXRBc0VudHJ5KCkpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHRyYXZlcnNlRmlsZVRyZWU7IiwidmFyIG5vdyA9ICtuZXcgRGF0ZSgpO1xudmFyIGluZGV4ID0gMDtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVpZCgpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBsdXNwbHVzXG4gIHJldHVybiBcInJjLXVwbG9hZC1cIi5jb25jYXQobm93LCBcIi1cIikuY29uY2F0KCsraW5kZXgpO1xufSIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBpc0ZyYWdtZW50IH0gZnJvbSAncmVhY3QtaXMnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdG9BcnJheShjaGlsZHJlbikge1xuICB2YXIgb3B0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgdmFyIHJldCA9IFtdO1xuICBSZWFjdC5DaGlsZHJlbi5mb3JFYWNoKGNoaWxkcmVuLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICBpZiAoKGNoaWxkID09PSB1bmRlZmluZWQgfHwgY2hpbGQgPT09IG51bGwpICYmICFvcHRpb24ua2VlcEVtcHR5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY2hpbGQpKSB7XG4gICAgICByZXQgPSByZXQuY29uY2F0KHRvQXJyYXkoY2hpbGQpKTtcbiAgICB9IGVsc2UgaWYgKGlzRnJhZ21lbnQoY2hpbGQpICYmIGNoaWxkLnByb3BzKSB7XG4gICAgICByZXQgPSByZXQuY29uY2F0KHRvQXJyYXkoY2hpbGQucHJvcHMuY2hpbGRyZW4sIG9wdGlvbikpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXQucHVzaChjaGlsZCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJldDtcbn0iLCJpbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJXcmFwKHRhcmdldCwgZXZlbnRUeXBlLCBjYiwgb3B0aW9uKSB7XG4gIC8qIGVzbGludCBjYW1lbGNhc2U6IDIgKi9cbiAgdmFyIGNhbGxiYWNrID0gUmVhY3RET00udW5zdGFibGVfYmF0Y2hlZFVwZGF0ZXMgPyBmdW5jdGlvbiBydW4oZSkge1xuICAgIFJlYWN0RE9NLnVuc3RhYmxlX2JhdGNoZWRVcGRhdGVzKGNiLCBlKTtcbiAgfSA6IGNiO1xuXG4gIGlmICh0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgY2FsbGJhY2ssIG9wdGlvbik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgaWYgKHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgICAgIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgY2FsbGJhY2spO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjYW5Vc2VEb20oKSB7XG4gIHJldHVybiAhISh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuZG9jdW1lbnQgJiYgd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbnRhaW5zKHJvb3QsIG4pIHtcbiAgaWYgKCFyb290KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHJvb3QuY29udGFpbnMobik7XG59IiwiLyogZXNsaW50LWRpc2FibGUgbm8tbmVzdGVkLXRlcm5hcnkgKi9cbnZhciBQSVhFTF9QQVRURVJOID0gL21hcmdpbnxwYWRkaW5nfHdpZHRofGhlaWdodHxtYXh8bWlufG9mZnNldC87XG52YXIgcmVtb3ZlUGl4ZWwgPSB7XG4gIGxlZnQ6IHRydWUsXG4gIHRvcDogdHJ1ZVxufTtcbnZhciBmbG9hdE1hcCA9IHtcbiAgY3NzRmxvYXQ6IDEsXG4gIHN0eWxlRmxvYXQ6IDEsXG4gIGZsb2F0OiAxXG59O1xuXG5mdW5jdGlvbiBnZXRDb21wdXRlZFN0eWxlKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IDEgPyBub2RlLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBudWxsKSA6IHt9O1xufVxuXG5mdW5jdGlvbiBnZXRTdHlsZVZhbHVlKG5vZGUsIHR5cGUsIHZhbHVlKSB7XG4gIHR5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKHZhbHVlID09PSAnYXV0bycpIHtcbiAgICBpZiAodHlwZSA9PT0gJ2hlaWdodCcpIHtcbiAgICAgIHJldHVybiBub2RlLm9mZnNldEhlaWdodDtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gJ3dpZHRoJykge1xuICAgICAgcmV0dXJuIG5vZGUub2Zmc2V0V2lkdGg7XG4gICAgfVxuICB9XG5cbiAgaWYgKCEodHlwZSBpbiByZW1vdmVQaXhlbCkpIHtcbiAgICByZW1vdmVQaXhlbFt0eXBlXSA9IFBJWEVMX1BBVFRFUk4udGVzdCh0eXBlKTtcbiAgfVxuXG4gIHJldHVybiByZW1vdmVQaXhlbFt0eXBlXSA/IHBhcnNlRmxvYXQodmFsdWUpIHx8IDAgOiB2YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldChub2RlLCBuYW1lKSB7XG4gIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICBuYW1lID0gZmxvYXRNYXBbbmFtZV0gPyAnY3NzRmxvYXQnIGluIG5vZGUuc3R5bGUgPyAnY3NzRmxvYXQnIDogJ3N0eWxlRmxvYXQnIDogbmFtZTtcbiAgcmV0dXJuIGxlbmd0aCA9PT0gMSA/IHN0eWxlIDogZ2V0U3R5bGVWYWx1ZShub2RlLCBuYW1lLCBzdHlsZVtuYW1lXSB8fCBub2RlLnN0eWxlW25hbWVdKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXQobm9kZSwgbmFtZSwgdmFsdWUpIHtcbiAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gIG5hbWUgPSBmbG9hdE1hcFtuYW1lXSA/ICdjc3NGbG9hdCcgaW4gbm9kZS5zdHlsZSA/ICdjc3NGbG9hdCcgOiAnc3R5bGVGbG9hdCcgOiBuYW1lO1xuXG4gIGlmIChsZW5ndGggPT09IDMpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiBQSVhFTF9QQVRURVJOLnRlc3QobmFtZSkpIHtcbiAgICAgIHZhbHVlID0gXCJcIi5jb25jYXQodmFsdWUsIFwicHhcIik7XG4gICAgfVxuXG4gICAgbm9kZS5zdHlsZVtuYW1lXSA9IHZhbHVlOyAvLyBOdW1iZXJcblxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGZvciAodmFyIHggaW4gbmFtZSkge1xuICAgIGlmIChuYW1lLmhhc093blByb3BlcnR5KHgpKSB7XG4gICAgICBzZXQobm9kZSwgeCwgbmFtZVt4XSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0T3V0ZXJXaWR0aChlbCkge1xuICBpZiAoZWwgPT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuICB9XG5cbiAgcmV0dXJuIGVsLm9mZnNldFdpZHRoO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldE91dGVySGVpZ2h0KGVsKSB7XG4gIGlmIChlbCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgfVxuXG4gIHJldHVybiBlbC5vZmZzZXRIZWlnaHQ7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RG9jU2l6ZSgpIHtcbiAgdmFyIHdpZHRoID0gTWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFdpZHRoLCBkb2N1bWVudC5ib2R5LnNjcm9sbFdpZHRoKTtcbiAgdmFyIGhlaWdodCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQsIGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0KTtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHRcbiAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRTaXplKCkge1xuICB2YXIgd2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHZhciBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHRcbiAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY3JvbGwoKSB7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogTWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQsIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCksXG4gICAgc2Nyb2xsVG9wOiBNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcClcbiAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRPZmZzZXQobm9kZSkge1xuICB2YXIgYm94ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIGRvY0VsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7IC8vIDwgaWU4IOS4jeaUr+aMgSB3aW4ucGFnZVhPZmZzZXQsIOWImeS9v+eUqCBkb2NFbGVtLnNjcm9sbExlZnRcblxuICByZXR1cm4ge1xuICAgIGxlZnQ6IGJveC5sZWZ0ICsgKHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbExlZnQpIC0gKGRvY0VsZW0uY2xpZW50TGVmdCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudExlZnQgfHwgMCksXG4gICAgdG9wOiBib3gudG9wICsgKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbFRvcCkgLSAoZG9jRWxlbS5jbGllbnRUb3AgfHwgZG9jdW1lbnQuYm9keS5jbGllbnRUb3AgfHwgMClcbiAgfTtcbn0iLCJpbXBvcnQgY2FuVXNlRG9tIGZyb20gJy4vY2FuVXNlRG9tJztcbnZhciBNQVJLX0tFWSA9IFwicmMtdXRpbC1rZXlcIjtcblxuZnVuY3Rpb24gZ2V0Q29udGFpbmVyKG9wdGlvbikge1xuICBpZiAob3B0aW9uLmF0dGFjaFRvKSB7XG4gICAgcmV0dXJuIG9wdGlvbi5hdHRhY2hUbztcbiAgfVxuXG4gIHZhciBoZWFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xuICByZXR1cm4gaGVhZCB8fCBkb2N1bWVudC5ib2R5O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0Q1NTKGNzcykge1xuICB2YXIgX29wdGlvbiRjc3A7XG5cbiAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgaWYgKCFjYW5Vc2VEb20oKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdmFyIHN0eWxlTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG5cbiAgaWYgKChfb3B0aW9uJGNzcCA9IG9wdGlvbi5jc3ApID09PSBudWxsIHx8IF9vcHRpb24kY3NwID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0aW9uJGNzcC5ub25jZSkge1xuICAgIHZhciBfb3B0aW9uJGNzcDI7XG5cbiAgICBzdHlsZU5vZGUubm9uY2UgPSAoX29wdGlvbiRjc3AyID0gb3B0aW9uLmNzcCkgPT09IG51bGwgfHwgX29wdGlvbiRjc3AyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0aW9uJGNzcDIubm9uY2U7XG4gIH1cblxuICBzdHlsZU5vZGUuaW5uZXJIVE1MID0gY3NzO1xuICB2YXIgY29udGFpbmVyID0gZ2V0Q29udGFpbmVyKG9wdGlvbik7XG4gIHZhciBmaXJzdENoaWxkID0gY29udGFpbmVyLmZpcnN0Q2hpbGQ7XG5cbiAgaWYgKG9wdGlvbi5wcmVwZW5kICYmIGNvbnRhaW5lci5wcmVwZW5kKSB7XG4gICAgLy8gVXNlIGBwcmVwZW5kYCBmaXJzdFxuICAgIGNvbnRhaW5lci5wcmVwZW5kKHN0eWxlTm9kZSk7XG4gIH0gZWxzZSBpZiAob3B0aW9uLnByZXBlbmQgJiYgZmlyc3RDaGlsZCkge1xuICAgIC8vIEZhbGxiYWNrIHRvIGBpbnNlcnRCZWZvcmVgIGxpa2UgSUUgbm90IHN1cHBvcnQgYHByZXBlbmRgXG4gICAgY29udGFpbmVyLmluc2VydEJlZm9yZShzdHlsZU5vZGUsIGZpcnN0Q2hpbGQpO1xuICB9IGVsc2Uge1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdHlsZU5vZGUpO1xuICB9XG5cbiAgcmV0dXJuIHN0eWxlTm9kZTtcbn1cbnZhciBjb250YWluZXJDYWNoZSA9IG5ldyBNYXAoKTtcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDU1MoY3NzLCBrZXkpIHtcbiAgdmFyIG9wdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307XG4gIHZhciBjb250YWluZXIgPSBnZXRDb250YWluZXIob3B0aW9uKTsgLy8gR2V0IHJlYWwgcGFyZW50XG5cbiAgaWYgKCFjb250YWluZXJDYWNoZS5oYXMoY29udGFpbmVyKSkge1xuICAgIHZhciBwbGFjZWhvbGRlclN0eWxlID0gaW5qZWN0Q1NTKCcnLCBvcHRpb24pO1xuICAgIHZhciBwYXJlbnROb2RlID0gcGxhY2Vob2xkZXJTdHlsZS5wYXJlbnROb2RlO1xuICAgIGNvbnRhaW5lckNhY2hlLnNldChjb250YWluZXIsIHBhcmVudE5vZGUpO1xuICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocGxhY2Vob2xkZXJTdHlsZSk7XG4gIH1cblxuICB2YXIgZXhpc3ROb2RlID0gQXJyYXkuZnJvbShjb250YWluZXJDYWNoZS5nZXQoY29udGFpbmVyKS5jaGlsZHJlbikuZmluZChmdW5jdGlvbiAobm9kZSkge1xuICAgIHJldHVybiBub2RlLnRhZ05hbWUgPT09ICdTVFlMRScgJiYgbm9kZVtNQVJLX0tFWV0gPT09IGtleTtcbiAgfSk7XG5cbiAgaWYgKGV4aXN0Tm9kZSkge1xuICAgIHZhciBfb3B0aW9uJGNzcDMsIF9vcHRpb24kY3NwNDtcblxuICAgIGlmICgoKF9vcHRpb24kY3NwMyA9IG9wdGlvbi5jc3ApID09PSBudWxsIHx8IF9vcHRpb24kY3NwMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX29wdGlvbiRjc3AzLm5vbmNlKSAmJiBleGlzdE5vZGUubm9uY2UgIT09ICgoX29wdGlvbiRjc3A0ID0gb3B0aW9uLmNzcCkgPT09IG51bGwgfHwgX29wdGlvbiRjc3A0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0aW9uJGNzcDQubm9uY2UpKSB7XG4gICAgICB2YXIgX29wdGlvbiRjc3A1O1xuXG4gICAgICBleGlzdE5vZGUubm9uY2UgPSAoX29wdGlvbiRjc3A1ID0gb3B0aW9uLmNzcCkgPT09IG51bGwgfHwgX29wdGlvbiRjc3A1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0aW9uJGNzcDUubm9uY2U7XG4gICAgfVxuXG4gICAgaWYgKGV4aXN0Tm9kZS5pbm5lckhUTUwgIT09IGNzcykge1xuICAgICAgZXhpc3ROb2RlLmlubmVySFRNTCA9IGNzcztcbiAgICB9XG5cbiAgICByZXR1cm4gZXhpc3ROb2RlO1xuICB9XG5cbiAgdmFyIG5ld05vZGUgPSBpbmplY3RDU1MoY3NzLCBvcHRpb24pO1xuICBuZXdOb2RlW01BUktfS0VZXSA9IGtleTtcbiAgcmV0dXJuIG5ld05vZGU7XG59IiwiaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG4vKipcbiAqIFJldHVybiBpZiBhIG5vZGUgaXMgYSBET00gbm9kZS4gRWxzZSB3aWxsIHJldHVybiBieSBgZmluZERPTU5vZGVgXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZmluZERPTU5vZGUobm9kZSkge1xuICBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICByZXR1cm4gUmVhY3RET00uZmluZERPTU5vZGUobm9kZSk7XG59IiwiaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXlcIjtcbmltcG9ydCBpc1Zpc2libGUgZnJvbSAnLi9pc1Zpc2libGUnO1xuXG5mdW5jdGlvbiBmb2N1c2FibGUobm9kZSkge1xuICB2YXIgaW5jbHVkZVBvc2l0aXZlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTtcblxuICBpZiAoaXNWaXNpYmxlKG5vZGUpKSB7XG4gICAgdmFyIG5vZGVOYW1lID0gbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBpc0ZvY3VzYWJsZUVsZW1lbnQgPSAvLyBGb2N1c2FibGUgZWxlbWVudFxuICAgIFsnaW5wdXQnLCAnc2VsZWN0JywgJ3RleHRhcmVhJywgJ2J1dHRvbiddLmluY2x1ZGVzKG5vZGVOYW1lKSB8fCAvLyBFZGl0YWJsZSBlbGVtZW50XG4gICAgbm9kZS5pc0NvbnRlbnRFZGl0YWJsZSB8fCAvLyBBbmNob3Igd2l0aCBocmVmIGVsZW1lbnRcbiAgICBub2RlTmFtZSA9PT0gJ2EnICYmICEhbm9kZS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTsgLy8gR2V0IHRhYkluZGV4XG5cbiAgICB2YXIgdGFiSW5kZXhBdHRyID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7XG4gICAgdmFyIHRhYkluZGV4TnVtID0gTnVtYmVyKHRhYkluZGV4QXR0cik7IC8vIFBhcnNlIGFzIG51bWJlciBpZiB2YWxpZGF0ZVxuXG4gICAgdmFyIHRhYkluZGV4ID0gbnVsbDtcblxuICAgIGlmICh0YWJJbmRleEF0dHIgJiYgIU51bWJlci5pc05hTih0YWJJbmRleE51bSkpIHtcbiAgICAgIHRhYkluZGV4ID0gdGFiSW5kZXhOdW07XG4gICAgfSBlbHNlIGlmIChpc0ZvY3VzYWJsZUVsZW1lbnQgJiYgdGFiSW5kZXggPT09IG51bGwpIHtcbiAgICAgIHRhYkluZGV4ID0gMDtcbiAgICB9IC8vIEJsb2NrIGZvY3VzYWJsZSBpZiBkaXNhYmxlZFxuXG5cbiAgICBpZiAoaXNGb2N1c2FibGVFbGVtZW50ICYmIG5vZGUuZGlzYWJsZWQpIHtcbiAgICAgIHRhYkluZGV4ID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGFiSW5kZXggIT09IG51bGwgJiYgKHRhYkluZGV4ID49IDAgfHwgaW5jbHVkZVBvc2l0aXZlICYmIHRhYkluZGV4IDwgMCk7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2N1c05vZGVMaXN0KG5vZGUpIHtcbiAgdmFyIGluY2x1ZGVQb3NpdGl2ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG5cbiAgdmFyIHJlcyA9IF90b0NvbnN1bWFibGVBcnJheShub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJyonKSkuZmlsdGVyKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIHJldHVybiBmb2N1c2FibGUoY2hpbGQsIGluY2x1ZGVQb3NpdGl2ZSk7XG4gIH0pO1xuXG4gIGlmIChmb2N1c2FibGUobm9kZSwgaW5jbHVkZVBvc2l0aXZlKSkge1xuICAgIHJlcy51bnNoaWZ0KG5vZGUpO1xuICB9XG5cbiAgcmV0dXJuIHJlcztcbn1cbnZhciBsYXN0Rm9jdXNFbGVtZW50ID0gbnVsbDtcbi8qKiBAZGVwcmVjYXRlZCBEbyBub3QgdXNlIHNpbmNlIHRoaXMgbWF5IGZhaWxlZCB3aGVuIHVzZWQgaW4gYXN5bmMgKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVMYXN0Rm9jdXNOb2RlKCkge1xuICBsYXN0Rm9jdXNFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbn1cbi8qKiBAZGVwcmVjYXRlZCBEbyBub3QgdXNlIHNpbmNlIHRoaXMgbWF5IGZhaWxlZCB3aGVuIHVzZWQgaW4gYXN5bmMgKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyTGFzdEZvY3VzTm9kZSgpIHtcbiAgbGFzdEZvY3VzRWxlbWVudCA9IG51bGw7XG59XG4vKiogQGRlcHJlY2F0ZWQgRG8gbm90IHVzZSBzaW5jZSB0aGlzIG1heSBmYWlsZWQgd2hlbiB1c2VkIGluIGFzeW5jICovXG5cbmV4cG9ydCBmdW5jdGlvbiBiYWNrTGFzdEZvY3VzTm9kZSgpIHtcbiAgaWYgKGxhc3RGb2N1c0VsZW1lbnQpIHtcbiAgICB0cnkge1xuICAgICAgLy8g5YWD57Sg5Y+v6IO95bey57uP6KKr56e75Yqo5LqGXG4gICAgICBsYXN0Rm9jdXNFbGVtZW50LmZvY3VzKCk7XG4gICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgIH0gY2F0Y2ggKGUpIHsvLyBlbXB0eVxuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIG5vLWVtcHR5ICovXG5cbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGxpbWl0VGFiUmFuZ2Uobm9kZSwgZSkge1xuICBpZiAoZS5rZXlDb2RlID09PSA5KSB7XG4gICAgdmFyIHRhYk5vZGVMaXN0ID0gZ2V0Rm9jdXNOb2RlTGlzdChub2RlKTtcbiAgICB2YXIgbGFzdFRhYk5vZGUgPSB0YWJOb2RlTGlzdFtlLnNoaWZ0S2V5ID8gMCA6IHRhYk5vZGVMaXN0Lmxlbmd0aCAtIDFdO1xuICAgIHZhciBsZWF2aW5nVGFiID0gbGFzdFRhYk5vZGUgPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgfHwgbm9kZSA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblxuICAgIGlmIChsZWF2aW5nVGFiKSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gdGFiTm9kZUxpc3RbZS5zaGlmdEtleSA/IHRhYk5vZGVMaXN0Lmxlbmd0aCAtIDEgOiAwXTtcbiAgICAgIHRhcmdldC5mb2N1cygpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfVxufSIsImV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoZWxlbWVudCkge1xuICBpZiAoIWVsZW1lbnQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZWxlbWVudC5vZmZzZXRQYXJlbnQpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlmIChlbGVtZW50LmdldEJCb3gpIHtcbiAgICB2YXIgYm94ID0gZWxlbWVudC5nZXRCQm94KCk7XG5cbiAgICBpZiAoYm94LndpZHRoIHx8IGJveC5oZWlnaHQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgIHZhciBfYm94ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmIChfYm94LndpZHRoIHx8IF9ib3guaGVpZ2h0KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59KTsiLCJpbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheVwiO1xuaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2tcIjtcbmltcG9ydCBnZXRTY3JvbGxCYXJTaXplIGZyb20gJy4uL2dldFNjcm9sbEJhclNpemUnO1xuaW1wb3J0IHNldFN0eWxlIGZyb20gJy4uL3NldFN0eWxlJztcbnZhciBsb2NrcyA9IFtdO1xudmFyIHNjcm9sbGluZ0VmZmVjdENsYXNzTmFtZSA9ICdhbnQtc2Nyb2xsaW5nLWVmZmVjdCc7XG52YXIgc2Nyb2xsaW5nRWZmZWN0Q2xhc3NOYW1lUmVnID0gbmV3IFJlZ0V4cChcIlwiLmNvbmNhdChzY3JvbGxpbmdFZmZlY3RDbGFzc05hbWUpLCAnZycpO1xudmFyIHV1aWQgPSAwOyAvLyBodHRwczovL2dpdGh1Yi5jb20vYW50LWRlc2lnbi9hbnQtZGVzaWduL2lzc3Vlcy8xOTM0MFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvMTkzMzJcblxudmFyIGNhY2hlU3R5bGUgPSBuZXcgTWFwKCk7XG5cbnZhciBTY3JvbGxMb2NrZXIgPSBmdW5jdGlvbiBTY3JvbGxMb2NrZXIob3B0aW9ucykge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTY3JvbGxMb2NrZXIpO1xuXG4gIHRoaXMuZ2V0Q29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfdGhpcyRvcHRpb25zO1xuXG4gICAgcmV0dXJuIChfdGhpcyRvcHRpb25zID0gX3RoaXMub3B0aW9ucykgPT09IG51bGwgfHwgX3RoaXMkb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkb3B0aW9ucy5jb250YWluZXI7XG4gIH07IC8vIGlmIG9wdGlvbnMgY2hhbmdlLi4uXG5cblxuICB0aGlzLnJlTG9jayA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgdmFyIGZpbmRMb2NrID0gbG9ja3MuZmluZChmdW5jdGlvbiAoX3JlZikge1xuICAgICAgdmFyIHRhcmdldCA9IF9yZWYudGFyZ2V0O1xuICAgICAgcmV0dXJuIHRhcmdldCA9PT0gX3RoaXMubG9ja1RhcmdldDtcbiAgICB9KTtcblxuICAgIGlmIChmaW5kTG9jaykge1xuICAgICAgX3RoaXMudW5Mb2NrKCk7XG4gICAgfVxuXG4gICAgX3RoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICBpZiAoZmluZExvY2spIHtcbiAgICAgIGZpbmRMb2NrLm9wdGlvbnMgPSBvcHRpb25zO1xuXG4gICAgICBfdGhpcy5sb2NrKCk7XG4gICAgfVxuICB9O1xuXG4gIHRoaXMubG9jayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX3RoaXMkb3B0aW9uczM7XG5cbiAgICAvLyBJZiBsb2NrVGFyZ2V0IGV4aXN0IHJldHVyblxuICAgIGlmIChsb2Nrcy5zb21lKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIHRhcmdldCA9IF9yZWYyLnRhcmdldDtcbiAgICAgIHJldHVybiB0YXJnZXQgPT09IF90aGlzLmxvY2tUYXJnZXQ7XG4gICAgfSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIElmIHNhbWUgY29udGFpbmVyIGVmZmVjdCwgcmV0dXJuXG5cblxuICAgIGlmIChsb2Nrcy5zb21lKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgdmFyIF90aGlzJG9wdGlvbnMyO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IF9yZWYzLm9wdGlvbnM7XG4gICAgICByZXR1cm4gKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5jb250YWluZXIpID09PSAoKF90aGlzJG9wdGlvbnMyID0gX3RoaXMub3B0aW9ucykgPT09IG51bGwgfHwgX3RoaXMkb3B0aW9uczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG9wdGlvbnMyLmNvbnRhaW5lcik7XG4gICAgfSkpIHtcbiAgICAgIGxvY2tzID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShsb2NrcyksIFt7XG4gICAgICAgIHRhcmdldDogX3RoaXMubG9ja1RhcmdldCxcbiAgICAgICAgb3B0aW9uczogX3RoaXMub3B0aW9uc1xuICAgICAgfV0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBzY3JvbGxCYXJTaXplID0gMDtcbiAgICB2YXIgY29udGFpbmVyID0gKChfdGhpcyRvcHRpb25zMyA9IF90aGlzLm9wdGlvbnMpID09PSBudWxsIHx8IF90aGlzJG9wdGlvbnMzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRvcHRpb25zMy5jb250YWluZXIpIHx8IGRvY3VtZW50LmJvZHk7XG5cbiAgICBpZiAoY29udGFpbmVyID09PSBkb2N1bWVudC5ib2R5ICYmIHdpbmRvdy5pbm5lcldpZHRoIC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gMCB8fCBjb250YWluZXIuc2Nyb2xsSGVpZ2h0ID4gY29udGFpbmVyLmNsaWVudEhlaWdodCkge1xuICAgICAgc2Nyb2xsQmFyU2l6ZSA9IGdldFNjcm9sbEJhclNpemUoKTtcbiAgICB9XG5cbiAgICB2YXIgY29udGFpbmVyQ2xhc3NOYW1lID0gY29udGFpbmVyLmNsYXNzTmFtZTtcblxuICAgIGlmIChsb2Nrcy5maWx0ZXIoZnVuY3Rpb24gKF9yZWY0KSB7XG4gICAgICB2YXIgX3RoaXMkb3B0aW9uczQ7XG5cbiAgICAgIHZhciBvcHRpb25zID0gX3JlZjQub3B0aW9ucztcbiAgICAgIHJldHVybiAob3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmNvbnRhaW5lcikgPT09ICgoX3RoaXMkb3B0aW9uczQgPSBfdGhpcy5vcHRpb25zKSA9PT0gbnVsbCB8fCBfdGhpcyRvcHRpb25zNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkb3B0aW9uczQuY29udGFpbmVyKTtcbiAgICB9KS5sZW5ndGggPT09IDApIHtcbiAgICAgIGNhY2hlU3R5bGUuc2V0KGNvbnRhaW5lciwgc2V0U3R5bGUoe1xuICAgICAgICB3aWR0aDogXCJjYWxjKDEwMCUgLSBcIi5jb25jYXQoc2Nyb2xsQmFyU2l6ZSwgXCJweClcIiksXG4gICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgICAgb3ZlcmZsb3dYOiAnaGlkZGVuJyxcbiAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJ1xuICAgICAgfSwge1xuICAgICAgICBlbGVtZW50OiBjb250YWluZXJcbiAgICAgIH0pKTtcbiAgICB9IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbnQtZGVzaWduL2FudC1kZXNpZ24vaXNzdWVzLzE5NzI5XG5cblxuICAgIGlmICghc2Nyb2xsaW5nRWZmZWN0Q2xhc3NOYW1lUmVnLnRlc3QoY29udGFpbmVyQ2xhc3NOYW1lKSkge1xuICAgICAgdmFyIGFkZENsYXNzTmFtZSA9IFwiXCIuY29uY2F0KGNvbnRhaW5lckNsYXNzTmFtZSwgXCIgXCIpLmNvbmNhdChzY3JvbGxpbmdFZmZlY3RDbGFzc05hbWUpO1xuICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IGFkZENsYXNzTmFtZS50cmltKCk7XG4gICAgfVxuXG4gICAgbG9ja3MgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGxvY2tzKSwgW3tcbiAgICAgIHRhcmdldDogX3RoaXMubG9ja1RhcmdldCxcbiAgICAgIG9wdGlvbnM6IF90aGlzLm9wdGlvbnNcbiAgICB9XSk7XG4gIH07XG5cbiAgdGhpcy51bkxvY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIF90aGlzJG9wdGlvbnM1O1xuXG4gICAgdmFyIGZpbmRMb2NrID0gbG9ja3MuZmluZChmdW5jdGlvbiAoX3JlZjUpIHtcbiAgICAgIHZhciB0YXJnZXQgPSBfcmVmNS50YXJnZXQ7XG4gICAgICByZXR1cm4gdGFyZ2V0ID09PSBfdGhpcy5sb2NrVGFyZ2V0O1xuICAgIH0pO1xuICAgIGxvY2tzID0gbG9ja3MuZmlsdGVyKGZ1bmN0aW9uIChfcmVmNikge1xuICAgICAgdmFyIHRhcmdldCA9IF9yZWY2LnRhcmdldDtcbiAgICAgIHJldHVybiB0YXJnZXQgIT09IF90aGlzLmxvY2tUYXJnZXQ7XG4gICAgfSk7XG5cbiAgICBpZiAoIWZpbmRMb2NrIHx8IGxvY2tzLnNvbWUoZnVuY3Rpb24gKF9yZWY3KSB7XG4gICAgICB2YXIgX2ZpbmRMb2NrJG9wdGlvbnM7XG5cbiAgICAgIHZhciBvcHRpb25zID0gX3JlZjcub3B0aW9ucztcbiAgICAgIHJldHVybiAob3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmNvbnRhaW5lcikgPT09ICgoX2ZpbmRMb2NrJG9wdGlvbnMgPSBmaW5kTG9jay5vcHRpb25zKSA9PT0gbnVsbCB8fCBfZmluZExvY2skb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZpbmRMb2NrJG9wdGlvbnMuY29udGFpbmVyKTtcbiAgICB9KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gLy8gUmVtb3ZlIEVmZmVjdFxuXG5cbiAgICB2YXIgY29udGFpbmVyID0gKChfdGhpcyRvcHRpb25zNSA9IF90aGlzLm9wdGlvbnMpID09PSBudWxsIHx8IF90aGlzJG9wdGlvbnM1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRvcHRpb25zNS5jb250YWluZXIpIHx8IGRvY3VtZW50LmJvZHk7XG4gICAgdmFyIGNvbnRhaW5lckNsYXNzTmFtZSA9IGNvbnRhaW5lci5jbGFzc05hbWU7XG4gICAgaWYgKCFzY3JvbGxpbmdFZmZlY3RDbGFzc05hbWVSZWcudGVzdChjb250YWluZXJDbGFzc05hbWUpKSByZXR1cm47XG4gICAgc2V0U3R5bGUoY2FjaGVTdHlsZS5nZXQoY29udGFpbmVyKSwge1xuICAgICAgZWxlbWVudDogY29udGFpbmVyXG4gICAgfSk7XG4gICAgY2FjaGVTdHlsZS5kZWxldGUoY29udGFpbmVyKTtcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gY29udGFpbmVyLmNsYXNzTmFtZS5yZXBsYWNlKHNjcm9sbGluZ0VmZmVjdENsYXNzTmFtZVJlZywgJycpLnRyaW0oKTtcbiAgfTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBsdXNwbHVzXG5cblxuICB0aGlzLmxvY2tUYXJnZXQgPSB1dWlkKys7XG4gIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG59O1xuXG5leHBvcnQgeyBTY3JvbGxMb2NrZXIgYXMgZGVmYXVsdCB9OyIsIi8qKlxuICogQGlnbm9yZVxuICogc29tZSBrZXktY29kZXMgZGVmaW5pdGlvbiBhbmQgdXRpbHMgZnJvbSBjbG9zdXJlLWxpYnJhcnlcbiAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tXG4gKi9cbnZhciBLZXlDb2RlID0ge1xuICAvKipcbiAgICogTUFDX0VOVEVSXG4gICAqL1xuICBNQUNfRU5URVI6IDMsXG5cbiAgLyoqXG4gICAqIEJBQ0tTUEFDRVxuICAgKi9cbiAgQkFDS1NQQUNFOiA4LFxuXG4gIC8qKlxuICAgKiBUQUJcbiAgICovXG4gIFRBQjogOSxcblxuICAvKipcbiAgICogTlVNTE9DSyBvbiBGRi9TYWZhcmkgTWFjXG4gICAqL1xuICBOVU1fQ0VOVEVSOiAxMixcblxuICAvKipcbiAgICogRU5URVJcbiAgICovXG4gIEVOVEVSOiAxMyxcblxuICAvKipcbiAgICogU0hJRlRcbiAgICovXG4gIFNISUZUOiAxNixcblxuICAvKipcbiAgICogQ1RSTFxuICAgKi9cbiAgQ1RSTDogMTcsXG5cbiAgLyoqXG4gICAqIEFMVFxuICAgKi9cbiAgQUxUOiAxOCxcblxuICAvKipcbiAgICogUEFVU0VcbiAgICovXG4gIFBBVVNFOiAxOSxcblxuICAvKipcbiAgICogQ0FQU19MT0NLXG4gICAqL1xuICBDQVBTX0xPQ0s6IDIwLFxuXG4gIC8qKlxuICAgKiBFU0NcbiAgICovXG4gIEVTQzogMjcsXG5cbiAgLyoqXG4gICAqIFNQQUNFXG4gICAqL1xuICBTUEFDRTogMzIsXG5cbiAgLyoqXG4gICAqIFBBR0VfVVBcbiAgICovXG4gIFBBR0VfVVA6IDMzLFxuXG4gIC8qKlxuICAgKiBQQUdFX0RPV05cbiAgICovXG4gIFBBR0VfRE9XTjogMzQsXG5cbiAgLyoqXG4gICAqIEVORFxuICAgKi9cbiAgRU5EOiAzNSxcblxuICAvKipcbiAgICogSE9NRVxuICAgKi9cbiAgSE9NRTogMzYsXG5cbiAgLyoqXG4gICAqIExFRlRcbiAgICovXG4gIExFRlQ6IDM3LFxuXG4gIC8qKlxuICAgKiBVUFxuICAgKi9cbiAgVVA6IDM4LFxuXG4gIC8qKlxuICAgKiBSSUdIVFxuICAgKi9cbiAgUklHSFQ6IDM5LFxuXG4gIC8qKlxuICAgKiBET1dOXG4gICAqL1xuICBET1dOOiA0MCxcblxuICAvKipcbiAgICogUFJJTlRfU0NSRUVOXG4gICAqL1xuICBQUklOVF9TQ1JFRU46IDQ0LFxuXG4gIC8qKlxuICAgKiBJTlNFUlRcbiAgICovXG4gIElOU0VSVDogNDUsXG5cbiAgLyoqXG4gICAqIERFTEVURVxuICAgKi9cbiAgREVMRVRFOiA0NixcblxuICAvKipcbiAgICogWkVST1xuICAgKi9cbiAgWkVSTzogNDgsXG5cbiAgLyoqXG4gICAqIE9ORVxuICAgKi9cbiAgT05FOiA0OSxcblxuICAvKipcbiAgICogVFdPXG4gICAqL1xuICBUV086IDUwLFxuXG4gIC8qKlxuICAgKiBUSFJFRVxuICAgKi9cbiAgVEhSRUU6IDUxLFxuXG4gIC8qKlxuICAgKiBGT1VSXG4gICAqL1xuICBGT1VSOiA1MixcblxuICAvKipcbiAgICogRklWRVxuICAgKi9cbiAgRklWRTogNTMsXG5cbiAgLyoqXG4gICAqIFNJWFxuICAgKi9cbiAgU0lYOiA1NCxcblxuICAvKipcbiAgICogU0VWRU5cbiAgICovXG4gIFNFVkVOOiA1NSxcblxuICAvKipcbiAgICogRUlHSFRcbiAgICovXG4gIEVJR0hUOiA1NixcblxuICAvKipcbiAgICogTklORVxuICAgKi9cbiAgTklORTogNTcsXG5cbiAgLyoqXG4gICAqIFFVRVNUSU9OX01BUktcbiAgICovXG4gIFFVRVNUSU9OX01BUks6IDYzLFxuXG4gIC8qKlxuICAgKiBBXG4gICAqL1xuICBBOiA2NSxcblxuICAvKipcbiAgICogQlxuICAgKi9cbiAgQjogNjYsXG5cbiAgLyoqXG4gICAqIENcbiAgICovXG4gIEM6IDY3LFxuXG4gIC8qKlxuICAgKiBEXG4gICAqL1xuICBEOiA2OCxcblxuICAvKipcbiAgICogRVxuICAgKi9cbiAgRTogNjksXG5cbiAgLyoqXG4gICAqIEZcbiAgICovXG4gIEY6IDcwLFxuXG4gIC8qKlxuICAgKiBHXG4gICAqL1xuICBHOiA3MSxcblxuICAvKipcbiAgICogSFxuICAgKi9cbiAgSDogNzIsXG5cbiAgLyoqXG4gICAqIElcbiAgICovXG4gIEk6IDczLFxuXG4gIC8qKlxuICAgKiBKXG4gICAqL1xuICBKOiA3NCxcblxuICAvKipcbiAgICogS1xuICAgKi9cbiAgSzogNzUsXG5cbiAgLyoqXG4gICAqIExcbiAgICovXG4gIEw6IDc2LFxuXG4gIC8qKlxuICAgKiBNXG4gICAqL1xuICBNOiA3NyxcblxuICAvKipcbiAgICogTlxuICAgKi9cbiAgTjogNzgsXG5cbiAgLyoqXG4gICAqIE9cbiAgICovXG4gIE86IDc5LFxuXG4gIC8qKlxuICAgKiBQXG4gICAqL1xuICBQOiA4MCxcblxuICAvKipcbiAgICogUVxuICAgKi9cbiAgUTogODEsXG5cbiAgLyoqXG4gICAqIFJcbiAgICovXG4gIFI6IDgyLFxuXG4gIC8qKlxuICAgKiBTXG4gICAqL1xuICBTOiA4MyxcblxuICAvKipcbiAgICogVFxuICAgKi9cbiAgVDogODQsXG5cbiAgLyoqXG4gICAqIFVcbiAgICovXG4gIFU6IDg1LFxuXG4gIC8qKlxuICAgKiBWXG4gICAqL1xuICBWOiA4NixcblxuICAvKipcbiAgICogV1xuICAgKi9cbiAgVzogODcsXG5cbiAgLyoqXG4gICAqIFhcbiAgICovXG4gIFg6IDg4LFxuXG4gIC8qKlxuICAgKiBZXG4gICAqL1xuICBZOiA4OSxcblxuICAvKipcbiAgICogWlxuICAgKi9cbiAgWjogOTAsXG5cbiAgLyoqXG4gICAqIE1FVEFcbiAgICovXG4gIE1FVEE6IDkxLFxuXG4gIC8qKlxuICAgKiBXSU5fS0VZX1JJR0hUXG4gICAqL1xuICBXSU5fS0VZX1JJR0hUOiA5MixcblxuICAvKipcbiAgICogQ09OVEVYVF9NRU5VXG4gICAqL1xuICBDT05URVhUX01FTlU6IDkzLFxuXG4gIC8qKlxuICAgKiBOVU1fWkVST1xuICAgKi9cbiAgTlVNX1pFUk86IDk2LFxuXG4gIC8qKlxuICAgKiBOVU1fT05FXG4gICAqL1xuICBOVU1fT05FOiA5NyxcblxuICAvKipcbiAgICogTlVNX1RXT1xuICAgKi9cbiAgTlVNX1RXTzogOTgsXG5cbiAgLyoqXG4gICAqIE5VTV9USFJFRVxuICAgKi9cbiAgTlVNX1RIUkVFOiA5OSxcblxuICAvKipcbiAgICogTlVNX0ZPVVJcbiAgICovXG4gIE5VTV9GT1VSOiAxMDAsXG5cbiAgLyoqXG4gICAqIE5VTV9GSVZFXG4gICAqL1xuICBOVU1fRklWRTogMTAxLFxuXG4gIC8qKlxuICAgKiBOVU1fU0lYXG4gICAqL1xuICBOVU1fU0lYOiAxMDIsXG5cbiAgLyoqXG4gICAqIE5VTV9TRVZFTlxuICAgKi9cbiAgTlVNX1NFVkVOOiAxMDMsXG5cbiAgLyoqXG4gICAqIE5VTV9FSUdIVFxuICAgKi9cbiAgTlVNX0VJR0hUOiAxMDQsXG5cbiAgLyoqXG4gICAqIE5VTV9OSU5FXG4gICAqL1xuICBOVU1fTklORTogMTA1LFxuXG4gIC8qKlxuICAgKiBOVU1fTVVMVElQTFlcbiAgICovXG4gIE5VTV9NVUxUSVBMWTogMTA2LFxuXG4gIC8qKlxuICAgKiBOVU1fUExVU1xuICAgKi9cbiAgTlVNX1BMVVM6IDEwNyxcblxuICAvKipcbiAgICogTlVNX01JTlVTXG4gICAqL1xuICBOVU1fTUlOVVM6IDEwOSxcblxuICAvKipcbiAgICogTlVNX1BFUklPRFxuICAgKi9cbiAgTlVNX1BFUklPRDogMTEwLFxuXG4gIC8qKlxuICAgKiBOVU1fRElWSVNJT05cbiAgICovXG4gIE5VTV9ESVZJU0lPTjogMTExLFxuXG4gIC8qKlxuICAgKiBGMVxuICAgKi9cbiAgRjE6IDExMixcblxuICAvKipcbiAgICogRjJcbiAgICovXG4gIEYyOiAxMTMsXG5cbiAgLyoqXG4gICAqIEYzXG4gICAqL1xuICBGMzogMTE0LFxuXG4gIC8qKlxuICAgKiBGNFxuICAgKi9cbiAgRjQ6IDExNSxcblxuICAvKipcbiAgICogRjVcbiAgICovXG4gIEY1OiAxMTYsXG5cbiAgLyoqXG4gICAqIEY2XG4gICAqL1xuICBGNjogMTE3LFxuXG4gIC8qKlxuICAgKiBGN1xuICAgKi9cbiAgRjc6IDExOCxcblxuICAvKipcbiAgICogRjhcbiAgICovXG4gIEY4OiAxMTksXG5cbiAgLyoqXG4gICAqIEY5XG4gICAqL1xuICBGOTogMTIwLFxuXG4gIC8qKlxuICAgKiBGMTBcbiAgICovXG4gIEYxMDogMTIxLFxuXG4gIC8qKlxuICAgKiBGMTFcbiAgICovXG4gIEYxMTogMTIyLFxuXG4gIC8qKlxuICAgKiBGMTJcbiAgICovXG4gIEYxMjogMTIzLFxuXG4gIC8qKlxuICAgKiBOVU1MT0NLXG4gICAqL1xuICBOVU1MT0NLOiAxNDQsXG5cbiAgLyoqXG4gICAqIFNFTUlDT0xPTlxuICAgKi9cbiAgU0VNSUNPTE9OOiAxODYsXG5cbiAgLyoqXG4gICAqIERBU0hcbiAgICovXG4gIERBU0g6IDE4OSxcblxuICAvKipcbiAgICogRVFVQUxTXG4gICAqL1xuICBFUVVBTFM6IDE4NyxcblxuICAvKipcbiAgICogQ09NTUFcbiAgICovXG4gIENPTU1BOiAxODgsXG5cbiAgLyoqXG4gICAqIFBFUklPRFxuICAgKi9cbiAgUEVSSU9EOiAxOTAsXG5cbiAgLyoqXG4gICAqIFNMQVNIXG4gICAqL1xuICBTTEFTSDogMTkxLFxuXG4gIC8qKlxuICAgKiBBUE9TVFJPUEhFXG4gICAqL1xuICBBUE9TVFJPUEhFOiAxOTIsXG5cbiAgLyoqXG4gICAqIFNJTkdMRV9RVU9URVxuICAgKi9cbiAgU0lOR0xFX1FVT1RFOiAyMjIsXG5cbiAgLyoqXG4gICAqIE9QRU5fU1FVQVJFX0JSQUNLRVRcbiAgICovXG4gIE9QRU5fU1FVQVJFX0JSQUNLRVQ6IDIxOSxcblxuICAvKipcbiAgICogQkFDS1NMQVNIXG4gICAqL1xuICBCQUNLU0xBU0g6IDIyMCxcblxuICAvKipcbiAgICogQ0xPU0VfU1FVQVJFX0JSQUNLRVRcbiAgICovXG4gIENMT1NFX1NRVUFSRV9CUkFDS0VUOiAyMjEsXG5cbiAgLyoqXG4gICAqIFdJTl9LRVlcbiAgICovXG4gIFdJTl9LRVk6IDIyNCxcblxuICAvKipcbiAgICogTUFDX0ZGX01FVEFcbiAgICovXG4gIE1BQ19GRl9NRVRBOiAyMjQsXG5cbiAgLyoqXG4gICAqIFdJTl9JTUVcbiAgICovXG4gIFdJTl9JTUU6IDIyOSxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09IEZ1bmN0aW9uID09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiB3aGV0aGVyIHRleHQgYW5kIG1vZGlmaWVkIGtleSBpcyBlbnRlcmVkIGF0IHRoZSBzYW1lIHRpbWUuXG4gICAqL1xuICBpc1RleHRNb2RpZnlpbmdLZXlFdmVudDogZnVuY3Rpb24gaXNUZXh0TW9kaWZ5aW5nS2V5RXZlbnQoZSkge1xuICAgIHZhciBrZXlDb2RlID0gZS5rZXlDb2RlO1xuXG4gICAgaWYgKGUuYWx0S2V5ICYmICFlLmN0cmxLZXkgfHwgZS5tZXRhS2V5IHx8IC8vIEZ1bmN0aW9uIGtleXMgZG9uJ3QgZ2VuZXJhdGUgdGV4dFxuICAgIGtleUNvZGUgPj0gS2V5Q29kZS5GMSAmJiBrZXlDb2RlIDw9IEtleUNvZGUuRjEyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSAvLyBUaGUgZm9sbG93aW5nIGtleXMgYXJlIHF1aXRlIGhhcm1sZXNzLCBldmVuIGluIGNvbWJpbmF0aW9uIHdpdGhcbiAgICAvLyBDVFJMLCBBTFQgb3IgU0hJRlQuXG5cblxuICAgIHN3aXRjaCAoa2V5Q29kZSkge1xuICAgICAgY2FzZSBLZXlDb2RlLkFMVDpcbiAgICAgIGNhc2UgS2V5Q29kZS5DQVBTX0xPQ0s6XG4gICAgICBjYXNlIEtleUNvZGUuQ09OVEVYVF9NRU5VOlxuICAgICAgY2FzZSBLZXlDb2RlLkNUUkw6XG4gICAgICBjYXNlIEtleUNvZGUuRE9XTjpcbiAgICAgIGNhc2UgS2V5Q29kZS5FTkQ6XG4gICAgICBjYXNlIEtleUNvZGUuRVNDOlxuICAgICAgY2FzZSBLZXlDb2RlLkhPTUU6XG4gICAgICBjYXNlIEtleUNvZGUuSU5TRVJUOlxuICAgICAgY2FzZSBLZXlDb2RlLkxFRlQ6XG4gICAgICBjYXNlIEtleUNvZGUuTUFDX0ZGX01FVEE6XG4gICAgICBjYXNlIEtleUNvZGUuTUVUQTpcbiAgICAgIGNhc2UgS2V5Q29kZS5OVU1MT0NLOlxuICAgICAgY2FzZSBLZXlDb2RlLk5VTV9DRU5URVI6XG4gICAgICBjYXNlIEtleUNvZGUuUEFHRV9ET1dOOlxuICAgICAgY2FzZSBLZXlDb2RlLlBBR0VfVVA6XG4gICAgICBjYXNlIEtleUNvZGUuUEFVU0U6XG4gICAgICBjYXNlIEtleUNvZGUuUFJJTlRfU0NSRUVOOlxuICAgICAgY2FzZSBLZXlDb2RlLlJJR0hUOlxuICAgICAgY2FzZSBLZXlDb2RlLlNISUZUOlxuICAgICAgY2FzZSBLZXlDb2RlLlVQOlxuICAgICAgY2FzZSBLZXlDb2RlLldJTl9LRVk6XG4gICAgICBjYXNlIEtleUNvZGUuV0lOX0tFWV9SSUdIVDpcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIHdoZXRoZXIgY2hhcmFjdGVyIGlzIGVudGVyZWQuXG4gICAqL1xuICBpc0NoYXJhY3RlcktleTogZnVuY3Rpb24gaXNDaGFyYWN0ZXJLZXkoa2V5Q29kZSkge1xuICAgIGlmIChrZXlDb2RlID49IEtleUNvZGUuWkVSTyAmJiBrZXlDb2RlIDw9IEtleUNvZGUuTklORSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGtleUNvZGUgPj0gS2V5Q29kZS5OVU1fWkVSTyAmJiBrZXlDb2RlIDw9IEtleUNvZGUuTlVNX01VTFRJUExZKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoa2V5Q29kZSA+PSBLZXlDb2RlLkEgJiYga2V5Q29kZSA8PSBLZXlDb2RlLlopIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gLy8gU2FmYXJpIHNlbmRzIHplcm8ga2V5IGNvZGUgZm9yIG5vbi1sYXRpbiBjaGFyYWN0ZXJzLlxuXG5cbiAgICBpZiAod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignV2ViS2l0JykgIT09IC0xICYmIGtleUNvZGUgPT09IDApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHN3aXRjaCAoa2V5Q29kZSkge1xuICAgICAgY2FzZSBLZXlDb2RlLlNQQUNFOlxuICAgICAgY2FzZSBLZXlDb2RlLlFVRVNUSU9OX01BUks6XG4gICAgICBjYXNlIEtleUNvZGUuTlVNX1BMVVM6XG4gICAgICBjYXNlIEtleUNvZGUuTlVNX01JTlVTOlxuICAgICAgY2FzZSBLZXlDb2RlLk5VTV9QRVJJT0Q6XG4gICAgICBjYXNlIEtleUNvZGUuTlVNX0RJVklTSU9OOlxuICAgICAgY2FzZSBLZXlDb2RlLlNFTUlDT0xPTjpcbiAgICAgIGNhc2UgS2V5Q29kZS5EQVNIOlxuICAgICAgY2FzZSBLZXlDb2RlLkVRVUFMUzpcbiAgICAgIGNhc2UgS2V5Q29kZS5DT01NQTpcbiAgICAgIGNhc2UgS2V5Q29kZS5QRVJJT0Q6XG4gICAgICBjYXNlIEtleUNvZGUuU0xBU0g6XG4gICAgICBjYXNlIEtleUNvZGUuQVBPU1RST1BIRTpcbiAgICAgIGNhc2UgS2V5Q29kZS5TSU5HTEVfUVVPVEU6XG4gICAgICBjYXNlIEtleUNvZGUuT1BFTl9TUVVBUkVfQlJBQ0tFVDpcbiAgICAgIGNhc2UgS2V5Q29kZS5CQUNLU0xBU0g6XG4gICAgICBjYXNlIEtleUNvZGUuQ0xPU0VfU1FVQVJFX0JSQUNLRVQ6XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG59O1xuZXhwb3J0IGRlZmF1bHQgS2V5Q29kZTsiLCJpbXBvcnQgeyB1c2VSZWYsIHVzZUVmZmVjdCwgZm9yd2FyZFJlZiwgdXNlSW1wZXJhdGl2ZUhhbmRsZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IGNhblVzZURvbSBmcm9tICcuL0RvbS9jYW5Vc2VEb20nO1xudmFyIFBvcnRhbCA9IGZvcndhcmRSZWYoZnVuY3Rpb24gKHByb3BzLCByZWYpIHtcbiAgdmFyIGRpZFVwZGF0ZSA9IHByb3BzLmRpZFVwZGF0ZSxcbiAgICAgIGdldENvbnRhaW5lciA9IHByb3BzLmdldENvbnRhaW5lcixcbiAgICAgIGNoaWxkcmVuID0gcHJvcHMuY2hpbGRyZW47XG4gIHZhciBjb250YWluZXJSZWYgPSB1c2VSZWYoKTsgLy8gUmVmIHJldHVybiBub3RoaW5nLCBvbmx5IGZvciB3cmFwcGVyIGNoZWNrIGV4aXN0XG5cbiAgdXNlSW1wZXJhdGl2ZUhhbmRsZShyZWYsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge307XG4gIH0pOyAvLyBDcmVhdGUgY29udGFpbmVyIGluIGNsaWVudCBzaWRlIHdpdGggc3luYyB0byBhdm9pZCB1c2VFZmZlY3Qgbm90IGdldCByZWZcblxuICB2YXIgaW5pdFJlZiA9IHVzZVJlZihmYWxzZSk7XG5cbiAgaWYgKCFpbml0UmVmLmN1cnJlbnQgJiYgY2FuVXNlRG9tKCkpIHtcbiAgICBjb250YWluZXJSZWYuY3VycmVudCA9IGdldENvbnRhaW5lcigpO1xuICAgIGluaXRSZWYuY3VycmVudCA9IHRydWU7XG4gIH0gLy8gW0xlZ2FjeV0gVXNlZCBieSBgcmMtdHJpZ2dlcmBcblxuXG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgZGlkVXBkYXRlID09PSBudWxsIHx8IGRpZFVwZGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGlkVXBkYXRlKHByb3BzKTtcbiAgfSk7XG4gIHVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfY29udGFpbmVyUmVmJGN1cnJlbnQsIF9jb250YWluZXJSZWYkY3VycmVudDI7XG5cbiAgICAgIC8vIFtMZWdhY3ldIFRoaXMgc2hvdWxkIG5vdCBiZSBoYW5kbGUgYnkgUG9ydGFsIGJ1dCBwYXJlbnQgUG9ydGFsV3JhcHBlciBpbnN0ZWFkLlxuICAgICAgLy8gU2luY2Ugc29tZSBjb21wb25lbnQgdXNlIGBQb3J0YWxgIGRpcmVjdGx5LCB3ZSBoYXZlIHRvIGtlZXAgdGhlIGxvZ2ljIGhlcmUuXG4gICAgICAoX2NvbnRhaW5lclJlZiRjdXJyZW50ID0gY29udGFpbmVyUmVmLmN1cnJlbnQpID09PSBudWxsIHx8IF9jb250YWluZXJSZWYkY3VycmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9jb250YWluZXJSZWYkY3VycmVudDIgPSBfY29udGFpbmVyUmVmJGN1cnJlbnQucGFyZW50Tm9kZSkgPT09IG51bGwgfHwgX2NvbnRhaW5lclJlZiRjdXJyZW50MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NvbnRhaW5lclJlZiRjdXJyZW50Mi5yZW1vdmVDaGlsZChjb250YWluZXJSZWYuY3VycmVudCk7XG4gICAgfTtcbiAgfSwgW10pO1xuICByZXR1cm4gY29udGFpbmVyUmVmLmN1cnJlbnQgPyBSZWFjdERPTS5jcmVhdGVQb3J0YWwoY2hpbGRyZW4sIGNvbnRhaW5lclJlZi5jdXJyZW50KSA6IG51bGw7XG59KTtcbmV4cG9ydCBkZWZhdWx0IFBvcnRhbDsiLCJpbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVja1wiO1xuaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3NcIjtcbmltcG9ydCBfaW5oZXJpdHMgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzXCI7XG5pbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIjtcbmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mXCI7XG5pbXBvcnQgX3R5cGVvZiBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mXCI7XG5cbmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH1cblxuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZXJzY29yZS1kYW5nbGUscmVhY3QvcmVxdWlyZS1kZWZhdWx0LXByb3BzICovXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgcmFmIGZyb20gJy4vcmFmJztcbmltcG9ydCBQb3J0YWwgZnJvbSAnLi9Qb3J0YWwnO1xuaW1wb3J0IGNhblVzZURvbSBmcm9tICcuL0RvbS9jYW5Vc2VEb20nO1xuaW1wb3J0IHN3aXRjaFNjcm9sbGluZ0VmZmVjdCBmcm9tICcuL3N3aXRjaFNjcm9sbGluZ0VmZmVjdCc7XG5pbXBvcnQgc2V0U3R5bGUgZnJvbSAnLi9zZXRTdHlsZSc7XG5pbXBvcnQgU2Nyb2xsTG9ja2VyIGZyb20gJy4vRG9tL3Njcm9sbExvY2tlcic7XG52YXIgb3BlbkNvdW50ID0gMDtcbnZhciBzdXBwb3J0RG9tID0gY2FuVXNlRG9tKCk7XG4vKiogQHByaXZhdGUgVGVzdCB1c2FnZSBvbmx5ICovXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcGVuQ291bnQoKSB7XG4gIHJldHVybiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnID8gb3BlbkNvdW50IDogMDtcbn0gLy8gaHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9pc3N1ZXMvMTkzNDBcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbnQtZGVzaWduL2FudC1kZXNpZ24vaXNzdWVzLzE5MzMyXG5cbnZhciBjYWNoZU92ZXJmbG93ID0ge307XG5cbnZhciBnZXRQYXJlbnQgPSBmdW5jdGlvbiBnZXRQYXJlbnQoZ2V0Q29udGFpbmVyKSB7XG4gIGlmICghc3VwcG9ydERvbSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgaWYgKGdldENvbnRhaW5lcikge1xuICAgIGlmICh0eXBlb2YgZ2V0Q29udGFpbmVyID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZ2V0Q29udGFpbmVyKVswXTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGdldENvbnRhaW5lciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGdldENvbnRhaW5lcigpO1xuICAgIH1cblxuICAgIGlmIChfdHlwZW9mKGdldENvbnRhaW5lcikgPT09ICdvYmplY3QnICYmIGdldENvbnRhaW5lciBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MRWxlbWVudCkge1xuICAgICAgcmV0dXJuIGdldENvbnRhaW5lcjtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZG9jdW1lbnQuYm9keTtcbn07XG5cbnZhciBQb3J0YWxXcmFwcGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhQb3J0YWxXcmFwcGVyLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFBvcnRhbFdyYXBwZXIpO1xuXG4gIGZ1bmN0aW9uIFBvcnRhbFdyYXBwZXIocHJvcHMpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9ydGFsV3JhcHBlcik7XG5cbiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTtcbiAgICBfdGhpcy5jb21wb25lbnRSZWYgPSBSZWFjdC5jcmVhdGVSZWYoKTtcblxuICAgIF90aGlzLnVwZGF0ZVNjcm9sbExvY2tlciA9IGZ1bmN0aW9uIChwcmV2UHJvcHMpIHtcbiAgICAgIHZhciBfcmVmID0gcHJldlByb3BzIHx8IHt9LFxuICAgICAgICAgIHByZXZWaXNpYmxlID0gX3JlZi52aXNpYmxlO1xuXG4gICAgICB2YXIgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICBnZXRDb250YWluZXIgPSBfdGhpcyRwcm9wcy5nZXRDb250YWluZXIsXG4gICAgICAgICAgdmlzaWJsZSA9IF90aGlzJHByb3BzLnZpc2libGU7XG5cbiAgICAgIGlmICh2aXNpYmxlICYmIHZpc2libGUgIT09IHByZXZWaXNpYmxlICYmIHN1cHBvcnREb20gJiYgZ2V0UGFyZW50KGdldENvbnRhaW5lcikgIT09IF90aGlzLnNjcm9sbExvY2tlci5nZXRDb250YWluZXIoKSkge1xuICAgICAgICBfdGhpcy5zY3JvbGxMb2NrZXIucmVMb2NrKHtcbiAgICAgICAgICBjb250YWluZXI6IGdldFBhcmVudChnZXRDb250YWluZXIpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy51cGRhdGVPcGVuQ291bnQgPSBmdW5jdGlvbiAocHJldlByb3BzKSB7XG4gICAgICB2YXIgX3JlZjIgPSBwcmV2UHJvcHMgfHwge30sXG4gICAgICAgICAgcHJldlZpc2libGUgPSBfcmVmMi52aXNpYmxlLFxuICAgICAgICAgIHByZXZHZXRDb250YWluZXIgPSBfcmVmMi5nZXRDb250YWluZXI7XG5cbiAgICAgIHZhciBfdGhpcyRwcm9wczIgPSBfdGhpcy5wcm9wcyxcbiAgICAgICAgICB2aXNpYmxlID0gX3RoaXMkcHJvcHMyLnZpc2libGUsXG4gICAgICAgICAgZ2V0Q29udGFpbmVyID0gX3RoaXMkcHJvcHMyLmdldENvbnRhaW5lcjsgLy8gVXBkYXRlIGNvdW50XG5cbiAgICAgIGlmICh2aXNpYmxlICE9PSBwcmV2VmlzaWJsZSAmJiBzdXBwb3J0RG9tICYmIGdldFBhcmVudChnZXRDb250YWluZXIpID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgIGlmICh2aXNpYmxlICYmICFwcmV2VmlzaWJsZSkge1xuICAgICAgICAgIG9wZW5Db3VudCArPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKHByZXZQcm9wcykge1xuICAgICAgICAgIG9wZW5Db3VudCAtPSAxO1xuICAgICAgICB9XG4gICAgICB9IC8vIENsZWFuIHVwIGNvbnRhaW5lciBpZiBuZWVkZWRcblxuXG4gICAgICB2YXIgZ2V0Q29udGFpbmVySXNGdW5jID0gdHlwZW9mIGdldENvbnRhaW5lciA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgcHJldkdldENvbnRhaW5lciA9PT0gJ2Z1bmN0aW9uJztcblxuICAgICAgaWYgKGdldENvbnRhaW5lcklzRnVuYyA/IGdldENvbnRhaW5lci50b1N0cmluZygpICE9PSBwcmV2R2V0Q29udGFpbmVyLnRvU3RyaW5nKCkgOiBnZXRDb250YWluZXIgIT09IHByZXZHZXRDb250YWluZXIpIHtcbiAgICAgICAgX3RoaXMucmVtb3ZlQ3VycmVudENvbnRhaW5lcigpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5hdHRhY2hUb1BhcmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG5cbiAgICAgIGlmIChmb3JjZSB8fCBfdGhpcy5jb250YWluZXIgJiYgIV90aGlzLmNvbnRhaW5lci5wYXJlbnROb2RlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSBnZXRQYXJlbnQoX3RoaXMucHJvcHMuZ2V0Q29udGFpbmVyKTtcblxuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKF90aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICBfdGhpcy5nZXRDb250YWluZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXN1cHBvcnREb20pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGlmICghX3RoaXMuY29udGFpbmVyKSB7XG4gICAgICAgIF90aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIF90aGlzLmF0dGFjaFRvUGFyZW50KHRydWUpO1xuICAgICAgfVxuXG4gICAgICBfdGhpcy5zZXRXcmFwcGVyQ2xhc3NOYW1lKCk7XG5cbiAgICAgIHJldHVybiBfdGhpcy5jb250YWluZXI7XG4gICAgfTtcblxuICAgIF90aGlzLnNldFdyYXBwZXJDbGFzc05hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgd3JhcHBlckNsYXNzTmFtZSA9IF90aGlzLnByb3BzLndyYXBwZXJDbGFzc05hbWU7XG5cbiAgICAgIGlmIChfdGhpcy5jb250YWluZXIgJiYgd3JhcHBlckNsYXNzTmFtZSAmJiB3cmFwcGVyQ2xhc3NOYW1lICE9PSBfdGhpcy5jb250YWluZXIuY2xhc3NOYW1lKSB7XG4gICAgICAgIF90aGlzLmNvbnRhaW5lci5jbGFzc05hbWUgPSB3cmFwcGVyQ2xhc3NOYW1lO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5yZW1vdmVDdXJyZW50Q29udGFpbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF90aGlzJGNvbnRhaW5lciwgX3RoaXMkY29udGFpbmVyJHBhcmVuO1xuXG4gICAgICAvLyBQb3J0YWwgd2lsbCByZW1vdmUgZnJvbSBgcGFyZW50Tm9kZWAuXG4gICAgICAvLyBMZXQncyBoYW5kbGUgdGhpcyBhZ2FpbiB0byBhdm9pZCByZWZhY3RvciBpc3N1ZS5cbiAgICAgIChfdGhpcyRjb250YWluZXIgPSBfdGhpcy5jb250YWluZXIpID09PSBudWxsIHx8IF90aGlzJGNvbnRhaW5lciA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aGlzJGNvbnRhaW5lciRwYXJlbiA9IF90aGlzJGNvbnRhaW5lci5wYXJlbnROb2RlKSA9PT0gbnVsbCB8fCBfdGhpcyRjb250YWluZXIkcGFyZW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNvbnRhaW5lciRwYXJlbi5yZW1vdmVDaGlsZChfdGhpcy5jb250YWluZXIpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRW5oYW5jZSAuL3N3aXRjaFNjcm9sbGluZ0VmZmVjdFxuICAgICAqIDEuIFNpbXVsYXRlIGRvY3VtZW50IGJvZHkgc2Nyb2xsIGJhciB3aXRoXG4gICAgICogMi4gUmVjb3JkIGJvZHkgaGFzIG92ZXJmbG93IHN0eWxlIGFuZCByZWNvdmVyIHdoZW4gYWxsIG9mIFBvcnRhbFdyYXBwZXIgaW52aXNpYmxlXG4gICAgICogMy4gRGlzYWJsZSBib2R5IHNjcm9sbCB3aGVuIFBvcnRhbFdyYXBwZXIgaGFzIG9wZW5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJvZiBQb3J0YWxXcmFwcGVyXG4gICAgICovXG5cblxuICAgIF90aGlzLnN3aXRjaFNjcm9sbGluZ0VmZmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChvcGVuQ291bnQgPT09IDEgJiYgIU9iamVjdC5rZXlzKGNhY2hlT3ZlcmZsb3cpLmxlbmd0aCkge1xuICAgICAgICBzd2l0Y2hTY3JvbGxpbmdFZmZlY3QoKTsgLy8gTXVzdCBiZSBzZXQgYWZ0ZXIgc3dpdGNoU2Nyb2xsaW5nRWZmZWN0XG5cbiAgICAgICAgY2FjaGVPdmVyZmxvdyA9IHNldFN0eWxlKHtcbiAgICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICAgICAgb3ZlcmZsb3dYOiAnaGlkZGVuJyxcbiAgICAgICAgICBvdmVyZmxvd1k6ICdoaWRkZW4nXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICghb3BlbkNvdW50KSB7XG4gICAgICAgIHNldFN0eWxlKGNhY2hlT3ZlcmZsb3cpO1xuICAgICAgICBjYWNoZU92ZXJmbG93ID0ge307XG4gICAgICAgIHN3aXRjaFNjcm9sbGluZ0VmZmVjdCh0cnVlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgX3RoaXMuc2Nyb2xsTG9ja2VyID0gbmV3IFNjcm9sbExvY2tlcih7XG4gICAgICBjb250YWluZXI6IGdldFBhcmVudChwcm9wcy5nZXRDb250YWluZXIpXG4gICAgfSk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFBvcnRhbFdyYXBwZXIsIFt7XG4gICAga2V5OiBcImNvbXBvbmVudERpZE1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIHRoaXMudXBkYXRlT3BlbkNvdW50KCk7XG5cbiAgICAgIGlmICghdGhpcy5hdHRhY2hUb1BhcmVudCgpKSB7XG4gICAgICAgIHRoaXMucmFmSWQgPSByYWYoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzMi5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY29tcG9uZW50RGlkVXBkYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMpIHtcbiAgICAgIHRoaXMudXBkYXRlT3BlbkNvdW50KHByZXZQcm9wcyk7XG4gICAgICB0aGlzLnVwZGF0ZVNjcm9sbExvY2tlcihwcmV2UHJvcHMpO1xuICAgICAgdGhpcy5zZXRXcmFwcGVyQ2xhc3NOYW1lKCk7XG4gICAgICB0aGlzLmF0dGFjaFRvUGFyZW50KCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbXBvbmVudFdpbGxVbm1vdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzMyA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgdmlzaWJsZSA9IF90aGlzJHByb3BzMy52aXNpYmxlLFxuICAgICAgICAgIGdldENvbnRhaW5lciA9IF90aGlzJHByb3BzMy5nZXRDb250YWluZXI7XG5cbiAgICAgIGlmIChzdXBwb3J0RG9tICYmIGdldFBhcmVudChnZXRDb250YWluZXIpID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgIC8vIOemu+W8gOaXtuS4jeS8miByZW5kZXLvvIwg5a+85Yiw56a75byA5pe25pWw5YC85LiN5Y+Y77yM5pS555SoIGZ1bmMg44CC44CCXG4gICAgICAgIG9wZW5Db3VudCA9IHZpc2libGUgJiYgb3BlbkNvdW50ID8gb3BlbkNvdW50IC0gMSA6IG9wZW5Db3VudDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZW1vdmVDdXJyZW50Q29udGFpbmVyKCk7XG4gICAgICByYWYuY2FuY2VsKHRoaXMucmFmSWQpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJyZW5kZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgY2hpbGRyZW4gPSBfdGhpcyRwcm9wczQuY2hpbGRyZW4sXG4gICAgICAgICAgZm9yY2VSZW5kZXIgPSBfdGhpcyRwcm9wczQuZm9yY2VSZW5kZXIsXG4gICAgICAgICAgdmlzaWJsZSA9IF90aGlzJHByb3BzNC52aXNpYmxlO1xuICAgICAgdmFyIHBvcnRhbCA9IG51bGw7XG4gICAgICB2YXIgY2hpbGRQcm9wcyA9IHtcbiAgICAgICAgZ2V0T3BlbkNvdW50OiBmdW5jdGlvbiBnZXRPcGVuQ291bnQoKSB7XG4gICAgICAgICAgcmV0dXJuIG9wZW5Db3VudDtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0Q29udGFpbmVyOiB0aGlzLmdldENvbnRhaW5lcixcbiAgICAgICAgc3dpdGNoU2Nyb2xsaW5nRWZmZWN0OiB0aGlzLnN3aXRjaFNjcm9sbGluZ0VmZmVjdCxcbiAgICAgICAgc2Nyb2xsTG9ja2VyOiB0aGlzLnNjcm9sbExvY2tlclxuICAgICAgfTtcblxuICAgICAgaWYgKGZvcmNlUmVuZGVyIHx8IHZpc2libGUgfHwgdGhpcy5jb21wb25lbnRSZWYuY3VycmVudCkge1xuICAgICAgICBwb3J0YWwgPSAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChQb3J0YWwsIHtcbiAgICAgICAgICBnZXRDb250YWluZXI6IHRoaXMuZ2V0Q29udGFpbmVyLFxuICAgICAgICAgIHJlZjogdGhpcy5jb21wb25lbnRSZWZcbiAgICAgICAgfSwgY2hpbGRyZW4oY2hpbGRQcm9wcykpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcG9ydGFsO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBQb3J0YWxXcmFwcGVyO1xufShSZWFjdC5Db21wb25lbnQpO1xuXG5leHBvcnQgZGVmYXVsdCBQb3J0YWxXcmFwcGVyOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG52YXIgY2FjaGVkO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0U2Nyb2xsQmFyU2l6ZShmcmVzaCkge1xuICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgaWYgKGZyZXNoIHx8IGNhY2hlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIGlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgaW5uZXIuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgaW5uZXIuc3R5bGUuaGVpZ2h0ID0gJzIwMHB4JztcbiAgICB2YXIgb3V0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgb3V0ZXJTdHlsZSA9IG91dGVyLnN0eWxlO1xuICAgIG91dGVyU3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIG91dGVyU3R5bGUudG9wID0gJzAnO1xuICAgIG91dGVyU3R5bGUubGVmdCA9ICcwJztcbiAgICBvdXRlclN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgb3V0ZXJTdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgb3V0ZXJTdHlsZS53aWR0aCA9ICcyMDBweCc7XG4gICAgb3V0ZXJTdHlsZS5oZWlnaHQgPSAnMTUwcHgnO1xuICAgIG91dGVyU3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICBvdXRlci5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdXRlcik7XG4gICAgdmFyIHdpZHRoQ29udGFpbmVkID0gaW5uZXIub2Zmc2V0V2lkdGg7XG4gICAgb3V0ZXIuc3R5bGUub3ZlcmZsb3cgPSAnc2Nyb2xsJztcbiAgICB2YXIgd2lkdGhTY3JvbGwgPSBpbm5lci5vZmZzZXRXaWR0aDtcblxuICAgIGlmICh3aWR0aENvbnRhaW5lZCA9PT0gd2lkdGhTY3JvbGwpIHtcbiAgICAgIHdpZHRoU2Nyb2xsID0gb3V0ZXIuY2xpZW50V2lkdGg7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdXRlcik7XG4gICAgY2FjaGVkID0gd2lkdGhDb250YWluZWQgLSB3aWR0aFNjcm9sbDtcbiAgfVxuXG4gIHJldHVybiBjYWNoZWQ7XG59XG5cbmZ1bmN0aW9uIGVuc3VyZVNpemUoc3RyKSB7XG4gIHZhciBtYXRjaCA9IHN0ci5tYXRjaCgvXiguKilweCQvKTtcbiAgdmFyIHZhbHVlID0gTnVtYmVyKG1hdGNoID09PSBudWxsIHx8IG1hdGNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXRjaFsxXSk7XG4gIHJldHVybiBOdW1iZXIuaXNOYU4odmFsdWUpID8gZ2V0U2Nyb2xsQmFyU2l6ZSgpIDogdmFsdWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXJnZXRTY3JvbGxCYXJTaXplKHRhcmdldCkge1xuICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJyB8fCAhdGFyZ2V0IHx8ICEodGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICB9XG5cbiAgdmFyIF9nZXRDb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YXJnZXQsICc6Oi13ZWJraXQtc2Nyb2xsYmFyJyksXG4gICAgICB3aWR0aCA9IF9nZXRDb21wdXRlZFN0eWxlLndpZHRoLFxuICAgICAgaGVpZ2h0ID0gX2dldENvbXB1dGVkU3R5bGUuaGVpZ2h0O1xuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IGVuc3VyZVNpemUod2lkdGgpLFxuICAgIGhlaWdodDogZW5zdXJlU2l6ZShoZWlnaHQpXG4gIH07XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlTWVtbyhnZXRWYWx1ZSwgY29uZGl0aW9uLCBzaG91bGRVcGRhdGUpIHtcbiAgdmFyIGNhY2hlUmVmID0gUmVhY3QudXNlUmVmKHt9KTtcblxuICBpZiAoISgndmFsdWUnIGluIGNhY2hlUmVmLmN1cnJlbnQpIHx8IHNob3VsZFVwZGF0ZShjYWNoZVJlZi5jdXJyZW50LmNvbmRpdGlvbiwgY29uZGl0aW9uKSkge1xuICAgIGNhY2hlUmVmLmN1cnJlbnQudmFsdWUgPSBnZXRWYWx1ZSgpO1xuICAgIGNhY2hlUmVmLmN1cnJlbnQuY29uZGl0aW9uID0gY29uZGl0aW9uO1xuICB9XG5cbiAgcmV0dXJuIGNhY2hlUmVmLmN1cnJlbnQudmFsdWU7XG59IiwiaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5XCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VDb250cm9sbGVkU3RhdGUoZGVmYXVsdFN0YXRlVmFsdWUsIG9wdGlvbikge1xuICB2YXIgX3JlZiA9IG9wdGlvbiB8fCB7fSxcbiAgICAgIGRlZmF1bHRWYWx1ZSA9IF9yZWYuZGVmYXVsdFZhbHVlLFxuICAgICAgdmFsdWUgPSBfcmVmLnZhbHVlLFxuICAgICAgb25DaGFuZ2UgPSBfcmVmLm9uQ2hhbmdlLFxuICAgICAgcG9zdFN0YXRlID0gX3JlZi5wb3N0U3RhdGU7XG5cbiAgdmFyIF9SZWFjdCR1c2VTdGF0ZSA9IFJlYWN0LnVzZVN0YXRlKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIGlmIChkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHR5cGVvZiBkZWZhdWx0VmFsdWUgPT09ICdmdW5jdGlvbicgPyBkZWZhdWx0VmFsdWUoKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHlwZW9mIGRlZmF1bHRTdGF0ZVZhbHVlID09PSAnZnVuY3Rpb24nID8gZGVmYXVsdFN0YXRlVmFsdWUoKSA6IGRlZmF1bHRTdGF0ZVZhbHVlO1xuICB9KSxcbiAgICAgIF9SZWFjdCR1c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGUsIDIpLFxuICAgICAgaW5uZXJWYWx1ZSA9IF9SZWFjdCR1c2VTdGF0ZTJbMF0sXG4gICAgICBzZXRJbm5lclZhbHVlID0gX1JlYWN0JHVzZVN0YXRlMlsxXTtcblxuICB2YXIgbWVyZ2VkVmFsdWUgPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBpbm5lclZhbHVlO1xuXG4gIGlmIChwb3N0U3RhdGUpIHtcbiAgICBtZXJnZWRWYWx1ZSA9IHBvc3RTdGF0ZShtZXJnZWRWYWx1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiB0cmlnZ2VyQ2hhbmdlKG5ld1ZhbHVlKSB7XG4gICAgc2V0SW5uZXJWYWx1ZShuZXdWYWx1ZSk7XG5cbiAgICBpZiAobWVyZ2VkVmFsdWUgIT09IG5ld1ZhbHVlICYmIG9uQ2hhbmdlKSB7XG4gICAgICBvbkNoYW5nZShuZXdWYWx1ZSwgbWVyZ2VkVmFsdWUpO1xuICAgIH1cbiAgfSAvLyBFZmZlY3Qgb2YgcmVzZXQgdmFsdWUgdG8gYHVuZGVmaW5lZGBcblxuXG4gIHZhciBmaXJzdFJlbmRlclJlZiA9IFJlYWN0LnVzZVJlZih0cnVlKTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZmlyc3RSZW5kZXJSZWYuY3VycmVudCkge1xuICAgICAgZmlyc3RSZW5kZXJSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBzZXRJbm5lclZhbHVlKHZhbHVlKTtcbiAgICB9XG4gIH0sIFt2YWx1ZV0pO1xuICByZXR1cm4gW21lcmdlZFZhbHVlLCB0cmlnZ2VyQ2hhbmdlXTtcbn0iLCJleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgYWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IgfHwgd2luZG93Lm9wZXJhO1xuXG4gIGlmICgvKGFuZHJvaWR8YmJcXGQrfG1lZWdvKS4rbW9iaWxlfGF2YW50Z298YmFkYVxcL3xibGFja2JlcnJ5fGJsYXplcnxjb21wYWx8ZWxhaW5lfGZlbm5lY3xoaXB0b3B8aWVtb2JpbGV8aXAoaG9uZXxvZCl8aXJpc3xraW5kbGV8bGdlIHxtYWVtb3xtaWRwfG1tcHxtb2JpbGUuK2ZpcmVmb3h8bmV0ZnJvbnR8b3BlcmEgbShvYnxpbilpfHBhbG0oIG9zKT98cGhvbmV8cChpeGl8cmUpXFwvfHBsdWNrZXJ8cG9ja2V0fHBzcHxzZXJpZXMoNHw2KTB8c3ltYmlhbnx0cmVvfHVwXFwuKGJyb3dzZXJ8bGluayl8dm9kYWZvbmV8d2FwfHdpbmRvd3MgY2V8eGRhfHhpaW5vfGFuZHJvaWR8aXBhZHxwbGF5Ym9va3xzaWxrL2kudGVzdChhZ2VudCkgfHwgLzEyMDd8NjMxMHw2NTkwfDNnc298NHRocHw1MFsxLTZdaXw3NzBzfDgwMnN8YSB3YXxhYmFjfGFjKGVyfG9vfHMtKXxhaShrb3xybil8YWwoYXZ8Y2F8Y28pfGFtb2l8YW4oZXh8bnl8eXcpfGFwdHV8YXIoY2h8Z28pfGFzKHRlfHVzKXxhdHR3fGF1KGRpfC1tfHIgfHMgKXxhdmFufGJlKGNrfGxsfG5xKXxiaShsYnxyZCl8YmwoYWN8YXopfGJyKGV8dil3fGJ1bWJ8YnctKG58dSl8YzU1XFwvfGNhcGl8Y2N3YXxjZG0tfGNlbGx8Y2h0bXxjbGRjfGNtZC18Y28obXB8bmQpfGNyYXd8ZGEoaXR8bGx8bmcpfGRidGV8ZGMtc3xkZXZpfGRpY2F8ZG1vYnxkbyhjfHApb3xkcygxMnwtZCl8ZWwoNDl8YWkpfGVtKGwyfHVsKXxlcihpY3xrMCl8ZXNsOHxleihbNC03XTB8b3N8d2F8emUpfGZldGN8Zmx5KC18Xyl8ZzEgdXxnNTYwfGdlbmV8Z2YtNXxnLW1vfGdvKFxcLnd8b2QpfGdyKGFkfHVuKXxoYWllfGhjaXR8aGQtKG18cHx0KXxoZWktfGhpKHB0fHRhKXxocCggaXxpcCl8aHMtY3xodChjKC18IHxffGF8Z3xwfHN8dCl8dHApfGh1KGF3fHRjKXxpLSgyMHxnb3xtYSl8aTIzMHxpYWMoIHwtfFxcLyl8aWJyb3xpZGVhfGlnMDF8aWtvbXxpbTFrfGlubm98aXBhcXxpcmlzfGphKHR8dilhfGpicm98amVtdXxqaWdzfGtkZGl8a2VqaXxrZ3QoIHxcXC8pfGtsb258a3B0IHxrd2MtfGt5byhjfGspfGxlKG5vfHhpKXxsZyggZ3xcXC8oa3xsfHUpfDUwfDU0fC1bYS13XSl8bGlid3xseW54fG0xLXd8bTNnYXxtNTBcXC98bWEodGV8dWl8eG8pfG1jKDAxfDIxfGNhKXxtLWNyfG1lKHJjfHJpKXxtaShvOHxvYXx0cyl8bW1lZnxtbygwMXwwMnxiaXxkZXxkb3x0KC18IHxvfHYpfHp6KXxtdCg1MHxwMXx2ICl8bXdicHxteXdhfG4xMFswLTJdfG4yMFsyLTNdfG4zMCgwfDIpfG41MCgwfDJ8NSl8bjcoMCgwfDEpfDEwKXxuZSgoY3xtKS18b258dGZ8d2Z8d2d8d3QpfG5vayg2fGkpfG56cGh8bzJpbXxvcCh0aXx3dil8b3Jhbnxvd2cxfHA4MDB8cGFuKGF8ZHx0KXxwZHhnfHBnKDEzfC0oWzEtOF18YykpfHBoaWx8cGlyZXxwbChheXx1Yyl8cG4tMnxwbyhja3xydHxzZSl8cHJveHxwc2lvfHB0LWd8cWEtYXxxYygwN3wxMnwyMXwzMnw2MHwtWzItN118aS0pfHF0ZWt8cjM4MHxyNjAwfHJha3N8cmltOXxybyh2ZXx6byl8czU1XFwvfHNhKGdlfG1hfG1tfG1zfG55fHZhKXxzYygwMXxoLXxvb3xwLSl8c2RrXFwvfHNlKGMoLXwwfDEpfDQ3fG1jfG5kfHJpKXxzZ2gtfHNoYXJ8c2llKC18bSl8c2stMHxzbCg0NXxpZCl8c20oYWx8YXJ8YjN8aXR8dDUpfHNvKGZ0fG55KXxzcCgwMXxoLXx2LXx2ICl8c3koMDF8bWIpfHQyKDE4fDUwKXx0NigwMHwxMHwxOCl8dGEoZ3R8bGspfHRjbC18dGRnLXx0ZWwoaXxtKXx0aW0tfHQtbW98dG8ocGx8c2gpfHRzKDcwfG0tfG0zfG01KXx0eC05fHVwKFxcLmJ8ZzF8c2kpfHV0c3R8djQwMHx2NzUwfHZlcml8dmkocmd8dGUpfHZrKDQwfDVbMC0zXXwtdil8dm00MHx2b2RhfHZ1bGN8dngoNTJ8NTN8NjB8NjF8NzB8ODB8ODF8ODN8ODV8OTgpfHczYygtfCApfHdlYmN8d2hpdHx3aShnIHxuY3xudyl8d21sYnx3b251fHg3MDB8eWFzLXx5b3VyfHpldG98enRlLS9pLnRlc3QoYWdlbnQgPT09IG51bGwgfHwgYWdlbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFnZW50LnN1YnN0cigwLCA0KSkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn0pOyIsImltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5XCI7XG5cbmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9XG5cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvbWl0KG9iaiwgZmllbGRzKSB7XG4gIHZhciBjbG9uZSA9IF9vYmplY3RTcHJlYWQoe30sIG9iaik7XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkoZmllbGRzKSkge1xuICAgIGZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGRlbGV0ZSBjbG9uZVtrZXldO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIGNsb25lO1xufSIsImltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5XCI7XG5cbmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9XG5cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfVxuXG52YXIgYXR0cmlidXRlcyA9IFwiYWNjZXB0IGFjY2VwdENoYXJzZXQgYWNjZXNzS2V5IGFjdGlvbiBhbGxvd0Z1bGxTY3JlZW4gYWxsb3dUcmFuc3BhcmVuY3lcXG4gICAgYWx0IGFzeW5jIGF1dG9Db21wbGV0ZSBhdXRvRm9jdXMgYXV0b1BsYXkgY2FwdHVyZSBjZWxsUGFkZGluZyBjZWxsU3BhY2luZyBjaGFsbGVuZ2VcXG4gICAgY2hhclNldCBjaGVja2VkIGNsYXNzSUQgY2xhc3NOYW1lIGNvbFNwYW4gY29scyBjb250ZW50IGNvbnRlbnRFZGl0YWJsZSBjb250ZXh0TWVudVxcbiAgICBjb250cm9scyBjb29yZHMgY3Jvc3NPcmlnaW4gZGF0YSBkYXRlVGltZSBkZWZhdWx0IGRlZmVyIGRpciBkaXNhYmxlZCBkb3dubG9hZCBkcmFnZ2FibGVcXG4gICAgZW5jVHlwZSBmb3JtIGZvcm1BY3Rpb24gZm9ybUVuY1R5cGUgZm9ybU1ldGhvZCBmb3JtTm9WYWxpZGF0ZSBmb3JtVGFyZ2V0IGZyYW1lQm9yZGVyXFxuICAgIGhlYWRlcnMgaGVpZ2h0IGhpZGRlbiBoaWdoIGhyZWYgaHJlZkxhbmcgaHRtbEZvciBodHRwRXF1aXYgaWNvbiBpZCBpbnB1dE1vZGUgaW50ZWdyaXR5XFxuICAgIGlzIGtleVBhcmFtcyBrZXlUeXBlIGtpbmQgbGFiZWwgbGFuZyBsaXN0IGxvb3AgbG93IG1hbmlmZXN0IG1hcmdpbkhlaWdodCBtYXJnaW5XaWR0aCBtYXggbWF4TGVuZ3RoIG1lZGlhXFxuICAgIG1lZGlhR3JvdXAgbWV0aG9kIG1pbiBtaW5MZW5ndGggbXVsdGlwbGUgbXV0ZWQgbmFtZSBub1ZhbGlkYXRlIG5vbmNlIG9wZW5cXG4gICAgb3B0aW11bSBwYXR0ZXJuIHBsYWNlaG9sZGVyIHBvc3RlciBwcmVsb2FkIHJhZGlvR3JvdXAgcmVhZE9ubHkgcmVsIHJlcXVpcmVkXFxuICAgIHJldmVyc2VkIHJvbGUgcm93U3BhbiByb3dzIHNhbmRib3ggc2NvcGUgc2NvcGVkIHNjcm9sbGluZyBzZWFtbGVzcyBzZWxlY3RlZFxcbiAgICBzaGFwZSBzaXplIHNpemVzIHNwYW4gc3BlbGxDaGVjayBzcmMgc3JjRG9jIHNyY0xhbmcgc3JjU2V0IHN0YXJ0IHN0ZXAgc3R5bGVcXG4gICAgc3VtbWFyeSB0YWJJbmRleCB0YXJnZXQgdGl0bGUgdHlwZSB1c2VNYXAgdmFsdWUgd2lkdGggd21vZGUgd3JhcFwiO1xudmFyIGV2ZW50c05hbWUgPSBcIm9uQ29weSBvbkN1dCBvblBhc3RlIG9uQ29tcG9zaXRpb25FbmQgb25Db21wb3NpdGlvblN0YXJ0IG9uQ29tcG9zaXRpb25VcGRhdGUgb25LZXlEb3duXFxuICAgIG9uS2V5UHJlc3Mgb25LZXlVcCBvbkZvY3VzIG9uQmx1ciBvbkNoYW5nZSBvbklucHV0IG9uU3VibWl0IG9uQ2xpY2sgb25Db250ZXh0TWVudSBvbkRvdWJsZUNsaWNrXFxuICAgIG9uRHJhZyBvbkRyYWdFbmQgb25EcmFnRW50ZXIgb25EcmFnRXhpdCBvbkRyYWdMZWF2ZSBvbkRyYWdPdmVyIG9uRHJhZ1N0YXJ0IG9uRHJvcCBvbk1vdXNlRG93blxcbiAgICBvbk1vdXNlRW50ZXIgb25Nb3VzZUxlYXZlIG9uTW91c2VNb3ZlIG9uTW91c2VPdXQgb25Nb3VzZU92ZXIgb25Nb3VzZVVwIG9uU2VsZWN0IG9uVG91Y2hDYW5jZWxcXG4gICAgb25Ub3VjaEVuZCBvblRvdWNoTW92ZSBvblRvdWNoU3RhcnQgb25TY3JvbGwgb25XaGVlbCBvbkFib3J0IG9uQ2FuUGxheSBvbkNhblBsYXlUaHJvdWdoXFxuICAgIG9uRHVyYXRpb25DaGFuZ2Ugb25FbXB0aWVkIG9uRW5jcnlwdGVkIG9uRW5kZWQgb25FcnJvciBvbkxvYWRlZERhdGEgb25Mb2FkZWRNZXRhZGF0YVxcbiAgICBvbkxvYWRTdGFydCBvblBhdXNlIG9uUGxheSBvblBsYXlpbmcgb25Qcm9ncmVzcyBvblJhdGVDaGFuZ2Ugb25TZWVrZWQgb25TZWVraW5nIG9uU3RhbGxlZCBvblN1c3BlbmQgb25UaW1lVXBkYXRlIG9uVm9sdW1lQ2hhbmdlIG9uV2FpdGluZyBvbkxvYWQgb25FcnJvclwiO1xudmFyIHByb3BMaXN0ID0gXCJcIi5jb25jYXQoYXR0cmlidXRlcywgXCIgXCIpLmNvbmNhdChldmVudHNOYW1lKS5zcGxpdCgvW1xcc1xcbl0rLyk7XG4vKiBlc2xpbnQtZW5hYmxlIG1heC1sZW4gKi9cblxudmFyIGFyaWFQcmVmaXggPSAnYXJpYS0nO1xudmFyIGRhdGFQcmVmaXggPSAnZGF0YS0nO1xuXG5mdW5jdGlvbiBtYXRjaChrZXksIHByZWZpeCkge1xuICByZXR1cm4ga2V5LmluZGV4T2YocHJlZml4KSA9PT0gMDtcbn1cbi8qKlxuICogUGlja2VyIHByb3BzIGZyb20gZXhpc3QgcHJvcHMgd2l0aCBmaWx0ZXJcbiAqIEBwYXJhbSBwcm9wcyBQYXNzZWQgcHJvcHNcbiAqIEBwYXJhbSBhcmlhT25seSBib29sZWFuIHwgeyBhcmlhPzogYm9vbGVhbjsgZGF0YT86IGJvb2xlYW47IGF0dHI/OiBib29sZWFuOyB9IGZpbHRlciBjb25maWdcbiAqL1xuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHBpY2tBdHRycyhwcm9wcykge1xuICB2YXIgYXJpYU9ubHkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlO1xuICB2YXIgbWVyZ2VkQ29uZmlnO1xuXG4gIGlmIChhcmlhT25seSA9PT0gZmFsc2UpIHtcbiAgICBtZXJnZWRDb25maWcgPSB7XG4gICAgICBhcmlhOiB0cnVlLFxuICAgICAgZGF0YTogdHJ1ZSxcbiAgICAgIGF0dHI6IHRydWVcbiAgICB9O1xuICB9IGVsc2UgaWYgKGFyaWFPbmx5ID09PSB0cnVlKSB7XG4gICAgbWVyZ2VkQ29uZmlnID0ge1xuICAgICAgYXJpYTogdHJ1ZVxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgbWVyZ2VkQ29uZmlnID0gX29iamVjdFNwcmVhZCh7fSwgYXJpYU9ubHkpO1xuICB9XG5cbiAgdmFyIGF0dHJzID0ge307XG4gIE9iamVjdC5rZXlzKHByb3BzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBpZiAoIC8vIEFyaWFcbiAgICBtZXJnZWRDb25maWcuYXJpYSAmJiAoa2V5ID09PSAncm9sZScgfHwgbWF0Y2goa2V5LCBhcmlhUHJlZml4KSkgfHwgLy8gRGF0YVxuICAgIG1lcmdlZENvbmZpZy5kYXRhICYmIG1hdGNoKGtleSwgZGF0YVByZWZpeCkgfHwgLy8gQXR0clxuICAgIG1lcmdlZENvbmZpZy5hdHRyICYmIHByb3BMaXN0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGF0dHJzW2tleV0gPSBwcm9wc1trZXldO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBhdHRycztcbn0iLCJ2YXIgcmFmID0gZnVuY3Rpb24gcmFmKGNhbGxiYWNrKSB7XG4gIHJldHVybiArc2V0VGltZW91dChjYWxsYmFjaywgMTYpO1xufTtcblxudmFyIGNhZiA9IGZ1bmN0aW9uIGNhZihudW0pIHtcbiAgcmV0dXJuIGNsZWFyVGltZW91dChudW0pO1xufTtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICdyZXF1ZXN0QW5pbWF0aW9uRnJhbWUnIGluIHdpbmRvdykge1xuICByYWYgPSBmdW5jdGlvbiByYWYoY2FsbGJhY2spIHtcbiAgICByZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShjYWxsYmFjayk7XG4gIH07XG5cbiAgY2FmID0gZnVuY3Rpb24gY2FmKGhhbmRsZSkge1xuICAgIHJldHVybiB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUoaGFuZGxlKTtcbiAgfTtcbn1cblxudmFyIHJhZlVVSUQgPSAwO1xudmFyIHJhZklkcyA9IG5ldyBNYXAoKTtcblxuZnVuY3Rpb24gY2xlYW51cChpZCkge1xuICByYWZJZHMuZGVsZXRlKGlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gd3JhcHBlclJhZihjYWxsYmFjaykge1xuICB2YXIgdGltZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDE7XG4gIHJhZlVVSUQgKz0gMTtcbiAgdmFyIGlkID0gcmFmVVVJRDtcblxuICBmdW5jdGlvbiBjYWxsUmVmKGxlZnRUaW1lcykge1xuICAgIGlmIChsZWZ0VGltZXMgPT09IDApIHtcbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICBjbGVhbnVwKGlkKTsgLy8gVHJpZ2dlclxuXG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBOZXh0IHJhZlxuICAgICAgdmFyIHJlYWxJZCA9IHJhZihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNhbGxSZWYobGVmdFRpbWVzIC0gMSk7XG4gICAgICB9KTsgLy8gQmluZCByZWFsIHJhZiBpZFxuXG4gICAgICByYWZJZHMuc2V0KGlkLCByZWFsSWQpO1xuICAgIH1cbiAgfVxuXG4gIGNhbGxSZWYodGltZXMpO1xuICByZXR1cm4gaWQ7XG59XG5cbndyYXBwZXJSYWYuY2FuY2VsID0gZnVuY3Rpb24gKGlkKSB7XG4gIHZhciByZWFsSWQgPSByYWZJZHMuZ2V0KGlkKTtcbiAgY2xlYW51cChyZWFsSWQpO1xuICByZXR1cm4gY2FmKHJlYWxJZCk7XG59OyIsImltcG9ydCBfdHlwZW9mIGZyb20gXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2ZcIjtcbmltcG9ydCB7IGlzTWVtbyB9IGZyb20gJ3JlYWN0LWlzJztcbmV4cG9ydCBmdW5jdGlvbiBmaWxsUmVmKHJlZiwgbm9kZSkge1xuICBpZiAodHlwZW9mIHJlZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJlZihub2RlKTtcbiAgfSBlbHNlIGlmIChfdHlwZW9mKHJlZikgPT09ICdvYmplY3QnICYmIHJlZiAmJiAnY3VycmVudCcgaW4gcmVmKSB7XG4gICAgcmVmLmN1cnJlbnQgPSBub2RlO1xuICB9XG59XG4vKipcbiAqIE1lcmdlIHJlZnMgaW50byBvbmUgcmVmIGZ1bmN0aW9uIHRvIHN1cHBvcnQgcmVmIHBhc3NpbmcuXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBvc2VSZWYoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZWZzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIHJlZnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICByZWZzLmZvckVhY2goZnVuY3Rpb24gKHJlZikge1xuICAgICAgZmlsbFJlZihyZWYsIG5vZGUpO1xuICAgIH0pO1xuICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHN1cHBvcnRSZWYobm9kZU9yQ29tcG9uZW50KSB7XG4gIHZhciBfdHlwZSRwcm90b3R5cGUsIF9ub2RlT3JDb21wb25lbnQkcHJvdDtcblxuICB2YXIgdHlwZSA9IGlzTWVtbyhub2RlT3JDb21wb25lbnQpID8gbm9kZU9yQ29tcG9uZW50LnR5cGUudHlwZSA6IG5vZGVPckNvbXBvbmVudC50eXBlOyAvLyBGdW5jdGlvbiBjb21wb25lbnQgbm9kZVxuXG4gIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJyAmJiAhKChfdHlwZSRwcm90b3R5cGUgPSB0eXBlLnByb3RvdHlwZSkgPT09IG51bGwgfHwgX3R5cGUkcHJvdG90eXBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdHlwZSRwcm90b3R5cGUucmVuZGVyKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSAvLyBDbGFzcyBjb21wb25lbnRcblxuXG4gIGlmICh0eXBlb2Ygbm9kZU9yQ29tcG9uZW50ID09PSAnZnVuY3Rpb24nICYmICEoKF9ub2RlT3JDb21wb25lbnQkcHJvdCA9IG5vZGVPckNvbXBvbmVudC5wcm90b3R5cGUpID09PSBudWxsIHx8IF9ub2RlT3JDb21wb25lbnQkcHJvdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vZGVPckNvbXBvbmVudCRwcm90LnJlbmRlcikpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cbi8qIGVzbGludC1lbmFibGUgKi8iLCIvKipcbiAqIEVhc3kgdG8gc2V0IGVsZW1lbnQgc3R5bGUsIHJldHVybiBwcmV2aW91cyBzdHlsZVxuICogSUUgYnJvd3NlciBjb21wYXRpYmxlKElFIGJyb3dzZXIgZG9lc24ndCBtZXJnZSBvdmVyZmxvdyBzdHlsZSwgbmVlZCB0byBzZXQgaXQgc2VwYXJhdGVseSlcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9hbnQtZGVzaWduL2FudC1kZXNpZ24vaXNzdWVzLzE5MzkzXG4gKlxuICovXG5mdW5jdGlvbiBzZXRTdHlsZShzdHlsZSkge1xuICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgaWYgKCFzdHlsZSkge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIHZhciBfb3B0aW9ucyRlbGVtZW50ID0gb3B0aW9ucy5lbGVtZW50LFxuICAgICAgZWxlbWVudCA9IF9vcHRpb25zJGVsZW1lbnQgPT09IHZvaWQgMCA/IGRvY3VtZW50LmJvZHkgOiBfb3B0aW9ucyRlbGVtZW50O1xuICB2YXIgb2xkU3R5bGUgPSB7fTtcbiAgdmFyIHN0eWxlS2V5cyA9IE9iamVjdC5rZXlzKHN0eWxlKTsgLy8gSUUgYnJvd3NlciBjb21wYXRpYmxlXG5cbiAgc3R5bGVLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIG9sZFN0eWxlW2tleV0gPSBlbGVtZW50LnN0eWxlW2tleV07XG4gIH0pO1xuICBzdHlsZUtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgZWxlbWVudC5zdHlsZVtrZXldID0gc3R5bGVba2V5XTtcbiAgfSk7XG4gIHJldHVybiBvbGRTdHlsZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc2V0U3R5bGU7IiwiaW1wb3J0IGdldFNjcm9sbEJhclNpemUgZnJvbSAnLi9nZXRTY3JvbGxCYXJTaXplJztcbmltcG9ydCBzZXRTdHlsZSBmcm9tICcuL3NldFN0eWxlJztcblxuZnVuY3Rpb24gaXNCb2R5T3ZlcmZsb3dpbmcoKSB7XG4gIHJldHVybiBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCA+ICh3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkgJiYgd2luZG93LmlubmVyV2lkdGggPiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoO1xufVxuXG52YXIgY2FjaGVTdHlsZSA9IHt9O1xuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uIChjbG9zZSkge1xuICBpZiAoIWlzQm9keU92ZXJmbG93aW5nKCkgJiYgIWNsb3NlKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbnQtZGVzaWduL2FudC1kZXNpZ24vaXNzdWVzLzE5NzI5XG5cblxuICB2YXIgc2Nyb2xsaW5nRWZmZWN0Q2xhc3NOYW1lID0gJ2FudC1zY3JvbGxpbmctZWZmZWN0JztcbiAgdmFyIHNjcm9sbGluZ0VmZmVjdENsYXNzTmFtZVJlZyA9IG5ldyBSZWdFeHAoXCJcIi5jb25jYXQoc2Nyb2xsaW5nRWZmZWN0Q2xhc3NOYW1lKSwgJ2cnKTtcbiAgdmFyIGJvZHlDbGFzc05hbWUgPSBkb2N1bWVudC5ib2R5LmNsYXNzTmFtZTtcblxuICBpZiAoY2xvc2UpIHtcbiAgICBpZiAoIXNjcm9sbGluZ0VmZmVjdENsYXNzTmFtZVJlZy50ZXN0KGJvZHlDbGFzc05hbWUpKSByZXR1cm47XG4gICAgc2V0U3R5bGUoY2FjaGVTdHlsZSk7XG4gICAgY2FjaGVTdHlsZSA9IHt9O1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NOYW1lID0gYm9keUNsYXNzTmFtZS5yZXBsYWNlKHNjcm9sbGluZ0VmZmVjdENsYXNzTmFtZVJlZywgJycpLnRyaW0oKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2Nyb2xsQmFyU2l6ZSA9IGdldFNjcm9sbEJhclNpemUoKTtcblxuICBpZiAoc2Nyb2xsQmFyU2l6ZSkge1xuICAgIGNhY2hlU3R5bGUgPSBzZXRTdHlsZSh7XG4gICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgIHdpZHRoOiBcImNhbGMoMTAwJSAtIFwiLmNvbmNhdChzY3JvbGxCYXJTaXplLCBcInB4KVwiKVxuICAgIH0pO1xuXG4gICAgaWYgKCFzY3JvbGxpbmdFZmZlY3RDbGFzc05hbWVSZWcudGVzdChib2R5Q2xhc3NOYW1lKSkge1xuICAgICAgdmFyIGFkZENsYXNzTmFtZSA9IFwiXCIuY29uY2F0KGJvZHlDbGFzc05hbWUsIFwiIFwiKS5jb25jYXQoc2Nyb2xsaW5nRWZmZWN0Q2xhc3NOYW1lKTtcbiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NOYW1lID0gYWRkQ2xhc3NOYW1lLnRyaW0oKTtcbiAgICB9XG4gIH1cbn0pOyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldChlbnRpdHksIHBhdGgpIHtcbiAgdmFyIGN1cnJlbnQgPSBlbnRpdHk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgaWYgKGN1cnJlbnQgPT09IG51bGwgfHwgY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGN1cnJlbnQgPSBjdXJyZW50W3BhdGhbaV1dO1xuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnQ7XG59IiwiaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tIFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHlcIjtcbmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5XCI7XG5pbXBvcnQgX3RvQXJyYXkgZnJvbSBcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQXJyYXlcIjtcblxuZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH1cblxuZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9XG5cbmltcG9ydCBnZXQgZnJvbSAnLi9nZXQnO1xuXG5mdW5jdGlvbiBpbnRlcm5hbFNldChlbnRpdHksIHBhdGhzLCB2YWx1ZSwgcmVtb3ZlSWZVbmRlZmluZWQpIHtcbiAgaWYgKCFwYXRocy5sZW5ndGgpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICB2YXIgX3BhdGhzID0gX3RvQXJyYXkocGF0aHMpLFxuICAgICAgcGF0aCA9IF9wYXRoc1swXSxcbiAgICAgIHJlc3RQYXRoID0gX3BhdGhzLnNsaWNlKDEpO1xuXG4gIHZhciBjbG9uZTtcblxuICBpZiAoIWVudGl0eSAmJiB0eXBlb2YgcGF0aCA9PT0gJ251bWJlcicpIHtcbiAgICBjbG9uZSA9IFtdO1xuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZW50aXR5KSkge1xuICAgIGNsb25lID0gX3RvQ29uc3VtYWJsZUFycmF5KGVudGl0eSk7XG4gIH0gZWxzZSB7XG4gICAgY2xvbmUgPSBfb2JqZWN0U3ByZWFkKHt9LCBlbnRpdHkpO1xuICB9IC8vIERlbGV0ZSBwcm9wIGlmIGByZW1vdmVJZlVuZGVmaW5lZGAgYW5kIHZhbHVlIGlzIHVuZGVmaW5lZFxuXG5cbiAgaWYgKHJlbW92ZUlmVW5kZWZpbmVkICYmIHZhbHVlID09PSB1bmRlZmluZWQgJiYgcmVzdFBhdGgubGVuZ3RoID09PSAxKSB7XG4gICAgZGVsZXRlIGNsb25lW3BhdGhdW3Jlc3RQYXRoWzBdXTtcbiAgfSBlbHNlIHtcbiAgICBjbG9uZVtwYXRoXSA9IGludGVybmFsU2V0KGNsb25lW3BhdGhdLCByZXN0UGF0aCwgdmFsdWUsIHJlbW92ZUlmVW5kZWZpbmVkKTtcbiAgfVxuXG4gIHJldHVybiBjbG9uZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc2V0KGVudGl0eSwgcGF0aHMsIHZhbHVlKSB7XG4gIHZhciByZW1vdmVJZlVuZGVmaW5lZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7XG5cbiAgLy8gRG8gbm90aGluZyBpZiBgcmVtb3ZlSWZVbmRlZmluZWRgIGFuZCBwYXJlbnQgb2JqZWN0IG5vdCBleGlzdFxuICBpZiAocGF0aHMubGVuZ3RoICYmIHJlbW92ZUlmVW5kZWZpbmVkICYmIHZhbHVlID09PSB1bmRlZmluZWQgJiYgIWdldChlbnRpdHksIHBhdGhzLnNsaWNlKDAsIC0xKSkpIHtcbiAgICByZXR1cm4gZW50aXR5O1xuICB9XG5cbiAgcmV0dXJuIGludGVybmFsU2V0KGVudGl0eSwgcGF0aHMsIHZhbHVlLCByZW1vdmVJZlVuZGVmaW5lZCk7XG59IiwiLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqL1xudmFyIHdhcm5lZCA9IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIHdhcm5pbmcodmFsaWQsIG1lc3NhZ2UpIHtcbiAgLy8gU3VwcG9ydCB1Z2xpZnlcbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIXZhbGlkICYmIGNvbnNvbGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJXYXJuaW5nOiBcIi5jb25jYXQobWVzc2FnZSkpO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gbm90ZSh2YWxpZCwgbWVzc2FnZSkge1xuICAvLyBTdXBwb3J0IHVnbGlmeVxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhdmFsaWQgJiYgY29uc29sZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc29sZS53YXJuKFwiTm90ZTogXCIuY29uY2F0KG1lc3NhZ2UpKTtcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0V2FybmVkKCkge1xuICB3YXJuZWQgPSB7fTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjYWxsKG1ldGhvZCwgdmFsaWQsIG1lc3NhZ2UpIHtcbiAgaWYgKCF2YWxpZCAmJiAhd2FybmVkW21lc3NhZ2VdKSB7XG4gICAgbWV0aG9kKGZhbHNlLCBtZXNzYWdlKTtcbiAgICB3YXJuZWRbbWVzc2FnZV0gPSB0cnVlO1xuICB9XG59XG5leHBvcnQgZnVuY3Rpb24gd2FybmluZ09uY2UodmFsaWQsIG1lc3NhZ2UpIHtcbiAgY2FsbCh3YXJuaW5nLCB2YWxpZCwgbWVzc2FnZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gbm90ZU9uY2UodmFsaWQsIG1lc3NhZ2UpIHtcbiAgY2FsbChub3RlLCB2YWxpZCwgbWVzc2FnZSk7XG59XG5leHBvcnQgZGVmYXVsdCB3YXJuaW5nT25jZTtcbi8qIGVzbGludC1lbmFibGUgKi8iXSwic291cmNlUm9vdCI6IiJ9